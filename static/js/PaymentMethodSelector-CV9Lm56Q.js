import{_ as L,z as V,bB as z,r as A,D as T,F as c,G as m,H as n,P as u,$ as r,J as q,K as E,Z as k,I as d,U as y,Q as l,O as a,a3 as H,a4 as h,X as M,Y as j}from"./vendor-Dr_RpJ_Y.js";import{_ as G}from"./point-arrow-BXwQ0Ukh.js";import{a as J,e as B,al as C,k as K,y as Q}from"./index-CU2nzZe6.js";import{P as b}from"./order-H59PKTFP.js";import{u as X}from"./usePointRelase-RvMNM9mf.js";const Y=i=>(M("data-v-5d6544c4"),i=i(),j(),i),Z={class:"payment-method-selector bg-b6 rounded-xl overflow-hidden"},ee={class:"custom-title flex items-center justify-start gap-2"},te=["onClick"],oe=Y(()=>d("img",{src:G,class:"w-4 h-4 mx-3"},null,-1)),ae={class:"text-xs text-b3 flex w-full overflow-x-auto"},se={class:"min-w-fit"},ne={key:1},le={key:2,class:"flex min-w-fit"},ie={key:1},re={class:"text-sm text-b2 my-4 leading-5"},ce={class:"flex justify-center gap-x-2"},ue=V({name:"PaymentMethodSelector"});function de(i,{expose:$,emit:v}){const w=i,{contributesStore:s}=J(),{handleNaturePointsToast:x}=X(),[D,p]=z(!1),f=A(w.modelValue.toString()),R=e=>{f.value=e.toString(),v("update:modelValue",e),v("change",e)},I=()=>{var e,o,g,_;(e=s.releaseData)!=null&&e.remainTotal&&+((o=s.releaseData)==null?void 0:o.remainTotal)>0&&(!((g=s.releaseData)!=null&&g.nextSubmitDate)||new Date().getTime()>=+((_=s.releaseData)==null?void 0:_.nextSubmitDate))?x(S):p(!0)},S=()=>{let e=0;const o=async()=>{console.log("payment-method-selector getPointBalance"),v("getPointBalance"),s.fetchContributes(),await Promise.all([s.fetchUserRelase(),s.getNaturalReleaseTimes()]),e++,e<3&&setTimeout(o,3e3)};o()},N=()=>{p(!1),x(S)};return T(()=>w.modelValue,e=>{f.value=e.toString()}),T(()=>w.boutique,e=>{if(e)try{setTimeout(()=>{s.fetchContributes(),s.fetchUserRelase(),s.getNaturalReleaseTimes()},150)}catch(o){console.warn("Failed to obtain points related data",o)}},{immediate:!0,deep:!0}),$({selectedPaySource:f}),(e,o)=>{const g=c("van-image"),_=c("van-loading"),O=c("van-radio"),U=c("van-cell"),W=c("van-cell-group"),F=c("van-radio-group"),P=c("VanButton");return n(),m("div",Z,[u(F,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=t=>f.value=t)},{default:r(()=>[(n(!0),m(q,null,E(i.paymentOptions,t=>(n(),k(W,{key:t.source},{default:r(()=>[u(U,{center:"",title:e.$t(t.name),clickable:"",onClick:()=>R(t.source)},{icon:r(()=>[u(g,{src:a(K)(t.icon),class:"w-6 h-6 mr-3"},null,8,["src"])]),title:r(()=>[d("div",ee,[d("span",null,l(e.$t(t.name)),1),t.source===a(b).WITHDRAW_POINTS&&a(B)(a(s).freeRelease)>0?(n(),m("div",{key:0,class:"text-xs font-normal text-newOrigin flex-center",onClick:H(I,["stop"])},[h(l(e.$t("integral.keshifang",{num:a(B)(a(s).freeRelease)})),1),oe],8,te)):y("",!0)]),d("div",ae,[d("span",se,l(e.$t("huabei.nowCanUse",{symbol:t.source===a(b).USDT_WALLET?`(${t.symbol})`:null})),1),i.loading?(n(),k(_,{key:0,size:"14"})):(n(),m("span",ne,l(a(C)(t.balance)),1)),t.source===a(b).WITHDRAW_POINTS?(n(),m("span",le,[h(" /"+l(e.$t("integral.order_can_use"))+" ",1),i.loading?(n(),k(_,{key:0,size:"14"})):(n(),m("span",ie,l(a(C)(t.availableBalance)),1))])):y("",!0)])]),"right-icon":r(()=>[u(O,{"icon-size":"16px",name:t.source.toString(),"checked-color":"#FF8812"},null,8,["name"])]),_:2},1032,["title","onClick"])]),_:2},1024))),128))]),_:1},8,["modelValue"]),u(Q,{show:a(D),name:e.$t("common.tip"),onClose:o[2]||(o[2]=t=>a(p)(!1))},{default:r(()=>[d("div",re,l(e.$t("integral.relaseTip")),1),d("div",ce,[u(P,{type:"primary",class:"flex-1 min-w-[130px] h-[46px] rounded-full border border-solid border-b4 bg-white text-b2 text-base font-semibold",onClick:o[1]||(o[1]=t=>a(p)(!1))},{default:r(()=>[h(l(e.$t("common.cancel")),1)]),_:1}),u(P,{class:"bg-btnOrBg rounded-full w-full text-b1 font-semibold",onClick:N},{default:r(()=>[h(l(e.$t("common.confirm")),1)]),_:1})])]),_:1},8,["show","name"])])}}const me=V({...ue,props:{paymentOptions:null,modelValue:{default:b.WALLET},boutique:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["update:modelValue","change","getPointBalance"],setup:de}),be=L(me,[["__scopeId","data-v-5d6544c4"]]);export{be as P};
