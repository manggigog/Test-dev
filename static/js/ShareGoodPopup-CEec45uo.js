import{_ as ce}from"./shop-arrow-right-Br6r0Qcd.js";import{B as de}from"./BoutiqueLabelInLogo-8rzV321c.js";import{R as re}from"./RatioBox-ys008e7W.js";import{g as me,r as Q,h as ue,V as M,ax as fe,ay as pe,aE as ve,d as he}from"./index-k1FFr-1T.js";import{_ as H,y as O,bf as ge,z as K,E as B,F as c,G as n,H as t,P as m,O as u,a0 as I,Q as i,Y as N,Z as F,x as P,be as L,a2 as $,N as k,a4 as z,w as xe,r as S,D as ye,a9 as we,K as V,I as _e,R as G,$ as be,T as j,bc as ke,bd as $e,bn as Se}from"./vendor-BUT0HZ5j.js";import{b as Ie,c as Be,d as Te,e as Ce}from"./GoodsInfo-DtQoQgyg.js";import{_ as Ae}from"./kefu-BZ7ykajd.js";import{c as De}from"./goods-Dr4TCxnz.js";import{D as E}from"./goods-BVwS8oFG.js";import{c as Y,i as J,s as W}from"./convertToImage-DIjasxRw.js";import{d as q}from"./active_empty-CBz3QrKQ.js";import{H as Ue}from"./HelpPop-2HtEDPpf.js";import{_ as Ve}from"./MCOIN-BcbOHmhy.js";import{_ as je}from"./logo-CT48NEDW.js";const is="/Test-dev/static/images/good_back-D3eNN5v8.png",cs="/Test-dev/static/images/good_share-1a0Cq1VD.png",Ee=e=>(N("data-v-0e486320"),e=e(),F(),e),Le={class:"w-full flex justify-start items-center"},He={class:"w-10 h-10 rounded-[4px] overflow-hidden flex-shrink-0 relative"},Oe=["src"],Ne={class:"absolute right-0 top-0"},Fe={class:"ml-1 h-10 flex flex-col justify-between items-start"},Pe={class:"text-base font-semibold text-black line-clamp-1 max-w-max leading-[22px] flex items-center"},ze=Ee(()=>t("img",{src:ce,class:"shrink-0 w-4 h-4 object-cover"},null,-1)),Re={class:"flex items-center text-xs text-primary"},Me={class:"ml-1"},Ge={class:"h-10 flex flex-col justify-start items-center ml-auto flex-shrink-0"},qe=O({props:{store:null},emits:["handleTo"],setup(e,{emit:w}){const a=e;return ge({}),K(()=>a.store.id,()=>{},{immediate:!0}),(o,p)=>{const x=B("van-rate");return n(),c("div",{class:"p-3 mb-2.5 bg-white rounded-xl text-base",onClick:p[1]||(p[1]=d=>w("handleTo",`/shop?shopId=${e.store.id}`))},[t("div",Le,[t("div",He,[t("img",{src:e.store.logo||e.store.scenery&&e.store.scenery.split(",")[0]||m(me)("images/goods/defaultImg.png"),class:"w-10 h-full object-cover"},null,8,Oe),t("div",Ne,[u(de,{type:e.store.type},null,8,["type"])])]),t("div",Fe,[t("div",Pe,[I(i(e.store.storeName)+" ",1),ze]),t("div",Re,[u(x,{class:"flex-shrink-0",readonly:"","allow-half":"",modelValue:e.store.star,"onUpdate:modelValue":p[0]||(p[0]=d=>e.store.star=d),size:14,gutter:"1",color:"#FEA021"},null,8,["modelValue"]),t("span",Me,i(e.store.star),1)])]),t("div",Ge,[u(re,{tag:o.$t("common.rebate"),ratio:e.store.discountRatio||0},null,8,["tag","ratio"])])])])}}}),ds=H(qe,[["__scopeId","data-v-0e486320"]]),X="/Test-dev/static/images/collect_b-kiXhnb3F.svg",Z="/Test-dev/static/images/collect_gray-BYsbfCdJ.svg",Qe={class:"w-[335px] relative rounded-none",id:"serverQR"},Ke={class:"img-box rounded-none"},Ye=["src"],Je={key:0,class:"fixed left-0 w-full px-2.5 flex-center-bw top-1.5"},We={class:"ml-1 text-sm font-normal"},Xe=O({props:{show:{type:Boolean},imgUrl:null},emits:["close","onSuccess"],setup(e,{emit:w}){const a=e,{loadingToggle:o}=Q(),p=P(()=>a.imgUrl?a.imgUrl.startsWith("http")?a.imgUrl+"?"+new Date().getTime():q:q),[x,d]=L(!1),f=()=>{w("close")},C=()=>{d(!0),o(!0),document.getElementById("serverQR")?setTimeout(()=>{_()},200):setTimeout(()=>{_()},3e3)},_=async()=>{let r=document.getElementById("serverQR");r.style.display="block";const v=await Y(r);await J(v)&&W(v,"img")&&setTimeout(()=>{f(),d(!1),o(!1),w("onSuccess")},3e3)};return(r,v)=>{const b=B("van-icon"),A=B("VanButton");return a.show?(n(),c("div",{key:0,class:"popup-overlay",onClick:f},[t("div",Qe,[t("div",Ke,[t("img",{src:m(p),alt:"",crossOrigin:"anonymous"},null,8,Ye)]),m(x)?$("",!0):(n(),c("div",Je,[u(A,{class:"text-sm h-[30px] min-w-[65px] rounded-2xl text-white share-btn",onClick:z(C,["stop"])},{default:k(()=>[u(b,{name:"back-top",class:"rotate-180",size:"14"}),t("span",We,i(r.$t("common.save")),1)]),_:1},8,["onClick"]),t("div",{class:"share-btn w-[30px] h-[30px] rounded-full flex justify-center items-center text-white text-lg",onClick:f},[u(b,{name:"cross"})])]))])])):$("",!0)}}}),Ze=H(Xe,[["__scopeId","data-v-062c2a0c"]]),ee=e=>(N("data-v-3a73f7c6"),e=e(),F(),e),et={class:"w-full flex items-center justify-between bg-white rounded-full sm:w-[355px]"},tt={class:"flex justify-between"},st={key:0,src:Ie,class:"w-6 h-6 m-auto mb-1"},ot={key:1,src:Be,class:"w-6 h-6 m-auto mb-1"},lt={class:"text-[#999] text-xs"},nt={key:0,class:"text-xs text-center px-1.5 mr-3"},at=ee(()=>t("img",{src:Ae,class:"w-6 h-6 m-auto mb-1"},null,-1)),it={class:"text-[#999] text-xs"},ct={key:0,src:X,class:"w-6 h-6 m-auto mb-1"},dt={key:1,src:Z,class:"w-6 h-6 m-auto mb-1"},rt={class:"text-[#999] text-xs"},mt={key:0,src:X,class:"w-6 h-6 m-auto mb-1"},ut={key:1,src:Z,class:"w-6 h-6 m-auto mb-1"},ft={class:"text-[#999] text-xs"},pt={key:0,class:"flex flex-1 justify-end"},vt={class:"flex items-center"},ht=ee(()=>t("img",{src:Te,class:"h-6 m-auto mr-1 w-11"},null,-1)),gt={key:0,class:"text-center text-white"},xt={class:"text-sm leading-3"},yt={class:"text-lg font-medium leading-5"},wt=I(" Mcoin "),_t={class:"text-[0.675rem]"},bt={class:"mr-0.5"},kt={key:1,class:"py-2.5 ml-2 text-[#999] text-base"},$t={key:2,class:"py-2.5 ml-2 text-[#999] text-base"},St=O({props:{isFollow:{type:Boolean},goodsId:null,isSale:{type:Boolean},isSaleEnd:{type:Boolean},isSaleStart:{type:Boolean},isSaleOver:{type:Boolean},goods:null,systemTime:null,currentAmount:null,totalAmount:null,payType:null,boutiqueFlag:{type:Boolean},deliveryType:null,storeInfo:null,stock:null,goodsTypes:null},emits:["handeToShop","handleConnect","handleBuy","handleAddCart","toPurchase","handleOffine"],setup(e,{expose:w,emit:a}){const o=e,[p,x]=L(!1),{t:d}=xe(),f=S(!1),[C,_]=L(!1),r=S(!1),v=S([]),b=S(null),A=s=>{var l;if(s.id==="metakey"){try{window==null||window.handleCustomerService({shopId:(l=o.goods)==null?void 0:l.shopId})}catch(h){console.log(h)}return}if(s.id==="downloadmetakey"){se();return}s.customerServiceLink?s.customerServiceLink.includes("img.s3")?(b.value=s.customerServiceLink,x(!0)):(j({message:d("common.link copy and open"),duration:4e3}),ue(s.customerServiceLink)):j({message:d("common.no service")})},te=async()=>{const s=o.storeInfo.id,l=await ve(s);if(l.success){const h=[];l.data.forEach(y=>{y.customerServiceLink&&h.push({text:y.nickname,id:y.id,customerServiceLink:y.customerServiceLink,disabled:!1})}),v.value=h,C.value?h.unshift({text:d("common.meta-key-service"),id:"metakey",disabled:!1}):h.unshift({text:d("common.meta-key-service"),id:"downloadmetakey",disabled:!1})}},U=S(!1),se=()=>{U.value=!0};K(()=>o.storeInfo,()=>{var s;(s=o.storeInfo)!=null&&s.id&&te()},{immediate:!0,deep:!0});const R=S(!1),oe=P(()=>[{text:d("piggy.normalBuy"),id:1}]),le=s=>{a("handleBuy",`payType=${s.id}`)},ne=()=>{De({goodsIds:[o.goodsId],type:f.value?2:1,collectType:o.isSale?2:1}).then(s=>{s.success&&(f.value?j({message:d("common.cancel collect"),icon:M("toast-success.svg")}):j({message:d("common.collect success"),icon:M("toast-success.svg")}),f.value=!f.value)})},T=S(!1),ae=async()=>{var l,h;if(T.value||!((l=o.goods)!=null&&l.goodsId))return;o.goods.collectId=9999,T.value=!0;const s=await fe({goodsId:(h=o.goods)==null?void 0:h.goodsId});T.value=!1,s.success&&(o.goods.collectId=s.data)},ie=async()=>{var l;if(T.value||!((l=o.goods)!=null&&l.goodsId))return;let s=o.goods.collectId;o.goods.collectId=null,T.value=!0,await pe({ids:[s]}),T.value=!1};return w({}),ye(()=>{var s;f.value=o.isFollow,(s=window.ethereum)!=null&&s.isMetaKey?_(!0):_(!1)}),we(()=>{}),(s,l)=>{const h=B("van-popover"),y=B("VanButton");return n(),c("div",{class:G(["fixed bottom-0 sm:left-1/2 sm:-translate-x-2/4 left-0 sm:w-[375px] w-full bg-white box-shadow safe-bottom flex-center pt-2.5 px-2.5 font-Puhui font-normal",m(p)?"z-[2003]":"z-20"])},[t("div",et,[t("div",tt,[t("div",{class:"text-xs text-center px-1.5 mr-3",onClick:l[0]||(l[0]=()=>a("handeToShop"))},[e.isSale?(n(),c("img",ot)):(n(),c("img",st)),t("div",lt,i(s.$t("mall.shop")),1)]),u(h,{show:r.value,"onUpdate:show":l[1]||(l[1]=g=>r.value=g),actions:v.value,onSelect:A,placement:"top",trigger:"click"},{reference:k(()=>[v.value.length>0?(n(),c("div",nt,[at,t("div",it,i(s.$t("common.service")),1)])):$("",!0)]),_:1},8,["show","actions"]),!e.isSale&&e.deliveryType===m(E).online?(n(),c("div",{key:0,class:"text-xs text-center px-1.5",onClick:ne},[f.value?(n(),c("img",ct)):(n(),c("img",dt)),t("div",rt,i(s.$t("common.collect")),1)])):$("",!0),!e.isSale&&e.deliveryType===m(E).offeline?(n(),c("div",{key:1,class:"text-xs text-center px-1.5",onClick:l[2]||(l[2]=g=>e.goods.collectId?ie():ae())},[e.goods.collectId?(n(),c("img",mt)):(n(),c("img",ut)),t("div",ft,i(s.$t("common.collect")),1)])):$("",!0)]),e.isSale?(n(),V(y,{key:1,class:G(["min-w-[60px] rounded-3xl px-2.5",o.isSaleEnd||o.isSaleStart||o.currentAmount>=o.totalAmount?"bg-[#D9D9D9]":"bg-[#FB1A18]"]),disabled:o.isSaleStart||o.isSaleEnd||o.currentAmount>=o.totalAmount,onClick:l[7]||(l[7]=()=>{a("toPurchase")})},{default:k(()=>[t("div",vt,[ht,!o.isSaleEnd&&!o.isSaleStart&&o.currentAmount<o.totalAmount?(n(),c("div",gt,[t("div",xt,[t("span",yt,i(e.goods.price),1),wt]),t("div",_t,[t("span",bt,i(s.$t("refund.TotalNum",{num:e.totalAmount})),1),t("span",null,i(s.$t("flashSale.Already snatched"))+i(o.currentAmount)+i(s.$t("common.pieces")),1)])])):o.isSaleStart?(n(),c("div",kt,i(s.$t("common.no start")),1)):(n(),c("div",$t,i(o.currentAmount>=o.totalAmount?s.$t("flashSale.Alreadygrabbed"):s.$t("flashSale.gooderror")),1))])]),_:1},8,["disabled","class"])):(n(),c("div",pt,[e.deliveryType===m(E).online?(n(),c(_e,{key:0},[u(y,{class:"px-4 text-sm text-newOrigin rounded-r-none bg-newOrigin/20 rounded-l-3xl",disabled:e.stock===0&&e.goodsTypes!=2,onClick:l[3]||(l[3]=z(g=>a("handleAddCart"),["stop"]))},{default:k(()=>[I(i(s.$t("common.addCart")),1)]),_:1},8,["disabled"]),e.payType!==3||e.boutiqueFlag?(n(),V(y,{key:0,class:"px-4 text-sm text-default rounded-l-none rounded-r-3xl bg-btnOrBg",onClick:l[4]||(l[4]=()=>a("handleBuy",e.payType===2?"":"payType=1")),disabled:e.stock===0&&e.goodsTypes!=2},{default:k(()=>[I(i(e.payType===2?s.$t("piggy.cardBuy"):s.$t("common.Buy it now")),1)]),_:1},8,["disabled"])):(n(),V(h,{key:1,placement:"top",show:R.value,"onUpdate:show":l[5]||(l[5]=g=>R.value=g),actions:m(oe),onSelect:le},{reference:k(()=>[u(y,{class:"px-5 text-sm text-white bg-primary rounded-r-3xl",disabled:e.stock===0&&e.goodsTypes!=2},{default:k(()=>[I(i(s.$t("common.Buy it now")),1)]),_:1},8,["disabled"])]),_:1},8,["show","actions"]))],64)):(n(),V(y,{key:1,class:"max-w-[200px] w-full !justify-center text-sm text-default text-center bg-btnOrBg rounded-3xl ml-6",onClick:l[6]||(l[6]=()=>a("handleOffine")),text:s.$t("common.payBill")},null,8,["text"]))]))]),u(Ze,{show:m(p),"onUpdate:show":l[8]||(l[8]=g=>be(p)?p.value=g:null),imgUrl:b.value,onOnSuccess:l[9]||(l[9]=g=>m(x)(!1)),onClose:l[10]||(l[10]=g=>m(x)(!1))},null,8,["show","imgUrl"]),u(Ue,{show:U.value,"onUpdate:show":l[11]||(l[11]=g=>U.value=g),display:["download","account","wallet","auth"],onClose:l[12]||(l[12]=g=>U.value=!1)},null,8,["show"])],2)}}}),rs=H(St,[["__scopeId","data-v-3a73f7c6"]]),D=e=>(N("data-v-e260fc0e"),e=e(),F(),e),It={class:"w-[335px] relative",id:"saveHtml"},Bt={class:"img-box"},Tt=["src"],Ct={key:0,class:"fixed left-0 w-full px-2.5 flex-center-bw top-1.5"},At=D(()=>t("div",null,null,-1)),Dt={class:"px-2.5 py-2"},Ut={class:"flex items-center justify-start text-primary"},Vt=D(()=>t("div",{class:"mr-1.5 w-6 flex-shrink-0"},[t("img",{class:"w-6 h-6",src:Ve})],-1)),jt={class:"text-[#FEA021] text-3xl font-medium mr-1"},Et=D(()=>t("span",{class:"text-base"},"Mcoin",-1)),Lt={class:"self-center ml-4"},Ht={class:"mt-1 text-sm font-semibold text-left text-default"},Ot={class:"flex items-center justify-between pt-8"},Nt={class:"flex items-center"},Ft={class:"border border-solid border-black/20 p-0.5"},Pt={class:"ml-3 text-sm text-black-800 opacity-80"},zt=D(()=>t("br",null,null,-1)),Rt=D(()=>t("img",{src:je,class:"w-[60px] h-[60px] object-contain"},null,-1)),Mt={key:1,class:"fixed w-fit px-2.5 left-1/2 bottom-9 transform -translate-x-1/2"},Gt={class:"ml-1 text-sm font-normal"},qt=O({props:{show:{type:Boolean},goods:null,codeUrl:null},emits:["close","onSuceess"],setup(e,{emit:w}){const a=e,{loadingToggle:o}=Q(),p=P(()=>a.codeUrl||window.location.origin+"/#/goodsDetail?id="+a.goods.id),[x,d]=L(!1),f=()=>{w("close")},C=()=>{d(!0),o(!0),document.getElementById("saveHtml")?setTimeout(()=>{_()},200):setTimeout(()=>{_()},3e3)},_=async()=>{let r=document.getElementById("saveHtml");r.style.display="block";const v=await Y(r);await J(v)&&W(v,a.goods.goodsName||a.goods.title||"")&&setTimeout(()=>{f(),d(!1),o(!1),w("onSuceess")},3e3)};return(r,v)=>{const b=B("van-icon"),A=B("VanButton");return a.show?(n(),c("div",{key:0,class:"popup-overlay",onClick:f},[t("div",{class:"popup-content",onClick:v[0]||(v[0]=z(()=>{},["stop"]))},[t("div",It,[t("div",Bt,[t("img",{src:(a.goods.icons||a.goods.mainImageUrls||"").split(",")[0]+"?"+new Date().getTime(),alt:"",crossOrigin:"anonymous"},null,8,Tt)]),m(x)?$("",!0):(n(),c("div",Ct,[At,t("div",{class:"share-btn w-[30px] h-[30px] rounded-full flex justify-center items-center text-white text-lg",onClick:f},[u(b,{name:"cross"})])])),t("div",Dt,[t("div",Ut,[Vt,t("div",null,[t("span",jt,i(m(he)(a.goods.price||0)),1),Et]),ke(t("div",Lt,[u(Ce,{goods:e.goods},null,8,["goods"])],512),[[$e,e.goods.deliveryType===m(E).online]])]),t("div",Ht,i(a.goods.goodsName||a.goods.title||""),1),t("div",Ot,[t("div",Nt,[t("div",Ft,[u(Se,{value:m(p),size:60,level:"H"},null,8,["value"])]),t("div",Pt,[I(i(r.$t("common.new found")),1),zt,I(i(r.$t("common.share you")),1)])]),Rt])]),m(x)?$("",!0):(n(),c("div",Mt,[u(A,{class:"text-sm h-[30px] min-w-[65px] rounded-2xl text-white share-btn",onClick:C},{default:k(()=>[u(b,{name:"back-top",class:"rotate-180",size:"14"}),t("span",Gt,i(r.$t("common.save img")),1)]),_:1})]))])])])):$("",!0)}}}),ms=H(qt,[["__scopeId","data-v-e260fc0e"]]);export{rs as G,ds as S,is as _,ms as a,cs as b};
