import{C as $e}from"./CommonVanProvider-D__Wy38-.js";import{_ as Q,z as Fe,r as V,F as j,G as B,H as g,I as e,P as d,$ as c,Q as m,bv as We,X,Y,y as z,Z as G,a3 as Le,O as a,U as oe,K as ne,J as le,a4 as C,bl as Te,a2 as F,E as Ve,T as u,a0 as je}from"./vendor-Dr_RpJ_Y.js";import{_ as Be}from"./search-C4fLtTfY.js";import{B as Ie}from"./BetweenTab-nGcUWfRT.js";import{B as Oe,r as Pe,C as q,c as Re}from"./index-BckdT6oc.js";import{a as He,b as y,f as Ee}from"./account-DB9d_JsQ.js";import{a as De}from"./activityContract-BZvr-VTx.js";import"./BackIcon-CDrGaEPo.js";/* empty css                                                               */const Me=""+new URL("../images/vip-D3L2MIbj.svg",import.meta.url).href,Ne=n=>(X("data-v-33b16693"),n=n(),Y(),n),Ue={class:"flex items-center"},Ke={class:"flex-1 bg-white rounded-3xl search-input-box"},Je=Ne(()=>e("div",null,[e("img",{src:Be,class:"w-4 h-4"})],-1)),ze=Fe({props:{modelValue:{type:String,default:""}},emits:["update:modelValue","onSubmit"],setup(n,{emit:b}){const x=V(null),k=()=>{b("onSubmit"),x.value.blur()};return(L,w)=>{const I=j("VanField");return g(),B("div",Ue,[e("div",Ke,[d(I,{ref:(i,O)=>{O.searchRef=i,x.value=i},onKeyup:We(k,["enter"]),"model-value":n.modelValue,"onUpdate:modelValue":w[1]||(w[1]=i=>b("update:modelValue",i)),placeholder:"请输入地址进行查找",class:"w-[100% - 20px] text-center bg-transparent items-center",clearable:"",enterkeyhint:"search"},{"left-icon":c(()=>[Je]),"right-icon":c(()=>[e("div",{onClick:w[0]||(w[0]=i=>b("onSubmit")),class:"text-newOrigin font-semibold leading-5"},m(L.$t("common.search")),1)]),_:1},8,["onKeyup","model-value"])])])}}}),qe=Q(ze,[["__scopeId","data-v-33b16693"]]),re=n=>(X("data-v-2535b8de"),n=n(),Y(),n),Ge={class:"w-full bg-[#F5F5F5] rounded-t-[20px] overflow-hidden"},Qe={class:"text-center w-full relative px-6 pt-6 pb-4"},Xe={class:"text-base font-bold text-[#332100]"},Ye=["onClick"],Ze={class:"px-4 pb-4"},et={class:"mb-4 bg-white px-3 rounded-[12px]"},tt={class:"add-item text-sm text-orange-500 font-semibold break-all border-b px-[20%] py-[16px] !last-child:border-b-none text-center"},st={class:"flex items-center justify-between h-[52px]"},at=re(()=>e("div",{class:"text-sm text-b3 font-normal"},"申请状态",-1)),ot={class:"text-sm text-b1 font-normal"},nt={class:"mb-4"},lt=re(()=>e("div",{class:"text-sm text-b3 font-normal mb-4"},"白名单地址列表",-1)),rt={class:"space-y-2 max-h-[310px] overflow-y-auto bg-white rounded-[12px] text-center px-3"},dt={key:0,class:"text-sm text-b3 font-normal text-center py-4"},it={class:"flex items-center justify-center gap-3"},ct=C(" 拒绝 "),ut=C(" 通过 "),pt={props:{show:{type:Boolean,required:!0,default:!1},title:{type:String,default:"此地址申请编辑白名单"},data:{type:Object,default:()=>({applyAddress:"",applyInfo:"",type:3,message:"",messageHash:"",signature:""})},loading:{type:Boolean,default:!1}},emits:["close","confirm","reject"],setup(n,{emit:b}){const x=n,k=z(()=>{if(!x.data.applyInfo)return[];let o={};return typeof x.data.applyInfo=="string"&&(o=JSON.parse(x.data.applyInfo)||[]),o&&o.addressList?o.addressList||[]:[]}),L=z(()=>{if(!x.data.applyInfo)return!1;let o={};return typeof x.data.applyInfo=="string"&&(o=JSON.parse(x.data.applyInfo)||[]),o&&o.switchStatus&&o.switchStatus||!1}),w=z(()=>L.value===!0?"开启":"关闭"),I=o=>typeof o=="string"?o:o&&typeof o=="object"&&(o.address||o.applyAddress)||"--",i=()=>{b("close")},O=()=>{const o=L.value,M=k.value.map(P=>P.address)||[];b("confirm",{switch_:o,addrs:M})},T=()=>{b("reject")};return(o,M)=>{const P=j("van-icon"),p=j("van-button"),r=j("VanPopup");return g(),G(r,{teleport:"body",position:"bottom",show:n.show,style:{background:"transparent","max-height":"95vh"},"close-on-click-overlay":!0,onClickOverlay:i,onClose:i},{default:c(()=>[e("div",Ge,[e("header",Qe,[e("div",Xe,m(n.title),1),e("div",{class:"absolute right-4 top-6",onClick:Le(i,["stop"])},[d(P,{name:"cross",size:"20"})],8,Ye)]),e("div",Ze,[e("div",et,[e("div",tt,m(n.data.applyAddress||"--"),1),e("div",st,[at,e("div",ot,m(a(w)),1)])]),e("div",nt,[lt,e("div",rt,[a(k).length===0?(g(),B("div",dt," 无白名单地址 ")):oe("",!0),(g(!0),B(le,null,ne(a(k),(R,f)=>(g(),B("div",{key:f,class:"add-item text-sm text-b2 font-normal break-all border-b px-[20%] py-[16px] !last-child:border-b-none font-Puhui"},m(I(R)),1))),128))])]),e("div",it,[d(p,{class:"w-full h-[46px] bg-[#f44] border-none rounded-[100px] text-white text-sm font-semibold text-center",loading:n.loading,onClick:T},{default:c(()=>[ct]),_:1},8,["loading"]),d(p,{class:"w-full h-[46px] bg-[#07C160] border-none rounded-[100px] text-white text-sm font-semibold text-center",loading:n.loading,onClick:O},{default:c(()=>[ut]),_:1},8,["loading"])])])])]),_:1},8,["show"])}}},ft=Q(pt,[["__scopeId","data-v-2535b8de"]]),W=n=>(X("data-v-d442bcfc"),n=n(),Y(),n),ht={class:"px-3 mt-3"},mt={class:"overflow-y-auto p-3 h-[calc(100vh-132px)]"},_t=["onClick"],xt={class:"flex items-center justify-between mb-4"},vt={class:"text-sm text-b2 font-semibold"},bt={class:"text-sm text-orange-500 font-semibold"},gt=W(()=>e("div",{class:"border-t border-[#D9D9D9] mb-4"},null,-1)),wt={class:"flex gap-2 h-[40px] items-center"},yt=W(()=>e("div",{class:"text-sm text-b3 font-normal flex-shrink-0"}," 申请地址 ",-1)),Ct={class:"text-sm text-b1 word-break text-right pl-[20%] ml-auto"},kt={class:"h-[86px]"},At={class:"text-sm text-b2 font-normal px-8 break-words h-[40px]"},St={class:"flex items-center justify-center gap-3 mt-6"},$t=C(" 拒绝 "),Ft=C(" 通过 "),Wt={class:"h-[86px]"},Lt={class:"text-sm text-b2 font-normal px-8 break-words h-[40px]"},Tt={class:"flex items-center justify-center gap-3 mt-6"},Vt=C(" 拒绝 "),jt=C(" 通过 "),Bt={class:"h-[256px]"},It={class:"flex flex-col gap-2"},Ot=W(()=>e("div",{class:"bg-[#FFF1E3] h-[36px] w-full p-2 text-left rounded"},[e("span",{class:"text-[#FF8812] tex-sm font-normal"},"请仔细核对申请人提交的新地址")],-1)),Pt={class:"flex gap-2 items-center h-[56px] border-b"},Rt=W(()=>e("div",{class:"text-sm text-b3 font-normal flex-shrink-0"},"原地址",-1)),Ht={class:"text-sm text-b1 word-break text-right pl-[5%] ml-auto"},Et={class:"flex gap-2 items-center h-[56px] border-b"},Dt=W(()=>e("div",{class:"text-sm text-b3 font-normal flex-shrink-0"},"新地址",-1)),Mt={class:"text-sm text-b1 word-break text-right pl-[5%] ml-auto"},Nt={class:"flex gap-2 items-center h-[36px]"},Ut=W(()=>e("div",{class:"text-sm text-b3 font-normal flex-shrink-0"},"等级",-1)),Kt={class:"text-sm text-b1 word-break text-right pl-[20%] ml-auto"},Jt={class:"flex items-center bg-[#fed73a] h-[20px] px-[6px] rounded-full gap-[1px]"},zt=W(()=>e("img",{src:Me,class:"w-[14px] h-[14px]",alt:""},null,-1)),qt={class:"text-sm text-b1 font-normal"},Gt={class:"flex items-center justify-center gap-3 mt-6"},Qt=C(" 拒绝 "),Xt=C(" 通过 "),Yt={setup(n){const{memberLevels:b}=Re(),{unbanWithdraw:x,banWithdraw:k,transferAccount:L,updateTradeWhitelist:w}=De(),I=[{label:"全部",value:""},{label:"关闭提取",value:0},{label:"开放提取",value:1},{label:"网体授权",value:2},{label:"赠送白名单",value:3}],i=Te({type:"",address:""}),O=async t=>{_.value.memberLevel=await b(t)},[T,o]=F(!1),[M,P]=F(!1),[p,r]=F(!1),R=V([]),f=async()=>{u.loading({message:"加载中...",duration:0});const t={type:i.type,applyAddress:i.address};o(!0);const s=await He(t);s.success&&(R.value=s.data||[]),u.clear(),P(!0),o(!1)},de=t=>({0:"关闭提取",1:"开放提取",2:"网体授权",3:"编辑白名单"})[t]||"未知操作",ie=()=>{f()},ce=t=>{t.type===0?pe(t):t.type===1?_e(t):t.type===2?ge(t):t.type===3&&ke(t)},[ue,N]=F(!1),A=V({}),pe=t=>{A.value=t,N(!0)},Z=()=>{N(!1)},fe=async()=>{console.log("handleConfirmBanWithdraw");try{r(!0);const t=A.value.applyAddress,s=A.value.messageHash,v=A.value.signature;if((await k(t,s,v)).success){const l={id:A.value.id,approvedFlag:!0};await y(l),u.success("已通过申请"),N(!1),f()}}catch(t){console.error("关闭提取失败:",t)}finally{r(!1)}},he=async()=>{try{r(!0);const t={id:A.value.id,approvedFlag:!1};await y(t),u.success("已拒绝申请"),Z(),f()}catch{}finally{r(!1)}},[me,ee]=F(!1),S=V({}),_e=t=>{S.value=t,ee(!0)},U=()=>{ee(!1)},xe=async()=>{try{r(!0);const t=S.value.applyAddress,s=S.value.messageHash,v=S.value.signature;if((await x(t,s,v)).success){const l={id:S.value.id,approvedFlag:!0};await y(l),u.success("已通过申请"),U(),f()}}catch{}finally{r(!1)}},ve=async()=>{try{r(!0);const t={id:S.value.id,approvedFlag:!1};await y(t),u.success("已拒绝申请"),U(),f()}catch{}finally{r(!1)}},[be,te]=F(!1),_=V({}),ge=async t=>{_.value=t,te(!0),O(t.applyAddress)},K=()=>{te(!1)},we=async()=>{var t;try{r(!0);const s=await Ee({address:_.value.applyAddress});if(!(s!=null&&s.data)||((t=s==null?void 0:s.data)==null?void 0:t.length)===0){u.fail("没有下级地址");return}const v=_.value.applyAddress,h=_.value.applyInfo||"",l=s.data||[],H=_.value.messageHash,E=_.value.signature;if((await L(v,h,H,l,E)).success){const D={id:_.value.id,approvedFlag:!0};await y(D),u.success("已通过申请"),K(),f()}}catch{}finally{r(!1)}},ye=async()=>{try{r(!0);const t={id:_.value.id,approvedFlag:!1};await y(t),u.success("已拒绝申请"),K(),f()}catch{}finally{r(!1)}},[Ce,se]=F(!1),$=V({}),ke=t=>{$.value=t,se(!0)},J=()=>{se(!1)},Ae=async t=>{try{r(!0);const s=$.value.applyAddress,v=t.switch_||!1,h=t.addrs||[],l=$.value.messageHash,H=$.value.signature;console.log("account",s),console.log("switch_",v),console.log("addrs",h),console.log("messageHash",l),console.log("signature",H);const E=await w(s,v,h,l,H);if(!E.success){u.fail(E.message);return}const ae={id:$.value.id,approvedFlag:!0},D=await y(ae);if(!D.success){u.fail(D.message);return}u.success("已通过申请"),J(),f()}catch{}finally{r(!1)}},Se=async()=>{try{r(!0);const t={id:$.value.id,approvedFlag:!1},s=await y(t);if(!s.success){u.fail(s.message);return}u.success("已拒绝申请"),J(),f()}catch{}finally{r(!1)}};return Ve(()=>{f()}),(t,s)=>{const v=j("van-list"),h=j("van-button");return g(),G($e,{title:"操作申请",class:"font-Puhui font-normal relative bg-gray1 h-[100vh] overflow-hidden",themeVars:{navBarBackgroundColor:"#ffffff"}},{default:c(()=>[d(Ie,{options:I,"label-key":"label","value-key":"value",modelValue:a(i).type,"onUpdate:modelValue":s[0]||(s[0]=l=>a(i).type=l),onChange:ie},null,8,["modelValue"]),e("div",ht,[d(qe,{modelValue:a(i).address,"onUpdate:modelValue":s[1]||(s[1]=l=>a(i).address=l),onOnSubmit:f},null,8,["modelValue"])]),e("div",mt,[R.value.length===0&&!a(T)?(g(),G(Oe,{key:0,name:"没有操作申请",class:"py-6"})):oe("",!0),d(v,{loading:a(T),"onUpdate:loading":s[2]||(s[2]=l=>je(T)?T.value=l:null),finished:"","error-text":"请求失败，点击重新加载"},{default:c(()=>[(g(!0),B(le,null,ne(R.value,l=>(g(),B("div",{key:l.id,class:"bg-white rounded-[12px] px-4 py-3 mb-3",onClick:H=>ce(l)},[e("div",xt,[e("div",vt,m(a(Pe)(l.createTime)),1),e("div",bt,m(de(l.type)),1)]),gt,e("div",wt,[yt,e("div",Ct,m(l.applyAddress||l.address||"-"),1)])],8,_t))),128))]),_:1},8,["loading"])]),d(q,{show:a(ue),title:"此地址申请关闭提取",showConfirm:!1,showReject:!1,loading:a(p),onClose:Z},{default:c(()=>[e("div",kt,[e("p",At,m(A.value.applyAddress||"--"),1),e("div",St,[d(h,{class:"w-full h-[46px] bg-[#f44] border-none rounded-[100px] text-white text-sm font-semibold text-center",loading:a(p),onClick:he},{default:c(()=>[$t]),_:1},8,["loading"]),d(h,{class:"w-full h-[46px] bg-[#07C160] border-none rounded-[100px] text-white text-sm font-semibold text-center",loading:a(p),onClick:fe},{default:c(()=>[Ft]),_:1},8,["loading"])])])]),_:1},8,["show","loading"]),d(q,{show:a(me),title:"此地址申请开放提取",showConfirm:!1,showReject:!1,loading:a(p),onClose:U},{default:c(()=>[e("div",Wt,[e("p",Lt,m(S.value.applyAddress||"--"),1),e("div",Tt,[d(h,{class:"w-full h-[46px] bg-[#f44] border-none rounded-[100px] text-white text-sm font-semibold text-center",loading:a(p),onClick:ve},{default:c(()=>[Vt]),_:1},8,["loading"]),d(h,{class:"w-full h-[46px] bg-[#07C160] border-none rounded-[100px] text-white text-sm font-semibold text-center",loading:a(p),onClick:xe},{default:c(()=>[jt]),_:1},8,["loading"])])])]),_:1},8,["show","loading"]),d(q,{show:a(be),title:"此地址申请网体授权",showConfirm:!1,showReject:!1,loading:a(p),onClose:K},{default:c(()=>[e("div",Bt,[e("div",It,[Ot,e("div",Pt,[Rt,e("div",Ht,m(_.value.applyAddress||"-"),1)]),e("div",Et,[Dt,e("div",Mt,m(_.value.applyInfo||"-"),1)]),e("div",Nt,[Ut,e("div",Kt,[e("div",Jt,[zt,e("span",qt,"V"+m(_.value.memberLevel||0),1)])])])]),e("div",Gt,[d(h,{class:"w-full h-[46px] bg-[#f44] border-none rounded-[100px] text-white text-sm font-semibold text-center",loading:a(p),onClick:ye},{default:c(()=>[Qt]),_:1},8,["loading"]),d(h,{class:"w-full h-[46px] bg-[#07C160] border-none rounded-[100px] text-white text-sm font-semibold text-center",loading:a(p),onClick:we},{default:c(()=>[Xt]),_:1},8,["loading"])])])]),_:1},8,["show","loading"]),d(ft,{show:a(Ce),data:$.value,onClose:J,onConfirm:Ae,onReject:Se,loading:a(p)},null,8,["show","data","loading"])]),_:1})}}},ds=Q(Yt,[["__scopeId","data-v-d442bcfc"]]);export{ds as default};
