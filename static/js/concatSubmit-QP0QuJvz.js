import{_ as z}from"./arrow-CRN8rk-J.js";import{_ as N}from"./upload-B7OBZe8E.js";import{B as O}from"./BackIcon-biFt6cm7.js";import{_ as G,y as H,be as L,w as Y,r as a,F as q,G as Q,H as e,O as i,N as x,Q as n,R as Z,E as d,P as J,$ as K,T as b,l as M,Y as W,Z as X}from"./vendor-BUT0HZ5j.js";import{r as ee,a2 as te,q as oe}from"./index-BvL8wS8a.js";import{u as se}from"./upload-CFisGMJ4.js";import{b as ae}from"./concat-BFkpLYeO.js";const ne="/Test-dev/static/images/close-icon-BPGUtSYx.svg",p=m=>(W("data-v-2ba51370"),m=m(),X(),m),le={class:"w-full bg-[#F2F0EF]"},ue={class:"header-bar bg-white sticky top-0 flex font-normal justify-start text-sm items-center h-[44px] px-2.5 z-50"},ie={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},re={class:"relative w-full p-4 overflow-hidden content-wrap"},ce=p(()=>e("div",{class:"w-5 h-5 ml-auto"},[e("img",{class:"w-5 h-5 opacity-50",src:z,alt:""})],-1)),de={class:"w-full min-h-[170px] p-4 mt-4 bg-white rounded-[10px] relative cursor-pointer"},pe={class:"mt-4 mb-0"},me={class:"bg-[#F2F0EF] p-2.5 pt-[5px] rounded-xl w-[60px] h-[60px]"},fe=p(()=>e("img",{class:"w-[24px] h-[24px] m-auto object-cover",src:N},null,-1)),ve={class:"text-[#2E2008] opacity-30 text-xxs mt-[2px]"},xe={class:"text-xxs text-[#2E2008] opacity-30 leading-none text-center w-full"},_e={class:"text-count absolute bottom-[15px] right-[15px]"},he={class:"text-xxs text-[#2E2008] leading-none text-right"},be={class:"w-full h-[50px] p-4 mt-4 flex items-center justify-start bg-white rounded-[10px] cursor-pointer"},ge=p(()=>e("span",{class:"mr-2 whitespace-nowrap"},"完整地址(选填)",-1)),we={class:"text-sm font-normal text-black"},ke={class:"relative h-[56px] flex items-center justify-center text-[#2e2008]"},Ee=p(()=>e("div",{class:"text-base title"},"选择交流类型",-1)),ye=p(()=>e("img",{class:"w-5 h-5",src:ne},null,-1)),Ce=[ye],Be={class:"flex p-4 gap-3 pb-[calc(16px+env(safe-area-inset-bottom))]"},Fe=H({setup(m){const g=M(),{loadingToggle:f}=ee(),[r,w]=L(!1),{t:C}=Y(),v=a(null),_=a(null),B=a([{name:"订单问题",id:"1"},{name:"商品问题",id:"2"},{name:"店铺问题",id:"3"},{name:"账户问题",id:"4"},{name:"功能bug",id:"5"},{name:"操作体验",id:"6"},{name:"其他",id:"7"}]),c=a(""),l=a([]),h=a(""),k=a(3),E=a(200),F=async t=>{try{f(!0,1);const o=await te(t,"feedback"),u=await se(o);if(!u.success)return l.value.length-=1;l.value[l.value.length-1]={url:oe.imgUrl+u.data}}finally{f(!1)}},V=()=>{w(!0)},D=t=>{console.log(t,"value"),v.value=t.name,_.value=t.id,w(!1)},y=a(null),I=()=>{var t;(t=y.value)==null||t.confirm()},S=async()=>{if(!_.value){b("请选择交流类型");return}if(!c.value){b(C("user.Enter your concat"));return}f(!0);const t=l.value.map(u=>u.url).join(",");let o={};o=await ae({content:c.value,imageUrls:t,typeStr:_.value,fullAddress:h.value}),f(!1),o.success&&(b("发布成功"),setTimeout(()=>{A()},1e3))},A=()=>{g.back()},T=t=>{g.push(t)};return(t,o)=>{const u=d("van-field"),$=d("van-uploader"),j=d("van-button"),P=d("VanPicker"),R=d("VanPopup");return Q(),q("div",le,[e("section",ue,[e("div",ie,[i(O,null,{default:x(()=>[e("span",null,n(t.$t("common.comminicate")),1)]),_:1})]),e("div",{class:"ml-auto text-[#999]",onClick:o[0]||(o[0]=s=>T("/concatHistory"))},n(t.$t("common.history")),1)]),e("div",re,[e("div",{class:"w-full h-[50px] p-4 flex items-center justify-start bg-white rounded-[10px] cursor-pointer",onClick:V},[e("div",{class:Z(["text-sm font-normal",{"font-medium":!!v.value}])},n(v.value?v.value:"请选择交流类型"),3),ce]),e("div",de,[i(u,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=s=>c.value=s),rows:"5",autosize:"",label:"",type:"textarea",placeholder:t.$t("user.Enter your concat"),maxlength:E.value,class:"van-field"},null,8,["modelValue","placeholder","maxlength"]),e("div",pe,[i($,{modelValue:l.value,"onUpdate:modelValue":o[2]||(o[2]=s=>l.value=s),accept:"image/*","max-count":k.value,"preview-size":"60",afterRead:F},{default:x(()=>[e("div",me,[fe,e("div",ve,n(t.$t("common.add img")),1),e("div",xe,n(l.value.length)+" / "+n(k.value),1)])]),_:1},8,["modelValue","max-count"])]),e("div",_e,[e("div",he,n(c.value.length)+" / "+n(E.value),1)])]),e("div",be,[ge,i(u,{modelValue:h.value,"onUpdate:modelValue":o[3]||(o[3]=s=>h.value=s),"input-align":"right",placeholder:t.$t("shop.pleaseInput"),class:"van-field"},null,8,["modelValue","placeholder"])]),i(j,{class:"w-full h-[50px] p-4 mt-4 flex items-center justify-center bg-[#FED73A] rounded-full cursor-pointer",onClick:S},{default:x(()=>[e("div",we,n(t.$t("common.submit")),1)]),_:1})]),i(R,{show:J(r),"onUpdate:show":o[6]||(o[6]=s=>K(r)?r.value=s:null),round:"",position:"bottom","show-toolbar":"","safe-area-inset-bottom":!0,class:"custom-popup"},{default:x(()=>[e("div",ke,[Ee,e("div",{class:"absolute p-1 -translate-y-1/2 cursor-pointer right-4 top-1/2",onClick:o[4]||(o[4]=s=>r.value=!1)},Ce)]),i(P,{ref:(s,U)=>{U.pickerRef=s,y.value=s},"value-key":"name","show-toolbar":!1,columns:B.value,"default-index":0,onConfirm:D,class:"custom-picker [&_.van-picker-column__item]:text-base [&_.van-picker-column__item]:px-4 [&_.van-picker-column__item--selected]:text-[#333] [&_.van-picker-column__item--selected]:font-semibold [&::before]:border-0 [&::before]:hidden [&::after]:border-0 [&::after]:hidden border-0"},null,8,["columns"]),e("div",Be,[e("div",{class:"flex-1 w-[168px] h-12 flex items-center justify-center text-[15px] rounded-[25px] cursor-pointer bg-white text-[#333] border border-[#cdcdcd]",onClick:o[5]||(o[5]=s=>r.value=!1)}," 取消 "),e("div",{class:"flex-1 w-[168px] h-12 flex items-center justify-center text-[15px] rounded-[25px] cursor-pointer bg-[#f1ab4a] text-white",onClick:I}," 确认 ")])]),_:1},8,["show"])])}}}),je=G(Fe,[["__scopeId","data-v-2ba51370"]]);export{je as default};
