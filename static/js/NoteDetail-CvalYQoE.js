import{z as T,G as i,H as l,I as s,U as N,a3 as I,P as m,F as g,O as v,Q as w,_ as O,x as U,y as S,o as Y,r as h,E as J,ad as M,bE as Z,N as K,$ as F,Z as V,q as Q,X,Y as W,J as ee,K as te,a4 as se,aL as oe,T as ae}from"./vendor-Dr_RpJ_Y.js";import{k as ne,f as le,r as ce,a as ie,aG as ue,w as re,aH as de,aI as me,aJ as fe,Y as ve}from"./index-7OiUoGXy.js";import{B as pe}from"./BackIcon-CDrGaEPo.js";import{_ as _e,a as he}from"./GoodItem-DfwGHJgX.js";import"./collect-EjkhARjb.js";import"./useCityMap-CJiyuUmB.js";import"./MCOIN-Bodfn-v1.js";import"./ImgBoutiqueLable-B-2xCcw4.js";import"./shop-CeqcS6K2.js";const ge=""+new URL("../images/dark-delete-Bo7Z4RyI.svg",import.meta.url).href,we={class:"w-full bg-white"},xe=T({props:{data:{default:{}}},emits:["handleTo"],setup(o,{emit:p}){return(x,a)=>{var u,r,d,_,t;return l(),i("div",null,[s("div",we,[(u=o.data)!=null&&u.store?(l(),i("div",{key:0,class:"w-full bg-[#F5F5F5] rounded-[10px] p-3",onClick:a[0]||(a[0]=I(y=>{var n;return p("handleTo","/storefront?storeId="+((n=o.data)==null?void 0:n.storeId))},["stop"]))},[m(_e,{store:(r=o.data)==null?void 0:r.store},null,8,["store"])])):N("",!0),(d=o.data)!=null&&d.goods?(l(),i("div",{key:1,class:"w-full bg-[#F5F5F5] rounded-[10px] p-3 mt-3",onClick:a[1]||(a[1]=I(y=>{var n,b;return p("handleTo","/offlineGoodsDetail"+("?goodsId="+((n=o.data)==null?void 0:n.goodsId))+("&storeId="+((b=o.data)==null?void 0:b.storeId)))},["stop"]))},[m(he,{goods:(_=o.data)==null?void 0:_.goods,store:(t=o.data)==null?void 0:t.store},null,8,["goods","store"])])):N("",!0)])])}}}),ye={class:"flex justify-between items-center"},be={class:"flex items-center gap-1"},ke={class:"text-sm font-normal text-b2"},Ce={class:"text-sm font-normal text-b3"},Ie=T({props:{data:{default:{}}},setup(o){return(p,x)=>{var u,r;const a=g("VanImage");return l(),i("div",ye,[s("div",be,[m(a,{src:v(ne)("images/avatar.png"),class:"w-5 h-5 rounded-full overflow-hidden",alt:"头像"},null,8,["src"]),s("span",ke,w(v(le)(((u=o.data)==null?void 0:u.userAddress)||"","***",4,4)),1)]),s("div",null,[s("span",Ce,w(v(ce)(((r=o.data)==null?void 0:r.releaseTime)||"")),1)])])}}}),D=o=>(X("data-v-43e5af3a"),o=o(),W(),o),Be={class:"relative w-full bg-white detail-page"},Fe={class:"flex flex-wrap items-center w-10"},Ne=D(()=>s("p",{class:"text-base font-bold text-b1 text-center"},"笔记详情",-1)),Te=["onClick"],De=D(()=>s("img",{src:ge,alt:"删除",class:"w-5 h-5"},null,-1)),Le=[De],$e={key:1,class:"w-10"},Ae={class:"w-full bg-white"},Ee={class:"w-full h-fit bg-white p-4"},Se={class:"text-base font-semibold text-b1"},Ve={class:"text-sm font-normal text-b2 mt-4 min-h-[60px]"},je={class:"mt-4 flex flex-col gap-3"},qe={class:"authors mt-4"},Ge=D(()=>s("div",{class:"h-[78px]"},null,-1)),Pe={key:0,class:"fixed bottom-0 sm:w-[375px] w-full bg-white"},Re={class:"py-4 px-3 flex justify-between"},ze=se(" 感兴趣 "),He={key:1,round:"",class:"w-full font-semibold text-b1 text-base h-[46px] bg-[#D9D9D9] rounded-full flex justify-center items-center",disabled:""},Oe=T({setup(o){const{t:p}=U(),x=Y(),a=Q(),{loadingToggle:u}=re(),{accountStore:r}=ie(),d=S(()=>{var e;return(e=x.query)!=null&&e.child?document.querySelector(".detail-page"):document.getElementById("fm-page")}),_=S(()=>{var e;return((e=x.query)==null?void 0:e.noteId)||""}),t=h({}),y=h([]),n=h(!1),b=async()=>{var c,f;const e=await ue({id:_.value});e.success&&(t.value=e.data||{},y.value=(c=e.data)!=null&&c.storeNotePics?(f=e.data)==null?void 0:f.storeNotePics.split(","):[])},j=()=>{n.value||oe.confirm({messageAlign:"center",message:"确认将这篇笔记删除？",confirmButtonText:p("shop.delete"),confirmButtonColor:"#FF507A",cancelButtonText:p("cart.thinkAgain"),cancelButtonColor:"#2E2008"}).then(async()=>{n.value=!0,u(!0);const e=await de({id:_.value});n.value=!1,u(!1),e.success&&(G("删除成功","toast-success.svg"),setTimeout(()=>{var c,f,C;((C=(f=(c=a.options)==null?void 0:c.history)==null?void 0:f.state)==null?void 0:C.back.indexOf("/city/myNote"))>-1?(a.back(),setTimeout(()=>{a.replace("/city/myNote")},50)):a.replace("/city/myNote")},1e3))}).catch(()=>{})},q=async()=>{if(n.value)return;let e=t.value.addLikeCountFlag;t.value.addLikeCountFlag=!t.value.addLikeCountFlag,n.value=!0,e?(t.value.likeCount++,await me({id:t.value.storeNoteId})):(t.value.likeCount--,await fe({id:t.value.storeNoteId})),n.value=!1},G=(e="",c="toast-warn.svg")=>{ae({message:e,icon:ve(c),duration:2e3,overlay:!0,overlayClass:"toastOverlay",className:"toastCard",type:"html"})},P=e=>{a.push(e)},L=h(0);let k=h(!0);const R=()=>{var e;(e=d.value)==null||e.addEventListener("scroll",B),B()},B=Z(()=>{var e,c;L.value=((e=d.value)==null?void 0:e.scrollY)||((c=d.value)==null?void 0:c.scrollTop),L.value<100?k.value=!1:k.value=!0},100);return J(()=>{R(),b()}),M(()=>{var e;d.value&&((e=d.value)==null||e.removeEventListener("scroll",B))}),(e,c)=>{var $,A;const f=g("VanImage"),C=g("van-swipe-item"),z=g("van-swipe"),H=g("VanButton");return l(),i("div",Be,[s("header",{class:K(["flex items-center sm:w-[375px] w-full justify-between top-0 z-50 h-[50px] px-4 fixed",{"bg-white":v(k)," bg-transparent":!v(k)}])},[s("div",Fe,[m(pe)]),Ne,($=t.value)!=null&&$.userAddress&&((A=v(r))!=null&&A.account)&&t.value.userAddress.toLocaleLowerCase()===v(r).account.toLocaleLowerCase()?(l(),i("div",{key:0,onClick:I(j,["stop"])},Le,8,Te)):(l(),i("div",$e))],2),s("section",Ae,[m(z,{class:"note-imgs-swiper",autoplay:3e3,"indicator-color":"white"},{default:F(()=>[(l(!0),i(ee,null,te(y.value,E=>(l(),V(C,{key:E},{default:F(()=>[m(f,{src:E,class:"w-full h-full overflow-hidden",alt:"",fit:"cover"},null,8,["src"])]),_:2},1024))),128))]),_:1})]),s("section",Ee,[s("p",Se,w(t.value.storeNoteTopic||""),1),s("div",Ve,w(t.value.storeNoteContent||""),1),s("div",je,[m(xe,{data:t.value,onHandleTo:P},null,8,["data"])]),s("div",qe,[m(Ie,{data:t.value},null,8,["data"])])]),Ge,t.value.storeNoteId?(l(),i("section",Pe,[s("div",Re,[t.value.addLikeCountFlag?(l(),V(H,{key:0,round:"",class:"w-full main-btn font-semibold text-b1 text-base h-[46px] rounded-full",onClick:I(q,["stop"])},{default:F(()=>[ze]),_:1},8,["onClick"])):(l(),i("div",He," 已点赞 "+w(t.value.likeCount||0),1))])])):N("",!0)])}}}),et=O(Oe,[["__scopeId","data-v-43e5af3a"]]);export{et as default};
