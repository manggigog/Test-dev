import{B as H}from"./BackIcon-biFt6cm7.js";import{_ as z}from"./TimeFilter-CGMRTQ41.js";import{_ as k,y as F,w as L,r,x as A,l as j,D as N,F as S,G as g,O as _,N as B,H as e,Q as c,P as D,a1 as q,E as U,Y as V,Z as Y,I as Z,J,K}from"./vendor-BUT0HZ5j.js";import{_ as Q}from"./OfflineConsumer-C87vmyyJ.js";import{_ as W}from"./OfflineGoods-BjltvH3M.js";import{a as I,O as X}from"./offlineGoods-DvT2Go6q.js";import{f as ee,u as te,b as se,bM as oe,bH as ae,c as re}from"./index-DDhEkd_5.js";import"./avatarRing-DpEnkbQ2.js";import"./MCOIN-BcbOHmhy.js";import"./ImgBoutiqueLable-BF5Xoxsv.js";import"./shop-CeqcS6K2.js";const le={class:"list__item w-full rounded-xl bg-white p-3"},ne={class:"text-b3"},de=F({props:["order"],setup(t){const{t:i}=L(),p=r(null);A(()=>1/p.value);const v=async()=>{const{mcoinRate:a}=ee();p.value=await a()};j();const w=A(()=>[{label:i("order.wait"),value:I.PAYMENT_SUCCESS},{label:i("order.canceled"),value:I.CANCELLED},{label:i("order.completed"),value:I.COMPLETED},{label:i("common.all"),value:-1}]),y=a=>{var l;return(l=w.value.find(u=>+u.value==+a))==null?void 0:l.label};return N(async()=>{await v()}),(a,l)=>(g(),S("div",le,[_(Q,{order:t.order,"show-status":"",status:y(t.order.orderStatus)},null,8,["order","status"]),_(W,{"show-order-type":"",class:"mt-3 h-[80px]",goods:{goodsName:t.order.relName,goodsIcons:t.order.relIcons,orderType:t.order.orderType,goodsPrice:t.order.orderRealAmount},onImageClick:l[0]||(l[0]=u=>t.order.orderType===D(X).GOODS?a.handleTo("/offlineMerchantOrders/offlineGoodsDetail?goodsId="+t.order.relId):a.handleTo("/shop?shopId="+t.order.relId))},{"bottom-left":B(()=>[e("div",ne,c(a.$t("common.total"))+"：",1)]),_:1},8,["goods"])]))}}),ce=k(de,[["__scopeId","data-v-93109146"]]),ie=t=>(V("data-v-5e3c8ad6"),t=t(),Y(),t),ue={class:"w-full bg-[#F2F0EF]",style:{"background-image":"none"}},me={class:"header-bar sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50"},fe={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},_e={class:"font-semibold"},pe={class:"list-content pt-2 px-4"},ve={class:"total__wrap w-full flex flex-row justify-between gap-2"},he={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},xe={class:"text-xs font-normal text-default"},ge={class:"text-left mt-1"},we={class:"num-value text-2xl font-semibold text-left"},ye={class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},be={class:"total__item w-[50%] h-[74px] bg-white rounded-xl"},Ce={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},Ie={class:"text-xs font-normal text-default"},Se={class:"text-left mt-1"},Oe={class:"num-value text-2xl font-semibold text-left"},Te=ie(()=>e("span",{class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},"Mcoin",-1)),Ee={class:"list__wrap mt-3 w-full h-[calc(100vh-174px)] z-50 overflow-y-auto scroll-smooth"},$e=F({setup(t){const{t:i}=L(),p=q(),{getCurrentStoreId:v}=te(),w=20,y=i("order.history_order_title"),a=r(p.query.address),l=r(`${se(a.value,"...",5,5)||""}${y}`);document.title=l.value;const u=r({}),m=r([]),f=r(!1),h=r(!1),x=r(0),b=r(null),C=r(null),M=()=>{x.value=0,m.value=[],h.value=!1},P=async()=>{var n;const s={orderCustomerAddress:a.value,shopId:(n=await v())==null?void 0:n.id},o=await oe(s);o.success&&(u.value=o.data||{})},R=async()=>{var n,d,T,E,$;const s={page:x.value,size:w,shopId:(n=await v())==null?void 0:n.id,orderStatus:4,orderCustomerAddress:a.value,startTime:b.value,endTime:C.value,sortBy:"desc|create_time"},o=await ae(s);if(f.value=!1,!o.success||!o.data||!((d=o.data)!=null&&d.total)){h.value=!0;return}m.value=x.value===1?(T=o.data)==null?void 0:T.records:[...m.value,...(E=o.data)==null?void 0:E.records],h.value=m.value.length>=(($=o.data)==null?void 0:$.total)},O=async()=>{f.value=!0,x.value+=1,await R(),f.value=!1},G=s=>{s&&s[0]&&s[1]?[b.value,C.value]=s:(b.value=null,C.value=null),M(),O()};return N(()=>{P()}),(s,o)=>{const n=U("van-list");return g(),S("div",ue,[e("section",me,[e("div",fe,[_(H)]),e("div",_e,c(l.value),1)]),e("section",pe,[e("div",ve,[e("div",he,[e("p",xe,c(s.$t("order.history_order_count")),1),e("p",ge,[e("span",we,c(u.value.orderCompleteCount||0),1),e("span",ye,c(s.$t("common.order_count_suffix")),1)])]),e("div",be,[e("div",Ce,[e("p",Ie,c(s.$t("order.history_transaction_count")),1),e("p",Se,[e("span",Oe,c(D(re)(u.value.orderCompleteAmount||0)),1),Te])])])]),_(z,{"allow-reverse":"",onChange:G}),e("div",Ee,[_(n,{loading:f.value,"onUpdate:loading":o[0]||(o[0]=d=>f.value=d),finished:h.value,"finished-text":"没有更多了",onLoad:O},{default:B(()=>[(g(!0),S(Z,null,J(m.value,d=>(g(),K(ce,{key:d.id,order:d},null,8,["order"]))),128))]),_:1},8,["loading","finished"])])])])}}}),He=k($e,[["__scopeId","data-v-5e3c8ad6"]]);export{He as default};
