import{z as V,r as B,y as F,F as b,G as x,H as m,I as i,P as h,U as H,O as o,J as L,a4 as C,Q as d,Z as T,$ as v,a3 as S,_ as Y,q as z,o as U,x as D,bl as E,E as G,K as M}from"./vendor-Dr_RpJ_Y.js";import{_ as j}from"./avatarRing2-Ckr5tuam.js";import{_ as J}from"./MCOIN-Bodfn-v1.js";import{_ as K}from"./PayHelpSelector-DiNYDxtL.js";import{f as Q,e as W,a as Z,Y as X,ch as ee}from"./index-BckdT6oc.js";import{_ as te}from"./OfflineGoods-DKMaiwr2.js";import{O as $}from"./payHelp-BuwJxNdC.js";import{_ as oe}from"./HelpPayGuide-BCJKzawm.js";import{C as ne}from"./CommonVanProvider-KZuKVOde.js";import{B as se}from"./BetweenTab-nGcUWfRT.js";import{P as ae}from"./bill-DDCezy34.js";import"./offlineGoods-DvT2Go6q.js";import"./ImgBoutiqueLable-B-2xCcw4.js";import"./shop-CeqcS6K2.js";import"./tips-gray-CQI5auMx.js";import"./DescriptionPop-Cx06amZN.js";import"./BackIcon-CDrGaEPo.js";/* empty css                                                               */const ie={class:"flex items-center gap-x-1"},le=i("div",{class:"w-[30px] h-[30px] bg-b5 rounded-full"},[i("img",{src:j})],-1),re={class:"text-b2 flex-1"},ce={class:"flex gap-x-0.5 text-newOrigin font-semibold"},de={class:"text-b3"},me={class:"flex items-center"},fe=i("img",{src:J,class:"w-4 h-4 mr-1.5"},null,-1),ue={class:"text-b1 font-normal"},pe={key:0,class:"flex items-center justify-end mt-3"},ye=V({props:{info:null,type:null},emits:["removeItem"],setup(r,{emit:w}){var l;const f=r,y=B(+((l=f.info)==null?void 0:l.createTime)+15*60*1e3-+new Date().valueOf()),k=F(()=>{var s;return`${window.location.origin}/#/payHelpOffline?payId=${(s=f==null?void 0:f.info)==null?void 0:s.orderId}`}),_=B(null),R=()=>{var s;_.value&&((s=_.value)==null||s.setShow(!0))},e=()=>{y.value=0,w("removeItem")};return(s,A)=>{var g,P,t,n;const I=b("van-count-down"),O=b("VanButton");return m(),x("div",{class:"flex flex-col",ref:(a,c)=>{c.boxRef=a}},[i("div",ie,[le,i("div",re,[r.type===o($).PAYOTHER?(m(),x(L,{key:0},[C(d(o(Q)((g=r.info)==null?void 0:g.orderCustomerAddress,"...",5,5))+d(s.$t("payhelp.launch_payHelp")),1)],64)):(m(),x(L,{key:1},[C(d(s.$t("payhelp.payment_I_initiated")),1)],64))]),i("div",ce,[y.value>0?(m(),T(I,{key:0,time:y.value,format:"mm:ss",onFinish:e},null,8,["time"])):H("",!0),i("span",null,d(y.value>0?s.$t("payhelp.timeout"):s.$t("common.expired")),1)])]),h(te,{class:"mt-3","show-order-type":"",goods:{goodsIcons:(P=r.info)==null?void 0:P.relIcons,goodsName:(t=r.info)==null?void 0:t.relName,...r.info}},{"bottom-left":v(()=>[i("div",de,d(s.$t("payhelp.totalAmount"))+":",1)]),"bottom-price":v(()=>{var a;return[i("div",me,[fe,i("div",ue,d(o(W)(((a=r.info)==null?void 0:a.orderRealAmount)||0)),1)])]}),_:1},8,["goods"]),r.type===o($).OTHER?(m(),x("div",pe,[h(O,{class:"bg-yellow h-[32px] px-3 rounded-md text-b1 font-semibold",onClick:S(R,["stop"])},{default:v(()=>[C(d(s.$t("payhelp.share_link")),1)]),_:1},8,["onClick"])])):H("",!0),h(K,{ref:(a,c)=>{c.payHelpRef=a,_.value=a},amount:(n=r.info)==null?void 0:n.orderRealAmount,link:o(k)},null,8,["amount","link"])],512)}}}),he=["src"],_e={class:"text-b3"},ge={class:"mx-3 py-3 safe-body overflow-y-auto"},ve=V({name:"ConsumerOrders"});function we(r){const{regionStore:w,accountStore:f}=Z(),y=z(),k=U(),{t:_}=D(),R=F(()=>[{label:_("payhelp.pay_for_other"),value:$.PAYOTHER},{label:_("payhelp.pay_wait_other"),value:$.OTHER}]),e=E({shopInfo:null,list:[],total:0,loading:!1,finished:!1,nowTime:null}),l=E({page:0,size:10,orderPayType:$.PAYOTHER,sortBy:"desc|create_time"}),s=t=>{l.orderPayType=t,y.replace({path:"payHelpOfflineList",query:{status:t}}),I()},A=t=>{y.push(t)},I=async()=>{e.finished=!1,e.total=0,e.list=[],l.page=0,g()},O=t=>{t!=null&&t.orderId&&(t.orderStatus=3)},g=async()=>{if(!(f!=null&&f.sign.address))return e.finished=!0;e.loading=!0,l.page+=1,await P(),e.loading=!1},P=async()=>{const{success:t,data:n}=await ee(l);if(e.loading=!1,!t||!n||!(n!=null&&n.records)){e.finished=!0;return}const{records:a,total:c}=n;if(!a||!c||+c<=0){e.finished=!0;return}e.list=l.page===1?a:e.list.concat(a),c<=e.list.length&&(e.finished=!0)};return G(async()=>{var t,n;(t=k.query)!=null&&t.status&&(l.orderPayType=Number((n=k.query)==null?void 0:n.status)),g()}),(t,n)=>{const a=b("Empty"),c=b("VanList"),N=b("router-view");return m(),T(ne,{title:t.$t("payhelp.payList"),class:"bg-gray1 font-Puhui font-normal relative payHelpPage","theme-vars":{"field-placeholder-text-color":"#A6A6A6","count-down-text-color":"#FF8812","count-down-font-size":"16px"},ref:(u,p)=>{p.shopGoodsRef=u}},{right:v(()=>[i("img",{src:o(X)(`mall/${o(w).country}-flag.svg`),class:"w-5 h-auto mr-1"},null,8,he),i("span",_e,d(t.$t(`country.${o(w).country}`))+d(o(w).country),1)]),default:v(()=>[h(se,{options:o(R),"label-key":"label","value-key":"value",modelValue:o(l).orderPayType,"onUpdate:modelValue":n[0]||(n[0]=u=>o(l).orderPayType=u),onChange:s},null,8,["options","modelValue"]),i("div",ge,[h(c,{loading:o(e).loading,"onUpdate:loading":n[1]||(n[1]=u=>o(e).loading=u),finished:o(e).finished,"immediate-check":!1,"finished-text":"","loading-text":t.$t("common.loading"),onLoad:g},{default:v(()=>{var u;return[(m(!0),x(L,null,M(o(e).list,p=>(m(),T(ye,{class:"offline-crad-box mb-3",key:p.id,info:p,type:o(l).orderPayType,onClick:q=>A(`/payHelpOffline?payId=${p==null?void 0:p.orderId}`),onRemoveItem:q=>O(p)},null,8,["info","type","onClick","onRemoveItem"]))),128)),!o(e).loading&&o(e).finished&&((u=o(e).list)==null?void 0:u.length)<=0?(m(),T(a,{key:0,name:" "})):H("",!0)]}),_:1},8,["loading","finished","loading-text"])]),h(oe,{payChannel:o(ae).OFFLINE},null,8,["payChannel"]),h(N,{class:"child-view bg-gray1"})]),_:1},8,["title"])}}const xe=V({...ve,setup:we}),Se=Y(xe,[["__scopeId","data-v-89945902"]]);export{Se as default};
