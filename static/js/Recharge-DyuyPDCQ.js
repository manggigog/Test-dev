import{_ as U,a as N,b as se,c as oe}from"./recharge-BTiBJUn9.js";import{_ as R}from"./checked-C0ib8aDP.js";import{_ as ae,y as le,bc as ne,x as ce,r as f,bd as F,D as ie,F as r,G as c,H as e,O as b,Q as a,a2 as d,P as o,N as w,E as y,K as E,a1 as re,Y as de,Z as ue,a0 as V}from"./vendor-D6JO6WHW.js";import{B as me}from"./BackIcon-CPUEW9je.js";import{r as ve,s as _e,g as M,d as k,ap as pe,q as fe}from"./index-koYZVdtr.js";import{o as he}from"./OTCContract-B7UI9-4l.js";import{_ as ge}from"./ApproveButton-GJT7kgQN.js";const _=h=>(de("data-v-dd6fd5a4"),h=h(),ue(),h),xe={class:"relative w-full h-full linear-bg px-2.5 safe-bottom-page"},be={class:"flex items-center justify-between sticky top-0 z-50 bg-[#FFEFD6] py-2.5"},we={class:"flex flex-wrap items-center font-semibold"},ye={class:"ml-2 font-normal"},ke={class:"flex items-center px-4 py-5 bg-white rounded-xl"},Ae={class:"flex-1 text-sm text-[#2E2008]"},De={key:0,class:"flex items-center"},Fe=_(()=>e("img",{class:"w-4 h-4",src:N},null,-1)),Me={class:"ml-2 mr-4 text-[#8D8D8D]"},Ce={key:1,class:"w-2.5 h-2.5 my-2",src:U},$e={class:"flex items-center"},Ie=_(()=>e("img",{class:"w-4 h-4",src:se},null,-1)),Be={class:"ml-2 mr-4 text-[#8D8D8D]"},Se={key:2,class:"w-2.5 h-2.5 my-2",src:U},Te={key:3,class:"flex items-center"},Ee=_(()=>e("img",{class:"w-4 h-4",src:N},null,-1)),Ve={class:"ml-2 mr-4 text-[#8D8D8D]"},Ue=_(()=>e("img",{class:"w-5 h-5",src:oe},null,-1)),Ne=[Ue],Re={class:"bg-white rounded-xl p-4 pb-12 w-full mt-2.5"},Oe={class:"bg-[#FFF8EC] rounded-xl p-2.5 flex items-center w-full relative"},qe=["src"],je={class:"w-full px-4 bg-white rounded-xl"},Le=["src"],Pe=_(()=>e("span",null,"MAI",-1)),ze={key:0,class:"ml-auto w-3.5 h-3.5",src:R,alt:""},Ge=["src"],He=_(()=>e("span",null,"MUSD",-1)),Ke={key:0,class:"ml-auto w-3.5 h-3.5",src:R,alt:""},Qe={class:"mt-1.5 text-[0.65rem] text-[#2E2008] opacity-60"},We={key:0},Xe={key:1},Ye={class:"bg-[#FFF8EC] rounded-xl px-0.5 pr-2.5 pt-2.5 pb-3 mt-5 flex justify-between items-end w-full"},Ze={class:"mt-1.5 text-[0.65rem] text-[#2E2008] opacity-60"},Je={class:"flex flex-col items-center justify-center mt-28"},et=le({setup(h){const{mai:O,musd:q,balances:j,withdraw:L,deposit:P}=he(),{loadingToggle:A}=ve(),C=re(),[$,g]=ne(!1),I=ce(()=>l.value===1?n.value>m[t.value]:n.value>p[t.value]),n=f(null),t=f("MAI"),z=f(null),B=f(null),S=s=>{t.value=s,B.value.toggle(),x()},l=f(2),G=()=>{l.value===1?l.value=2:l.value=1},u=F({MAI:"",MUSD:""}),p=F({MAI:0,MUSD:0}),m=F({MAI:0,MUSD:0}),H=async()=>{u.MUSD=await q(),u.MAI=await O()},K=async()=>{const s=await j(u[t.value]);p[t.value]=s},Q=async()=>{const s=await(await _e(u[t.value])).balanceOf();m[t.value]=+s},W=()=>{l.value===1?n.value=m[t.value]||0:n.value=p[t.value]||0},T=async()=>{l.value===1?(g(!0),await P(u[t.value],n.value),x(),g(!1)):(g(!0),await L(u[t.value],n.value),x(),g(!1)),Y()},X=()=>{C.query.type&&(C.query.type==="buy"?t.value="MUSD":t.value="MAI")},Y=()=>{n.value=0},x=async()=>{A(!0),await Promise.all([K(),Q()]),A(!1)};return ie(async()=>{A(!0),X(),await H(),x()}),(s,v)=>{const Z=y("van-dropdown-item"),J=y("van-dropdown-menu"),ee=y("VanField"),te=y("VanButton");return c(),r("div",xe,[e("header",be,[e("div",we,[b(me),e("div",ye,a(s.$t("otc.Recharge")),1)])]),e("div",ke,[e("div",Ae,[l.value==2?(c(),r("div",De,[Fe,e("div",Me,a(s.$t("otc.from")),1),e("div",null,a(s.$t("otc.OTCAccount")),1)])):d("",!0),l.value==2?(c(),r("img",Ce)):d("",!0),e("div",$e,[Ie,e("div",Be,a(l.value==1?s.$t("otc.from"):s.$t("otc.to")),1),e("div",null,a(s.$t("otc.walletaccount")),1)]),l.value==1?(c(),r("img",Se)):d("",!0),l.value==1?(c(),r("div",Te,[Ee,e("div",Ve,a(s.$t("otc.to")),1),e("div",null,a(s.$t("otc.OTCAccount")),1)])):d("",!0)]),e("div",{onClick:G},Ne)]),e("div",Re,[e("div",Oe,[e("img",{class:"w-6 h-6 mr-1.5",src:o(M)(`images/tokens/${t.value}.png`),alt:"",srcset:""},null,8,qe),b(J,{class:"w-full",ref:(i,D)=>{D.menuRef=i,z.value=i},"active-color":"#FEA021",overlay:!1},{default:w(()=>[b(Z,{title:t.value,ref:(i,D)=>{D.itemRef=i,B.value=i}},{default:w(()=>[e("div",je,[e("div",{class:"py-5 flex items-center border-b-[1px] border-[#e5e5e5] border-solid",onClick:v[0]||(v[0]=i=>S("MAI"))},[e("img",{class:"w-6 h-6 mr-1.5",src:o(M)("images/tokens/MAI.png"),alt:"",srcset:""},null,8,Le),Pe,t.value=="MAI"?(c(),r("img",ze)):d("",!0)]),e("div",{class:"flex items-center py-5",onClick:v[1]||(v[1]=i=>S("MUSD"))},[e("img",{class:"w-6 h-6 mr-1.5",src:o(M)("images/tokens/MUSD.png"),alt:"",srcset:""},null,8,Ge),He,t.value=="MUSD"?(c(),r("img",Ke)):d("",!0)])])]),_:1},8,["title"])]),_:1},512)]),e("div",Qe,[l.value===2?(c(),r("span",We,a(s.$t("otc.wallectblance"))+a(o(k)(o(m)[t.value]))+" "+a(t.value),1)):(c(),r("span",Xe,a(s.$t("common.balance",{token:"OTC"}))+"ï¼š"+a(o(k)(o(p)[t.value]))+" "+a(t.value),1))]),e("div",Ye,[b(ee,{class:"flex-1 bg-[#FFF8EC] text-3xl font-bold text-[#2E2008]",modelValue:n.value,"onUpdate:modelValue":v[2]||(v[2]=i=>n.value=i),type:"number",placeholder:"0",formatter:o(pe)},null,8,["modelValue","formatter"]),e("div",{class:"px-1.5 py-1 border-[1px] border-[#FBA923] border-solid rounded text-xs text-[#FBA923] font-medium",onClick:W}," MAX ")]),e("div",Ze,a(s.$t("otc.canuse"))+a(l.value===2?o(k)(o(p)[t.value]):o(k)(o(m)[t.value]))+" "+a(t.value),1),e("div",Je,[l.value===1?(c(),E(ge,{key:0,contract:o(fe).otc,token:o(u)[t.value],approveAmount:o(m)[t.value],loading:o($),fallBack:T,disabled:!n.value||+n.value<=0||o(I),class:"font-semibold btn1 h-[38px] min-w-[130px] px-4 rounded-3xl text-base text-center leading-[38px]"},{default:w(()=>[V(a(s.$t("common.submit")),1)]),_:1},8,["contract","token","approveAmount","loading","disabled"])):d("",!0),l.value===2?(c(),E(te,{key:1,loading:o($),disabled:!n.value||+n.value<=0||o(I),class:"font-semibold btn1 h-[38px] min-w-[130px] px-4 rounded-3xl text-base",onClick:T},{default:w(()=>[V(a(s.$t("common.submit")),1)]),_:1},8,["loading","disabled"])):d("",!0)])])])}}}),it=ae(et,[["__scopeId","data-v-dd6fd5a4"]]);export{it as default};
