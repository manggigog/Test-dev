import{_ as P,br as T,a2 as p,r as _,y as k,E as R,Z as v,H as g,$ as b,o as S,q as L,F as w,I as e,U as C,O as t,Q as N,P as j,a4 as U,N as z,X as A,Y as O,T as $}from"./vendor-Dr_RpJ_Y.js";import{g as H,f as J,u as M,ae as Q}from"./index-7OiUoGXy.js";import{a as W}from"./activityContract-bcX9y4nM.js";import{_ as X}from"./EmptyTipsPop-DFfFg0cQ.js";import{C as Y}from"./CommonVanProvider-D__Wy38-.js";import"./BackIcon-CDrGaEPo.js";const Z=""+new URL("../images/shield-icon-2-JRn58PIr.svg",import.meta.url).href,d=c=>(A("data-v-a0985d80"),c=c(),O(),c),G={class:"px-3 pt-4 pb-24 font-Puhui"},K=d(()=>e("div",{class:"tips-card rounded-lg p-2 mb-3"},[e("p",{class:"text-sm text-[#7D3619] font-normal"}," 此操作涉及资金安全，请核对地址 ")],-1)),ee={class:"bg-white rounded-xl px-3 py-4"},te=d(()=>e("div",{class:"flex items-center justify-center"},[e("img",{src:Z,alt:"盾牌2",class:"w-[60px] h-[60px]"})],-1)),oe=d(()=>e("div",{class:"flex items-center justify-center mt-6"},[e("p",{class:"text-sm text-b3 font-normal"},"请确认地址")],-1)),se={class:"my-2 flex items-center justify-center"},ae={class:"text-base text-[#FF8812] font-bold"},re=d(()=>e("div",{class:"flex items-center justify-center"},[e("p",{class:"text-sm text-b3 font-normal"},"的提取多签授权")],-1)),ne={class:"fixed bottom-0 left-0 right-0 p-3 bg-gray1 safe-bottom"},ce=U(" 确认授权 "),le={setup(c){const{isEqual:ie,cloneDeep:ue}=T,{verifyDatePeriod:de}=H,l=S(),h=L(),{agreeSecondConfirmOnce:D}=W(),[i,x]=p(!1),[f,y]=p(!1),[V,u]=p(!1),r=_(""),n=_(!1),o=_({owner:"",time:""}),m=k(()=>o.value.owner&&o.value.time),q=()=>{try{x(!0);const s=l.query.owner?decodeURIComponent(atob(l.query.owner)):"",a=l.query.t?decodeURIComponent(atob(l.query.t)):"";if(o.value.owner=s,o.value.time=a,console.log("qrForm",o.value),!s||!a){r.value="错误的链接或参数",n.value=!0;return}console.log("qrForm",o.value)}catch(s){console.error("解析参数失败:",s),r.value="错误的链接或参数",n.value=!0,u(!0)}finally{setTimeout(()=>{x(!1)},1e3)}},B=()=>{u(!1),h.replace("/home")},E=async()=>{if(!m.value){r.value="参数丢失或不完整",n.value=!0,u(!0);return}const s=M().getCurrentAccount();s||($.fail("请先连接钱包"),s||await Q());try{y(!0),(await D()).success&&(r.value="验证成功",n.value=!1,u(!0),setTimeout(()=>{h.replace("/home")},1500))}catch(a){console.error("授权失败:",a)}finally{y(!1)}};return R(()=>{q()}),(s,a)=>{const I=w("van-loading"),F=w("VanButton");return g(),v(Y,{title:"",class:"font-Puhui font-normal relative bg-gray1 min-h-screen",themeVars:{navBarBackgroundColor:"#ffffff"}},{default:b(()=>[e("div",G,[K,e("div",ee,[te,oe,e("div",se,[e("p",ae,[t(i)&&!o.value.owner?(g(),v(I,{key:0,size:"14"})):C("",!0),e("span",null,N(o.value.owner?t(J)(o.value.owner,"...",4,4):"--"),1)])]),re])]),e("div",ne,[j(F,{onClick:E,loading:t(f)||t(i),disabled:t(f)||t(i)||!t(m),class:z(["bg-btnOrBg w-full h-[46px] flex-center text-b1 text-base font-semibold z-50 rounded-full",{"!bg-[#D9D9D9] !opacity-100":t(f)||t(i)||!t(m)}])},{default:b(()=>[ce]),_:1},8,["loading","disabled","class"])]),t(V)?(g(),v(X,{key:0,onClose:B,text:r.value,isError:n.value},null,8,["text","isError"])):C("",!0)]),_:1})}}},he=P(le,[["__scopeId","data-v-a0985d80"]]);export{he as default};
