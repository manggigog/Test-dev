import{B as z}from"./BackIcon-CDrGaEPo.js";import{_ as q}from"./TimeFilter-BFI-K4ma.js";import{_ as A,z as k,x as L,r as l,y as N,q as H,E as B,G as S,H as g,P as _,$ as F,I as t,Q as i,O as D,o as j,F as U,X as V,Y,J as Z,K as J,Z as K}from"./vendor-Dr_RpJ_Y.js";import{_ as Q}from"./OfflineConsumer-CFKdyJq4.js";import{_ as X}from"./OfflineGoods-DKMaiwr2.js";import{a as C,O as W}from"./offlineGoods-DvT2Go6q.js";import{c as ee,u as te,f as oe,c8 as se,c2 as ae,d as re}from"./index-LRhcxFAI.js";import"./avatarRing-CLGxkH-F.js";import"./arrow-newOrigin-BFyZPNch.js";import"./MCOIN-Bodfn-v1.js";import"./ImgBoutiqueLable-B-2xCcw4.js";import"./shop-CeqcS6K2.js";const le={class:"list__item w-full rounded-xl bg-white p-3"},ne={class:"text-b3"},de=k({props:["order"],setup(e){const{t:u}=L(),v=l(null);N(()=>1/v.value);const h=async()=>{const{mcoinRate:a}=ee();v.value=await a()},y=H(),w=N(()=>[{label:u("order.wait"),value:C.PAYMENT_SUCCESS},{label:u("order.canceled"),value:C.CANCELLED},{label:u("order.completed"),value:C.COMPLETED},{label:u("common.all"),value:-1}]),m=a=>{var r;return(r=w.value.find(n=>+n.value==+a))==null?void 0:r.label},f=a=>{y.push(a)};return B(async()=>{await h()}),(a,r)=>(g(),S("div",le,[_(Q,{order:e.order,"show-status":"",status:m(e.order.orderStatus)},null,8,["order","status"]),_(X,{"show-order-type":"",class:"mt-3 h-[80px]",goods:{goodsName:e.order.relName,goodsIcons:e.order.relIcons,orderType:e.order.orderType,goodsPrice:e.order.orderRealAmount,storeName:e.order.storeName,areaExtName2:e.order.areaExtName2},onImageClick:r[0]||(r[0]=n=>e.order.orderType===D(W).GOODS?f("/offlineMerchantOrders/offlineGoodsDetail?goodsId="+e.order.relId+(e.order.storeId?`&storeId=${e.order.storeId}`:"")+"&child=1"):f("/shop?shopId="+e.order.relId))},{"bottom-left":F(()=>[t("div",ne,i(a.$t("common.total"))+"ï¼š",1)]),_:1},8,["goods"])]))}}),ce=A(de,[["__scopeId","data-v-520bf033"]]),ie=e=>(V("data-v-6febf002"),e=e(),Y(),e),ue={class:"w-full bg-[#F2F0EF]",style:{"background-image":"none"}},me={class:"header-bar sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50"},fe={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},_e={class:"font-semibold"},ve={class:"list-content pt-2 px-4"},he={class:"total__wrap w-full flex flex-row justify-between gap-2"},pe={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},xe={class:"text-xs font-normal text-default"},ge={class:"text-left mt-1"},ye={class:"num-value text-2xl font-semibold text-left"},we={class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},be={class:"total__item w-[50%] h-[74px] bg-white rounded-xl"},Ie={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},Ce={class:"text-xs font-normal text-default"},Se={class:"text-left mt-1"},Oe={class:"num-value text-2xl font-semibold text-left"},$e=ie(()=>t("span",{class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},"Mcoin",-1)),Ee={class:"list__wrap mt-3 w-full h-[calc(100vh-174px)] z-50 overflow-y-auto scroll-smooth"},Te=k({setup(e){const{t:u}=L(),v=j(),{getCurrentStoreId:h}=te(),y=20,w=u("order.history_order_title"),m=l(v.query.address),f=l(`${oe(m.value,"...",5,5)||""}${w}`);document.title=f.value;const a=l({}),r=l([]),n=l(!1),p=l(!1),x=l(0),b=l(null),I=l(null),M=()=>{x.value=0,r.value=[],p.value=!1},P=async()=>{var d;const o={orderCustomerAddress:m.value,shopId:(d=await h())==null?void 0:d.id},s=await se(o);s.success&&(a.value=s.data||{})},R=async()=>{var d,c,$,E,T;const o={page:x.value,size:y,shopId:(d=await h())==null?void 0:d.id,orderStatus:4,orderCustomerAddress:m.value,startTime:b.value,endTime:I.value,sortBy:"desc|create_time"},s=await ae(o);if(n.value=!1,!s.success||!s.data||!((c=s.data)!=null&&c.total)){p.value=!0;return}r.value=x.value===1?($=s.data)==null?void 0:$.records:[...r.value,...(E=s.data)==null?void 0:E.records],p.value=r.value.length>=((T=s.data)==null?void 0:T.total)},O=async()=>{n.value=!0,x.value+=1,await R(),n.value=!1},G=o=>{o&&o[0]&&o[1]?[b.value,I.value]=o:(b.value=null,I.value=null),M(),O()};return B(()=>{P()}),(o,s)=>{const d=U("van-list");return g(),S("div",ue,[t("section",me,[t("div",fe,[_(z)]),t("div",_e,i(f.value),1)]),t("section",ve,[t("div",he,[t("div",pe,[t("p",xe,i(o.$t("order.history_order_count")),1),t("p",ge,[t("span",ye,i(a.value.orderCompleteCount||0),1),t("span",we,i(o.$t("common.order_count_suffix")),1)])]),t("div",be,[t("div",Ie,[t("p",Ce,i(o.$t("order.history_transaction_count")),1),t("p",Se,[t("span",Oe,i(D(re)(a.value.orderCompleteAmount||0)),1),$e])])])]),_(q,{"allow-reverse":"",onChange:G}),t("div",Ee,[_(d,{loading:n.value,"onUpdate:loading":s[0]||(s[0]=c=>n.value=c),finished:p.value,"finished-text":o.$t("common.no more"),onLoad:O},{default:F(()=>[(g(!0),S(Z,null,J(r.value,c=>(g(),K(ce,{key:c.id,order:c},null,8,["order"]))),128))]),_:1},8,["loading","finished","finished-text"])])])])}}}),qe=A(Te,[["__scopeId","data-v-6febf002"]]);export{qe as default};
