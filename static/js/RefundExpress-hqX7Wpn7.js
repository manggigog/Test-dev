import{_ as H,z as M,x as z,q as F,r as f,o as J,a2 as A,bl as G,E as Q,F as v,G as x,H as _,I as s,U as S,P as d,Q as i,$ as g,O as p,J as X,K as Y,a9 as W,a3 as Z,a4 as ee,X as se,Y as te,T as C}from"./vendor-Dr_RpJ_Y.js";import{_ as oe}from"./arrow-down-585654-BvWo_huQ.js";import{_ as ae}from"./copy-w-F2Lv8QkV.js";import{a as ne}from"./order-BTAcEDew.js";import{e as re}from"./refund-DnmzK6ip.js";import{B as le}from"./BackIcon-CDrGaEPo.js";import{V as ie,h as de}from"./index-BckdT6oc.js";const w=m=>(se("data-v-0e262f2b"),m=m(),te(),m),pe={class:"font-Puhui main-bg safe-bottom-page"},ce={class:"header-bar fixed top-0 left-0 right-0 flex font-normal justify-center text-sm items-center h-[50px] px-4 z-50 backdrop-blur-md bg-white"},ue={class:"absolute left-4 flex items-center gap-1 -translate-y-1/2 top-1/2"},fe={class:"font-bold text-base text-b1"},me={key:0,class:"safe-bottom pt-[62px] rounded-xl px-3"},ye={class:"rounded-xl bg-white overflow-hidden px-3"},he=w(()=>s("img",{src:oe,class:"w-4 h-4 m-[2px]",alt:""},null,-1)),ve=w(()=>s("div",{class:"h-px bg-[#e5e5e5]"},null,-1)),xe={class:"flex justify-center items-center relative h-14 font-bold text-[22px] text-[#3a2e13]"},_e={class:"flex-1 text-center text-base font-semibold text-b1"},be={class:"pl-4 pr-4 pb-4 h-[calc(100%-56px)] overflow-y-scroll"},ge=["onClick"],Ce={class:"text-b1"},we={key:0,class:"bg-white p-3 mt-3 rounded-xl"},$e={class:"flex items-center justify-between"},Ne={class:"text-sm text-b1 font-semibold"},Ie=["onClick"],ke={class:"break-all whitespace-pre-wrap"},De={class:"mt-1 flex justify-between items-end"},Ve=w(()=>s("img",{class:"shrink-0 w-5 h-5",src:ae,alt:""},null,-1)),Se={class:"w-full mt-3"},Oe={class:"text-sm text-b3 font-normal"},Be={class:"popup-footer w-full fixed bottom-0 left-0 right-0 safe-bottom px-3"},Le=M({name:"SellerDelivery"});function Te(m){const{t:$}=z(),b=F(),{getUserDhKey:N,decryptAddressKey:O,encryptKey:I}=ie();f(!1);const k=J(),B=k.query.id;k.query.detail;const y=f(null),D=f(!1),r=f({}),L=async()=>{var l,a;const e=await ne({id:B});y.value=e.data,r.value=(l=e.data.refundInfo)!=null&&l.addressInfo?JSON.parse((a=e.data.refundInfo)==null?void 0:a.addressInfo):{};const t=await N(e.data.stores.id);t&&(r.value=O(r.value,t))},[T,E]=A(!1),c=f(!1),K=["无需发货","到付运费","顺丰速运","中国邮政EMS","京东物流","中通快递","圆通速递","韵达快递","申通快递","极兔速递","德邦物流","其他"],o=G({expressCompany:"",expressNo:"",orderId:""}),P=e=>{o.expressCompany=e,c.value=!1},j=()=>{c.value=!1},R=async()=>{var t,l;if(D.value)return;u(!0),o.orderId=y.value.id;const e=await N((l=(t=y.value)==null?void 0:t.stores)==null?void 0:l.id);try{if(!o.expressCompany){C.fail($("order.deliveryCompanyPlaceholder")),u(!1);return}if(o.expressCompany!=="无需发货"&&!o.expressNo){C.fail($("order.express empty")),u(!1);return}let a={expressCompany:o.expressCompany,expressNo:o.expressNo,orderId:o.orderId,shippingHash:null};if(e){const h=I(o.expressNo,e);a.expressNo=h.encrypt,a.shippingHash=h.hash;const n=I(o.expressCompany,e);a.expressCompany=n.encrypt}(await re(a)).success&&setTimeout(()=>{U()},50),u(!1)}catch(a){u(!1),C.fail(a.message)}},U=()=>{var t,l,a;const e=(t=window.history)==null?void 0:t.state;((l=e==null?void 0:e.back)==null?void 0:l.indexOf("buyerOrderDetail"))>-1?b.go(-2):((a=e==null?void 0:e.back)==null?void 0:a.indexOf("buyerOrderList"))>-1&&b.go(-1),setTimeout(()=>{b.replace({path:"/buyerOrderList",query:{active:2,type:1}})},100)},u=(e=!0)=>{E(e),D.value=e},q=()=>{const e=r.value,t=`${e.provinceName??""}${e.cityName??""}${e.countyName??""}${e.detailInfo??""} ${e.userName??""} ${e.telNumber??""}`;de(t)};return Q(async()=>{await L()}),(e,t)=>{const l=v("van-field"),a=v("van-icon"),V=v("van-popup"),h=v("VanButton");return _(),x("div",pe,[s("section",ce,[s("div",ue,[d(le)]),s("div",fe,i(e.$t("order.deliveryInfo")),1)]),y.value?(_(),x("div",me,[s("div",ye,[d(l,{modelValue:p(o).expressCompany,"onUpdate:modelValue":t[0]||(t[0]=n=>p(o).expressCompany=n),label:e.$t("order.deliveryCompany"),placeholder:e.$t("order.deliveryCompanyPlaceholder"),border:!1,"input-align":"right",readonly:"",onClick:t[1]||(t[1]=n=>c.value=!0)},{"right-icon":g(()=>[he]),_:1},8,["modelValue","label","placeholder"]),ve,d(l,{modelValue:p(o).expressNo,"onUpdate:modelValue":t[2]||(t[2]=n=>p(o).expressNo=n),label:e.$t("order.deliveryId"),placeholder:e.$t("order.deliveryPlaceholder"),border:!1,"input-align":"right",maxlength:150},null,8,["modelValue","label","placeholder"]),d(V,{show:c.value,"onUpdate:show":t[3]||(t[3]=n=>c.value=n),position:"bottom",round:"",style:{width:"100%",borderRadius:"20px 20px 0 0",maxHeight:"90vh",height:"660px"}},{default:g(()=>[s("div",xe,[s("span",_e,i(e.$t("order.deliveryCompany")),1),d(a,{name:"cross",class:"absolute right-4 top-1/2 -translate-y-1/2 text-2xl",onClick:j})]),s("div",be,[(_(),x(X,null,Y(K,(n,Ke)=>s("div",{key:n,class:"text-b1 py-4 border-b border-[#D9D9D9]",onClick:Pe=>P(n)},[s("span",Ce,i(n),1)],8,ge)),64))])]),_:1},8,["show"])]),p(W.isEmpty)(r.value)?S("",!0):(_(),x("div",we,[s("div",$e,[s("div",Ne,i(e.$t("afterSale.Recipient Information")),1)]),s("div",{class:"mt-2 text-sm text-b2 font-normal",onClick:Z(q,["stop"])},[s("div",ke,[s("span",null,i(`${r.value.provinceName??""}${r.value.cityName??""}${r.value.countyName??""}${r.value.detailInfo??""}`),1)]),s("div",De,[s("div",null,i(r.value.userName)+" "+i(r.value.telNumber),1),Ve])],8,Ie)])),s("div",Se,[s("ul",Oe,[s("li",null,i(e.$t("afterSale.buyer refund input address tips1")),1),s("li",null,i(e.$t("afterSale.buyer refund input address tips2")),1),s("li",null,i(e.$t("afterSale.buyer refund input address tips3")),1)])]),s("div",Be,[d(h,{round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full w-full",loading:p(T),onClick:R},{default:g(()=>[ee(i(e.$t("common.confirm")),1)]),_:1},8,["loading"])])])):S("",!0)])}}const Ee=Object.assign(Le,{setup:Te}),Fe=H(Ee,[["__scopeId","data-v-0e262f2b"]]);export{Fe as default};
