import{_ as B,bl as A,E as F,Z as x,H as d,$ as S,q as R,o as j,F as I,I as e,P as K,bj as M,G as u,U as y,a3 as O,O as i,Q as h,bt as U,bv as q,K as z,J as E,X as D,Y as G}from"./vendor-Dr_RpJ_Y.js";import{_ as H}from"./down-arrow-IWNxO-Dl.js";import{_ as J}from"./search-C4fLtTfY.js";import{_ as Q}from"./delete-BlDblrKv.js";import{C as T}from"./CommonVanProvider-KZuKVOde.js";import{a as X,aE as Y,aP as Z,B as W}from"./index-7OiUoGXy.js";import"./BackIcon-CDrGaEPo.js";const g=m=>(D("data-v-808b55ce"),m=m(),G(),m),ee={class:"px-3"},te={class:"search__wrap w-full h-[50px] pb-3"},se={class:"search__input w-full h-full bg-b5 rounded-3xl flex items-center justify-center px-3 py-2.5"},oe=["onClick"],ae={class:"text-sm text-b2 font-normal min-w-[28px] max-w-[56px]"},ne={key:1,class:"text-truncate"},ie=g(()=>e("img",{src:H,class:"w-[9px] h-auto"},null,-1)),re=g(()=>e("div",{class:"mx-2 bg-b4 w-[1px] h-full"},null,-1)),le=g(()=>e("div",{class:"search__icon flex-shrink-0"},[e("img",{src:J,class:"w-4 h-4"})],-1)),ce=["placeholder","onKeyup"],de=g(()=>e("img",{src:Q,class:"w-4 h-4",alt:""},null,-1)),fe=[de],pe={class:"text-[#FF8812] text-sm font-semibold whitespace-nowrap"},ue=["onClick"],he={class:"flex-1 flex items-center gap-1"},me={class:"line-clamp-1 text-base font-semibold"},_e={key:0,class:"text-xs text-newOrigin border border-newOrigin px-1 rounded-sm"},ge={class:"mt-1 text-b3 flex items-center justify-between gap-x-1"},ve={class:"line-clamp-1"},xe={setup(m){var w,C,L;const{cityMapStore:s}=X(),b=R(),N=j(),t=A({total:0,loading:!1,finished:!1,list:[]}),a=A({page:0,size:20,overseasFlag:((w=s.currentActiveCity)==null?void 0:w.overseasFlag)||!1,storeNameLike:void 0,longitude:s.locationCoords.lng||((C=s.currentActiveCity)==null?void 0:C.areaLongitude)||null,latitude:s.locationCoords.lat||((L=s.currentActiveCity)==null?void 0:L.areaLatitude)||null}),$=()=>{b.push({path:"/city/selectArea",query:{mode:"select",from:encodeURIComponent(N.path)}})},k=()=>{console.log(a.storeNameLike),a.page=0,a.size=20,a.finished=!1,a.list=[],v()},P=n=>{n.storeId&&s.setSelectedStore(n),b.back()},v=async()=>{console.log("onLoad"),t.loading=!0,a.page+=1,await V(),t.loading=!1},V=async()=>{var o,r;if(!((o=s.selectedArea)!=null&&o.areaId)){t.finished=!0;return}a.areaIdPreviousLastLeaf=(r=s.selectedArea)==null?void 0:r.areaId;const{success:n,data:l}=await Y(a);if(t.loading=!1,!n){t.finished=!0;return}const{records:c,total:_,current:f,pages:p}=l;(!_||!c||!(c!=null&&c.length))&&(t.finished=!0),t.total=_,t.list=a.page===1?c:t.list.concat(c),+f>=+p&&(t.finished=!0)};return F(()=>{s.selectedArea||s.setSelectedArea(s.currentActiveCity),v()}),(n,l)=>{const c=I("van-loading"),_=I("VanList");return d(),x(T,{title:"选择门店",class:"bg-white font-Puhui font-normal relative","theme-vars":{"nav-bar-background-color":"#fff","field-placeholder-text-color":"#A6A6A6"},ref:(f,p)=>{p.searchRef=f}},{default:S(()=>{var f,p;return[e("div",ee,[e("div",te,[e("div",se,[e("div",{class:"city-selector flex items-center justify-start gap-1",onClick:O($,["stop"])},[e("div",ae,[(f=i(s).selectedArea)!=null&&f.areaName?(d(),u("span",ne,h((p=i(s).selectedArea)==null?void 0:p.areaName),1)):(d(),x(c,{key:0,size:"14"}))]),ie],8,oe),re,le,M(e("input",{ref:(o,r)=>{r.searchRef=o},type:"text","onUpdate:modelValue":l[0]||(l[0]=o=>i(a).storeNameLike=o),class:"flex-1 h-full bg-transparent ml-1 font-normal",placeholder:n.$t("offline.store_search"),onKeyup:q(k,["enter"]),enterkeyhint:"search"},null,40,ce),[[U,i(a).storeNameLike]]),i(a).storeNameLike?(d(),u("div",{key:0,class:"flex-shrink-0 flex items-center justify-center",onClick:l[1]||(l[1]=(...o)=>n.onClear&&n.onClear(...o))},fe)):y("",!0),e("div",{class:"search__btn ml-2 flex-shrink-0",onClick:k},[e("span",pe,h(n.$t("common.search")),1)])])]),K(_,{loading:i(t).loading,"onUpdate:loading":l[2]||(l[2]=o=>i(t).loading=o),finished:i(t).finished,"immediate-check":!1,"loading-text":n.$t("common.loading"),onLoad:v,class:"shopList h-[calc(100vh-100px)] overflow-y-auto"},{default:S(()=>{var o;return[e("section",null,[!((o=i(t))!=null&&o.list.length)&&!i(Z)?(d(),x(W,{key:0})):y("",!0),(d(!0),u(E,null,z(i(t).list,r=>(d(),u("div",{key:r.storeId,class:"gap-1 text-sm py-3 border-b border-b-b4 first:pt-0 last:border-none",onClick:ye=>P(r)},[e("div",he,[e("div",me,h(r.storeName),1),+r.storeGoodsCount>0?(d(),u("div",_e,h(n.$t("goods.Buying agent")),1)):y("",!0)]),e("div",ge,[e("span",ve,h(r.storeAddress),1)])],8,ue))),128))])]}),_:1},8,["loading","finished","loading-text"])])]}),_:1},512)}}},Ie=B(xe,[["__scopeId","data-v-808b55ce"]]);export{Ie as default};
