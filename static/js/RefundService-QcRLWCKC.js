import{_ as D}from"./chongdian-icon-Cd-A7yaw.js";import{_ as E,y as H,w as O,a1 as U,r as J,bf as k,be as I,D as K,F as R,G as g,H as o,O as r,Q as p,K as L,a2 as G,P as d,E as u,N as m,$ as M,Y as Q,Z as Y,l as Z,I as W,J as X,a0 as ee,T as te}from"./vendor-BUT0HZ5j.js";import{B as se}from"./BackIcon-biFt6cm7.js";import{_ as oe}from"./BuyerDeliveredItem-HWjL2Rsz.js";import{a as ae,c as ne}from"./order-5h45IqlB.js";import{r as re,c as ce,o as ie}from"./refund-DnaEknLH.js";import{o as le,r as de}from"./index-BvL8wS8a.js";import{P as ue}from"./flashSale-DDyqLyYN.js";import"./useOrderStatus-BSCfQVBG.js";import"./order-H59PKTFP.js";import"./useRefundStatus-DsYoZX36.js";import"./useShipTemplate-SAWfRcmZ.js";import"./enums-DlE-aiss.js";import"./default-avatar-C3GeIXRh.js";const pe=f=>(Q("data-v-43709900"),f=f(),Y(),f),me={class:"px-3 main-bg"},fe={class:"header-bar fixed top-0 left-0 right-0 flex font-normal justify-center text-sm items-center h-[50px] px-4 z-50 backdrop-blur-md"},_e={class:"absolute left-4 flex items-center gap-1 -translate-y-1/2 top-1/2"},he={class:"font-bold text-base text-b1"},ge={class:"safe-bottom pt-[50px]"},ve={class:"px-3 py-4 mt-3 bg-white rounded-xl"},be={class:"flex items-center mb-5"},ye=pe(()=>o("img",{src:D,class:"w-[18px] h-[18px]"},null,-1)),we={class:"ml-1 font-semibold"},xe={class:"flex items-center"},ke={class:"ml-1"},Ie={class:"mt-[18px] mb-[20px] font-semibold text-base text-center"},Re={class:"m-auto text-center"},Le=H({setup(f){const{loadingToggle:_}=de(),{senderProtest:N}=le(),h=U(),w=Z(),{locale:S}=O(),C=h.query.id,c=J(null),x=k({page:1,size:999,type:null}),a=k({reasonList:[],checked:null}),[v,T]=I(!1),V=async()=>{const t=await ae({id:C});c.value=t.data,c.value.payType===ue.STORE_CARD&&(x.type=3)},[B,b]=I(!1),$=async()=>{var t,e;if(((t=h.query)==null?void 0:t.type)==="credit")try{b(!0);const s=await ne({orderIds:c.value.id+""}),i=s.data.ordIds&&s.data.ordIds[0];if(!(await N(i)).success)return;const{success:y}=await ce({orderId:c.value.id,refundReasonId:a.checked,longTimeFlag:(e=h.query)!=null&&e.longTime?!0:null});b(!1),y&&w.push("/refundList")}catch(s){te(s.message||s)}finally{b(!1)}else{const s={orderId:c.value.id,refundReasonId:a.checked};_(!0);const{success:i}=await ie(s);_(!1),i&&w.push("/refundList")}},P=async()=>{var s;const{success:t,data:e}=await re(x);if(t){const i=A(S.value);e.length>0&&(a.checked=e[0].id),a.reasonList=e.map(l=>({...l,showName:l[i]})),(s=h.query)!=null&&s.longTime&&(a.checked=3,a.reasonList=a.reasonList.filter(l=>l.id===3))}},A=t=>{let e="cnFtName";switch(t){case"zh-CN":e="jtName";break;case"zh-HK":e="cnFtName";break;case"en-US":e="enName";break;case"ja-JP":e="japanName";break}return e},F=async()=>{_(!0),await V(),P(),_(!1)};return K(async()=>{await F()}),(t,e)=>{const s=u("van-icon"),i=u("van-radio"),l=u("van-cell"),y=u("van-cell-group"),j=u("van-radio-group"),q=u("VanButton"),z=u("VanPopup");return g(),R("div",me,[o("section",fe,[o("div",_e,[r(se)]),o("div",he,p(t.$t("order.deliver")),1)]),o("section",ge,[c.value?(g(),L(oe,{key:0,order:c.value},null,8,["order"])):G("",!0),o("div",ve,[o("div",be,[ye,o("span",we,p(t.$t("refund.service")),1)]),o("div",{class:"flex items-center justify-between",onClick:e[0]||(e[0]=n=>d(T)(!0))},[o("div",xe,[r(s,{name:"circle",color:"rgba(217, 217, 217, 1)",size:"24px"}),o("span",ke,p(t.$t("refund.refund choose")),1)]),r(s,{name:"arrow",color:"rgba(46, 32, 8, 1)"})])])]),r(z,{show:d(v),"onUpdate:show":e[2]||(e[2]=n=>M(v)?v.value=n:null),round:"",position:"bottom",closeable:"",style:{height:"auto",maxHeight:"80%"}},{default:m(()=>[o("div",Ie,p(t.$t("refund.reason")),1),r(j,{modelValue:d(a).checked,"onUpdate:modelValue":e[1]||(e[1]=n=>d(a).checked=n)},{default:m(()=>[r(y,null,{default:m(()=>[(g(!0),R(W,null,X(d(a).reasonList,n=>(g(),L(l,{key:n.id,title:n.showName,onClick:Ne=>d(a).checked=n.id},{"right-icon":m(()=>[r(i,{name:n.id,"checked-color":"#FEA021"},null,8,["name"])]),_:2},1032,["title","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"]),o("div",Re,[r(q,{loading:d(B),class:"my-[50px] inline-block btn-orange btn-shadow w-[180px] h-[40px] text-white",onClick:$},{default:m(()=>[ee(p(t.$t("ecology.submitApplication")),1)]),_:1},8,["loading"])])]),_:1},8,["show"])])}}}),He=E(Le,[["__scopeId","data-v-43709900"]]);export{He as default};
