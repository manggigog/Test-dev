import{_ as Re,z as Te,q as wt,y as xe,x as ze,bQ as bt,F as P,G as u,H as r,I as t,U as A,a1 as Yt,a3 as _e,Q as n,O as m,J as me,K as $e,N as Ce,V as Xe,Z as G,P as T,$ as E,a4 as ee,T as k,X as $t,Y as Ct,r as x,a2 as Ge,D as qe,bl as Wt,bo as ht,E as kt,bj as ce,bk as ue,bW as Jt,t as Qt,j as Zt,B as Se,a9 as xt,a0 as Xt,n as es,o as ts,bS as ss}from"./vendor-Dr_RpJ_Y.js";import{_ as At}from"./avatarRing-DtI_kRg6.js";import{_ as os}from"./arrow-newOrigin-k7S6PCOF.js";import{_ as as}from"./add-line-newOrigin-BNsjLv3l.js";import{_ as ns}from"./address-BcVTHe5T.js";import{G as rs}from"./GoodsItem-BpifqR9B.js";import{_ as ls}from"./CountdownLabel-BEWGrnUw.js";import{a as Ke,i as at,f as et,u as _t,b as is,V as ds,C as cs,bM as It,r as Ie,a8 as us,e as yt}from"./index-CU2nzZe6.js";import{u as Tt,o as ms,a as Me,k as St,l as fs,m as ps}from"./useOrderStatus-CfUN23nj.js";import{c as tt,n as st,m as Ue,v as vs,w as hs,x as xs,y as ys,z as gs,a as ws}from"./order-D4JYoGRo.js";import{P as Rt}from"./flashSale-DDyqLyYN.js";import{h as ot}from"./color-CLXjroBk.js";import{c as bs,d as Bt,a as $s,h as Cs}from"./useOrderActionButtons-DauZK0uT.js";import{S as ks,M as As}from"./MerchantRefund-DunlLBK6.js";import{e as _s}from"./excel-DblxN39_.js";import{u as Is,a as Ts}from"./useRefund-BaR9moOG.js";import{_ as Et}from"./selected-icon-CfPkLSlb.js";import{_ as Ss}from"./credit-0laLclE7.js";import{_ as Rs}from"./MCOIN-BOqZVkND.js";import{B as Bs}from"./BackIcon-CDrGaEPo.js";import{C as Es}from"./ChangeRegion-DR-1e7wg.js";import Os from"./SellerOneSaleOrder-BZaQhoR7.js";import"./mcoin-logo-1-CkjdfX51.js";import"./useShipTemplate-DL0IJVAv.js";import"./enums-DlE-aiss.js";import"./copy-w-Dr8nkqKW.js";import"./link-CItP-_Ep.js";import"./UnfreezePop-DpE5NBJn.js";import"./ApproveButton-j0GrW5es.js";import"./edit-line-CBLoYbqh.js";import"./refund-BPUlWqkW.js";import"./filter-MXpgl_BE.js";import"./category-CPc0zbBB.js";import"./ChangeRegionPop-Czyv5Q4t.js";import"./DeliveredItem-Bl5RyYr3.js";import"./GoodsItem-DAJ0gCsh.js";import"./luckyShopContract-DunEf0Vg.js";const Ns="/static/images/mark-Dmikp-39.svg",je=e=>($t("data-v-5d1683f2"),e=e(),Ct(),e),Ls={class:"gap-2 flex-center-bw"},Ps=je(()=>t("div",{class:"w-8 h-8"},[t("img",{src:At,class:"w-full h-full rounded-md object-cover",alt:"",fit:"cover"})],-1)),Ds={class:"flex flex-col justify-center flex-1 h-8 text-default"},Fs={class:"text-sm font-semibold flex flex-row justify-start items-center align-middle"},Vs={key:0,class:"shrink-0 w-4 h-4",src:os,alt:""},js={class:"text-primary ml-auto text-sm leading-[20px] align-middle text-right"},Hs={class:"text-xs leading-[18px] opacity-60"},Gs={class:"w-full mt-4"},Ms={key:0,class:"w-fit h-[22px] px-1 border border-solid border-[#FF8812] rounded-[4px] flex items-center justify-center"},qs=je(()=>t("img",{class:"w-3 h-3",src:as,alt:""},null,-1)),Ks={key:0,class:"ml-0.5 mr-1 text-xxs leading-[14px] text-newOrigin font-normal"},Us={key:1,class:"bg-[#f5f5f5] text-default text-xxs w-[25px] h-[22px] rounded-[4px] py-1 mr-1 flex justify-center items-center"},zs=je(()=>t("span",null,"...",-1)),Ys=[zs],Ws={class:"mt-4 pt-4 break-all flex flex-row justify-start items-start border-t-[1px] border-[#e0e0e0] border-solid"},Js=je(()=>t("div",{class:"min-w-[20px]"},[t("img",{src:ns,class:"inline-block w-[20px]"})],-1)),Qs={class:"ml-1"},Zs={key:0,class:"text-sm text-[#585654] font-semibold"},Xs={key:1,class:"mt-1 text-sm text-[#a6a6a6] font-normal"},eo={key:0,class:"mt-2 break-all flex flex-row justify-start items-start"},to=je(()=>t("div",{class:"min-w-[20px]"},[t("img",{src:Ns,class:"inline-block w-[20px]"})],-1)),so={class:"ml-1"},oo={class:"text-sm text-[#a6a6a6] font-normal line-clamp-2"},ao={key:1,class:"pt-2.5 text-xs text-[#B9B9B9]"},no={class:"items-center inline"},ro={class:"block"},lo={class:"colon"},io={class:"block"},co={class:"colon"},uo={class:"block"},mo={class:"colon"},fo={class:"block"},po={class:"colon"},vo={key:1,class:"text-right"},ho={key:2,class:"tipsCard w-full h-fit p-2 mt-2 text-left"},xo={class:"text-sm text-[#FF8812] font-normal font-Puhui"},yo={key:3,class:"flex justify-end mt-3 gap-2"},go=Te({props:{order:null,isService:{type:Boolean},nowTime:null,tab:null},emits:["open"],setup(e,{emit:M}){const v=e,{accountStore:a}=Ke(),{clerkStore:y}=Ke(),_=wt(),q=xe(()=>{const c=v.order||{};return bs(c)}),S=xe(()=>{const c=v.order||{};return Bt(c)}),K=xe(()=>(v.order.orderGoods||[]).some(d=>d.buyFlag)),$=xe(()=>{var c,R;return((R=(c=v.order)==null?void 0:c.orderLabelList)==null?void 0:R.filter(d=>d==null?void 0:d.id))||[]}),{t:C}=ze(),w=c=>{v.isService||_.push(c)},g=()=>{v.isService||_.push(`/sellerOrderDetail?id=${v.order.id}`)},O=()=>{if(a.isOnlyView)return k(C("order.Requires merchant account operation"));_.push(`/sellerDelivery?id=${v.order.id}`)},ae=()=>{if(a.isOnlyView)return k(C("order.Requires merchant account operation"));_.push({name:"SellerOrderDetail",query:{id:v.order.id},params:{quick:"quackChange"}})},te=()=>{location.reload()},I=bt("openBatchReceiptPop",null),{merchantConfirm:Be}=at(),F=async c=>{if(a.isOnlyView)return k(C("order.Requires merchant account operation"));if(y.isClerk&&!y.clerkAuth)return k(C("order.Requires merchant account operation"));if(I){I(c);return}c.loading=!0;try{const d=(await tt({orderIds:c.id})).data.ordIds,f=await Be(d);if(!f.success)return;if(c.payType!==Rt.STORE_CARD){if(!(await st({ordIds:d,hash:f.result.hash})).success)return;c.merchantsConfirm=1,k.success(C("order.confirmSuccess")),_.replace({path:"/sellerOrderList",query:{active:4,type:1}})}}finally{c.loading=!1}},V=c=>{if(a.isOnlyView)return k(C("order.Requires merchant account operation"));M("open",c)},z=c=>{if(a.isOnlyView)return k(C("order.Requires merchant account operation"));if(!K.value)return;const R=c.userAddress.address;et(c.userAddress.address,"...",5,5),_.push(`/sellerOrderList-orderHistory?address=${R}&source=merchants`)},ne=c=>Cs(c),fe=c=>{var R;return((R=c.modifyInfo)==null?void 0:R.status)===1||c.orderPostscriptUpdateReviewId};return(c,R)=>{var B,j;const d=P("van-count-down"),f=P("VanButton");return r(),u("div",{class:"px-3 mt-3 bg-white rounded-xl py-3",onClick:g},[t("div",Ls,[Ps,t("div",Ds,[t("div",Fs,[e.order.userAddress&&e.order.userAddress.address?(r(),u("div",{key:0,class:"flex flex-row justify-start items-center",onClick:R[0]||(R[0]=_e(p=>z(e.order),["stop"]))},[t("p",null,n(m(et)(e.order.userAddress.address,"...",5,5)),1),!m(a).isOnlyView&&m(K)?(r(),u("img",Vs)):A("",!0)])):A("",!0),t("div",js,n(m(Tt)(e.order)),1)]),t("div",Hs,[t("span",null,n(m(ms)(e.order)),1)])])]),t("ul",Gs,[t("div",{class:"w-fit flex flex-wrap justify-start text-white gap-1",onClick:R[1]||(R[1]=_e(p=>V(e.order),["stop"]))},[m($).length<5?(r(),u("div",Ms,[qs,m($).length?A("",!0):(r(),u("div",Ks,n(c.$t("order.add order tag")),1))])):A("",!0),(r(!0),u(me,null,$e(m($).slice(0,5),p=>(r(),u("li",{style:Xe({backgroundColor:m(ot)(p==null?void 0:p.colorHex,.12),color:p==null?void 0:p.colorHex}),class:Ce(["text-xxs h-[22px] rounded-[4px] px-[8px] py-1 flex justify-center items-center font-normal whitespace-nowrap",{"w-[22px]":!(p!=null&&p.content)}]),key:p==null?void 0:p.id},n(p==null?void 0:p.content),7))),128)),m($).length>5?(r(),u("li",Us,Ys)):A("",!0)])]),(r(!0),u(me,null,$e(e.order.orderGoods,p=>(r(),G(rs,{class:"goods-item",creditFlag:e.order.creditFlag,payType:e.order.payType,key:p.goodsName,goods:p,storeCard:e.order.fmStoredCard,refundInfo:e.order.refundInfo,onHandleTo:w,tab:v.tab},null,8,["creditFlag","payType","goods","storeCard","refundInfo","tab"]))),128)),t("div",Ws,[Js,t("div",Qs,[e.order.userAddress?(r(),u("div",Zs,n(e.order.userAddress.provinceName??"")+n(e.order.userAddress.cityName??"")+n(e.order.userAddress.countyName??"")+n(e.order.userAddress.detailInfo??""),1)):A("",!0),e.order.userAddress?(r(),u("div",Xs,n(e.order.userAddress.userName)+" "+n(e.order.userAddress.telNumber),1)):A("",!0)])]),(B=e.order.userAddress)!=null&&B.postscript?(r(),u("div",eo,[to,t("div",so,[t("div",oo,n(((j=e.order.userAddress)==null?void 0:j.postscript)||c.$t("order.noRemark")),1)])])):A("",!0),ne(e.order)?(r(),u("div",ao,[m(Me)(e.order.expressTime,e.order.confirmLimit,e.nowTime)>0&&!e.order.merchantsConfirm?(r(),u(me,{key:0},[t("div",null,n(c.$t("order.observeTip")),1),t("div",no,[T(d,{class:"order-time",time:m(Me)(e.order.expressTime,e.order.confirmLimit,e.nowTime)},{default:E(p=>[t("span",ro,n(p.days),1),t("span",lo,n(c.$t("common.day")),1),t("span",io,n(p.hours),1),t("span",co,n(c.$t("common.hours")),1),t("span",uo,n(p.minutes),1),t("span",mo,n(c.$t("common.minutes")),1),t("span",fo,n(p.seconds),1),t("span",po,n(c.$t("common.seconds")),1)]),_:1},8,["time"]),t("span",null,n(c.$t("order.sellConfirmTip")),1)])],64)):m(S)?(r(),u("div",vo,n(c.$t("order.sellConfirm")),1)):A("",!0)])):A("",!0),fe(e.order)&&m($s)(e.order,e.nowTime)?(r(),u("div",ho,[t("span",xo,n(c.$t("order.buyer submit modify order info apply")),1)])):A("",!0),e.isService?A("",!0):(r(),u("div",yo,[!m(a).isOnlyView&&m(q)?(r(),G(f,{key:0,class:"bg-btnOrBg rounded-md h-[32px] px-3 text-default text-sm font-normal mt-3",onClick:_e(O,["stop"])},{default:E(()=>[ee(n(c.$t("order.Ship")),1)]),_:1},8,["onClick"])):A("",!0),!m(a).isOnlyView&&e.order.status===0&&!e.order.hash?(r(),G(f,{key:1,class:"bg-btnOrBg rounded-md h-[32px] px-3 text-default text-sm font-normal mt-3",onClick:_e(ae,["stop"])},{default:E(()=>[ee(n(c.$t("order.modifyPrice")),1),T(ls,{class:"inline-block ml-1 whitespace-nowrap",startTime:e.order.createTime,duration:15,durationType:"minutes",showZero:!1,onTimeDone:te},null,8,["startTime"])]),_:1},8,["onClick"])):A("",!0),m(S)?(r(),G(f,{key:2,class:Ce(["bg-btnOrBg rounded-md min-w-[80px] h-[32px] px-3 text-default text-sm font-semibold mt-3",{"opacity-50":!!m(a).isOnlyView}]),disabled:m(Me)(e.order.expressTime,e.order.confirmLimit,e.nowTime)>0,loading:e.order.loading,onClick:R[2]||(R[2]=_e(p=>F(e.order),["stop"]))},{default:E(()=>[ee(n(c.$t("order.confirmGeted")),1)]),_:1},8,["class","disabled","loading"])):A("",!0)])),Yt(c.$slots,"default",{},void 0,!0)])}}}),wo=Re(go,[["__scopeId","data-v-5d1683f2"]]),bo={class:"bg-[#f2f0ef]"},$o={class:"px-[20px] pt-[18px] pb-[15px] flex justify-between bg-white z-40 text-[14px] items-center absolute top-0 left-0 right-0"},Co={class:"text-[#222221] text-[16px] line-clamp-1"},ko={class:"tagForm"},Ao={class:"text-[#222221] mb-[10px]"},_o={class:"mt-[30px]"},Io={key:0,class:"text-center mt-[150px]"},To={class:"h-[96px] p-[16px] flex flex-col justify-center items-center fixed bottom-0 left-0 right-0 bg-white"},So={class:"mt-[8px] text-[#5D5A56] text-[12px] leading-none"},Ro={class:"p-[16px] flex justify-center fixed bottom-0 left-0 right-0 bg-white"},Bo=Te({props:{value:null},setup(e,{expose:M}){const{value:v}=e,{t:a}=ze(),y=x(null),{getCurrentStoreId:_}=_t(),{checkLoginAuth:q}=is(),{getMerchantDhKey:S,decryptAddressKey:K,decryptKey:$,cryptoAESWithSearch:C}=ds(),[w,g]=Ge(!1),O=x(0);qe(()=>v,s=>{O.value=s},{immediate:!0});const ae=Wt({statusEnum:St()}),te=xe(()=>[{id:-1,name:a("order.all")},{id:0,name:a("order.waitPay")},{id:1,name:a("order.wait")},{id:2,name:a("order.already")},{id:4,name:a("order.completed")}]),I=s=>{var i,N;return xt.isEmpty(s.refundInfo)?"":((i=s.refundInfo)==null?void 0:i.refundType)==1?"仅退款":((N=s.refundInfo)==null?void 0:N.refundType)==2?"退货退款":""},Be=s=>xt.isEmpty(s.refundInfo)?"":Is(s,!0),F=x(""),V=x([]),z=x(!1),ne=x(!1),fe=x(0),c=x(30),R=x(0),d=x({}),f=x(!1),B=x(0),j=async()=>{q(!0)&&(fe.value+=1,await pe(d.value))},p=x([]),ye=async s=>{ne.value=!1,V.value=[],fe.value=1,await pe(s)},nt=()=>{if(F.value=F.value.trim(),F.value&&F.value.length<2)return k(a("common.Please enter at least two keywords"));ye(d.value)},pe=s=>new Promise(async i=>{var de,U,X,ke,we,h,L,Q,o,He,Ne,Le,Pe,De,oe,Fe,mt,ft,pt;z.value&&i(),d.value=Object.keys(s).length>0?s:d.value;let N=null;f.value&&(N=Math.ceil((B.value+1)/c.value)),z.value=!0;let he=O.value,se=null;F.value&&(se=await C(F.value.replace(/\s+/g,""))),k.loading({duration:0,forbidClick:!0});const J={page:N||fe.value,size:c.value,status:te.value[O.value].id,type:1,keyword:se,keywordPlain:F.value,storeId:(de=await _())==null?void 0:de.id,...s};(s.waitBuyerReceive||s.waitSellerReceive)&&(console.log("有过滤收货状态"),J.status=2);const H=await Ue(J);if(!H.success){ne.value=!0;return}if(k.clear(),!H.data||!H.total){ne.value=!0,z.value=!1;return}if(he!==O.value)return;(H==null?void 0:H.total)===0&&(V.value=[]),R.value=H.total;const Z=[];for(let Ve=0;Ve<H.data.length;Ve++){let Ae="";const l=H.data[Ve];if(l.userAddress&&(l.userAddress.postscript=l.postscript),l.userAddress&&((U=l.userAddress)!=null&&U.encryptFlag)){const be=await S(l.address,l.submitUserPubKey);be&&(l.userAddress=K(l.userAddress,be),(X=l.userAddress)!=null&&X.success&&!l.merchantEns&&(Ae+=((ke=l.userAddress)==null?void 0:ke.userName)+((we=l.userAddress)==null?void 0:we.telNumber)+(((h=l.userAddress)==null?void 0:h.postalCode)??"")+((L=l.userAddress)==null?void 0:L.provinceName)+((Q=l.userAddress)==null?void 0:Q.cityName)+((o=l.userAddress)==null?void 0:o.countyName)+((He=l.userAddress)==null?void 0:He.detailInfo)+(((Ne=l.userAddress)==null?void 0:Ne.postscript)||"").replace(/\s+/g,"")))}else l.merchantEns||(Ae+=((Le=l.userAddress)==null?void 0:Le.userName)+((Pe=l.userAddress)==null?void 0:Pe.telNumber)+(((De=l.userAddress)==null?void 0:De.postalCode)??"")+((oe=l.userAddress)==null?void 0:oe.provinceName)+((Fe=l.userAddress)==null?void 0:Fe.cityName)+((mt=l.userAddress)==null?void 0:mt.countyName)+((ft=l.userAddress)==null?void 0:ft.detailInfo)+(((pt=l.userAddress)==null?void 0:pt.postscript)||"").replace(/\s+/g,""));if(l.shippingHash){const be=await S(l.address,l.shippingUserPubKey);if(be){const vt=$(l.expressNo,be);vt.hash===l.shippingHash&&(l.expressNo=vt.decrypt,l.expressCompany=$(l.expressCompany,be).decrypt,l.merchantEns||(Ae+=(l==null?void 0:l.expressNo)+(l==null?void 0:l.expressCompany)))}}else l.merchantEns||(Ae+=(l==null?void 0:l.expressNo)+(l==null?void 0:l.expressCompany));if(l.merchantEns||(Ae+=(l==null?void 0:l.hash)+(l==null?void 0:l.address)),Ae)try{Z.push({id:l.id,merchantEns:await C(Ae)})}catch(be){console.log(be)}}const b=Z.filter(Ve=>Ve.merchantEns);b.length>0&&vs({enInfoList:b}),p.value=H.data,f.value?(V.value.splice((N-1)*c.value,c.value,...p.value),f.value=!1):V.value=fe.value===1?p.value:V.value.concat(p.value),V.value.length>=R.value&&(ne.value=!0),z.value=!1,i()}),rt=async s=>{y.value.handleReset(!1),It.replace({path:"sellerOrderList",query:{type:1,active:s}}),O.value=s,z.value=!1,Mt()},Ot=async s=>{var L,Q;const i=navigator.userAgent.toLowerCase(),N=/mobile|android|iphone|ipad|phone/i.test(i),he=/tablet|ipad/i.test(i),se=/webview|wv/i.test(i),J=/fbav|instagram|line|twitter|whatsapp/i.test(i),H=/metamask/i.test(i),Z=/tokenpocket/i.test(i),b=(window==null?void 0:window.$onekey)||!1;if(Qt.isConnected()){g(!0);return}if(b){g(!0);return}if((N||he)&&(se||J||H||Z||b)&&!window.chrome&&!window.safari){g(!0);return}let de=null;F.value&&(de=await C(F.value.replace(/\s+/g,"")));const U={page:1,size:99999,status:te.value[O.value].id,type:1,keyword:de,keywordPlain:F.value,storeId:(L=await _())==null?void 0:L.id,...s};(s.waitBuyerReceive||s.waitSellerReceive)&&(console.log("导出-有过滤收货状态"),U.status=2),k.loading({duration:0,message:a("common.loading")});const X=await Ue(U);if(!X.success||!X.data||X.data.length===0){k.clear(),k(a("common.No data download"));return}const ke=X.data.map(o=>new Promise(async He=>{var Ne,Le,Pe,De;if(o!=null&&o.userAddress&&(o.userAddress.postscript=o.postscript),o!=null&&o.userAddress&&((Ne=o==null?void 0:o.userAddress)!=null&&Ne.encryptFlag)){const oe=await S(o.address,o==null?void 0:o.submitUserPubKey);oe&&(o.userAddress=K(o.userAddress,oe))}if(o!=null&&o.shippingHash){const oe=await S(o.address,o==null?void 0:o.shippingUserPubKey);if(oe){const Fe=$(o.expressNo,oe);Fe.hash===o.shippingHash&&(o.expressNo=Fe.decrypt,o.expressCompany=$(o.expressCompany,oe).decrypt)}}He([{text:o.id},{text:o.address},{text:o.hash||""},{text:o.orderGoods&&o.orderGoods.length?Ee(o.orderGoods,"goodsName"):""},{text:o.orderGoods&&o.orderGoods.length?Ee(o.orderGoods,"goodsId"):""},{text:o.orderGoods&&o.orderGoods.length?Ee(o.orderGoods,"number"):0},{text:o.orderGoods&&o.orderGoods.length?Ee(o.orderGoods,"price"):0},{text:ae.statusEnum[o.status+""]},{text:o.totalAmountOriginal||0},{text:o.merchantAdjustAmount||0},{text:o.activityReduceAmount||0},{text:o.voucherAmount||0},{text:Nt(o)},{text:o.orderGoods&&o.orderGoods.length?Ee(o.orderGoods,"discountRatio","%"):"0%"},{text:o.createTime?Ie(o.createTime):""},{text:o.chainCreateTime?Ie(o.chainCreateTime):""},{text:o.expressTime?Ie(o.expressTime):""},{text:o.finishTime?Ie(o.finishTime):""},{text:o.userAddress.postscript||""},{text:`${o.userAddress.provinceName??""}${o.userAddress.cityName??""}${o.userAddress.countyName??""}${o.userAddress.detailInfo??""} ${o.userAddress.userName??""} ${o.userAddress.telNumber??""}`},{text:o.creditFlag?a("common.yes"):a("common.no")},{text:o.merchantsConfirm?a("common.yes"):a("common.no")},{text:o.orderLabelList.map(oe=>oe.content).join(",")},{text:o.expressCompany||""},{text:o.expressNo||""},{text:I(o)},{text:Be(o)},{text:fs(o)},{text:((Le=o.refundInfo)==null?void 0:Le.submitTime)||""},{text:((Pe=o.refundInfo)==null?void 0:Pe.successTime)||""},{text:((De=o.refundInfo)==null?void 0:De.cancelTime)||""},{text:ps(o)}])})),we=await Promise.all(ke);if(!we||we.length===0){k.clear(),k(a("common.No data download"));return}const h=[{text:a("order.export.orderId")},{text:a("order.export.buyerAddress")},{text:a("order.export.transactionHash")},{text:a("order.export.goodsName")+"("+a("order.export.goodsName-tips")+")"},{text:a("order.export.goodsId")+"("+a("order.export.goodsId-tips")+")"},{text:a("order.export.goodsNumber")+"("+a("order.export.goodsName-tips")+")"},{text:a("order.goodsPrice")+"("+a("order.export.goodsName-tips")+")"},{text:a("order.orderStatus")},{text:a("order.export.goodsPrice total")},{text:a("order.merchant modify price total")},{text:a("order.export.activityReduceAmount total")},{text:a("voucher.voucher_deduction total")},{text:a("order.export.actualAmount total")},{text:a("common.ratio")},{text:a("order.createTime")},{text:a("order.export.paymentTime")},{text:a("order.Shipping time")},{text:a("order.Complete time")},{text:a("order.remark")},{text:a("order.receive address")},{text:a("order.export.isCreditReceive")},{text:a("order.export.merchantsConfirm")},{text:a("order.export.orderLabelList")},{text:a("order.deliveryCompany")},{text:a("order.deliveryId")},{text:"退款类型"},{text:a("refund.RefundReason")},{text:a("refund.refundStatus")},{text:a("refund.refundTime")},{text:a("refund.refundSuccessTime")},{text:a("refund.refundCancelTime")},{text:"平台介入状态"}];try{const o=((Q=await _())==null?void 0:Q.storeName)+"_"+Zt().format("YYYY-MM-DD HH:mm:ss");_s([h,...we],{excelName:o,worksheet:"sheet"}),k.clear()}catch{k.clear()}},lt=()=>{g(!1)},Nt=s=>{const i=new Se(s.totalAmountOriginal).plus(new Se(s.merchantAdjustAmount||0)).minus(new Se(s.activityReduceAmount||0)).minus(new Se(s.voucherAmount||0)).toNumber();return Lt(i)},Lt=s=>Number.isInteger(s)?s.toString():s.toFixed(4).replace(/\.?0+$/,""),Ee=(s,i,N)=>s.map(se=>{let J=se[i];return N&&(J=J+N),J}).join(","),Oe=x(!1),ve=x(!1),D=x(!1),re=x(null),Y=x([]),ge=x(""),Ye=x([]),le=x([]),ie=x(null),We=x(null),W=x({content:"",colorHex:"",id:null,shopId:null}),it=x(null),dt=x([{id:null,content:"",colorHex:"#D4380D"},{id:null,content:"",colorHex:"#E58312"},{id:null,content:"",colorHex:"#DEAD0E"},{id:null,content:"",colorHex:"#389E0D"},{id:null,content:"",colorHex:"#0958D9"},{id:null,content:"",colorHex:"#531DAB"}]),Pt=(s,i)=>{B.value=i,D.value=!1,Oe.value=!0,it.value=s.id,We.value=s.stores.id,s.orderLabelList&&(Y.value=s.orderLabelList.map(N=>N.id)),Qe()},Dt=s=>{D.value=!0,s.id&&(ie.value=s.id,re.value=s.content,W.value.id=s.id,W.value.colorHex=s.colorHex,ge.value=s.colorHex,Ye.value=Y.value)},Ft=()=>{D.value=!0,ie.value=null,re.value=null,W.value.id=null,W.value.colorHex=null,ge.value="",Ye.value=Y.value},Vt=s=>{Y.value&&Y.value.length>=5&&Y.value.findIndex(i=>i===le.value[s].id)===-1&&k(a("common.tag select num valid",{num:5}))},Je=()=>{D.value=!1,Y.value=Ye.value,ie.value=null,le.value.length=0,re.value=null,ge.value="",Qe()},ct=()=>{Oe.value=!1,D.value=!1,ie.value=null,Y.value=[],y.value.onLoadTagList()},Qe=()=>{le.value=[],hs({page:1,size:300,shopId:We.value}).then(s=>{s==null||s.data.forEach(i=>{le.value.push({id:i.id,content:i.content,colorHex:i.colorHex})})})},jt=()=>{var s;if(!ve.value){if(((s=ge.value)==null?void 0:s.length)===0){k.fail(a("order.Please select a color"));return}else W.value.colorHex=ge.value,W.value.id=ie.value,W.value.content=re.value,W.value.shopId=We.value;W.value.content&&(W.value.content=W.value.content.trim()),ie.value||delete W.value.id,ve.value=!0,xs(W.value).then(i=>{i.msg==="SUCCESS"&&(D.value=!1,le.value=[],ge.value="",re.value=null,Qe(),f.value=!0,pe(d.value),k(a("order.Save success")))}).finally(()=>{ve.value=!1})}},Ht=()=>{ve.value||(ve.value=!0,ys({id:ie.value}).then(s=>{s.msg==="SUCCESS"?(k(a("order.Delete success")),f.value=!0,pe(d.value),Je()):k(a("order.Delete failed"))}).finally(()=>{ve.value=!1}))},Gt=async()=>{ve.value||(Y.value=Y.value.filter(s=>!!le.value.find(i=>s==i.id)),ve.value=!0,await gs({orderId:it.value,orderLabelIds:Y.value.join(",")}).then(s=>{if((s==null?void 0:s.msg)==="SUCCESS")Oe.value=!1,D.value=!1,re.value="",k(a("order.Save success")),f.value=!0,pe(d.value);else{k(a("order.Save failed"));return}}).finally(()=>{ve.value=!1}))},Mt=()=>{ne.value=!1,fe.value=1,V.value=[],pe({})},Ze=x(new Date().getTime()/1e3),ut=async()=>{Ze.value=await us()};ht(()=>{Ze.value+=1},1e3),ht(()=>{ut()},6e4);const qt=x(null),Kt=async()=>{var i,N,he,se,J,H,Z;const s=sessionStorage.getItem("modifiedOrderId");if(s)try{const b=await ws({id:s});if(b.success&&b.data){if((i=b.data)!=null&&i.userAddress&&(b.data.userAddress.postscript=b.data.postscript),(N=b.data)!=null&&N.userAddress&&((se=(he=b.data)==null?void 0:he.userAddress)!=null&&se.encryptFlag)){const U=await S(b.data.address,(J=b.data)==null?void 0:J.submitUserPubKey);U&&(b.data.userAddress=K(b.data.userAddress,U))}if((H=b.data)!=null&&H.shippingHash){const U=await S(b.data.address,(Z=b.data)==null?void 0:Z.shippingUserPubKey);if(U){const X=$(b.data.expressNo,U);X.hash===b.data.shippingHash&&(b.data.expressNo=X.decrypt,b.data.expressCompany=$(b.data.expressCompany,U).decrypt)}}const de=V.value.findIndex(U=>U.id===parseInt(s));de!==-1?Object.assign(V.value[de],b.data):console.log("未找到要更新的订单，ID:",s)}}catch{}finally{sessionStorage.removeItem("modifiedOrderId")}},Ut=async()=>{V.value.length>0&&await Kt()},zt=s=>new Promise(i=>setTimeout(i,s));return kt(async()=>{var s;await zt(100),q(!0)&&(ut(),qt.value=(s=await _())==null?void 0:s.merchant)}),M({handleChangeTab:rt,active:O,updateModifiedOrders:Ut}),(s,i)=>{const N=P("Empty"),he=P("VanList"),se=P("VanTab"),J=P("VanTabs"),H=P("van-field"),Z=P("van-icon"),b=P("van-radio"),de=P("van-radio-group"),U=P("van-checkbox"),X=P("van-checkbox-group"),ke=P("van-button"),we=P("van-action-sheet");return r(),u(me,null,[T(J,{active:O.value,"onUpdate:active":i[2]||(i[2]=h=>O.value=h),onChange:rt,background:"#f2f0ef",sticky:"","offset-top":"44"},{"nav-bottom":E(()=>[t("div",bo,[T(ks,{modelValue:F.value,"onUpdate:modelValue":i[0]||(i[0]=h=>F.value=h),onOnSubmit:nt,onGetList:ye,noType:!0,ref:(h,L)=>{L.searchBox=h,y.value=h},active:O.value,onOnExport:Ot},null,8,["modelValue","active"])])]),default:E(()=>[(r(!0),u(me,null,$e(m(te),h=>(r(),G(se,{title:h.name,key:h.id},{default:E(()=>[V.value.length===0&&!z.value?(r(),G(N,{key:0,name:"没有订单",class:"py-6"})):A("",!0),T(he,{loading:z.value,"onUpdate:loading":i[1]||(i[1]=L=>z.value=L),finished:ne.value,"finished-text":s.$t("common.noMore"),"loading-text":s.$t("common.loading"),onLoad:j},{default:E(()=>[(r(!0),u(me,null,$e(V.value,(L,Q)=>(r(),G(wo,{key:L.id,order:L,onOpen:o=>Pt(o,Q),nowTime:Ze.value,tab:h},null,8,["order","onOpen","nowTime","tab"]))),128))]),_:2},1032,["loading","finished","finished-text","loading-text"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"]),T(we,{show:Oe.value,"onUpdate:show":i[8]||(i[8]=h=>Oe.value=h),closeable:!1,class:"h-[70vh] font-Puhui",onCancel:Je,onClose:ct},{default:E(()=>[t("div",$o,[ce(t("div",{class:"text-[#5D5A56] max-w-[80px] line-clamp-1",onClick:Je},n(s.$t("common.closed")),513),[[ue,D.value]]),ce(t("div",{class:"text-[#5D5A56] max-w-[80px] line-clamp-1",onClick:ct},n(s.$t("common.closed")),513),[[ue,!D.value]]),t("div",Co,n(ie.value?s.$t("common.editTag"):s.$t("common.addTag")),1),ce(t("div",{class:"text-[#A45E00] max-w-[80px] line-clamp-1 text-right",onClick:Ft},n(s.$t("piggy.add")),513),[[ue,!D.value]]),ce(t("div",{class:"text-[#A45E00] max-w-[80px] line-clamp-1 text-right",onClick:jt},n(s.$t("common.save")),513),[[ue,D.value]])]),t("div",{class:Ce(["mt-[53px] px-[20px]",D.value&&ie.value?"pb-[96px]":"pb-[72px]"])},[T(Jt,{name:"van-slide-up"},{default:E(()=>[ce(t("div",ko,[t("div",Ao,n(s.$t("common.NameOptional")),1),T(H,{modelValue:re.value,"onUpdate:modelValue":i[3]||(i[3]=h=>re.value=h),maxlength:"5",placeholder:s.$t("common.pleaseEnter")},null,8,["modelValue","placeholder"]),t("div",_o,n(s.$t("common.color")),1)],512),[[ue,D.value]])]),_:1}),ce(T(de,{modelValue:ge.value,"onUpdate:modelValue":i[4]||(i[4]=h=>ge.value=h),max:1},{default:E(()=>[(r(!0),u(me,null,$e(dt.value,(h,L)=>(r(),G(b,{name:h.colorHex,key:L,class:"relative flex checkedList"},{icon:E(Q=>[Q.checked?(r(),G(Z,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[23px] border-0 top-[1px] bg-transparent",size:"30"})):A("",!0)]),default:E(()=>[t("div",{style:Xe({backgroundColor:m(ot)(h.colorHex,.12),color:h.colorHex}),class:Ce(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",L<dt.value.length-1?"mb-[16px]":""])},n(h.content||re.value),7)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),[[ue,D.value]]),!D.value&&le.value.length==0?(r(),u("div",Io,n(s.$t("common.NoLabels")),1)):A("",!0),ce(T(X,{modelValue:Y.value,"onUpdate:modelValue":i[5]||(i[5]=h=>Y.value=h),max:5},{default:E(()=>[(r(!0),u(me,null,$e(le.value,(h,L)=>(r(),G(U,{name:h.id,key:L,class:"relative flex radioList",onClick:Q=>Vt(L)},{icon:E(Q=>[Q.checked?(r(),G(Z,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[40px] border-0 top-[1px] bg-transparent",size:"30"})):A("",!0)]),default:E(()=>[t("div",{style:Xe({backgroundColor:m(ot)(h.colorHex,.12),color:h.colorHex}),class:Ce(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",L<le.value.length-1?"mb-[16px]":""])},n(h.content||re.value),7),t("div",null,[T(Z,{name:"edit",class:"absolute right-[1px] top-[1px]",color:"#543E3E",size:"30",onClick:_e(Q=>Dt(h),["stop"])},null,8,["onClick"])])]),_:2},1032,["name","onClick"]))),128))]),_:1},8,["modelValue"]),[[ue,!D.value]]),ce(t("div",To,[T(ke,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"shrink-0 w-[180px] my-0 h-[40px] rounded-[20px]",onClick:i[6]||(i[6]=h=>Ht()),block:""},{default:E(()=>[ee(n(s.$t("common.RemoveTag")),1)]),_:1}),t("div",So,[T(Z,{name:"question-o",size:"12",class:"mr-[8px]"}),ee(n(s.$t("common.AllOrderLabelsCannotBeViewedAfterRemoval")),1)])],512),[[ue,D.value&&ie.value]])],2),ce(t("div",Ro,[T(ke,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"w-[180px] my-0 h-[40px] rounded-[20px]",onClick:i[7]||(i[7]=h=>Gt()),block:""},{default:E(()=>[ee(n(s.$t("common.ConfirmSelection")),1)]),_:1})],512),[[ue,!D.value&&le.value.length>0]])]),_:1},8,["show"]),T(cs,{show:m(w),title:"导出账单",content:"请在PC端操作账单导出",showConfirm:!0,showReject:!1,confirmText:"我知道了",rejectText:"拒绝",onClose:lt,onConfirm:lt},null,8,["show"])],64)}}}),Eo=Re(Bo,[["__scopeId","data-v-a53e6d9c"]]),Oo={},No={class:"dot w-[8px] h-[8px] rounded-full bg-[red] absolute top-0 right-[-10px]"};function Lo(e,M){return r(),u("div",No)}const Po=Re(Oo,[["render",Lo]]),Do={class:"py-[20px] flex-start gap-2"},Fo={class:"w-20 h-20"},Vo={class:"flex flex-col justify-between flex-1 h-20"},jo={class:"flex-1 text-sm text-default"},Ho={class:"w-full flex flex-row justify-start items-center gap-2 line-clamp-1"},Go={class:"max-w-[150px] font-semibold line-clamp-1"},Mo={key:0,class:"flex-shrink-0 flex items-center text-xs text-[#34C2A9]"},qo=t("img",{src:Ss,class:"w-5 h-5"},null,-1),Ko={class:"ml-auto text-sm text-default opacity-60 whitespace-nowrap"},Uo={class:"mt-0 text-sm font-normal text-[#a6a6a6]"},zo={key:0,class:"flex justify-end opacity-60 text-[#FD5520] text-sm"},Yo={class:"flex flex-row justify-end"},Wo={class:"text-sm text-[#a6a6a6] font-normal mr-1"},Jo={key:0,class:"text-newOrigin text-sm flex-start gap-[2px]"},Qo=["src"],Zo={class:"font-semibold"},Xo={class:"text-sm font-normal"},ea={key:1,class:"text-primary text-sm flex-start gap-[2px]"},ta=t("img",{src:Rs,class:"w-4 h-4 mr-[3px]",alt:"MCOIN"},null,-1),sa={class:"font-semibold"},oa=Te({props:{payType:null,goods:null,order:null,storeCard:null,creditFlag:{default:0}},setup(e){const M=a=>{const y=a.number??1,_=a.cardPrice??0,q=a.goodsActivityReduceAmount??0,S=new Se(_*y-q).toNumber();return yt(S)},v=a=>{const y=new Se(a.price).times(a.number).minus(a.goodsActivityReduceAmount||0).plus(a.goodsAdjustChangeAmount||0).toNumber();return yt(y||0)};return(a,y)=>{var q,S,K;const _=P("VanImage");return r(),u("div",Do,[t("div",Fo,[T(_,{src:(e.goods.icons||"").split(",")[0],radius:"10",class:"w-full h-full",alt:"",fit:"cover"},null,8,["src"])]),t("div",Vo,[t("div",jo,[t("div",null,[t("div",Ho,[t("div",Go,n(e.goods.goodsName),1),e.creditFlag?(r(),u("div",Mo,[qo,ee(" "+n(a.$t("order.Credit Collection")),1)])):A("",!0),t("div",Ko,[t("span",null,n(e.goods.price)+" Mcoin",1)])])]),t("div",Uo,n(a.$t("order.quantity",{number:e.goods.number})),1)]),m(Ts)(e.order)?(r(),u("div",zo,n(m(Tt)(e.order)),1)):A("",!0),t("div",Yo,[t("div",Wo,n(a.$t("order.actual payment")),1),e.payType===m(Rt).STORE_CARD?(r(),u("div",Jo,[(q=e.storeCard)!=null&&q.symbolLogo?(r(),u("img",{key:0,src:(S=e.storeCard)==null?void 0:S.symbolLogo,class:"w-3 h-3",alt:""},null,8,Qo)):A("",!0),t("span",Zo,n(M(e.goods)),1),t("span",Xo,n((K=e.storeCard)==null?void 0:K.symbol),1)])):(r(),u("div",ea,[ta,t("span",sa,n(v(e.goods)),1)]))])])])}}}),aa=e=>($t("data-v-a0d8c7f8"),e=e(),Ct(),e),na={class:"gap-2 flex-center-bw"},ra={key:0,class:"w-4 h-4",src:Et,alt:""},la={key:1,class:"w-4 h-4 border border-solid rounded-full border-[#000]/40"},ia=aa(()=>t("div",{class:"w-8 h-8"},[t("img",{src:At,class:"w-full h-full rounded-md",alt:"",fit:"cover"})],-1)),da={class:"flex flex-col justify-center flex-1 h-8 text-default"},ca={class:"text-sm font-normal flex-center-bw"},ua={key:0},ma={class:"text-primary"},fa={class:"text-xs font-normal opacity-60"},pa={key:0},va={key:1},ha={key:2},xa=Te({props:{order:null,isService:{type:Boolean},nowTime:null,selectIds:null},emits:["select"],setup(e,{emit:M}){const v=e;Ke();const a=wt(),y=St(),{t:_}=ze(),q=$=>{v.isService||a.push($)},S=()=>{if(v.isService){const $=v.order;K($)}else a.push(`/sellerOrderDetail?id=${v.order.id}`)};bt("openBatchReceiptPop",null),at();const K=$=>{M("select",$)};return($,C)=>(r(),u("div",{class:Ce(["p-3 mt-3 bg-white rounded-xl box-border default-border",{"border-orange":e.selectIds&&e.selectIds.includes(e.order.id)}]),onClick:S},[t("div",na,[t("div",null,[e.selectIds&&e.selectIds.includes(e.order.id)?(r(),u("img",ra)):(r(),u("div",la))]),ia,t("div",da,[t("div",ca,[e.order.userAddress&&e.order.userAddress.address?(r(),u("div",ua,n(m(et)(e.order.userAddress.address,"...",5,5)),1)):A("",!0),t("div",ma,n(m(y)[e.order.status+""]),1)]),t("div",fa,[e.order.status==4?(r(),u("span",pa,n(m(Ie)(e.order.finishTime))+" "+n($.$t("common.finish")),1)):e.order.status==2?(r(),u("span",va,n(m(Ie)(e.order.expressTime))+" "+n($.$t("order.Ship")),1)):(r(),u("span",ha,n(m(Ie)(e.order.createTime))+" "+n($.$t("order.buied")),1))])])]),(r(!0),u(me,null,$e(e.order.orderGoods,w=>(r(),G(oa,{class:"goods-item",creditFlag:e.order.creditFlag,payType:e.order.payType,key:w.goodsName,goods:w,order:e.order,storeCard:e.order.fmStoredCard,onHandleTo:q},null,8,["creditFlag","payType","goods","order","storeCard"]))),128))],2))}}),gt=Re(xa,[["__scopeId","data-v-a0d8c7f8"]]),ya={class:"px-3 text-base"},ga={class:"flex justify-center items-center h-[44px]"},wa={class:"flex items-center font-bold"},ba={class:"overflow-y-scroll max-h-[70vh] pb-[100px]"},$a={class:"mt-3 text-sm font-normal"},Ca={class:"text-primary font-semibold"},ka={class:"text-primary font-semibold"},Aa={class:"flex flex-col"},_a={class:"receipt__wrap flex flex-col items-center justify-center gap-3 py-5 px-6 fixed bottom-0 left-0 right-0"},Ia={class:"text-sm font-normal text-black"},Ta={class:"w-full flex flex-row justify-between items-center"},Sa={class:"flex items-center justify-center"},Ra={key:0,class:"w-4 h-4",src:Et,alt:""},Ba={key:1,class:"w-4 h-4 border border-solid rounded-full border-[#000]/40"},Ea={key:0,class:"text-default"},Oa=Te({props:{show:{type:Boolean},list:null,currentId:null,loading:{type:Boolean}},emits:["close","receipt","update:show"],setup(e,{emit:M}){const v=e,a=xe({get:()=>v.show,set:w=>M("update:show",w)}),y=x([]),_=xe(()=>v.list&&v.currentId?v.list.filter(w=>+w.id!=+v.currentId):[]),q=xe(()=>{const w=[v.currentId,..._.value.map(g=>g.id)];return y.value.length===w.length&&w.every(g=>y.value.includes(g))}),S=()=>{if(q.value)y.value=[];else{const w=[v.currentId,..._.value.map(g=>g.id)];y.value=w}};qe(()=>v.show,w=>{if(w){const g=document.getElementById("container");es(()=>{g&&g.scrollIntoView()}),y.value=[],y.value.push(v.currentId)}},{deep:!0});const K=w=>{const g=w.id;y.value.includes(g)?y.value=y.value.filter(O=>O!==g):y.value.push(g)},$=()=>{M("receipt",y.value)},C=xe(()=>v.list&&v.currentId?v.list.find(w=>+w.id==+v.currentId):[]);return(w,g)=>{const O=P("van-icon"),ae=P("VanButton"),te=P("van-popup");return r(),G(te,{show:m(a),"onUpdate:show":g[1]||(g[1]=I=>Xt(a)?a.value=I:null),round:"",class:"bg-[#F3F3F3]",position:"bottom",onClose:g[2]||(g[2]=I=>M("close")),"safe-area-inset-bottom":"","stop-propagation":!1},{default:E(()=>[t("div",ya,[t("div",ga,[t("div",wa,n(w.$t("order.you_have_other_pending_orders")),1),T(O,{class:"absolute right-2.5",name:"cross",size:"20",color:"#000",onClick:g[0]||(g[0]=_e(()=>M("close"),["stop"]))})]),t("div",ba,[m(C)?(r(),G(gt,{key:0,id:"container",onSelect:K,selectIds:y.value,order:m(C),isService:""},null,8,["selectIds","order"])):A("",!0),t("div",$a,[ee(n(w.$t("order.there are"))+" ",1),t("span",Ca,n(m(_).length),1),ee(" "+n(w.$t("order.order merchant"))+" ",1),t("span",ka,n(w.$t("order.already")),1),ee(" "+n(w.$t("order.can confirm receipt in batches")),1)]),t("div",Aa,[(r(!0),u(me,null,$e(m(_),I=>(r(),u("div",{key:I.id},[T(gt,{onSelect:K,selectIds:y.value,order:I,isService:""},null,8,["selectIds","order"])]))),128))]),t("div",_a,[t("div",Ia,n(w.$t("order.follow orders")),1),t("div",Ta,[t("div",{class:"flex flex-col items-center justify-center cursor-pointer",onClick:S},[t("div",Sa,[m(q)?(r(),u("img",Ra)):(r(),u("div",Ba))])]),T(ae,{loading:e.loading,round:"",disabled:!y.value||y.value&&y.value.length<=0,class:"ml-2 h-10 text-default min-w-[calc(100%-32px)] bg-btnOrBg rounded-[60px] font-semibold",onClick:$},{default:E(()=>[ee(n(w.$t("order.oneKeyConfirmGeted")),1),y.value.length?(r(),u("span",Ea,n(w.$t("order.selected count num",{count:y.value.length||0})),1)):A("",!0)]),_:1},8,["loading","disabled"])])])])])]),_:1},8,["show"])}}}),Na=Re(Oa,[["__scopeId","data-v-5dc12824"]]),La={class:"relative"},Pa={class:"px-3 bg-[#f2f0ef] pb-1 parent-view"},Da={class:"gap-2 pt-2 flex-start bg-[#f2f0ef] sticky top-0 z-10"},Fa=Te({name:"SellerOrderList"});function Va(e){const{t:M}=ze(),{getCurrentStoreId:v}=_t(),{clerkStore:a}=Ke(),[y,_]=Ge(!1),[q,S]=Ge(!1),[K,$]=Ge(!1),C=ts(),w=x(C.query.active?Number(C.query.active):0),g=x(C.query.type?Number(C.query.type):1),O=x(null),ae=x([]),te=x([]),I=x(null),Be=x(new Date().getTime()/1e3),F=d=>{console.log("changeType",d),g.value=d,It.replace({path:"sellerOrderList",query:{type:d}})},{merchantConfirm:V}=at(),z=async()=>{var f;const d=await Ue({page:1,size:999,status:2,type:1,storeId:(f=await v())==null?void 0:f.id});d.success&&(te.value=d.data)},ne=async d=>{O.value=d.id,te.value.length===0&&(d.loading=!0,await z(),d.loading=!1),ae.value=te.value.filter(f=>{if(Bt(f)&&!(Me(f.expressTime,f.confirmLimit,Be.value)>0))return!0}),ae.value.length<=1?fe(d):S(!0)},fe=async d=>{d.loading=!0;try{const B=(await tt({orderIds:d.id.toString()})).data.ordIds,j=await V(B);if(!j.success||!(await st({ordIds:B,hash:j.result.hash})).success)return;d.merchantsConfirm=1,k.success(M("order.confirmSuccess")),setTimeout(()=>{var ye;I.value?(ye=I.value)==null||ye.handleChangeTab(3):location.reload()},1e3)}finally{d.loading=!1}},c=async d=>{var f;$(!0);try{const B=d.map(String).join(),p=(await tt({orderIds:B})).data.ordIds,ye=await V(p);if(!ye.success||!(await st({ordIds:p,hash:ye.result.hash})).success)return;ae.value.forEach(pe=>{d.includes(pe.id)&&(pe.merchantsConfirm=1)}),S(!1),k.success(M("order.confirmSuccess")),await z(),I.value?(f=I.value)==null||f.handleChangeTab(3):location.reload()}finally{$(!1)}},R=async()=>{var B;const{success:d,total:f}=await Ue({page:1,size:3,status:-1,refundStatus:1,type:1,tab:2,storeId:(B=await v())==null?void 0:B.id});d&&f>0?_(!0):_(!1)};return ss("openBatchReceiptPop",ne),qe(()=>C.query.active,d=>{var f,B;+d&&I.value&&I.value.active&&C.path==="/sellerOrderList"&&((f=I.value)==null?void 0:f.active)!==+d&&((B=I.value)==null||B.handleChangeTab(+d))},{immediate:!1,deep:!0}),qe(()=>C.path,(d,f)=>{var B,j;d==="/sellerOrderList"&&f!=="/sellerOrderList"&&(console.log("从子页面返回，刷新订单列表"),I.value&&sessionStorage.getItem("modifiedOrderId")&&I.value.updateModifiedOrders(),C.query.active&&((B=I.value)==null?void 0:B.active)!==+C.query.active&&((j=I.value)==null||j.handleChangeTab(+C.query.active)))},{immediate:!1}),kt(()=>{R(),z(),a.checkClerkAuth()}),(d,f)=>{const B=P("router-view");return r(),u("div",La,[t("div",Pa,[t("div",Da,[T(Bs),t("div",{class:Ce(["text",{"active-text":g.value==1}]),onClick:f[0]||(f[0]=j=>F(1))},n(d.$t("order.order")),3),t("div",{class:Ce(["relative ml-2 text",{"active-text":g.value==2}]),onClick:f[1]||(f[1]=j=>F(2))},[ee(n(d.$t("order.Refund/After-sale"))+" ",1),ce(T(Po,null,null,512),[[ue,m(y)]])],2),T(Es,{showIcon:!0,showDownIcon:!1,class:"ml-auto bg-gray1 px-2 rounded-[20px] border-2 border-solid border-white",style:{"box-shadow":"0px 0px 15px 0px rgba(51, 47, 42, 0.3) inset"}})]),g.value==1?(r(),G(Eo,{key:0,ref:(j,p)=>{p.sellOrderRef=j,I.value=j},value:w.value},null,8,["value"])):g.value==2?(r(),G(As,{key:1,onRecompute:R})):g.value==3?(r(),G(Os,{key:2})):A("",!0)]),T(B,{id:"child",class:"child-view"}),T(Na,{show:m(q),list:ae.value,currentId:O.value,loading:m(K),onClose:f[2]||(f[2]=j=>m(S)(!1)),onReceipt:c},null,8,["show","list","currentId","loading"])])}}const ja=Te({...Fa,setup:Va}),An=Re(ja,[["__scopeId","data-v-1aede644"]]);export{An as default};
