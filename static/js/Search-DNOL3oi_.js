import{_ as V,z,F as g,Z as q,H as l,$,I as t,P as y,G as i,U as C,a1 as j,Q as d,a3 as E,a4 as S,V as Q,a0 as W,r as _,a2 as H,E as A,O as u,J as D,K as M,X as F,Y as G,q as X,o as Y,bC as Z,bl as ee,D as se,bj as te,bk as oe}from"./vendor-Dr_RpJ_Y.js";import{s as ae,h as le,g as J}from"./mall-BsPFqNQo.js";import{b as ne}from"./index-BckdT6oc.js";import{R as re}from"./Recommends-D6YerGzs.js";import{B as ce}from"./BackIcon-CDrGaEPo.js";import"./GoodsItem-BjohChWG.js";import"./buy-cart-m4kq4Bzt.js";import"./goods-BVwS8oFG.js";import"./ShopMaskTips-ClYuWX9C.js";import"./GoodsPrice-Dz5PcG19.js";import"./MCOIN-Bodfn-v1.js";import"./shop-CeqcS6K2.js";import"./WaterFull-BoFTr9ol.js";/* empty css                                                              */import"./ImgBoutiqueLable-B-2xCcw4.js";import"./RatioBox-BcgP5qRZ.js";import"./MetaKeyTag-CxtJ6uDg.js";import"./useOrderStatus-B4sCDXOr.js";import"./rangking-soiwLY3n.js";const ie=""+new URL("../images/delete-EDwJAk4o.svg",import.meta.url).href,de={class:"box-shadow w-full pb-1.5 py-2 bg-white rounded-[10px] overflow-hidden"},ue={class:"flex justify-between items-center pb-2.5 px-3.5"},me={class:"flex items-center text-sm"},pe={key:0},he={class:"border-solid border-b px-2.5 border-black-100 mt-1.5 text-lg font-semibold text-black text-center pb-8"},fe={class:"flex pt-5 pb-3.5 justify-around"},ye=z({props:{show:{type:Boolean},name:null,width:null,loading:{type:Boolean}},emits:["close","comfirm"],setup(n,{emit:h}){const f=()=>{h("comfirm")};return(a,c)=>{const v=g("van-icon"),e=g("van-button"),P=g("VanPopup");return l(),q(P,{show:n.show,"onUpdate:show":c[2]||(c[2]=x=>W(show)?show.value=x:null),style:Q([{width:n.width||"90%"},{background:"transparent","min-width":"280px","max-width":"335px"}]),"close-on-click-overlay":!0,onClickOverlay:c[3]||(c[3]=E(()=>h("close"),["stop"]))},{default:$(()=>[t("div",de,[t("div",ue,[t("div",me,[n.name?(l(),i("span",pe,d(n.name),1)):C("",!0),j(a.$slots,"header",{},void 0,!0)]),y(v,{class:"text-xl text-black",name:"cross",onClick:c[0]||(c[0]=E(()=>h("close"),["stop"]))})]),t("div",he,[S(d(a.$t("mall.deletehistoryrecords"))+" ",1),j(a.$slots,"default",{},void 0,!0)]),t("div",fe,[y(e,{round:"",type:"primary",class:"px-8 font-semibold border border-solid fd text-primary-001 border-primary-001",onClick:c[1]||(c[1]=()=>{h("close")})},{default:$(()=>[S(d(a.$t("common.cancel")),1)]),_:1}),y(e,{round:"",class:"px-8 font-semibold text-white bg-gradient",onClick:f,loading:n.loading},{default:$(()=>[S(d(a.$t("common.delete")),1)]),_:1},8,["loading"])])])]),_:3},8,["show","style"])}}}),ve=V(ye,[["__scopeId","data-v-1ed4ca51"]]),we=n=>(F("data-v-ac3e7d84"),n=n(),G(),n),ke={class:"mt-4 bg-white rounded-t-xl py-3 px-3.5 pb-10 search-recods min-h-[60vh]"},_e={key:0,class:"mb-5"},xe={class:"flex items-center justify-between text-xs font-semibold mb-2.5 text-black-800"},be=we(()=>t("img",{class:"w-4 h-auto",src:ie},null,-1)),ge=[be],$e={class:"flex flex-wrap gap-2.5"},Ce=["onClick"],Se=["src"],Pe={class:"flex items-center justify-between text-xs font-semibold mb-2.5 text-black-800"},Ie={class:"flex flex-wrap gap-2.5"},Le=["onClick"],Ue=["src"],Re=z({emits:["setKeyword"],setup(n,{emit:h}){const{checkLoginAuth:f}=ne(),a=_([]),c=async()=>{const r=await J({page:1,size:50,type:1});r.success&&(a.value=r.data||[])},v=_([]),e=async()=>{if(!f(!1))return;const r=await le({page:1,size:50});r.success&&(v.value=r.data||[])},[P,x]=H(!1),m=async()=>{x(!0),(await ae()).success&&(x(!1),e(),I(!1))},[N,I]=H(!1),U=r=>{h("setKeyword",r)},p=async()=>{await c()},R=async()=>{await e()},w=async()=>{await p(),await R()};return A(()=>{w()}),(r,k)=>(l(),i("div",ke,[v.value&&v.value.length>0?(l(),i("section",_e,[t("div",xe,[t("span",null,d(r.$t("mall.search history")),1),t("div",{onClick:k[0]||(k[0]=o=>u(I)(!0))},ge)]),t("div",$e,[(l(!0),i(D,null,M(v.value,o=>(l(),i("div",{key:o.keyword,onClick:s=>U(o.keyword),class:"px-4 py-0.5 text-xs line-clamp-1 max-w-full leading-normal rounded-xl bg-black-100 text-black-400"},[o.iconUrl?(l(),i("img",{key:0,class:"inline-block w-auto h-4 align-middle",src:o.iconUrl},null,8,Se)):C("",!0),S(" "+d(o.keyword),1)],8,Ce))),128))])])):C("",!0),t("section",null,[t("div",Pe,[t("span",null,d(r.$t("mall.popular searches")),1)]),t("div",Ie,[(l(!0),i(D,null,M(a.value,o=>(l(),i("div",{key:o.id,onClick:s=>U(o.keyword),class:"px-4 py-0.5 text-xs line-clamp-1 max-w-full leading-normal rounded-xl bg-black-100 text-black-400"},[o.iconUrl?(l(),i("img",{key:0,class:"inline-block w-auto h-4 align-middle",src:o.iconUrl},null,8,Ue)):C("",!0),S(" "+d(o.keyword),1)],8,Le))),128))])]),y(ve,{loading:u(P),show:u(N),onClose:k[1]||(k[1]=o=>u(I)(!1)),onComfirm:m},null,8,["loading","show"])]))}}),qe=V(Re,[["__scopeId","data-v-ac3e7d84"]]),ze=n=>(F("data-v-a4aba5ce"),n=n(),G(),n),Ne={style:{"background-color":"white"},class:"relative z-50 h-full min-h-screen overflow-y-hidden parent-view mall-header-bg"},Be={class:"sticky top-0 z-50 text-sm font-normal mall-header-bg"},Ke={class:"flex relative justify-center items-center h-[44px] px-2.5"},Ve={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},je={class:"font-semibold"},Ee={class:"px-2.5"},He={key:0,class:"bg-gradient-7 text-white px-2.5 py-0.5 text-xxs leading-normal rounded-xl"},De=ze(()=>t("div",{class:"h-[16px]"},null,-1)),Me=z({name:"Search"});function Ae(n){const h=X(),f=Y(),a=_(null),c=Z(re),v=()=>{m.value=!1},e=ee({keyword:"",classId:null});se(()=>e.keyword,()=>{e.keyword.length<=0&&(m.value=!1)});const P=()=>{e.classId=null,p.value=null,h.replace({path:"/search",query:{classId:null,className:null}}),a.value.setParam(e)},x=_(null),m=_(!1),N=s=>{console.log(s.charCode,"value"),(s.code==="Enter"||+s.charCode==13)&&(e.keyword&&k(e.keyword)&&o(w.value[e.keyword]),m.value=!0,a.value.setParam(e),x.value.blur())},I=()=>{var s;((s=e.keyword)==null?void 0:s.length)<=0||(k(e.keyword)&&o(w.value[e.keyword]),m.value=!0,a.value.setParam(e))},U=s=>{if(k(s)){o(w.value[s]);return}e.keyword=s,m.value=!0,a.value.setParam(e)},p=_(),R=_([]),w=_({}),r=async()=>{const s=await J({page:1,size:99,type:100});if(s.success){R.value=s.data||[];for(const L of R.value)w.value[L.keyword]=L}},k=s=>w.value[s]&&w.value[s].targetUrl,o=s=>{s.targetUrl&&s.targetUrl.startsWith("http")?window.open(s.targetUrl,"_self"):s.targetUrl?h.push(s.linkUrl):a.value.setParam(e)};return A(()=>{e.classId=f.query.classId||null,e.keyword=f.query.keyword||"",f.query.className==="refresh"?(p.value=null,e.keyword=""):(p.value=f.query.className||null,e.keyword=f.query.keyword||""),(e.classId||e.keyword)&&(m.value=!0,a.value.setParam(e)),r()}),(s,L)=>{const B=g("van-icon"),O=g("van-field"),T=g("router-view");return l(),i("div",Ne,[t("section",Be,[t("section",Ke,[t("div",Ve,[y(ce,null,{default:$(()=>[t("span",null,d(s.$t("common.return")),1)]),_:1})]),t("div",je,d(s.$t("common.search")),1)]),t("section",Ee,[y(O,{ref:(b,K)=>{K.searchRef=b,x.value=b},"model-value":u(e).keyword,"onUpdate:model-value":L[0]||(L[0]=b=>u(e).keyword=b),clearable:"",class:"flex-1 rounded-3xl flex items-center h-[30px] text-black-300",onKeypress:N,placeholder:p.value?"":s.$t("mall.Enter search keywords"),onClear:v,enterkeyhint:"search"},{"left-icon":$(()=>[p.value?(l(),i("view",{key:0,onClick:P,class:"flex items-center border border-solid rounded-xl px-2 py-0.5 text-xs text-primary"},[S(d(p.value)+" ",1),y(B,{class:"ml-0.5",name:"cross",size:"10"})])):u(e).keyword?C("",!0):(l(),q(B,{key:1,name:"search",size:"18"}))]),"right-icon":$(()=>[t("div",{onClick:I},[u(e).keyword?(l(),q(B,{key:1,name:"search",size:"18"})):(l(),i("div",He,d(s.$t("common.search")),1))])]),_:1},8,["model-value","placeholder"])]),De]),t("section",null,[(!u(e).keyword||!m.value)&&!p.value?(l(),q(qe,{key:0,onSetKeyword:U})):C("",!0),te(y(u(c),{isSearchPage:!0,class:"bg-[#f8f8f8] px-2.5",ref:(b,K)=>{K.listRef=b,a.value=b},mode:"div"},null,512),[[oe,u(e).keyword&&m.value||p.value]])]),y(T,{class:"child-view"})])}}const Fe=z({...Me,setup:Ae}),ds=V(Fe,[["__scopeId","data-v-a4aba5ce"]]);export{ds as default};
