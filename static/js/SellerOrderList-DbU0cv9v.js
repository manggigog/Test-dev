import{_ as Ne,y as _e,l as gt,x as Se,w as Ue,bP as wt,E as O,F as u,G as r,H as o,a2 as k,a3 as Mt,Q as n,P as m,a4 as xe,I as le,J as ke,R as Ce,X as et,K as B,O as T,N as I,a0 as z,T as A,Y as bt,Z as $t,r as y,be as je,z as qe,bf as qt,bg as ht,D as kt,bc as me,bd as fe,bQ as Kt,t as zt,o as Ut,B as Re,$ as Yt,n as Wt,a1 as Jt,bR as Qt}from"./vendor-BUT0HZ5j.js";import{_ as Ct}from"./avatarRing-DpEnkbQ2.js";import{_ as Zt}from"./address-BEqE8lWA.js";import{G as Xt}from"./GoodsItem-1-XrUNtL.js";import{_ as es}from"./CountdownLabel-D3fsbYlX.js";import{e as Ke,o as nt,b as tt,l as ee,u as At,R as ts,C as ss,br as Tt,a3 as os,d as xt}from"./index-BvL8wS8a.js";import{u as It,f as as}from"./useOrderStatus-BSCfQVBG.js";import{c as st,n as ot,l as ze,v as ns,w as rs,x as ls,y as is,z as ds,a as cs}from"./order-5h45IqlB.js";import{P as Ge}from"./flashSale-DDyqLyYN.js";import{g as Me}from"./orderTime-Dlnznyg5.js";import{h as at,e as us}from"./excel-DiIE5TbC.js";import{S as ms,M as fs}from"./MerchantRefund-CuX7L9v9.js";import{_ as St}from"./selected-icon-DEJAhYK1.js";import{_ as ps}from"./credit-Chkxk9-q.js";import{_ as vs}from"./MCOIN-BcbOHmhy.js";import{B as hs}from"./BackIcon-biFt6cm7.js";import{C as xs}from"./ChangeRegion-n_YpredT.js";import ys from"./SellerOneSaleOrder-Xk5Gl6aA.js";import"./mcoin-logo-1-BPG653EL.js";import"./useShipTemplate-SAWfRcmZ.js";import"./enums-DlE-aiss.js";import"./copy-w-7FY5xbhR.js";import"./UnfreezePop-DzxfaZy1.js";import"./ApproveButton-ClKDT0QG.js";import"./refund-DnaEknLH.js";import"./useRefundStatus-DsYoZX36.js";import"./filter-C_V9W5ek.js";import"./category-CM33gUQN.js";import"./ChangeRegionPop-BK0Y1zMg.js";import"./DeliveredItem-Co4p5YGM.js";import"./GoodsItem-BGpXBRz9.js";import"./luckyShopContract-Bj1eEjXA.js";const gs="/Test-dev/static/images/mark-Dmikp-39.svg",Ye=t=>(bt("data-v-86317d8e"),t=t(),$t(),t),ws={class:"gap-2 flex-center-bw"},bs=Ye(()=>o("div",{class:"w-8 h-8"},[o("img",{src:Ct,class:"w-full h-full rounded-md",alt:"",fit:"cover"})],-1)),$s={class:"flex flex-col justify-center flex-1 h-8 text-default"},ks={class:"text-sm font-semibold flex flex-row justify-start items-center align-middle"},Cs={key:0,class:"flex flex-row justify-start items-center"},As={class:"text-primary ml-auto text-sm leading-[20px] align-middle"},Ts={key:0},Is={key:1},Ss={key:2},_s={class:"text-xs leading-[18px] opacity-60"},Rs={key:0},Ns={key:1},Ls={key:2},Os=Ye(()=>o("span",null,"...",-1)),Bs=[Os],Ps={class:"mt-4 pt-4 break-all flex flex-row justify-start items-start border-t-[1px] border-[#e0e0e0] border-solid"},Es=Ye(()=>o("div",{class:"min-w-[20px]"},[o("img",{src:Zt,class:"inline-block w-[20px]"})],-1)),Ds={class:"ml-1"},Fs={key:0,class:"text-sm text-[#585654] font-semibold"},Vs={key:1,class:"mt-1 text-sm text-[#a6a6a6] font-normal"},Hs={key:1,class:"mt-2 break-all flex flex-row justify-start items-start"},js=Ye(()=>o("div",{class:"min-w-[20px]"},[o("img",{src:gs,class:"inline-block w-[20px]"})],-1)),Gs={class:"ml-1"},Ms={class:"text-sm text-[#a6a6a6] font-normal line-clamp-2"},qs={key:2,class:"pt-2.5 text-xs text-[#B9B9B9]"},Ks={class:"items-center inline"},zs={class:"block"},Us={class:"colon"},Ys={class:"block"},Ws={class:"colon"},Js={class:"block"},Qs={class:"colon"},Zs={class:"block"},Xs={class:"colon"},eo={key:1,class:"text-right"},to={key:3,class:"flex justify-end mt-3 gap-2"},so=_e({props:{order:null,isService:{type:Boolean},nowTime:null,tab:null},emits:["open"],setup(t,{emit:V}){const v=t,{accountStore:e}=Ke(),{clerkStore:f}=Ke(),C=gt(),S=Se(()=>(v.order.orderGoods||[]).some(D=>D.buyFlag)),_=Se(()=>{var d,$;return(($=(d=v.order)==null?void 0:d.orderLabelList)==null?void 0:$.filter(D=>D==null?void 0:D.id))||[]}),P=It(v.order.refundStatus,v.order.payType),{t:b}=Ue(),pe=d=>{v.isService||C.push(d)},h=()=>{v.isService||C.push(`/sellerOrderDetail?id=${v.order.id}`)},g=()=>{if(e.isOnlyView)return A(b("order.Requires merchant account operation"));C.push(`/sellerDelivery?id=${v.order.id}`)},U=()=>{if(e.isOnlyView)return A(b("order.Requires merchant account operation"));C.push({name:"SellerOrderDetail",query:{id:v.order.id},params:{quick:"quackChange"}})},oe=()=>{location.reload()},E=wt("openBatchReceiptPop",null),{merchantConfirm:ae}=nt(),R=async d=>{if(e.isOnlyView)return A(b("order.Requires merchant account operation"));if(f.isClerk&&!f.clerkAuth)return A(b("order.Requires merchant account operation"));if(E){E(d);return}d.loading=!0;try{const D=(await st({orderIds:d.id})).data.ordIds,W=await ae(D);if(!W.success)return;if(d.payType!==Ge.STORE_CARD){if(!(await ot({ordIds:D,hash:W.result.hash})).success)return;d.merchantsConfirm=1,A.success(b("order.confirmSuccess")),C.replace({path:"/sellerOrderList",query:{active:3,type:1}})}}finally{d.loading=!1}},N=d=>{if(e.isOnlyView)return A(b("order.Requires merchant account operation"));V("open",d)},Y=d=>{if(e.isOnlyView)return A(b("order.Requires merchant account operation"));const $=d.userAddress.address;tt(d.userAddress.address,"...",5,5),C.push(`/sellerOrderList-orderHistory?address=${$}&source=merchants`)};return(d,$)=>{var q,p;const D=O("van-count-down"),W=O("VanButton");return r(),u("div",{class:"px-3 mt-3 bg-white rounded-xl py-3",onClick:h},[o("div",ws,[bs,o("div",$s,[o("div",ks,[t.order.userAddress&&t.order.userAddress.address?(r(),u("div",Cs,[o("p",null,n(m(tt)(t.order.userAddress.address,"...",5,5)),1)])):k("",!0),o("div",As,[t.order.status==-1?(r(),u("span",Ts,n(d.$t("order.canceled")),1)):t.order.status===0&&t.order.hash?(r(),u("span",Is,n(d.$t("order.wait block chain")),1)):(r(),u("span",Ss,n(m(P)[t.order.status+""]),1))])]),o("div",_s,[t.order.status==4?(r(),u("span",Rs,n(m(ee)(t.order.finishTime))+" "+n(d.$t("common.finish")),1)):t.order.status==2?(r(),u("span",Ns,n(m(ee)(t.order.expressTime))+" "+n(d.$t("order.Ship")),1)):(r(),u("span",Ls,n(m(ee)(t.order.createTime))+" "+n(d.$t("order.buied")),1))])])]),m(_).length?(r(),u("ul",{key:0,class:"w-full flex justify-start items-center mt-[16px] text-white overflow-x-scroll",onClick:$[1]||($[1]=xe(i=>N(t.order),["stop"]))},[m(_).length>0?(r(),u(le,{key:0},[(r(!0),u(le,null,ke(m(_).slice(0,5),i=>(r(),u("li",{style:et({backgroundColor:m(at)(i==null?void 0:i.colorHex,.12),color:i==null?void 0:i.colorHex}),class:Ce(["text-xxs h-[22px] rounded-[4px] px-[8px] py-1 mr-1 flex justify-center items-center font-normal whitespace-nowrap",{"w-[22px]":!(i!=null&&i.content)}]),key:i==null?void 0:i.id},n(i==null?void 0:i.content),7))),128)),m(_).length>5?(r(),u("li",{key:0,class:"bg-[#f5f5f5] text-default text-xxs w-[25px] h-[22px] rounded-[4px] py-1 mr-1 flex justify-center items-center",onClick:$[0]||($[0]=xe(i=>N(t.order),["stop"]))},Bs)):k("",!0)],64)):k("",!0)])):k("",!0),(r(!0),u(le,null,ke(t.order.orderGoods,i=>(r(),B(Xt,{class:"goods-item",creditFlag:t.order.creditFlag,payType:t.order.payType,key:i.goodsName,goods:i,storeCard:t.order.fmStoredCard,refundStatus:t.order.refundStatus,onHandleTo:pe,tab:v.tab},null,8,["creditFlag","payType","goods","storeCard","refundStatus","tab"]))),128)),o("div",Ps,[Es,o("div",Ds,[t.order.userAddress?(r(),u("div",Fs,n(t.order.userAddress.provinceName??"")+n(t.order.userAddress.cityName??"")+n(t.order.userAddress.countyName??"")+n(t.order.userAddress.detailInfo??""),1)):k("",!0),t.order.userAddress?(r(),u("div",Vs,n(t.order.userAddress.userName)+" "+n(t.order.userAddress.telNumber),1)):k("",!0)])]),(q=t.order.userAddress)!=null&&q.postscript?(r(),u("div",Hs,[js,o("div",Gs,[o("div",Ms,n(((p=t.order.userAddress)==null?void 0:p.postscript)||d.$t("order.noRemark")),1)])])):k("",!0),t.order.status===2?(r(),u("div",qs,[m(Me)(t.order.expressTime,t.order.confirmLimit,t.nowTime)>0?(r(),u(le,{key:0},[o("div",null,n(d.$t("order.observeTip")),1),o("div",Ks,[T(D,{class:"order-time",time:m(Me)(t.order.expressTime,t.order.confirmLimit,t.nowTime)},{default:I(i=>[o("span",zs,n(i.days),1),o("span",Us,n(d.$t("common.day")),1),o("span",Ys,n(i.hours),1),o("span",Ws,n(d.$t("common.hours")),1),o("span",Js,n(i.minutes),1),o("span",Qs,n(d.$t("common.minutes")),1),o("span",Zs,n(i.seconds),1),o("span",Xs,n(d.$t("common.seconds")),1)]),_:1},8,["time"]),o("span",null,n(d.$t("order.sellConfirmTip")),1)])],64)):t.order.payType===m(Ge).WITHDRAW_POINTS&&!t.order.merchantsConfirm?(r(),u("div",eo,n(d.$t("order.sellConfirm")),1)):k("",!0)])):k("",!0),t.isService?k("",!0):(r(),u("div",to,[!m(e).isOnlyView&&m(S)?(r(),B(W,{key:0,class:"bg-[#f5f5f5] rounded-md h-[32px] px-3 text-[#585654] text-sm font-normal",onClick:$[2]||($[2]=xe(i=>Y(t.order),["stop"]))},{default:I(()=>[z(n(d.$t("order.orderHistoryBuy")),1)]),_:1})):k("",!0),m(e).isOnlyView?k("",!0):(r(),B(W,{key:1,class:"bg-[#f5f5f5] rounded-md h-[32px] px-3 text-[#585654] text-sm font-normal",onClick:$[3]||($[3]=xe(i=>N(t.order),["stop"]))},{default:I(()=>[z(n(d.$t("order.orderAddTag")),1)]),_:1})),!m(e).isOnlyView&&t.order.status===1?(r(),B(W,{key:2,class:"bg-btnOrBg rounded-md h-[32px] px-3 text-default text-sm font-normal",onClick:xe(g,["stop"])},{default:I(()=>[z(n(d.$t("order.Ship")),1)]),_:1},8,["onClick"])):k("",!0),!m(e).isOnlyView&&t.order.status===0&&!t.order.hash?(r(),B(W,{key:3,class:"bg-btnOrBg rounded-md h-[32px] px-3 text-default text-sm font-normal",onClick:xe(U,["stop"])},{default:I(()=>[z(n(d.$t("order.modifyPrice")),1),T(es,{class:"inline-block ml-1 whitespace-nowrap",startTime:t.order.createTime,duration:15,durationType:"minutes",showZero:!1,onTimeDone:oe},null,8,["startTime"])]),_:1},8,["onClick"])):k("",!0),!m(e).isOnlyView&&t.order.status===2&&t.order.payType!==m(Ge).STORE_CARD&&!t.order.merchantsConfirm?(r(),B(W,{key:4,class:Ce(["bg-btnOrBg rounded-md min-w-[80px] h-[32px] px-3 text-default text-sm font-semibold",{"opacity-50":!!m(e).isOnlyView}]),disabled:m(Me)(t.order.expressTime,t.order.confirmLimit,t.nowTime)>0,loading:t.order.loading,onClick:$[4]||($[4]=xe(i=>R(t.order),["stop"]))},{default:I(()=>[z(n(d.$t("order.confirmGeted")),1)]),_:1},8,["class","disabled","loading"])):k("",!0)])),Mt(d.$slots,"default",{},void 0,!0)])}}}),oo=Ne(so,[["__scopeId","data-v-86317d8e"]]),ao={class:"bg-[#f2f0ef]"},no={class:"px-[20px] pt-[18px] pb-[15px] flex justify-between bg-white z-40 text-[14px] items-center absolute top-0 left-0 right-0"},ro={class:"text-[#222221] text-[16px]"},lo={class:"tagForm"},io={class:"text-[#222221] mb-[10px]"},co={class:"mt-[30px]"},uo={key:0,class:"text-center mt-[150px]"},mo={class:"h-[96px] p-[16px] flex flex-col justify-center items-center fixed bottom-0 left-0 right-0 bg-white"},fo={class:"mt-[8px] text-[#5D5A56] text-[12px] leading-none"},po={class:"p-[16px] flex justify-center fixed bottom-0 left-0 right-0 bg-white"},vo=_e({props:{value:null},setup(t,{expose:V}){const{value:v}=t,{t:e}=Ue(),f=y(null),{getCurrentStoreId:C}=At(),{getMerchantDhKey:S,decryptAddressKey:_,decryptKey:P,cryptoAESWithSearch:b}=ts(),[pe,h]=je(!1),g=y(0);qe(()=>v,a=>{g.value=a},{immediate:!0});const U=qt({refundTabList:[{id:1,name:e("order.applying")},{id:2,name:e("order.refund block confirmation")},{id:3,name:e("order.refund completed")},{id:4,name:e("order.refund rejection")},{id:5,name:e("order.cancellation refund")},{id:10,name:e("order.platform intervention")},{id:11,name:e("order.platforms step in to support buyers")},{id:12,name:e("order.platform intervention to support sellers")},{id:13,name:e("order.freeze thawed")},{id:14,name:e("order.user forced liquidation")},{id:20,name:e("order.Long time no delivery")},{id:30,name:e("refund.refund success tips")}],statusTabList:[{id:0,name:e("order.waitPay")},{id:1,name:e("order.wait")},{id:2,name:e("order.already")},{id:3,name:e("order.fail")},{id:4,name:e("order.trade success")},{id:5,name:e("order.trade close")},{id:6,name:e("order.trade close")},{id:7,name:e("order.platform intervention")},{id:8,name:e("order.canceled")},{id:-1,name:e("order.canceled")}]}),oe=Se(()=>[{id:0,name:e("order.waitPay")},{id:1,name:e("order.wait")},{id:2,name:e("order.already")},{id:4,name:e("order.completed")},{id:-1,name:e("order.all")}]),E=as(),ae=a=>a.fmRefundReason?a.fmRefundReason[E]:"",R=y(""),N=y([]),Y=y(!1),d=y(!1),$=y(1),D=y(30),W=y(0),q=y({}),p=y(!1),i=y(0),ne=async()=>{$.value+=1,await ge(q.value)},K=y([]),ye=async a=>{d.value=!1,N.value=[],$.value=1,await ge(a)},Ae=()=>{if(R.value&&R.value.length<2)return A(e("common.Please enter at least two keywords"));ye(q.value)},ge=a=>new Promise(async c=>{var ue,G,se,Te,be,x,L,X,s,He,Pe,Ee,De,M,Fe,ut,mt,ft,pt;Y.value&&c(),q.value=Object.keys(a).length>0?a:q.value;let j=null;p.value&&(j=Math.ceil((i.value+1)/D.value)),Y.value=!0;let he=g.value,re=null;R.value&&(re=await b(R.value));const Z={page:j||$.value,size:D.value,status:oe.value[g.value].id,type:1,keyword:re,keywordPlain:R.value,storeId:(ue=await C())==null?void 0:ue.id,...a};(a.waitBuyerReceive||a.waitSellerReceive)&&(console.log("有过滤收货状态"),Z.status=2);const F=await ze(Z);if(!F.success){d.value=!0;return}if(!F.data||!F.total){d.value=!0,Y.value=!1;return}if(he!==g.value)return;(F==null?void 0:F.total)===0&&(N.value=[]),W.value=F.total;const te=[];for(let Ve=0;Ve<F.data.length;Ve++){let Ie="";const l=F.data[Ve];if(l.userAddress&&(l.userAddress.postscript=l.postscript),l.userAddress&&((G=l.userAddress)!=null&&G.encryptFlag)){const $e=await S(l.address,l.submitUserPubKey);$e&&(l.userAddress=_(l.userAddress,$e),(se=l.userAddress)!=null&&se.success&&!l.merchantEns&&(Ie+=((Te=l.userAddress)==null?void 0:Te.userName)+((be=l.userAddress)==null?void 0:be.telNumber)+(((x=l.userAddress)==null?void 0:x.postalCode)??"")+((L=l.userAddress)==null?void 0:L.provinceName)+((X=l.userAddress)==null?void 0:X.cityName)+((s=l.userAddress)==null?void 0:s.countyName)+((He=l.userAddress)==null?void 0:He.detailInfo)+((Pe=l.userAddress)==null?void 0:Pe.postscript)))}else l.merchantEns||(Ie+=((Ee=l.userAddress)==null?void 0:Ee.userName)+((De=l.userAddress)==null?void 0:De.telNumber)+(((M=l.userAddress)==null?void 0:M.postalCode)??"")+((Fe=l.userAddress)==null?void 0:Fe.provinceName)+((ut=l.userAddress)==null?void 0:ut.cityName)+((mt=l.userAddress)==null?void 0:mt.countyName)+((ft=l.userAddress)==null?void 0:ft.detailInfo)+((pt=l.userAddress)==null?void 0:pt.postscript));if(l.shippingHash){const $e=await S(l.address,l.shippingUserPubKey);if($e){const vt=P(l.expressNo,$e);vt.hash===l.shippingHash&&(l.expressNo=vt.decrypt,l.expressCompany=P(l.expressCompany,$e).decrypt,l.merchantEns||(Ie+=(l==null?void 0:l.expressNo)+(l==null?void 0:l.expressCompany)))}}else l.merchantEns||(Ie+=(l==null?void 0:l.expressNo)+(l==null?void 0:l.expressCompany));if(l.merchantEns||(Ie+=(l==null?void 0:l.hash)+(l==null?void 0:l.address)),Ie)try{te.push({id:l.id,merchantEns:await b(Ie)})}catch($e){console.log($e)}}const w=te.filter(Ve=>Ve.merchantEns);w.length>0&&ns({enInfoList:w}),K.value=F.data,p.value?(N.value.splice((j-1)*D.value,D.value,...K.value),p.value=!1):N.value=$.value===1?K.value:N.value.concat(K.value),N.value.length>=W.value&&(d.value=!0),Y.value=!1,c()}),Le=async a=>{f.value.handleReset(!1),Tt.replace({path:"sellerOrderList",query:{type:1,active:a}}),g.value=a,Y.value=!1,Vt()},_t=async a=>{var L,X;const c=navigator.userAgent.toLowerCase(),j=/mobile|android|iphone|ipad|phone/i.test(c),he=/tablet|ipad/i.test(c),re=/webview|wv/i.test(c),Z=/fbav|instagram|line|twitter|whatsapp/i.test(c),F=/metamask/i.test(c),te=/tokenpocket/i.test(c),w=(window==null?void 0:window.$onekey)||!1;if(zt.isConnected()){h(!0);return}if(w){h(!0);return}if((j||he)&&(re||Z||F||te||w)&&!window.chrome&&!window.safari){h(!0);return}let ue=null;R.value&&(ue=await b(R.value));const G={page:1,size:99999,status:oe.value[g.value].id,type:1,keyword:ue,keywordPlain:R.value,storeId:(L=await C())==null?void 0:L.id,...a};(a.waitBuyerReceive||a.waitSellerReceive)&&(console.log("导出-有过滤收货状态"),G.status=2),A.loading({duration:0,message:e("common.loading")});const se=await ze(G);if(!se.success||!se.data||se.data.length===0){A.clear(),A(e("common.No data download"));return}const Te=se.data.map(s=>new Promise(async He=>{var Pe,Ee,De;if(s!=null&&s.userAddress&&(s.userAddress.postscript=s.postscript),s!=null&&s.userAddress&&((Pe=s==null?void 0:s.userAddress)!=null&&Pe.encryptFlag)){const M=await S(s.address,s==null?void 0:s.submitUserPubKey);M&&(s.userAddress=_(s.userAddress,M))}if(s!=null&&s.shippingHash){const M=await S(s.address,s==null?void 0:s.shippingUserPubKey);if(M){const Fe=P(s.expressNo,M);Fe.hash===s.shippingHash&&(s.expressNo=Fe.decrypt,s.expressCompany=P(s.expressCompany,M).decrypt)}}He([{text:s.id},{text:s.address},{text:s.hash||""},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"goodsName"):""},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"goodsId"):""},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"number"):0},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"price"):0},{text:((Ee=U.statusTabList.find(M=>M.id==s.status))==null?void 0:Ee.name)||""},{text:s.totalAmountOriginal||0},{text:s.merchantAdjustAmount||0},{text:s.activityReduceAmount||0},{text:s.voucherAmount||0},{text:Rt(s)},{text:s.orderGoods&&s.orderGoods.length?Oe(s.orderGoods,"discountRatio","%"):"0%"},{text:s.createTime?ee(s.createTime):""},{text:s.chainCreateTime?ee(s.chainCreateTime):""},{text:s.expressTime?ee(s.expressTime):""},{text:s.finishTime?ee(s.finishTime):""},{text:s.userAddress.postscript||""},{text:`${s.userAddress.provinceName??""}${s.userAddress.cityName??""}${s.userAddress.countyName??""}${s.userAddress.detailInfo??""} ${s.userAddress.userName??""} ${s.userAddress.telNumber??""}`},{text:s.creditFlag?e("common.yes"):e("common.no")},{text:s.merchantsConfirm?e("common.yes"):e("common.no")},{text:s.orderLabelList.map(M=>M.content).join(",")},{text:s.expressCompany||""},{text:s.expressNo||""},{text:ae(s)},{text:((De=U.refundTabList.find(M=>M.id==s.refundStatus))==null?void 0:De.name)||""},{text:s.refundTime?ee(s.refundTime):""},{text:s.refundSuccessTime?ee(s.refundSuccessTime):""},{text:s.refundCancelTime?ee(s.refundCancelTime):""}])})),be=await Promise.all(Te);if(!be||be.length===0){A.clear(),A(e("common.No data download"));return}const x=[{text:e("order.export.orderId")},{text:e("order.export.buyerAddress")},{text:e("order.export.transactionHash")},{text:e("order.export.goodsName")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.export.goodsId")+"("+e("order.export.goodsId-tips")+")"},{text:e("order.export.goodsNumber")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.goodsPrice")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.orderStatus")},{text:e("order.export.goodsPrice total")},{text:e("order.merchant modify price total")},{text:e("order.export.activityReduceAmount total")},{text:e("voucher.voucher_deduction total")},{text:e("order.export.actualAmount total")},{text:e("common.ratio")},{text:e("order.createTime")},{text:e("order.export.paymentTime")},{text:e("order.Shipping time")},{text:e("order.Complete time")},{text:e("order.remark")},{text:e("order.receive address")},{text:e("order.export.isCreditReceive")},{text:e("order.export.merchantsConfirm")},{text:e("order.export.orderLabelList")},{text:e("order.deliveryCompany")},{text:e("order.deliveryId")},{text:e("refund.RefundReason")},{text:e("refund.refundStatus")},{text:e("refund.refundTime")},{text:e("refund.refundSuccessTime")},{text:e("refund.refundCancelTime")}];try{const s=((X=await C())==null?void 0:X.storeName)+"_"+Ut().format("YYYY-MM-DD HH:mm:ss");us([x,...be],{excelName:s,worksheet:"sheet"}),A.clear()}catch{A.clear()}},rt=()=>{h(!1)},Rt=a=>{const c=new Re(a.totalAmountOriginal).plus(new Re(a.merchantAdjustAmount||0)).minus(new Re(a.activityReduceAmount||0)).minus(new Re(a.voucherAmount||0)).toNumber();return Nt(c)},Nt=a=>Number.isInteger(a)?a.toString():a.toFixed(4).replace(/\.?0+$/,""),Oe=(a,c,j)=>a.map(re=>{let Z=re[c];return j&&(Z=Z+j),Z}).join(","),Be=y(!1),ve=y(!1),H=y(!1),ie=y(null),J=y([]),we=y(""),We=y([]),de=y([]),ce=y(null),Je=y(null),Q=y({content:"",colorHex:"",id:null,shopId:null}),lt=y(null),it=y([{id:null,content:"",colorHex:"#D4380D"},{id:null,content:"",colorHex:"#E58312"},{id:null,content:"",colorHex:"#DEAD0E"},{id:null,content:"",colorHex:"#389E0D"},{id:null,content:"",colorHex:"#0958D9"},{id:null,content:"",colorHex:"#531DAB"}]),Lt=(a,c)=>{i.value=c,Be.value=!0,lt.value=a.id,Je.value=a.stores.id,a.orderLabelList&&(J.value=a.orderLabelList.map(j=>j.id)),Ze()},Ot=a=>{H.value=!0,a.id&&(ce.value=a.id,ie.value=a.content,Q.value.id=a.id,Q.value.colorHex=a.colorHex,we.value=a.colorHex,We.value=J.value)},Bt=()=>{H.value=!0,ce.value=null,ie.value=null,Q.value.id=null,Q.value.colorHex=null,we.value="",We.value=J.value},Pt=a=>{J.value&&J.value.length>=5&&J.value.findIndex(c=>c===de.value[a].id)===-1&&A(e("common.tag select num valid",{num:5}))},Qe=()=>{H.value=!1,J.value=We.value,ce.value=null,de.value.length=0,ie.value=null,we.value="",Ze()},dt=()=>{Be.value=!1,ce.value=null,J.value=[],f.value.onLoadTagList()},Ze=()=>{de.value=[],rs({page:1,size:300,shopId:Je.value}).then(a=>{a==null||a.data.forEach(c=>{de.value.push({id:c.id,content:c.content,colorHex:c.colorHex})})})},Et=()=>{var a;if(!ve.value){if(((a=we.value)==null?void 0:a.length)===0){A.fail(e("order.Please select a color"));return}else Q.value.colorHex=we.value,Q.value.id=ce.value,Q.value.content=ie.value,Q.value.shopId=Je.value;Q.value.content&&(Q.value.content=Q.value.content.trim()),ce.value||delete Q.value.id,ve.value=!0,ls(Q.value).then(c=>{c.msg==="SUCCESS"&&(H.value=!1,de.value=[],we.value="",ie.value=null,Ze(),p.value=!0,ge(q.value),A(e("order.Save success")))}).finally(()=>{ve.value=!1})}},Dt=()=>{ve.value||(ve.value=!0,is({id:ce.value}).then(a=>{a.msg==="SUCCESS"?(A(e("order.Delete success")),p.value=!0,ge(q.value),Qe()):A(e("order.Delete failed"))}).finally(()=>{ve.value=!1}))},Ft=async()=>{ve.value||(J.value=J.value.filter(a=>!!de.value.find(c=>a==c.id)),ve.value=!0,await ds({orderId:lt.value,orderLabelIds:J.value.join(",")}).then(a=>{if((a==null?void 0:a.msg)==="SUCCESS")Be.value=!1,H.value=!1,ie.value="",A(e("order.Save success")),p.value=!0,ge(q.value);else{A(e("order.Save failed"));return}}).finally(()=>{ve.value=!1}))},Vt=()=>{d.value=!1,$.value=1,N.value=[],ge({})},Xe=y(new Date().getTime()/1e3),ct=async()=>{Xe.value=await os()};ht(()=>{Xe.value+=1},1e3),ht(()=>{ct()},6e4);const Ht=y(null),jt=async()=>{var c,j,he,re,Z,F,te;const a=sessionStorage.getItem("modifiedOrderId");if(a)try{const w=await cs({id:a});if(w.success&&w.data){if((c=w.data)!=null&&c.userAddress&&(w.data.userAddress.postscript=w.data.postscript),(j=w.data)!=null&&j.userAddress&&((re=(he=w.data)==null?void 0:he.userAddress)!=null&&re.encryptFlag)){const G=await S(w.data.address,(Z=w.data)==null?void 0:Z.submitUserPubKey);G&&(w.data.userAddress=_(w.data.userAddress,G))}if((F=w.data)!=null&&F.shippingHash){const G=await S(w.data.address,(te=w.data)==null?void 0:te.shippingUserPubKey);if(G){const se=P(w.data.expressNo,G);se.hash===w.data.shippingHash&&(w.data.expressNo=se.decrypt,w.data.expressCompany=P(w.data.expressCompany,G).decrypt)}}const ue=N.value.findIndex(G=>G.id===parseInt(a));ue!==-1?Object.assign(N.value[ue],w.data):console.log("未找到要更新的订单，ID:",a)}}catch{}finally{sessionStorage.removeItem("modifiedOrderId")}},Gt=async()=>{N.value.length>0&&await jt()};return kt(async()=>{var a;ct(),ge({}),Ht.value=(a=await C())==null?void 0:a.merchant}),V({handleChangeTab:Le,active:g,updateModifiedOrders:Gt}),(a,c)=>{const j=O("Empty"),he=O("VanList"),re=O("VanTab"),Z=O("VanTabs"),F=O("van-field"),te=O("van-icon"),w=O("van-radio"),ue=O("van-radio-group"),G=O("van-checkbox"),se=O("van-checkbox-group"),Te=O("van-button"),be=O("van-action-sheet");return r(),u(le,null,[T(Z,{active:g.value,"onUpdate:active":c[2]||(c[2]=x=>g.value=x),onChange:Le,background:"#f2f0ef",sticky:"","offset-top":"44"},{"nav-bottom":I(()=>[o("div",ao,[T(ms,{modelValue:R.value,"onUpdate:modelValue":c[0]||(c[0]=x=>R.value=x),onOnSubmit:Ae,onGetList:ye,noType:!0,ref:(x,L)=>{L.searchBox=x,f.value=x},active:g.value,onOnExport:_t},null,8,["modelValue","active"])])]),default:I(()=>[(r(!0),u(le,null,ke(m(oe),x=>(r(),B(re,{title:x.name,key:x.id},{default:I(()=>[N.value.length===0&&!Y.value?(r(),B(j,{key:0,name:"没有订单",class:"py-6"})):k("",!0),T(he,{loading:Y.value,"onUpdate:loading":c[1]||(c[1]=L=>Y.value=L),finished:d.value,"finished-text":a.$t("common.noMore"),"loading-text":a.$t("common.loading"),onLoad:ne},{default:I(()=>[(r(!0),u(le,null,ke(N.value,(L,X)=>(r(),B(oo,{key:L.id,order:L,onOpen:s=>Lt(s,X),nowTime:Xe.value,tab:x},null,8,["order","onOpen","nowTime","tab"]))),128))]),_:2},1032,["loading","finished","finished-text","loading-text"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"]),T(be,{show:Be.value,"onUpdate:show":c[8]||(c[8]=x=>Be.value=x),closeable:!1,class:"h-[70vh] font-Puhui",onCancel:Qe,onClose:dt},{default:I(()=>[o("div",no,[me(o("div",{class:"text-[#5D5A56] w-[60px]",onClick:Qe},n(a.$t("common.closed")),513),[[fe,H.value]]),me(o("div",{class:"text-[#5D5A56] w-[30px]",onClick:dt},n(a.$t("common.closed")),513),[[fe,!H.value]]),o("div",ro,n(ce.value?a.$t("common.editTag"):a.$t("common.addTag")),1),me(o("div",{class:"text-[#A45E00] w-[30px]",onClick:Bt},n(a.$t("piggy.add")),513),[[fe,!H.value]]),me(o("div",{class:"text-[#A45E00] w-[30px]",onClick:Et},n(a.$t("common.save")),513),[[fe,H.value]])]),o("div",{class:Ce(["mt-[53px] px-[20px]",H.value&&ce.value?"pb-[96px]":"pb-[72px]"])},[T(Kt,{name:"van-slide-up"},{default:I(()=>[me(o("div",lo,[o("div",io,n(a.$t("common.NameOptional")),1),T(F,{modelValue:ie.value,"onUpdate:modelValue":c[3]||(c[3]=x=>ie.value=x),maxlength:"5",placeholder:a.$t("common.pleaseEnter")},null,8,["modelValue","placeholder"]),o("div",co,n(a.$t("common.color")),1)],512),[[fe,H.value]])]),_:1}),me(T(ue,{modelValue:we.value,"onUpdate:modelValue":c[4]||(c[4]=x=>we.value=x),max:1},{default:I(()=>[(r(!0),u(le,null,ke(it.value,(x,L)=>(r(),B(w,{name:x.colorHex,key:L,class:"relative flex checkedList"},{icon:I(X=>[X.checked?(r(),B(te,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[23px] border-0 top-[1px] bg-transparent",size:"30"})):k("",!0)]),default:I(()=>[o("div",{style:et({backgroundColor:m(at)(x.colorHex,.12),color:x.colorHex}),class:Ce(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",L<it.value.length-1?"mb-[16px]":""])},n(x.content||ie.value),7)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),[[fe,H.value]]),!H.value&&de.value.length==0?(r(),u("div",uo,n(a.$t("common.NoLabels")),1)):k("",!0),me(T(se,{modelValue:J.value,"onUpdate:modelValue":c[5]||(c[5]=x=>J.value=x),max:5},{default:I(()=>[(r(!0),u(le,null,ke(de.value,(x,L)=>(r(),B(G,{name:x.id,key:L,class:"relative flex radioList",onClick:X=>Pt(L)},{icon:I(X=>[X.checked?(r(),B(te,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[40px] border-0 top-[1px] bg-transparent",size:"30"})):k("",!0)]),default:I(()=>[o("div",{style:et({backgroundColor:m(at)(x.colorHex,.12),color:x.colorHex}),class:Ce(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",L<de.value.length-1?"mb-[16px]":""])},n(x.content||ie.value),7),o("div",null,[T(te,{name:"edit",class:"absolute right-[1px] top-[1px]",color:"#543E3E",size:"30",onClick:xe(X=>Ot(x),["stop"])},null,8,["onClick"])])]),_:2},1032,["name","onClick"]))),128))]),_:1},8,["modelValue"]),[[fe,!H.value]]),me(o("div",mo,[T(Te,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"shrink-0 w-[180px] my-0 h-[40px] rounded-[20px]",onClick:c[6]||(c[6]=x=>Dt()),block:""},{default:I(()=>[z(n(a.$t("common.RemoveTag")),1)]),_:1}),o("div",fo,[T(te,{name:"question-o",size:"12",class:"mr-[8px]"}),z(n(a.$t("common.AllOrderLabelsCannotBeViewedAfterRemoval")),1)])],512),[[fe,H.value&&ce.value]])],2),me(o("div",po,[T(Te,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"w-[180px] my-0 h-[40px] rounded-[20px]",onClick:c[7]||(c[7]=x=>Ft()),block:""},{default:I(()=>[z(n(a.$t("common.ConfirmSelection")),1)]),_:1})],512),[[fe,!H.value&&de.value.length>0]])]),_:1},8,["show"]),T(ss,{show:m(pe),title:"导出账单",content:"请在PC端操作账单导出",showConfirm:!0,showReject:!1,confirmText:"我知道了",rejectText:"拒绝",onClose:rt,onConfirm:rt},null,8,["show"])],64)}}}),ho=Ne(vo,[["__scopeId","data-v-f061f13e"]]),xo={},yo={class:"dot w-[8px] h-[8px] rounded-full bg-[red] absolute top-0 right-[-10px]"};function go(t,V){return r(),u("div",yo)}const wo=Ne(xo,[["render",go]]),bo={class:"py-[20px] flex-start gap-2"},$o={class:"w-20 h-20"},ko={class:"flex flex-col justify-between flex-1 h-20 gap-2"},Co={class:"flex-1 text-sm text-default"},Ao={class:"w-full flex flex-row justify-start items-center gap-2 line-clamp-1"},To={class:"max-w-[150px] font-semibold line-clamp-1"},Io={key:0,class:"flex-shrink-0 flex items-center text-xs text-[#34C2A9]"},So=o("img",{src:ps,class:"w-5 h-5"},null,-1),_o={class:"ml-auto text-sm text-default opacity-60 whitespace-nowrap"},Ro={class:"mt-0 text-sm font-normal text-[#a6a6a6]"},No={class:"flex flex-row justify-end"},Lo={class:"text-sm text-[#a6a6a6] font-normal mr-1"},Oo={key:0,class:"text-newOrigin text-sm flex-start gap-[2px]"},Bo=["src"],Po={class:"font-semibold"},Eo={class:"text-sm font-normal"},Do={key:1,class:"text-primary text-sm flex-start gap-[2px]"},Fo=o("img",{src:vs,class:"w-4 h-4 mr-[3px]",alt:"MCOIN"},null,-1),Vo={class:"font-semibold"},Ho=_e({props:{payType:null,goods:null,storeCard:null,creditFlag:{default:0}},setup(t){const V=e=>{const f=e.number??1,C=e.cardPrice??0,S=e.goodsActivityReduceAmount??0,_=new Re(C*f-S).toNumber();return xt(_)},v=e=>{const f=new Re(e.price).times(e.number).minus(e.goodsActivityReduceAmount||0).plus(e.goodsAdjustChangeAmount||0).toNumber();return xt(f||0)};return(e,f)=>{var S,_,P;const C=O("VanImage");return r(),u("div",bo,[o("div",$o,[T(C,{src:(t.goods.icons||"").split(",")[0],radius:"10",class:"w-full h-full",alt:"",fit:"cover"},null,8,["src"])]),o("div",ko,[o("div",Co,[o("div",null,[o("div",Ao,[o("div",To,n(t.goods.goodsName),1),t.creditFlag?(r(),u("div",Io,[So,z(" "+n(e.$t("order.Credit Collection")),1)])):k("",!0),o("div",_o,[o("span",null,n(t.goods.price)+" Mcoin",1)])])]),o("div",Ro,n(e.$t("order.quantity",{number:t.goods.number})),1)]),o("div",No,[o("div",Lo,n(e.$t("order.actual payment")),1),t.payType===m(Ge).STORE_CARD?(r(),u("div",Oo,[(S=t.storeCard)!=null&&S.symbolLogo?(r(),u("img",{key:0,src:(_=t.storeCard)==null?void 0:_.symbolLogo,class:"w-3 h-3",alt:""},null,8,Bo)):k("",!0),o("span",Po,n(V(t.goods)),1),o("span",Eo,n((P=t.storeCard)==null?void 0:P.symbol),1)])):(r(),u("div",Do,[Fo,o("span",Vo,n(v(t.goods)),1)]))])])])}}}),jo=t=>(bt("data-v-1a205182"),t=t(),$t(),t),Go={class:"gap-2 flex-center-bw"},Mo={key:0,class:"w-4 h-4",src:St,alt:""},qo={key:1,class:"w-4 h-4 border border-solid rounded-full border-[#000]/40"},Ko=jo(()=>o("div",{class:"w-8 h-8"},[o("img",{src:Ct,class:"w-full h-full rounded-md",alt:"",fit:"cover"})],-1)),zo={class:"flex flex-col justify-center flex-1 h-8 text-default"},Uo={class:"text-sm font-normal flex-center-bw"},Yo={key:0},Wo={class:"text-primary"},Jo={class:"text-xs font-normal opacity-60"},Qo={key:0},Zo={key:1},Xo={key:2},ea=_e({props:{order:null,isService:{type:Boolean},nowTime:null,selectIds:null},emits:["select"],setup(t,{emit:V}){const v=t;Ke();const e=gt(),f=It(v.order.refundStatus,v.order.payType),{t:C}=Ue(),S=b=>{v.isService||e.push(b)},_=()=>{if(v.isService){const b=v.order;P(b)}else e.push(`/sellerOrderDetail?id=${v.order.id}`)};wt("openBatchReceiptPop",null),nt();const P=b=>{V("select",b)};return(b,pe)=>(r(),u("div",{class:Ce(["p-3 mt-3 bg-white rounded-xl box-border default-border",{"border-orange":t.selectIds&&t.selectIds.includes(t.order.id)}]),onClick:_},[o("div",Go,[o("div",null,[t.selectIds&&t.selectIds.includes(t.order.id)?(r(),u("img",Mo)):(r(),u("div",qo))]),Ko,o("div",zo,[o("div",Uo,[t.order.userAddress&&t.order.userAddress.address?(r(),u("div",Yo,n(m(tt)(t.order.userAddress.address,"...",5,5)),1)):k("",!0),o("div",Wo,n(m(f)[t.order.status+""]),1)]),o("div",Jo,[t.order.status==4?(r(),u("span",Qo,n(m(ee)(t.order.finishTime))+" "+n(b.$t("common.finish")),1)):t.order.status==2?(r(),u("span",Zo,n(m(ee)(t.order.expressTime))+" "+n(b.$t("order.Ship")),1)):(r(),u("span",Xo,n(m(ee)(t.order.createTime))+" "+n(b.$t("order.buied")),1))])])]),(r(!0),u(le,null,ke(t.order.orderGoods,h=>(r(),B(Ho,{class:"goods-item",creditFlag:t.order.creditFlag,payType:t.order.payType,key:h.goodsName,goods:h,storeCard:t.order.fmStoredCard,onHandleTo:S},null,8,["creditFlag","payType","goods","storeCard"]))),128))],2))}}),yt=Ne(ea,[["__scopeId","data-v-1a205182"]]),ta={class:"px-3 text-base"},sa={class:"flex justify-center items-center h-[44px]"},oa={class:"flex items-center font-bold"},aa={class:"overflow-y-scroll max-h-[70vh] pb-[100px]"},na={class:"mt-3 text-sm font-normal"},ra={class:"text-primary font-semibold"},la={class:"text-primary font-semibold"},ia={class:"flex flex-col"},da={class:"receipt__wrap flex flex-col items-center justify-center gap-3 py-5 px-6 fixed bottom-0 left-0 right-0"},ca={class:"text-sm font-normal text-black"},ua={class:"w-full flex flex-row justify-between items-center"},ma={class:"flex items-center justify-center"},fa={key:0,class:"w-4 h-4",src:St,alt:""},pa={key:1,class:"w-4 h-4 border border-solid rounded-full border-[#000]/40"},va={key:0,class:"text-default"},ha=_e({props:{show:{type:Boolean},list:null,currentId:null,loading:{type:Boolean}},emits:["close","receipt","update:show"],setup(t,{emit:V}){const v=t,e=Se({get:()=>v.show,set:h=>V("update:show",h)}),f=y([]),C=Se(()=>v.list&&v.currentId?v.list.filter(h=>+h.id!=+v.currentId):[]),S=Se(()=>{const h=[v.currentId,...C.value.map(g=>g.id)];return f.value.length===h.length&&h.every(g=>f.value.includes(g))}),_=()=>{if(S.value)f.value=[];else{const h=[v.currentId,...C.value.map(g=>g.id)];f.value=h}};qe(()=>v.show,h=>{if(h){const g=document.getElementById("container");Wt(()=>{g&&g.scrollIntoView()}),f.value=[],f.value.push(v.currentId)}},{deep:!0});const P=h=>{const g=h.id;f.value.includes(g)?f.value=f.value.filter(U=>U!==g):f.value.push(g)},b=()=>{V("receipt",f.value)},pe=Se(()=>v.list&&v.currentId?v.list.find(h=>+h.id==+v.currentId):[]);return(h,g)=>{const U=O("van-icon"),oe=O("VanButton"),E=O("van-popup");return r(),B(E,{show:m(e),"onUpdate:show":g[1]||(g[1]=ae=>Yt(e)?e.value=ae:null),round:"",class:"bg-[#F3F3F3]",position:"bottom",onClose:g[2]||(g[2]=ae=>V("close")),"safe-area-inset-bottom":"","stop-propagation":!1},{default:I(()=>[o("div",ta,[o("div",sa,[o("div",oa,n(h.$t("order.you_have_other_pending_orders")),1),T(U,{class:"absolute right-2.5",name:"cross",size:"20",color:"#000",onClick:g[0]||(g[0]=xe(()=>V("close"),["stop"]))})]),o("div",aa,[m(pe)?(r(),B(yt,{key:0,id:"container",onSelect:P,selectIds:f.value,order:m(pe),isService:""},null,8,["selectIds","order"])):k("",!0),o("div",na,[z(n(h.$t("order.there are"))+" ",1),o("span",ra,n(m(C).length),1),z(" "+n(h.$t("order.order merchant"))+" ",1),o("span",la,n(h.$t("order.already")),1),z(" "+n(h.$t("order.can confirm receipt in batches")),1)]),o("div",ia,[(r(!0),u(le,null,ke(m(C),ae=>(r(),u("div",{key:ae.id},[T(yt,{onSelect:P,selectIds:f.value,order:ae,isService:""},null,8,["selectIds","order"])]))),128))]),o("div",da,[o("div",ca,n(h.$t("order.follow orders")),1),o("div",ua,[o("div",{class:"flex flex-col items-center justify-center cursor-pointer",onClick:_},[o("div",ma,[m(S)?(r(),u("img",fa)):(r(),u("div",pa))])]),T(oe,{loading:t.loading,round:"",disabled:!f.value||f.value&&f.value.length<=0,class:"ml-2 h-10 text-default min-w-[calc(100%-32px)] bg-btnOrBg rounded-[60px] font-semibold",onClick:b},{default:I(()=>[z(n(h.$t("order.oneKeyConfirmGeted")),1),f.value.length?(r(),u("span",va,n(h.$t("order.selected count num",{count:f.value.length||0})),1)):k("",!0)]),_:1},8,["loading","disabled"])])])])])]),_:1},8,["show"])}}}),xa=Ne(ha,[["__scopeId","data-v-5dc12824"]]),ya={class:"relative"},ga={class:"px-3 bg-[#f2f0ef] pb-1 parent-view"},wa={class:"gap-2 pt-2 flex-start bg-[#f2f0ef] sticky top-0 z-10"},ba=_e({name:"SellerOrderList"});function $a(t){const{t:V}=Ue(),{getCurrentStoreId:v}=At(),e=y(0),f=y(1),{clerkStore:C}=Ke(),[S,_]=je(!1),[P,b]=je(!1),[pe,h]=je(!1),g=y(null),U=y([]),oe=y([]),E=y(null),ae=y(new Date().getTime()/1e3),R=Jt();R.query.active&&(e.value=Number(R.query.active)),R.query.type&&(f.value=Number(R.query.type));const N=p=>{console.log("changeType",p),f.value=p,Tt.replace({path:"sellerOrderList",query:{type:p}})},{merchantConfirm:Y}=nt(),d=async()=>{var i;const p=await ze({page:1,size:999,status:2,type:1,storeId:(i=await v())==null?void 0:i.id});p.success&&(oe.value=p.data)},$=async p=>{g.value=p.id,oe.value.length===0&&(p.loading=!0,await d(),p.loading=!1),U.value=oe.value.filter(i=>{if(!i.merchantsConfirm&&!(Me(i.expressTime,i.confirmLimit,ae.value)>0))return!0}),U.value.length<=1?D(p):b(!0)},D=async p=>{p.loading=!0;try{const ne=(await st({orderIds:p.id.toString()})).data.ordIds,K=await Y(ne);if(!K.success||!(await ot({ordIds:ne,hash:K.result.hash})).success)return;p.merchantsConfirm=1,A.success(V("order.confirmSuccess")),setTimeout(()=>{var Ae;E.value?(Ae=E.value)==null||Ae.handleChangeTab(3):location.reload()},1e3)}finally{p.loading=!1}},W=async p=>{var i;h(!0);try{const ne=p.map(String).join(),ye=(await st({orderIds:ne})).data.ordIds,Ae=await Y(ye);if(!Ae.success||!(await ot({ordIds:ye,hash:Ae.result.hash})).success)return;U.value.forEach(Le=>{p.includes(Le.id)&&(Le.merchantsConfirm=1)}),b(!1),A.success(V("order.confirmSuccess")),await d(),E.value?(i=E.value)==null||i.handleChangeTab(3):location.reload()}finally{h(!1)}},q=async()=>{var ne;const{success:p,total:i}=await ze({page:1,size:3,status:-1,refundStatus:1,type:1,tab:2,storeId:(ne=await v())==null?void 0:ne.id});p&&i>0?_(!0):_(!1)};return Qt("openBatchReceiptPop",$),qe(()=>R.query.active,p=>{var i;+p&&E.value&&E.value.active&&R.path==="/sellerOrderList"&&((i=E.value)==null?void 0:i.active)!==+p&&E.value.handleChangeTab(+p)},{immediate:!1,deep:!0}),qe(()=>R.path,(p,i)=>{p==="/sellerOrderList"&&i!=="/sellerOrderList"&&(console.log("从子页面返回，刷新订单列表"),E.value&&sessionStorage.getItem("modifiedOrderId")&&E.value.updateModifiedOrders())},{immediate:!1}),kt(()=>{q(),d(),C.checkClerkAuth()}),(p,i)=>{const ne=O("router-view");return r(),u("div",ya,[o("div",ga,[o("div",wa,[T(hs),o("div",{class:Ce(["text",{"active-text":f.value==1}]),onClick:i[0]||(i[0]=K=>N(1))},n(p.$t("order.order")),3),o("div",{class:Ce(["relative ml-2 text",{"active-text":f.value==2}]),onClick:i[1]||(i[1]=K=>N(2))},[z(n(p.$t("order.Refund/After-sale"))+" ",1),me(T(wo,null,null,512),[[fe,m(S)]])],2),T(xs,{showIcon:!0,showDownIcon:!1,class:"ml-auto bg-gray1 px-2 rounded-[20px] border-2 border-solid border-white",style:{"box-shadow":"0px 0px 15px 0px rgba(51, 47, 42, 0.3) inset"}})]),f.value==1?(r(),B(ho,{key:0,ref:(K,ye)=>{ye.sellOrderRef=K,E.value=K},value:e.value},null,8,["value"])):f.value==2?(r(),B(fs,{key:1,onRecompute:q})):f.value==3?(r(),B(ys,{key:2})):k("",!0)]),T(ne,{class:"child-view bg-[#f2f0ef]"}),T(xa,{show:m(P),list:U.value,currentId:g.value,loading:m(pe),onClose:i[2]||(i[2]=K=>m(b)(!1)),onReceipt:W},null,8,["show","list","currentId","loading"])])}}const ka=_e({...ba,setup:$a}),sn=Ne(ka,[["__scopeId","data-v-7214e9d6"]]);export{sn as default};
