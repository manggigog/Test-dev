import{_ as we,z as be,x as xe,a2 as R,j as C,y as Te,r,bl as ge,E as _e,F as u,G as T,H as m,I as n,P as a,a1 as ye,$ as i,Q as d,bv as ke,O as l,U as Z,J as j,K as q,N as S,a3 as W,a0 as F,Z as ee,V as De,X as Ce,Y as Se}from"./vendor-Dr_RpJ_Y.js";import{_ as Ve}from"./search-C4fLtTfY.js";import{_ as $e}from"./filter-DRLh1k_O.js";import{u as Ye,b as Le,aA as g}from"./index-7OiUoGXy.js";import{D as Ie}from"./goods-BVwS8oFG.js";import{w as Me}from"./order-D0_No2Ew.js";import{h as Ue}from"./color-CLXjroBk.js";const te=p=>(Ce("data-v-f8037c5c"),p=p(),Se(),p),Be={class:"flex items-center p-3"},Ee={class:"flex-1 bg-white rounded-3xl search-input-box"},Oe=te(()=>n("div",null,[n("img",{src:Ve,class:"w-4 h-4"})],-1)),Re=te(()=>n("img",{src:$e,class:"w-full h-full"},null,-1)),je=[Re],Fe={class:"flex flex-col max-h-[75vh] justify-between px-5 pb-[80px]"},ze={class:"pt-[18px] pb-4 font-semibold text-base text-center"},Ae={class:"overflow-y-auto flex-1"},He={class:"text-sm font-semibold"},Pe={class:"flex items-center gap-2 mt-3 overflow-x-auto"},Ke=["onClick"],Ne={class:"mt-3 flex-start"},Ge={class:"mx-2"},Je={key:0,class:"pt-4"},Qe={class:"text-sm font-semibold"},Xe={class:"pt-[10px] pr-[10px] mt-[10px] max-h-[300px]"},Ze={class:"pb-4 flex-center-bw p-4 flex justify-between gap-3 fixed bottom-0 left-0 right-0 bg-white"},qe={class:"text-base font-normal"},We={class:"text-base font-semibold"},et=be({props:{modelValue:null,deliveryType:{default:Ie.online},shopType:null,userRole:{default:"merchant"}},emits:["update:modelValue","onSearch"],setup(p,{expose:oe,emit:_}){const ne=p,{t:V}=xe(),[$,y]=R(!1),{getCurrentStoreId:se}=Ye(),{checkLoginAuth:z}=Le(),A=C().format("YYYY-MM-DD"),Y=C().subtract("days",7).format("YYYY-MM-DD"),L=C().subtract("month",1).format("YYYY-MM-DD"),I=C().subtract("month",3).format("YYYY-MM-DD"),le=Te(()=>[{id:1,label:V("shop.Last 7 days")},{id:2,label:V("shop.last month")},{id:3,label:V("shop.last 3 months")}]),[M,U]=R(!1),[B,k]=R(!1),c=r(new Date),h=r(new Date),ae=r(new Date(new Date("2020/1/1").getTime())),w=r(new Date(new Date("2020/1/1").getTime())),s=ge({startTime:null,endTime:null}),E=r(!1),H=r(!1),f=r([]),D=r([]),P=r(null),ie=()=>{_("onSearch"),P.value.blur()},re=()=>{s.startTime=null,s.endTime=null,v.value=null,c.value=null,h.value=null,D.value=[],N()},K=()=>{U(!1),k(!1),(!s.startTime||!s.endTime)&&(s.endTime=null,s.startTime=null)},de=o=>{c.value=new Date(g(o)),w.value=new Date(new Date(o).getTime()),s.startTime=g(c.value.toString()),v.value=null,U(!1),k(!0)},ce=o=>{h.value=new Date(g(o)),s.startTime=g(c.value.toString()),s.endTime=g(o),v.value=null,k(!1)},v=r(null),ue=o=>{if(v.value!==o){switch(h.value=new Date(A),s.endTime=A,o){case 1:s.startTime=Y,c.value=new Date(Y),w.value=new Date(new Date(Y).getTime()+60*1e3);break;case 2:s.startTime=L,c.value=new Date(L),w.value=new Date(new Date(L).getTime()+60*1e3);break;case 3:s.startTime=I,c.value=new Date(I),w.value=new Date(new Date(I).getTime()+60*1e3);break}v.value=o}},N=()=>{const o={startTime:s.startTime?s.startTime+" 00:00:00":null,endTime:s.endTime?s.endTime+" 23:59:59":null,orderLabelIdList:D.value};_("onSearch",o),y(!1)},O=async()=>{var o;z(!0)&&Me({page:1,size:300,shopId:(o=await se())==null?void 0:o.id}).then(t=>{f.value=t.data.map(b=>({id:b.id,content:b.content,colorHex:b.colorHex})),E.value=!1,f.value.length>=t.total&&(H.value=!0)})};return _e(()=>{z(!0)&&ne.userRole==="merchant"&&O()}),oe({onLoadTagList:O}),(o,t)=>{const b=u("VanField"),G=u("van-datetime-picker"),J=u("van-popup"),Q=u("van-icon"),me=u("van-checkbox"),pe=u("van-checkbox-group"),fe=u("van-list"),X=u("VanButton"),ve=u("VanPopup");return m(),T(j,null,[n("div",Be,[n("div",Ee,[a(b,{ref:(e,x)=>{x.searchRef=e,P.value=e},onKeyup:ke(ie,["enter"]),"model-value":p.modelValue,"onUpdate:modelValue":t[1]||(t[1]=e=>_("update:modelValue",e)),placeholder:o.$t("offline.searchTips"),class:"w-[100% - 20px] text-center bg-transparent items-center",clearable:"",enterkeyhint:"search"},{"left-icon":i(()=>[Oe]),"right-icon":i(()=>[n("div",{onClick:t[0]||(t[0]=e=>_("onSearch")),class:"text-newOrigin font-semibold leading-5"},d(o.$t("common.search")),1)]),_:1},8,["onKeyup","model-value","placeholder"])]),n("div",{class:"flex-shrink-0 w-5 h-5 ml-2",onClick:t[2]||(t[2]=e=>l(y)(!0))},je),ye(o.$slots,"default",{},void 0,!0)]),a(ve,{teleport:"body",show:l($),"onUpdate:show":t[11]||(t[11]=e=>F($)?$.value=e:null),round:"",position:"bottom",closeable:"",class:"sm:w-[375px]",style:{"max-height":"75vh","min-width":"280px",left:"50%",transform:"translate3d(-50%, 0, 0)"},"close-on-click-overlay":"",onClickOverlay:t[12]||(t[12]=e=>l(y)(!1)),onClickCloseIcon:t[13]||(t[13]=e=>l(y)(!1))},{default:i(()=>[n("div",Fe,[n("div",ze,d(o.$t("common.OrderScreening")),1),n("div",Ae,[n("div",He,d(o.$t("common.time")),1),n("div",Pe,[(m(!0),T(j,null,q(l(le),e=>(m(),T("div",{class:S(["type-cell flex-1",{"cell-active":v.value==e.id}]),key:e.id,onClick:x=>ue(e.id)},d(e.label),11,Ke))),128))]),n("div",Ne,[n("div",{class:"van-cell p-0 flex justify-center type-cell",onClick:t[3]||(t[3]=W(e=>l(U)(!0),["stop"]))},[n("div",{class:S({"opacity-30":!l(s).startTime})},d(l(s).startTime||o.$t("goods.selectStartTime")),3)]),a(J,{show:l(M),"onUpdate:show":t[5]||(t[5]=e=>F(M)?M.value=e:null),position:"bottom",round:"",style:{height:"50%"},"close-on-click-overlay":!1,teleport:"body"},{default:i(()=>[a(G,{modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=e=>c.value=e),"min-date":ae.value,type:"date",title:o.$t("goods.selectStartTime"),onCancel:K,onConfirm:de},null,8,["modelValue","min-date","title"])]),_:1},8,["show"]),n("div",Ge,[a(Q,{name:"minus"})]),n("div",{class:"van-cell p-0 flex justify-center type-cell",onClick:t[6]||(t[6]=W(e=>l(k)(!0),["stop"]))},[n("div",{class:S({"opacity-30":!l(s).endTime})},d(l(s).endTime||o.$t("goods.selectEndTime")),3)]),a(J,{show:l(B),"onUpdate:show":t[8]||(t[8]=e=>F(B)?B.value=e:null),position:"bottom",round:"",style:{height:"50%"},"close-on-click-overlay":!1,teleport:"body"},{default:i(()=>[a(G,{modelValue:h.value,"onUpdate:modelValue":t[7]||(t[7]=e=>h.value=e),onConfirm:ce,"min-date":w.value,onCancel:K,type:"date",title:o.$t("goods.selectEndTime")},null,8,["modelValue","min-date","title"])]),_:1},8,["show"])]),f.value&&f.value.length?(m(),T("div",Je,[n("div",Qe,d(o.$t("common.tag")),1),n("div",Xe,[a(fe,{loading:E.value,"onUpdate:loading":t[10]||(t[10]=e=>E.value=e),finished:H.value,onLoad:O},{default:i(()=>[a(pe,{modelValue:D.value,"onUpdate:modelValue":t[9]||(t[9]=e=>D.value=e),max:5},{default:i(()=>[(m(!0),T(j,null,q(f.value,(e,x)=>(m(),ee(me,{name:e.id,key:x,class:"relative flex radioList"},{icon:i(he=>[he.checked?(m(),ee(Q,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[15px] border-0 top-[1px] bg-transparent",size:"30"})):Z("",!0)]),default:i(()=>[n("div",{style:De({backgroundColor:l(Ue)(e.colorHex,.12),color:e.colorHex}),class:S(["rounded-[6px] min-h-[40px] p-[10px] text-white text-[0.875rem]",x===f.value.length-1?"":"mb-[16px]"])},d(e.content),7)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["loading","finished"])])])):Z("",!0)]),n("div",Ze,[a(X,{round:"",class:"!border-b4 text-b1 flex-1 h-[46px]",onClick:re},{default:i(()=>[n("span",qe,d(o.$t("common.reset")),1)]),_:1}),a(X,{round:"",class:"btn-yellow flex-1 h-[46px] border-0",onClick:N},{default:i(()=>[n("span",We,d(o.$t("common.confirm")),1)]),_:1})])])]),_:1},8,["show"])],64)}}}),rt=we(et,[["__scopeId","data-v-f8037c5c"]]);export{rt as O};
