import{_ as fe,y as ge,r as h,z as He,E as g,K as we,G as V,N as c,H as o,Q as l,F as A,J as ye,R as q,a0 as b,a2 as ne,I as xe,O as u,$ as Y,w as je,be as N,x as le,D as De,P as n,T as p,Y as Oe,Z as Qe}from"./vendor-BUT0HZ5j.js";import{U as Ge}from"./UpgradeStorePop-C5Yurcok.js";import{C as Je}from"./ChangeRegion-CK5Y8WZc.js";import{B as Ke}from"./BackIcon-biFt6cm7.js";import{u as We,e as Ye,v as Ze,ag as he,aj as Xe,a2 as J,q as K,bq as et,br as tt,S as ot}from"./index-k1FFr-1T.js";import{u as W}from"./upload-B40Myr0u.js";import{q as at}from"./category-DjU0R16T.js";import{a as st}from"./shop-CeqcS6K2.js";import{c as lt}from"./user-B-N_oWpO.js";import"./BoutiqueLable-r45nG6V6.js";import"./ChangeRegionPop-C7x8iMg_.js";const nt="/Test-dev/static/images/defaultImg-DQiyvs75.png",Z="/Test-dev/static/images/info-arrow-CiFW705A.svg",ut={class:"px-5"},rt={class:"mt-[18px] font-semibold text-base text-center"},dt={class:""},it=["onClick"],ct={key:0,class:"text-white"},pt={class:"pt-8 pb-4 flex-center-bw"},vt=ge({props:{show:{type:Boolean,default:!1},menus:{default:()=>[]},value:{default:()=>[]}},emits:["close","onChange"],setup(_,{emit:F}){const H=_,v=h([]);He(()=>H.show,f=>{f&&(v.value=H.value??[])});const X=f=>{v.value.includes(f)?v.value=v.value.filter(w=>w!==f):v.value.push(f)},j=()=>{v.value=[]},i=()=>{F("onChange",v.value),F("close")};return(f,w)=>{const R=g("VanButton"),y=g("VanPopup");return V(),we(y,{teleport:"body",show:_.show,"onUpdate:show":w[0]||(w[0]=d=>Y(show)?show.value=d:null),round:"",position:"bottom",closeable:"",style:{minHeight:"40%"},"close-on-click-overlay":"",onClickOverlay:w[1]||(w[1]=d=>F("close")),onClickCloseIcon:w[2]||(w[2]=d=>F("close"))},{default:c(()=>[o("div",ut,[o("div",rt,l(f.$t("shop.Please select the sort menu")),1),o("div",dt,[(V(!0),A(xe,null,ye(_.menus,(d,E)=>(V(),A("div",{onClick:B=>X(d.value),key:d.value,class:q(["py-4 flex items-center border-b border-solid border-[#F6F6F5] text-sm",{"border-none":E===_.menus.length-1}])},[o("div",{class:q(["w-5 h-5 mr-2 border border-solid rounded-full flex-center",{"bg-[#FEA021] border-[#FEA021]":v.value.includes(d.value),"border-[#c8c9cc]":!v.value.includes(d.value)}])},[v.value.includes(d.value)?(V(),A("div",ct,l(v.value.findIndex(B=>B===d.value)+1),1)):ne("",!0)],2),b(" "+l(d.text),1)],10,it))),128))]),o("div",pt,[u(R,{class:"border-orange bg-[#fff] rounded-3xl text-[#FEA021] w-[150px] h-[40px]",onClick:j},{default:c(()=>[b(l(f.$t("common.reset")),1)]),_:1}),u(R,{class:"btn-orange rounded-3xl text-white w-[150px] h-[40px]",onClick:i},{default:c(()=>[b(l(f.$t("common.confirm")),1)]),_:1})])])]),_:1},8,["show"])}}}),mt=fe(vt,[["__scopeId","data-v-3d9da0d8"]]),M=_=>(Oe("data-v-7aaed96e"),_=_(),Qe(),_),ht={class:"pb-4 text-sm text-default bg-[#f9f7f4]"},ft={class:"sticky top-0 z-50 gap-2 px-3 pt-2 flex-start bg-[#f9f7f4]"},gt={class:"bg-white px-2.5 py-4 mt-4"},wt={class:"flex-center-bw"},yt={class:"key"},xt=M(()=>o("div",{class:"w-[50px] h-[50px] rounded-xl bg-gray1 text-center text-lg text-[#d9d9d9] font-bold"},[o("img",{src:nt})],-1)),bt={class:"mt-4 flex-center-bw"},_t={class:"key"},$t={class:"mt-4 flex-center-bw"},Ct={class:"key"},St={class:"value"},Vt={class:"mt-4 flex-center-bw"},kt={class:"key"},It={class:"value"},Ut={class:"bg-white px-2.5 py-4 mt-4"},Tt={class:"flex-center-bw"},Lt={class:"key"},Rt=b("%"),At={class:"mt-4 flex-center-bw"},Ft={class:"key"},Bt={class:"value"},Nt={class:"mt-4 flex-center-bw"},qt={class:"key"},Et={class:"gap-1 value flex-start van-cell"},Pt=M(()=>o("img",{src:Z,class:"w-[6px]",alt:""},null,-1)),zt={class:"mt-4 flex-center-bw"},Mt={class:"key whitespace-nowrap"},Ht={class:"bg-white px-2.5 py-4 mt-4"},jt={class:"flex-center-bw"},Dt={class:"key"},Ot={class:"gap-1 value van-cell flex-start"},Qt=M(()=>o("img",{src:Z,class:"w-[6px]",alt:""},null,-1)),Gt={class:"mt-4 flex-center-bw"},Jt={class:"key"},Kt={class:"mt-4 flex-center-bw"},Wt={class:"key"},Yt={class:"gap-1 value flex-start van-cell"},Zt=M(()=>o("img",{src:Z,class:"w-[6px]",alt:""},null,-1)),Xt={class:"mt-4 flex-center-bw"},eo={class:"key"},to=M(()=>o("img",{src:Z,class:"w-[6px]",alt:""},null,-1)),oo={class:"mt-4 flex-center-bw"},ao={class:"key"},so={key:0,class:"flex-center gap-4 mt-2 px-2.5"},lo=ge({setup(_){const{getCurrentStoreId:F,getCurrentAccount:H}=We(),{regionStore:v,accountStore:X}=Ye(),{currentLocale:j}=Ze(),{t:i,messages:f}=je(),w=f.value[j.value][v.country==="CN"?"areaList":"jpAreaList"],R=h(!1),y=h(""),d=h(""),[E,B]=N(!1),[ee,te]=N(!1),[oe,ae]=N(!1),s=h({logo:null,storeName:null,openingHours:null,discountRatio:null,classId:1,contact:null,location:null,scenery:null,qrCode:null,shareImg:null,contactAddress:null,type:null}),k=h([]),ue=h([]),be=async()=>{const e=await at();e.success&&(ue.value=(e.data||[]).map(t=>({value:t.id,text:t[`${st[j.value]}Name`]})))},_e=le(()=>he(s.value.merchant)===he(H())&&(s.value.upgradableType&&s.value.upgradableType<s.value.type||s.value.type===0&&s.value.upgradableType>0)),[$e,se]=N(!1),[re,de]=N(!1),Ce=async e=>{de(!0);const{success:t}=await Xe(e);de(!1),t&&(se(!1),pe())},[P,ie]=N(!1),ce=le(()=>{var e,t;return(e=s.value)!=null&&e.type?[{text:i("mall.mallhome"),value:1},{text:i(`common.shop_type_${(t=s.value)==null?void 0:t.type}`),value:2},{text:i("mall.tabBar[3].text"),value:4},{text:i("mall.tabBar[2].text"),value:3}]:[{text:i("mall.mallhome"),value:1},{text:i("mall.tabBar[3].text"),value:4},{text:i("mall.tabBar[2].text"),value:3}]}),m=h([]),Se=e=>{m.value=e},Ve=le(()=>{var t;let e=[];try{for(let r=0;r<m.value.length;r++){const C=m.value[r],T=(t=ce.value.find(L=>L.value===C))==null?void 0:t.text;T&&e.push(T)}}catch{e=[]}return e}),ke=e=>e>80?80:e,$=h(!1),I=h([]),x=h([]),U=h([]),D=()=>{p.loading({message:i("common.uploading"),forbidClick:!0,duration:0})},Ie=()=>($.value=!0,D(),!0),Ue=async e=>{const t=await J(e,"shopLogo"),r=await W(t);if($.value=!1,p.clear(),!r.success)return I.value.length-=1;I.value[I.value.length-1]={url:K.imgUrl+r.data}},Te=()=>($.value=!0,D(),!0),Le=async e=>{const t=await J(e,"shopScenery"),r=await W(t);if($.value=!1,p.clear(),!r.success)return x.value.length-=1;x.value[x.value.length-1]={url:K.imgUrl+r.data}},Re=()=>($.value=!0,D(),!0),Ae=async e=>{const t=await J(e,"shopScenery"),r=await W(t);if($.value=!1,p.clear(),!r.success)return U.value.length-=1;U.value[U.value.length-1]={url:K.imgUrl+r.data}},Fe=()=>($.value=!0,D(),!0),Be=async e=>{const t=await J(e,"shopScenery"),r=await W(t);if($.value=!1,p.clear(),!r.success)return k.value.length-=1;k.value[k.value.length-1]={url:K.imgUrl+r.data}},Ne=e=>{if(!e[0].code||!e[1].code)return p(i("common.choose address"));s.value.location=[...new Set(e.map(t=>t.name))].join(""),B(!1)},qe=e=>{y.value=e,te(!1)},Ee=e=>{d.value=e,ae(!1)},Pe=async()=>{if(R.value||$.value)return;if(!I.value.length)return p(i("shop.emptyLogo"));if(!s.value.storeName)return p(i("shop.emptyName"));if(!y.value)return p(i("shop.emptyOpenTime"));if(!d.value)return p(i("shop.emptyEndTime"));if(!s.value.discountRatio||s.value.discountRatio<=0)return p(i("shop.emptyRadio"));if(!s.value.classId)return p(i("shop.emptyClass"));if(!x.value||x.value.length<=0)return p(i("shop.enterShopPhoto"));if(!m.value||m.value.length<=0)return p(i("shop.select menu configuration"));R.value=!0,s.value.logo=I.value[0].url,s.value.scenery=x.value.length?x.value.map(t=>t.url).join(","):"",s.value.qrCode=U.value.length?U.value[0].url:"",s.value.shareImg=k.value.length?k.value[0].url:"",s.value.openingHours=`${y.value} - ${d.value}`;const e=await et({...s.value,menus:m.value.join(",")??""});R.value=!1,e.success&&(lt(),tt.back())},ze=async()=>{var t,r,C,T,L,z,O,Q,G;const e=await ot((t=await F())==null?void 0:t.merchant);if(!(!e.success||!e.data)){if(s.value=e.data,e.data.openingHours){const S=e.data.openingHours.split("-");y.value=S[0].trim(),d.value=S[1].trim()}(r=e.data)!=null&&r.logo&&(I.value[0]={url:e.data.logo}),(C=e.data)!=null&&C.scenery&&(x.value=e.data.scenery?(T=e.data.scenery.split(","))==null?void 0:T.map(S=>({url:S})):[]),(L=e.data)!=null&&L.qrCode&&(U.value[0]={url:e.data.qrCode}),(z=e.data)!=null&&z.shareImg&&(k.value[0]={url:e.data.shareImg}),(O=e.data)!=null&&O.menus?(m.value=(G=(Q=e.data)==null?void 0:Q.menus)==null?void 0:G.split(","),m.value=m.value.map(S=>+S)):e.data.type>0?m.value=[1,2,3,4]:m.value=[1,3,4]}},pe=()=>{be(),ze()};return De(()=>{pe()}),(e,t)=>{var ve,me;const r=g("van-uploader"),C=g("VanField"),T=g("van-datetime-picker"),L=g("van-popup"),z=g("van-field"),O=g("van-dropdown-item"),Q=g("van-dropdown-menu"),G=g("van-area"),S=g("VanButton");return V(),A("div",ht,[o("div",ft,[u(Ke),o("div",null,l(e.$t("order.shopInfo")),1),u(Je,{showIcon:!0,showDownIcon:!1,class:"ml-auto bg-gray1 px-2 rounded-[20px] border-2 border-solid border-white",style:{"box-shadow":"0px 0px 15px 0px rgba(51, 47, 42, 0.3) inset"}})]),o("div",gt,[o("div",wt,[o("div",yt,l(e.$t("shop.shopLogo")),1),u(r,{modelValue:I.value,"onUpdate:modelValue":t[0]||(t[0]=a=>I.value=a),accept:"image/*","max-count":1,"preview-size":"50","before-read":Ie,afterRead:Ue},{default:c(()=>[xt]),_:1},8,["modelValue"])]),o("div",bt,[o("div",_t,l(e.$t("shop.shopName")),1),u(C,{class:"value","input-align":"right",maxlength:12,modelValue:s.value.storeName,"onUpdate:modelValue":t[1]||(t[1]=a=>s.value.storeName=a),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])]),o("div",$t,[o("div",Ct,l(e.$t("shop.openTime")),1),o("div",St,[o("div",{class:q(["px-[16px] py-[5px] text-right text-[#c8c9cc]",{"active-text":y.value}]),onClick:t[2]||(t[2]=a=>n(te)(!0))},l(y.value||e.$t("shop.pleaseSelect")),3)]),u(L,{round:"",show:n(ee),"onUpdate:show":t[5]||(t[5]=a=>Y(ee)?ee.value=a:null),position:"bottom",style:{height:"40%"}},{default:c(()=>[u(T,{modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=a=>y.value=a),type:"time",title:e.$t("shop.openTime"),"min-hour":0,"max-hour":24,onConfirm:qe,onCancel:t[4]||(t[4]=a=>n(te)(!1))},null,8,["modelValue","title"])]),_:1},8,["show"])]),o("div",Vt,[o("div",kt,l(e.$t("shop.endTime")),1),o("div",It,[o("div",{class:q(["px-[16px] py-[5px] text-right text-[#c8c9cc]",{"active-text":d.value}]),onClick:t[6]||(t[6]=a=>n(ae)(!0))},l(d.value||e.$t("shop.pleaseSelect")),3)]),u(L,{round:"",show:n(oe),"onUpdate:show":t[9]||(t[9]=a=>Y(oe)?oe.value=a:null),position:"bottom",style:{height:"40%"}},{default:c(()=>[u(T,{modelValue:d.value,"onUpdate:modelValue":t[7]||(t[7]=a=>d.value=a),type:"time",title:e.$t("shop.endTime"),"min-hour":0,"max-hour":24,onConfirm:Ee,onCancel:t[8]||(t[8]=a=>n(ae)(!1))},null,8,["modelValue","title"])]),_:1},8,["show"])])]),o("div",Ut,[o("div",Tt,[o("div",Lt,l(e.$t("shop.shopRateSetting")),1),u(z,{class:"value","input-align":"right",modelValue:s.value.discountRatio,"onUpdate:modelValue":t[10]||(t[10]=a=>s.value.discountRatio=a),type:"digit",placeholder:e.$t("shop.pleaseInput")+"1-80",formatter:ke},{"right-icon":c(()=>[Rt]),_:1},8,["modelValue","placeholder"])]),o("div",At,[o("div",Ft,l(e.$t("shop.shopCategory")),1),o("div",Bt,[u(z,{"input-align":"right",autocomplete:"off"},{input:c(()=>[u(Q,{"active-color":"#FEA021"},{default:c(()=>[u(O,{modelValue:s.value.classId,"onUpdate:modelValue":t[11]||(t[11]=a=>s.value.classId=a),options:ue.value},null,8,["modelValue","options"])]),_:1})]),_:1})])]),o("div",Nt,[o("div",qt,l(e.$t("shop.shopPhoto")),1),u(r,{modelValue:x.value,"onUpdate:modelValue":t[12]||(t[12]=a=>x.value=a),accept:"image/*","max-count":3,"preview-size":"50","before-read":Te,afterRead:Le},{default:c(()=>[o("div",Et,[b(l(e.$t("shop.upload"))+" ",1),Pt])]),_:1},8,["modelValue"])]),o("div",zt,[o("div",Mt,l(e.$t("shop.Menu Management")),1),o("div",{class:q(["flex-end value px-[16px] flex items-center gap-2 overflow-x-hidden",{"text-primary":n(P)}]),onClick:t[13]||(t[13]=a=>n(ie)(!n(P)))},[(V(!0),A(xe,null,ye(n(Ve),(a,Me)=>(V(),A("div",{key:Me,class:"text-sm px-1.5 leading-6 bg-[#FFF0DA] rounded whitespace-nowrap overflow-x-scroll"},l(a),1))),128)),o("div",{class:q({triangle_down:!n(P),triangle_up:n(P)})},null,2)],2)])]),o("div",Ht,[o("div",jt,[o("div",Dt,l(e.$t("shop.shop share img")),1),u(r,{modelValue:k.value,"onUpdate:modelValue":t[14]||(t[14]=a=>k.value=a),accept:"image/*","max-count":1,"preview-size":"50","before-read":Fe,afterRead:Be},{default:c(()=>[o("div",Ot,[b(l(e.$t("shop.upload"))+" ",1),Qt])]),_:1},8,["modelValue"])]),o("div",Gt,[o("div",Jt,l(e.$t("shop.contact")),1),u(C,{class:"value","input-align":"right",modelValue:s.value.contact,"onUpdate:modelValue":t[15]||(t[15]=a=>s.value.contact=a),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])]),o("div",Kt,[o("div",Wt,l(e.$t("shop.qrCode")),1),u(r,{modelValue:U.value,"onUpdate:modelValue":t[16]||(t[16]=a=>U.value=a),accept:"image/*","max-count":1,"preview-size":"50","before-read":Re,afterRead:Ae},{default:c(()=>[o("div",Yt,[b(l(e.$t("shop.upload"))+" ",1),Zt])]),_:1},8,["modelValue"])]),o("div",null,[o("div",Xt,[o("div",eo,l(e.$t("shop.shopAddress")),1),o("div",{class:"gap-1 value van-cell flex-end",onClick:t[17]||(t[17]=a=>n(B)(!0))},[b(l(e.$t("shop.edit"))+" ",1),to]),u(L,{round:"",show:n(E),"onUpdate:show":t[19]||(t[19]=a=>Y(E)?E.value=a:null),position:"bottom",style:{height:"40%"}},{default:c(()=>[u(G,{title:"","area-list":n(w),"columns-placeholder":[e.$t("shop.pleaseSelect"),e.$t("shop.pleaseSelect"),e.$t("shop.pleaseSelect")],"columns-num":"2",onConfirm:Ne,onCancel:t[18]||(t[18]=a=>n(B)(!1))},null,8,["area-list","columns-placeholder"])]),_:1},8,["show"])]),u(C,{class:"rounded bg-[#f2f0ef] px-1 py-2 mt-2",readonly:"",modelValue:s.value.location,"onUpdate:modelValue":t[20]||(t[20]=a=>s.value.location=a),placeholder:e.$t("shop.pleaseSelect")},null,8,["modelValue","placeholder"])]),o("div",null,[o("div",oo,[o("div",ao,l(e.$t("shop.shopSpecificAddress")),1)]),u(C,{class:"rounded bg-[#f2f0ef] px-1 py-2 mt-2",type:"textarea",rows:"2",modelValue:s.value.contactAddress,"onUpdate:modelValue":t[21]||(t[21]=a=>s.value.contactAddress=a),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])])]),n(X).isOnlyView?ne("",!0):(V(),A("div",so,[n(_e)?(V(),we(S,{key:0,class:"btn-orange btn-shadow min-w-[130px] block",loading:n(re),onClick:t[22]||(t[22]=a=>n(se)(!0))},{default:c(()=>[b(l(e.$t("profile.Upgrade your store")),1)]),_:1},8,["loading"])):ne("",!0),u(S,{class:"btn-orange btn-shadow min-w-[130px] block",loading:R.value,onClick:Pe},{default:c(()=>[b(l(e.$t("common.confirm")),1)]),_:1},8,["loading"])])),u(mt,{show:n(P),onClose:t[23]||(t[23]=a=>n(ie)(!1)),onOnChange:Se,menus:n(ce),value:m.value},null,8,["show","menus","value"]),u(Ge,{upgradeInfo:{type:(ve=s.value)==null?void 0:ve.type,upgradableType:(me=s.value)==null?void 0:me.upgradableType},show:n($e),onClose:t[24]||(t[24]=a=>n(se)(!1)),onConfirm:Ce,loading:n(re)},null,8,["upgradeInfo","show","loading"])])}}}),wo=fe(lo,[["__scopeId","data-v-7aaed96e"]]);export{wo as default};
