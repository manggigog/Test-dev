import{_ as W}from"./kefu-BZ7ykajd.js";import{_ as K,y as G,F as k,G as i,H as a,R as c,Q as m,w as Y,l as Z,a1 as X,r as n,z as ee,x as te,D as ae,E,K as I,a2 as q,O as S,N as L,I as oe,J as se,Y as ne,Z as re,T as J}from"./vendor-BUT0HZ5j.js";import{B as le}from"./BoutiqueGoodItemv2-ur8yUAX4.js";import{B as ue}from"./BackIcon-biFt6cm7.js";import{W as ie,r as de,a6 as ce}from"./index-k1FFr-1T.js";import{q as pe}from"./cart-D1U0eSk3.js";import{M as ve}from"./MallTabBar-UXdlrWhd.js";import{b as me}from"./mall-BnAUsXOy.js";import{_ as fe}from"./DefaultPage-0Skrrm1V.js";import"./RatioBox-ys008e7W.js";import"./GoodsPrice-Ai76_1qQ.js";import"./MCOIN-BcbOHmhy.js";import"./ShopMaskTips-dKZ6_BUi.js";import"./goods-BVwS8oFG.js";const ye={class:"bg-origin5 w-full"},he={class:"bg-white rounded-t-[12px] flex items-center gap-3 text-sm text-gray-500 p-2.5 overflow-x-auto"},ge={class:"flex flex-col justify-between ml-1 h-3"},be=G({props:{orderBy:null},emits:["change"],setup(s,{emit:l}){const f=s,p=()=>{f.orderBy!==4&&f.orderBy!==5||f.orderBy===4?l("change",5):l("change",4)};return(t,r)=>(i(),k("div",ye,[a("div",he,[a("div",{class:c(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":s.orderBy===1}]]),onClick:r[0]||(r[0]=o=>l("change",1))},m(t.$t("goods.comprehensive")),3),a("div",{class:c(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":s.orderBy===2}]]),onClick:r[1]||(r[1]=o=>l("change",2))},m(t.$t("mall.saleNum")),3),a("div",{class:c(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":s.orderBy===3}]]),onClick:r[2]||(r[2]=o=>l("change",3))},m(t.$t("flashSale.newGood")),3),a("div",{class:c(["min-w-1/4 flex items-center justify-center rounded-[6px] px-4 py-1 bg-[#F4F4F4] whitespace-nowrap",{"text-black font-medium":s.orderBy===4||s.orderBy===5}]),onClick:p},[a("span",null,m(t.$t("goods.price")),1),a("div",ge,[a("div",{class:c(["w-0 h-0 border-x-[4px] border-x-transparent border-b-[4px]",s.orderBy===5?"border-b-black":"border-b-gray-400"])},null,2),a("div",{class:c(["w-0 h-0 border-x-[4px] border-x-transparent border-t-[4px]",s.orderBy===4?"border-t-black":"border-t-gray-400"])},null,2)])],2)])]))}}),xe=K(be,[["__scopeId","data-v-3e699e18"]]),we=s=>(ne("data-v-2142ad98"),s=s(),re(),s),ke={class:"sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50 bg-origin5"},Be={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},_e={key:0,class:"font-semibold"},$e=we(()=>a("img",{class:"w-5 h-5",src:W},null,-1)),Ie=[$e],Te={class:"overflow-hidden"},Ce={class:"mall-header-bg mall-header-bg-box"},Fe={class:"bg-white h-full"},qe=G({name:"BoutiqueGood"});function Se(s){var V,A;const{t:l}=Y(),f=Z(),p=X(),t=n(null),r=n(null);t.value=((V=p.query)==null?void 0:V.shopId)||null,r.value=((A=p.query)==null?void 0:A.shopId)||null,ee(()=>{var e;return(e=p.query)==null?void 0:e.shopId},e=>{p.path==="/boutique-goods"&&(t.value=e||null,r.value!==t.value&&(r.value=t.value,o.value=null,t.value||T(),N()))},{deep:!0});const o=n(null),N=async()=>{if(!t.value)return;const e=await ie(t.value);!e.success||!e.data||(o.value=e.data,T())},y=n(1),O=e=>{y.value!==e&&(y.value=e,T())},h=n([]),g=n(!1),b=n(!1),x=n(0),j=n(10),B=n(0),d=n([]),P=te(()=>{let e={sortType:3,orderBy:1};switch(y.value){case 1:break;case 2:e.sortType=1;break;case 3:e.sortType=4;break;case 4:e.sortType=2;break;case 5:e.sortType=2,e.orderBy=2;break}return e}),Q=async()=>{var u,_;let e={};if(t.value?e=await me({page:x.value,size:j.value,status:1,merchant:(u=o.value)==null?void 0:u.merchant,type:o.value.type,...P.value}):e=await ce({page:x.value,size:j.value,status:1,sortType:y.value,merchantAddress:(_=o.value)==null?void 0:_.merchant}),!e.success||!e.data||!+e.total){b.value=!0,g.value=!1;return}B.value=e.total,d.value=e.data,t.value&&(d.value=d.value.map($=>{var w;return{...$.goods,storeName:(w=$.stores)==null?void 0:w.storeName}})),h.value=x.value===1?d.value.length>0?d.value:[]:h.value.concat(d.value),h.value.length>=B.value&&(b.value=!0)},z=async()=>{!o.value&&t.value||(g.value=!0,x.value+=1,await Q(),setTimeout(()=>{g.value=!1},1e3))},{loadingToggle:R}=de(),U=async e=>{if(e.stock===0&&e.goodsTypes!=2){J(l("order.Insufficient stock"));return}R(!0);const u=await pe(e.id);R(!1),u.success&&J(l("cart.addTips"))},T=()=>{d.value=[],h.value=[],x.value=0,B.value=0,b.value=!1,z()},C=e=>{f.push(e)};return ae(async()=>{await N()}),(e,u)=>{var w,M,D,H;const _=E("van-sticky"),$=E("VanList");return i(),k("div",{class:c([{"safe-bottom-page":t.value},"overflow-y-auto bg-white"])},[a("section",ke,[a("div",Be,[S(ue,null,{default:L(()=>[a("span",null,m(e.$t("common.return")),1)]),_:1})]),(w=o.value)!=null&&w.type?(i(),k("div",_e,m(e.$t("mall.Fine goods",{type:e.$t(`common.shop_type_${(M=o.value)==null?void 0:M.type}`)})),1)):q("",!0),(D=o.value)!=null&&D.merchant?(i(),k("div",{key:1,onClick:u[0]||(u[0]=v=>{var F;return C(`/shopInfo?address=${(F=o.value)==null?void 0:F.merchant}`)}),class:"absolute right-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},Ie)):q("",!0)]),a("div",Te,[S(_,{"offset-top":44},{default:L(()=>[a("div",Ce,[S(xe,{orderBy:y.value,onChange:O},null,8,["orderBy"])])]),_:1}),a("div",Fe,[b.value&&B.value===0?(i(),I(fe,{key:0,title:e.$t("common.No products")},null,8,["title"])):(i(),I($,{key:1,class:"pt-2 pb-5 px-2.5",loading:g.value,"onUpdate:loading":u[1]||(u[1]=v=>g.value=v),finished:b.value,"finished-text":e.$t("common.noMore"),"loading-text":e.$t("common.loading"),onLoad:z},{default:L(()=>[(i(!0),k(oe,null,se(h.value,v=>(i(),I(le,{key:v.id,data:v,onClick:F=>C(`/goodsDetail?id=${v.id}`),onHandleAddCart:U,onHandleTo:C},null,8,["data","onClick"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"]))])]),t.value?(i(),I(ve,{key:0,shopId:t.value,shopType:(H=o.value)==null?void 0:H.type},null,8,["shopId","shopType"])):q("",!0)],2)}}const Le=G({...qe,setup:Se}),Pe=K(Le,[["__scopeId","data-v-2142ad98"]]);export{Pe as default};
