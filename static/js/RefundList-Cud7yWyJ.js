import{_ as B}from"./MCOIN-Bodfn-v1.js";import{_ as N,z as j,r as u,E,G as l,H as a,P as T,$ as v,F as b,q as G,J as O,K as M,Z as C,I as s,Q as i,U as x,O as L,a4 as U,X as q,Y as H}from"./vendor-Dr_RpJ_Y.js";import{P as J}from"./flashSale-DDyqLyYN.js";import{m as K}from"./order-D0_No2Ew.js";import{u as Q}from"./useRefund-CEIg7RXJ.js";import{R as X}from"./RefundGoodItem-Drc9WgCx.js";import{C as Y}from"./CommonVanProvider-KZuKVOde.js";import{g as Z,c as W,n as ee}from"./useOrderStatus-CUBDjZMz.js";import{b as te}from"./index-7OiUoGXy.js";import"./GoodsItem-DZxsKjaZ.js";import"./credit-EZuPIBEN.js";import"./mcoin-logo-1-Deho8IWN.js";import"./useShipTemplate-VxaDU85Q.js";import"./enums-DlE-aiss.js";import"./BackIcon-CDrGaEPo.js";const se=f=>(q("data-v-010be3da"),f=f(),H(),f),ne={class:"refund-list-wrapper bg-gray1 h-full"},oe={class:"mt-3 w-full"},ae={class:"mb-3 flex items-start justify-between text-sm text-b3 font-normal"},re={class:"shrink-0"},ie={class:"text-sm whitespace-pre-wrap text-b1 text-right"},ue={class:"flex items-center justify-between text-sm text-b3 font-normal relative z-0"},le={class:"shrink-0"},ce={class:"text-sm text-b1 font-normal"},me={class:"flex justify-end whitespace-nowrap"},de={class:"text-[#FF8812] font-semibold"},fe={key:0,class:"ml-1 flex items-center"},pe=se(()=>s("img",{src:B,class:"w-4 h-4 mr-1"},null,-1)),_e={class:"font-semibold text-b1"},he={key:0},ve={key:0,class:"flex items-center ml-2 text-right"},ge={key:1,class:"flex items-center ml-2"},ye={key:1,class:"ml-2"},we=j({setup(f){const A=G(),{checkLoginAuth:I}=te(),g=u([]),p=u([]),d=u(!1),_=u(!1),y=u(0),D=u(10),k=u(0),R=async()=>{I(!0)&&(d.value=!0,y.value+=1,await V(),d.value=!1)},V=async()=>{const e=await K({page:y.value,size:D.value,status:-1,type:2,refundStatus:99,tab:2});if(d.value=!1,!e.success){_.value=!0;return}if(!e.data||!e.total){_.value=!0;return}k.value=e.total,g.value=e.data.map(n=>{var c,m;let r=null;if(w(n)==1){const t=new Date((c=n.refundInfo)==null?void 0:c.submitTime).getTime()/1e3,o=new Date().getTime()/1e3;r=Z(t,o)}else if(w(n)==2){const t=new Date((m=n.refundInfo)==null?void 0:m.expressTime).getTime()/1e3,o=new Date().getTime()/1e3;r=W(t,o)}return{...n,cutDownTimestamp:r}}),p.value=y.value===1?g.value:p.value.concat(g.value),p.value.length>=k.value&&(_.value=!0)},F=e=>Q(e,!0),w=e=>{const n=e.refundInfo||{},{refundStatus:r,returnStatus:c,merchantInterveneStatus:m}=n;return r===1?1:r===2&&c==2&&!m?2:null},P=e=>!!w(e),z=e=>{A.push(e)};return E(()=>{I(!0)&&R()}),(e,n)=>{const r=b("van-count-down"),c=b("VanList"),m=b("router-view");return a(),l("div",ne,[T(Y,{title:e.$t("order.refund title"),class:"bg-gray1 font-Puhui font-normal relative px-3 z-10","theme-vars":{"field-placeholder-text-color":"#A6A6A6"},ref:(t,o)=>{o.shopGoodsRef=t}},{default:v(()=>[T(c,{loading:d.value,"onUpdate:loading":n[0]||(n[0]=t=>d.value=t),finished:_.value,"finished-text":e.$t("common.noMore"),"loading-text":e.$t("common.loading"),onLoad:R},{default:v(()=>[(a(!0),l(O,null,M(p.value,t=>(a(),C(X,{payType:t.payType,key:t.id,"fm-stored-card":t.fmStoredCard,onClick:o=>z(`/refundDetail?id=${t.id}`),order:t,class:"mt-3"},{default:v(()=>{var o,S,$;return[s("div",oe,[s("div",ae,[s("p",re,i(e.$t("refund.reason title")),1),s("p",ie,[s("span",null,i(F(t)||" -- "),1)])]),s("div",ue,[s("p",le,i(e.$t("refund.progress title")),1),s("p",ce,[s("span",me,[s("span",de,i(L(ee)(t)),1),((o=t.refundInfo)==null?void 0:o.refundStatus)==5||t.refundInfo.refundTriggerType?(a(),l("span",fe,[pe,s("span",_e,i(t.totalAmount),1)])):x("",!0)]),P(t)?(a(),l("span",he,[t.payType!==L(J).STORE_CARD?(a(),l("span",ve,[t.cutDownTimestamp>0?(a(),C(r,{key:0,time:t.cutDownTimestamp},{default:v(h=>[U(i(e.$t("common.shop will",{time:h.days+e.$t("common.days")+h.hours+e.$t("common.hours")+h.minutes+e.$t("common.minutes")+h.seconds+e.$t("common.seconds")})),1)]),_:2},1032,["time"])):((S=t.refundInfo)==null?void 0:S.refundStatus)!=5&&!(($=t.refundInfo)!=null&&$.refundTriggerType)?(a(),l("span",ge,i(e.$t("refund.not delivered the goods")),1)):x("",!0)])):(a(),l("span",ye,i(e.$t("order.status4")),1))])):x("",!0)])])])]}),_:2},1032,["payType","fm-stored-card","onClick","order"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])]),_:1},8,["title"]),T(m,{class:"child-view"})])}}}),ze=N(we,[["__scopeId","data-v-010be3da"]]);export{ze as default};
