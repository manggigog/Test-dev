import{_ as Ne,y as _e,l as gt,x as Se,w as Ye,bM as wt,E as O,F as c,G as r,H as o,a2 as k,a3 as Gt,Q as n,P as m,a4 as ve,I as re,J as ke,R as Ce,X as et,K as L,O as A,N as I,a0 as z,T,Y as bt,Z as $t,r as y,bc as Ge,z as Ke,bd as Mt,be as ht,D as kt,ba as ce,bb as ue,bN as qt,t as Kt,o as zt,B as Re,$ as Ut,n as Yt,a1 as Wt,bO as Jt}from"./vendor-CjApaIpB.js";import{_ as Ct}from"./avatarRing-DpEnkbQ2.js";import{_ as Zt}from"./address-BEqE8lWA.js";import{G as Qt}from"./GoodsItem-Dpn1zj4M.js";import{_ as Xt}from"./CountdownLabel-BY1DjkiB.js";import{e as ze,o as nt,b as tt,l as Q,u as At,R as es,C as ts,a_ as Tt,a3 as ss,d as xt}from"./index-CduCwCyL.js";import{u as It,f as os}from"./useOrderStatus-DMn11Py2.js";import{c as st,n as ot,l as Ue,v as as,w as ns,x as rs,y as ls,z as is,a as ds}from"./order-aGzmIXWB.js";import{P as Me}from"./flashSale-DDyqLyYN.js";import{g as qe}from"./orderTime-Ct6bcBR3.js";import{h as at,S as cs,M as us}from"./MerchantRefund-MpNXhmlG.js";import{e as ms}from"./excel-BtFGf-Fb.js";import{_ as St}from"./selected-icon-DEJAhYK1.js";import{_ as fs}from"./credit-Chkxk9-q.js";import{_ as ps}from"./MCOIN-BcbOHmhy.js";import{B as vs}from"./BackIcon-D2Vm_lyR.js";import{C as hs}from"./ChangeRegion-Bkwu4vRr.js";import xs from"./SellerOneSaleOrder-0_2tkJTG.js";import"./mcoin-logo-1-BPG653EL.js";import"./useShipTemplate-DGyxlJb1.js";import"./enums-DlE-aiss.js";import"./copy-w-7FY5xbhR.js";import"./UnfreezePop-BW9-LXd4.js";import"./ApproveButton-DQWK4KIt.js";import"./refund-BlwyJney.js";import"./useRefundStatus-BOTs0ra-.js";import"./filter-C_V9W5ek.js";import"./category-C1RWK50_.js";import"./ChangeRegionPop-y40zTO9y.js";import"./DeliveredItem-5GTSFW19.js";import"./GoodsItem-CqvfUUWN.js";import"./luckyShopContract-DO_d2myb.js";const ys="/Test-dev/static/images/mark-Dmikp-39.svg",We=t=>(bt("data-v-86317d8e"),t=t(),$t(),t),gs={class:"gap-2 flex-center-bw"},ws=We(()=>o("div",{class:"w-8 h-8"},[o("img",{src:Ct,class:"w-full h-full rounded-md",alt:"",fit:"cover"})],-1)),bs={class:"flex flex-col justify-center flex-1 h-8 text-default"},$s={class:"text-sm font-semibold flex flex-row justify-start items-center align-middle"},ks={key:0,class:"flex flex-row justify-start items-center"},Cs={class:"text-primary ml-auto text-sm leading-[20px] align-middle"},As={key:0},Ts={key:1},Is={key:2},Ss={class:"text-xs leading-[18px] opacity-60"},_s={key:0},Rs={key:1},Ns={key:2},Os=We(()=>o("span",null,"...",-1)),Ls=[Os],Bs={class:"mt-4 pt-4 break-all flex flex-row justify-start items-start border-t-[1px] border-[#e0e0e0] border-solid"},Es=We(()=>o("div",{class:"min-w-[20px]"},[o("img",{src:Zt,class:"inline-block w-[20px]"})],-1)),Ps={class:"ml-1"},Ds={key:0,class:"text-sm text-[#585654] font-semibold"},Fs={key:1,class:"mt-1 text-sm text-[#a6a6a6] font-normal"},Vs={key:1,class:"mt-2 break-all flex flex-row justify-start items-start"},Hs=We(()=>o("div",{class:"min-w-[20px]"},[o("img",{src:ys,class:"inline-block w-[20px]"})],-1)),js={class:"ml-1"},Gs={class:"text-sm text-[#a6a6a6] font-normal line-clamp-2"},Ms={key:2,class:"pt-2.5 text-xs text-[#B9B9B9]"},qs={class:"items-center inline"},Ks={class:"block"},zs={class:"colon"},Us={class:"block"},Ys={class:"colon"},Ws={class:"block"},Js={class:"colon"},Zs={class:"block"},Qs={class:"colon"},Xs={key:1,class:"text-right"},eo={key:3,class:"flex justify-end mt-3 gap-2"},to=_e({props:{order:null,isService:{type:Boolean},nowTime:null,tab:null},emits:["open"],setup(t,{emit:V}){const v=t,{accountStore:e}=ze(),{clerkStore:f}=ze(),C=gt(),S=Se(()=>(v.order.orderGoods||[]).some(D=>D.buyFlag)),_=Se(()=>{var d,$;return(($=(d=v.order)==null?void 0:d.orderLabelList)==null?void 0:$.filter(D=>D==null?void 0:D.id))||[]}),B=It(v.order.refundStatus,v.order.payType),{t:b}=Ye(),me=d=>{v.isService||C.push(d)},h=()=>{v.isService||C.push(`/sellerOrderDetail?id=${v.order.id}`)},g=()=>{if(e.isOnlyView)return T(b("order.Requires merchant account operation"));C.push(`/sellerDelivery?id=${v.order.id}`)},U=()=>{if(e.isOnlyView)return T(b("order.Requires merchant account operation"));C.push({name:"SellerOrderDetail",query:{id:v.order.id},params:{quick:"quackChange"}})},se=()=>{location.reload()},E=wt("openBatchReceiptPop",null),{merchantConfirm:oe}=nt(),R=async d=>{if(e.isOnlyView)return T(b("order.Requires merchant account operation"));if(f.isClerk&&!f.clerkAuth)return T(b("order.Requires merchant account operation"));if(E){E(d);return}d.loading=!0;try{const D=(await st({orderIds:d.id})).data.ordIds,W=await oe(D);if(!W.success)return;if(d.payType!==Me.STORE_CARD){if(!(await ot({ordIds:D,hash:W.result.hash})).success)return;d.merchantsConfirm=1,T.success(b("order.confirmSuccess")),C.replace({path:"/sellerOrderList",query:{active:3,type:1}})}}finally{d.loading=!1}},N=d=>{if(e.isOnlyView)return T(b("order.Requires merchant account operation"));V("open",d)},Y=d=>{if(e.isOnlyView)return T(b("order.Requires merchant account operation"));const $=d.userAddress.address;tt(d.userAddress.address,"...",5,5),C.push(`/sellerOrderList-orderHistory?address=${$}&source=merchants`)};return(d,$)=>{var q,p;const D=O("van-count-down"),W=O("VanButton");return r(),c("div",{class:"px-3 mt-3 bg-white rounded-xl py-3",onClick:h},[o("div",gs,[ws,o("div",bs,[o("div",$s,[t.order.userAddress&&t.order.userAddress.address?(r(),c("div",ks,[o("p",null,n(m(tt)(t.order.userAddress.address,"...",5,5)),1)])):k("",!0),o("div",Cs,[t.order.status==-1?(r(),c("span",As,n(d.$t("order.canceled")),1)):t.order.status===0&&t.order.hash?(r(),c("span",Ts,n(d.$t("order.wait block chain")),1)):(r(),c("span",Is,n(m(B)[t.order.status+""]),1))])]),o("div",Ss,[t.order.status==4?(r(),c("span",_s,n(m(Q)(t.order.finishTime))+" "+n(d.$t("common.finish")),1)):t.order.status==2?(r(),c("span",Rs,n(m(Q)(t.order.expressTime))+" "+n(d.$t("order.Ship")),1)):(r(),c("span",Ns,n(m(Q)(t.order.createTime))+" "+n(d.$t("order.buied")),1))])])]),m(_).length?(r(),c("ul",{key:0,class:"w-full flex justify-start items-center mt-[16px] text-white overflow-x-scroll",onClick:$[1]||($[1]=ve(i=>N(t.order),["stop"]))},[m(_).length>0?(r(),c(re,{key:0},[(r(!0),c(re,null,ke(m(_).slice(0,5),i=>(r(),c("li",{style:et({backgroundColor:m(at)(i==null?void 0:i.colorHex,.12),color:i==null?void 0:i.colorHex}),class:Ce(["text-xxs h-[22px] rounded-[4px] px-[8px] py-1 mr-1 flex justify-center items-center font-normal whitespace-nowrap",{"w-[22px]":!(i!=null&&i.content)}]),key:i==null?void 0:i.id},n(i==null?void 0:i.content),7))),128)),m(_).length>5?(r(),c("li",{key:0,class:"bg-[#f5f5f5] text-default text-xxs w-[25px] h-[22px] rounded-[4px] py-1 mr-1 flex justify-center items-center",onClick:$[0]||($[0]=ve(i=>N(t.order),["stop"]))},Ls)):k("",!0)],64)):k("",!0)])):k("",!0),(r(!0),c(re,null,ke(t.order.orderGoods,i=>(r(),L(Qt,{class:"goods-item",creditFlag:t.order.creditFlag,payType:t.order.payType,key:i.goodsName,goods:i,storeCard:t.order.fmStoredCard,refundStatus:t.order.refundStatus,onHandleTo:me,tab:v.tab},null,8,["creditFlag","payType","goods","storeCard","refundStatus","tab"]))),128)),o("div",Bs,[Es,o("div",Ps,[t.order.userAddress?(r(),c("div",Ds,n(t.order.userAddress.provinceName??"")+n(t.order.userAddress.cityName??"")+n(t.order.userAddress.countyName??"")+n(t.order.userAddress.detailInfo??""),1)):k("",!0),t.order.userAddress?(r(),c("div",Fs,n(t.order.userAddress.userName)+" "+n(t.order.userAddress.telNumber),1)):k("",!0)])]),(q=t.order.userAddress)!=null&&q.postscript?(r(),c("div",Vs,[Hs,o("div",js,[o("div",Gs,n(((p=t.order.userAddress)==null?void 0:p.postscript)||d.$t("order.noRemark")),1)])])):k("",!0),t.order.status===2?(r(),c("div",Ms,[m(qe)(t.order.expressTime,t.order.confirmLimit,t.nowTime)>0?(r(),c(re,{key:0},[o("div",null,n(d.$t("order.observeTip")),1),o("div",qs,[A(D,{class:"order-time",time:m(qe)(t.order.expressTime,t.order.confirmLimit,t.nowTime)},{default:I(i=>[o("span",Ks,n(i.days),1),o("span",zs,n(d.$t("common.day")),1),o("span",Us,n(i.hours),1),o("span",Ys,n(d.$t("common.hours")),1),o("span",Ws,n(i.minutes),1),o("span",Js,n(d.$t("common.minutes")),1),o("span",Zs,n(i.seconds),1),o("span",Qs,n(d.$t("common.seconds")),1)]),_:1},8,["time"]),o("span",null,n(d.$t("order.sellConfirmTip")),1)])],64)):t.order.payType===m(Me).WITHDRAW_POINTS&&!t.order.merchantsConfirm?(r(),c("div",Xs,n(d.$t("order.sellConfirm")),1)):k("",!0)])):k("",!0),t.isService?k("",!0):(r(),c("div",eo,[!m(e).isOnlyView&&m(S)?(r(),L(W,{key:0,class:"bg-[#f5f5f5] rounded-md h-[32px] px-3 text-[#585654] text-sm font-normal",onClick:$[2]||($[2]=ve(i=>Y(t.order),["stop"]))},{default:I(()=>[z(n(d.$t("order.orderHistoryBuy")),1)]),_:1})):k("",!0),m(e).isOnlyView?k("",!0):(r(),L(W,{key:1,class:"bg-[#f5f5f5] rounded-md h-[32px] px-3 text-[#585654] text-sm font-normal",onClick:$[3]||($[3]=ve(i=>N(t.order),["stop"]))},{default:I(()=>[z(n(d.$t("order.orderAddTag")),1)]),_:1})),!m(e).isOnlyView&&t.order.status===1?(r(),L(W,{key:2,class:"bg-btnOrBg rounded-md h-[32px] px-3 text-default text-sm font-normal",onClick:ve(g,["stop"])},{default:I(()=>[z(n(d.$t("order.Ship")),1)]),_:1},8,["onClick"])):k("",!0),!m(e).isOnlyView&&t.order.status===0&&!t.order.hash?(r(),L(W,{key:3,class:"bg-btnOrBg rounded-md h-[32px] px-3 text-default text-sm font-normal",onClick:ve(U,["stop"])},{default:I(()=>[z(n(d.$t("order.modifyPrice")),1),A(Xt,{class:"inline-block ml-1 whitespace-nowrap",startTime:t.order.createTime,duration:15,durationType:"minutes",showZero:!1,onTimeDone:se},null,8,["startTime"])]),_:1},8,["onClick"])):k("",!0),!m(e).isOnlyView&&t.order.status===2&&t.order.payType!==m(Me).STORE_CARD&&!t.order.merchantsConfirm?(r(),L(W,{key:4,class:Ce(["bg-btnOrBg rounded-md min-w-[80px] h-[32px] px-3 text-default text-sm font-semibold",{"opacity-50":!!m(e).isOnlyView}]),disabled:m(qe)(t.order.expressTime,t.order.confirmLimit,t.nowTime)>0,loading:t.order.loading,onClick:$[4]||($[4]=ve(i=>R(t.order),["stop"]))},{default:I(()=>[z(n(d.$t("order.confirmGeted")),1)]),_:1},8,["class","disabled","loading"])):k("",!0)])),Gt(d.$slots,"default",{},void 0,!0)])}}}),so=Ne(to,[["__scopeId","data-v-86317d8e"]]),oo={class:"bg-[#f2f0ef]"},ao={class:"px-[20px] pt-[18px] pb-[15px] flex justify-between bg-white z-40 text-[14px] items-center absolute top-0 left-0 right-0"},no={class:"text-[#222221] text-[16px]"},ro={class:"tagForm"},lo={class:"text-[#222221] mb-[10px]"},io={class:"mt-[30px]"},co={key:0,class:"text-center mt-[150px]"},uo={class:"h-[96px] p-[16px] flex flex-col justify-center items-center fixed bottom-0 left-0 right-0 bg-white"},mo={class:"mt-[8px] text-[#5D5A56] text-[12px] leading-none"},fo={class:"p-[16px] flex justify-center fixed bottom-0 left-0 right-0 bg-white"},po=_e({props:{value:null},setup(t,{expose:V}){const{value:v}=t,{t:e}=Ye(),f=y(null),{getCurrentStoreId:C}=At(),{getMerchantDhKey:S,decryptAddressKey:_,decryptKey:B,cryptoAESWithSearch:b}=es(),[me,h]=Ge(!1),g=y(0);Ke(()=>v,a=>{g.value=a},{immediate:!0});const U=Mt({refundTabList:[{id:1,name:e("order.applying")},{id:2,name:e("order.refund block confirmation")},{id:3,name:e("order.refund completed")},{id:4,name:e("order.refund rejection")},{id:5,name:e("order.cancellation refund")},{id:10,name:e("order.platform intervention")},{id:11,name:e("order.platforms step in to support buyers")},{id:12,name:e("order.platform intervention to support sellers")},{id:13,name:e("order.freeze thawed")},{id:14,name:e("order.user forced liquidation")},{id:20,name:e("order.Long time no delivery")},{id:30,name:e("refund.refund success tips")}],statusTabList:[{id:0,name:e("order.waitPay")},{id:1,name:e("order.wait")},{id:2,name:e("order.already")},{id:3,name:e("order.fail")},{id:4,name:e("order.trade success")},{id:5,name:e("order.trade close")},{id:6,name:e("order.trade close")},{id:7,name:e("order.platform intervention")},{id:8,name:e("order.canceled")},{id:-1,name:e("order.canceled")}]}),se=Se(()=>[{id:0,name:e("order.waitPay")},{id:1,name:e("order.wait")},{id:2,name:e("order.already")},{id:4,name:e("order.completed")},{id:-1,name:e("order.all")}]),E=os(),oe=a=>a.fmRefundReason?a.fmRefundReason[E]:"",R=y(""),N=y([]),Y=y(!1),d=y(!1),$=y(1),D=y(30),W=y(0),q=y({}),p=y(!1),i=y(0),ae=async()=>{$.value+=1,await xe(q.value)},K=y([]),he=async a=>{d.value=!1,N.value=[],$.value=1,await xe(a)},Ae=()=>{if(R.value&&R.value.length<2)return T(e("common.Please enter at least two keywords"));he(q.value)},xe=a=>new Promise(async u=>{var de,G,ee,Te,be,x,P,te,s,je,Ee,Pe,De,M,Fe,ut,mt,ft,pt;Y.value&&u(),q.value=Object.keys(a).length>0?a:q.value;let j=null;p.value&&(j=Math.ceil((i.value+1)/D.value)),Y.value=!0;let pe=g.value,ne=null;R.value&&(ne=await b(R.value));const Z={page:j||$.value,size:D.value,status:se.value[g.value].id,type:1,keyword:ne,keywordPlain:R.value,storeId:(de=await C())==null?void 0:de.id,...a};(a.waitBuyerReceive||a.waitSellerReceive)&&(console.log("有过滤收货状态"),Z.status=2);const F=await Ue(Z);if(!F.success){d.value=!0;return}if(!F.data||!F.total){d.value=!0,Y.value=!1;return}if(pe!==g.value)return;(F==null?void 0:F.total)===0&&(N.value=[]),W.value=F.total;const X=[];for(let Ve=0;Ve<F.data.length;Ve++){let Ie="";const l=F.data[Ve];if(l.userAddress&&(l.userAddress.postscript=l.postscript),l.userAddress&&((G=l.userAddress)!=null&&G.encryptFlag)){const $e=await S(l.address,l.submitUserPubKey);$e&&(l.userAddress=_(l.userAddress,$e),(ee=l.userAddress)!=null&&ee.success&&!l.merchantEns&&(Ie+=((Te=l.userAddress)==null?void 0:Te.userName)+((be=l.userAddress)==null?void 0:be.telNumber)+(((x=l.userAddress)==null?void 0:x.postalCode)??"")+((P=l.userAddress)==null?void 0:P.provinceName)+((te=l.userAddress)==null?void 0:te.cityName)+((s=l.userAddress)==null?void 0:s.countyName)+((je=l.userAddress)==null?void 0:je.detailInfo)+((Ee=l.userAddress)==null?void 0:Ee.postscript)))}else l.merchantEns||(Ie+=((Pe=l.userAddress)==null?void 0:Pe.userName)+((De=l.userAddress)==null?void 0:De.telNumber)+(((M=l.userAddress)==null?void 0:M.postalCode)??"")+((Fe=l.userAddress)==null?void 0:Fe.provinceName)+((ut=l.userAddress)==null?void 0:ut.cityName)+((mt=l.userAddress)==null?void 0:mt.countyName)+((ft=l.userAddress)==null?void 0:ft.detailInfo)+((pt=l.userAddress)==null?void 0:pt.postscript));if(l.shippingHash){const $e=await S(l.address,l.shippingUserPubKey);if($e){const vt=B(l.expressNo,$e);vt.hash===l.shippingHash&&(l.expressNo=vt.decrypt,l.expressCompany=B(l.expressCompany,$e).decrypt,l.merchantEns||(Ie+=(l==null?void 0:l.expressNo)+(l==null?void 0:l.expressCompany)))}}else l.merchantEns||(Ie+=(l==null?void 0:l.expressNo)+(l==null?void 0:l.expressCompany));if(l.merchantEns||(Ie+=(l==null?void 0:l.hash)+(l==null?void 0:l.address)),Ie)try{X.push({id:l.id,merchantEns:await b(Ie)})}catch($e){console.log($e)}}const w=X.filter(Ve=>Ve.merchantEns);w.length>0&&as({enInfoList:w}),K.value=F.data,p.value?(N.value.splice((j-1)*D.value,D.value,...K.value),p.value=!1):N.value=$.value===1?K.value:N.value.concat(K.value),N.value.length>=W.value&&(d.value=!0),Y.value=!1,u()}),Oe=async a=>{f.value.handleReset(!1),Tt.replace({path:"sellerOrderList",query:{type:1,active:a}}),g.value=a,Y.value=!1,Ft()},_t=async a=>{var P,te;const u=navigator.userAgent.toLowerCase(),j=/mobile|android|iphone|ipad|phone/i.test(u),pe=/tablet|ipad/i.test(u),ne=/webview|wv/i.test(u),Z=/fbav|instagram|line|twitter|whatsapp/i.test(u),F=/metamask/i.test(u),X=/tokenpocket/i.test(u),w=(window==null?void 0:window.$onekey)||!1;if(Kt.isConnected()){h(!0);return}if(w){h(!0);return}if((j||pe)&&(ne||Z||F||X||w)&&!window.chrome&&!window.safari){h(!0);return}let de=null;R.value&&(de=await b(R.value));const G={page:1,size:99999,status:se.value[g.value].id,type:1,keyword:de,keywordPlain:R.value,storeId:(P=await C())==null?void 0:P.id,...a};(a.waitBuyerReceive||a.waitSellerReceive)&&(console.log("导出-有过滤收货状态"),G.status=2),T.loading({duration:0,message:e("common.loading")});const ee=await Ue(G);if(!ee.success||!ee.data||ee.data.length===0){T.clear(),T(e("common.No data download"));return}const Te=ee.data.map(s=>new Promise(async je=>{var Ee,Pe,De;if(s!=null&&s.userAddress&&(s.userAddress.postscript=s.postscript),s!=null&&s.userAddress&&((Ee=s==null?void 0:s.userAddress)!=null&&Ee.encryptFlag)){const M=await S(s.address,s==null?void 0:s.submitUserPubKey);M&&(s.userAddress=_(s.userAddress,M))}if(s!=null&&s.shippingHash){const M=await S(s.address,s==null?void 0:s.shippingUserPubKey);if(M){const Fe=B(s.expressNo,M);Fe.hash===s.shippingHash&&(s.expressNo=Fe.decrypt,s.expressCompany=B(s.expressCompany,M).decrypt)}}je([{text:s.id},{text:s.address},{text:s.hash||""},{text:s.orderGoods&&s.orderGoods.length?Le(s.orderGoods,"goodsName"):""},{text:s.orderGoods&&s.orderGoods.length?Le(s.orderGoods,"goodsId"):""},{text:s.orderGoods&&s.orderGoods.length?Le(s.orderGoods,"number"):0},{text:s.orderGoods&&s.orderGoods.length?Le(s.orderGoods,"price"):0},{text:((Pe=U.statusTabList.find(M=>M.id==s.status))==null?void 0:Pe.name)||""},{text:s.totalAmountOriginal||0},{text:s.merchantAdjustAmount||0},{text:s.activityReduceAmount||0},{text:s.voucherAmount||0},{text:Rt(s)},{text:s.orderGoods&&s.orderGoods.length?Le(s.orderGoods,"discountRatio","%"):"0%"},{text:s.createTime?Q(s.createTime):""},{text:s.chainCreateTime?Q(s.chainCreateTime):""},{text:s.expressTime?Q(s.expressTime):""},{text:s.finishTime?Q(s.finishTime):""},{text:s.userAddress.postscript||""},{text:`${s.userAddress.provinceName??""}${s.userAddress.cityName??""}${s.userAddress.countyName??""}${s.userAddress.detailInfo??""} ${s.userAddress.userName??""} ${s.userAddress.telNumber??""}`},{text:s.creditFlag?e("common.yes"):e("common.no")},{text:s.merchantsConfirm?e("common.yes"):e("common.no")},{text:s.orderLabelList.map(M=>M.content).join(",")},{text:s.expressCompany||""},{text:s.expressNo||""},{text:oe(s)},{text:((De=U.refundTabList.find(M=>M.id==s.refundStatus))==null?void 0:De.name)||""},{text:s.refundTime?Q(s.refundTime):""},{text:s.refundSuccessTime?Q(s.refundSuccessTime):""},{text:s.refundCancelTime?Q(s.refundCancelTime):""}])})),be=await Promise.all(Te);if(!be||be.length===0){T.clear(),T(e("common.No data download"));return}const x=[{text:e("order.export.orderId")},{text:e("order.export.buyerAddress")},{text:e("order.export.transactionHash")},{text:e("order.export.goodsName")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.export.goodsId")+"("+e("order.export.goodsId-tips")+")"},{text:e("order.export.goodsNumber")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.goodsPrice")+"("+e("order.export.goodsName-tips")+")"},{text:e("order.orderStatus")},{text:e("order.export.goodsPrice total")},{text:e("order.merchant modify price total")},{text:e("order.export.activityReduceAmount total")},{text:e("voucher.voucher_deduction total")},{text:e("order.export.actualAmount total")},{text:e("common.ratio")},{text:e("order.createTime")},{text:e("order.export.paymentTime")},{text:e("order.Shipping time")},{text:e("order.Complete time")},{text:e("order.remark")},{text:e("order.receive address")},{text:e("order.export.isCreditReceive")},{text:e("order.export.merchantsConfirm")},{text:e("order.export.orderLabelList")},{text:e("order.deliveryCompany")},{text:e("order.deliveryId")},{text:e("refund.RefundReason")},{text:e("refund.refundStatus")},{text:e("refund.refundTime")},{text:e("refund.refundSuccessTime")},{text:e("refund.refundCancelTime")}];try{const s=((te=await C())==null?void 0:te.storeName)+"_"+zt().format("YYYY-MM-DD HH:mm:ss");ms([x,...be],{excelName:s,worksheet:"sheet"}),T.clear()}catch{T.clear()}},rt=()=>{h(!1)},Rt=a=>{const u=new Re(a.totalAmountOriginal).plus(new Re(a.merchantAdjustAmount||0)).minus(new Re(a.activityReduceAmount||0)).minus(new Re(a.voucherAmount||0)).toNumber();return Nt(u)},Nt=a=>Number.isInteger(a)?a.toString():a.toFixed(4).replace(/\.?0+$/,""),Le=(a,u,j)=>a.map(ne=>{let Z=ne[u];return j&&(Z=Z+j),Z}).join(","),Be=y(!1),fe=y(!1),H=y(!1),le=y(null),ye=y([]),ge=y(""),Je=y([]),we=y([]),ie=y(null),Ze=y(null),J=y({content:"",colorHex:"",id:null,shopId:null}),lt=y(null),it=y([{id:null,content:"",colorHex:"#D4380D"},{id:null,content:"",colorHex:"#E58312"},{id:null,content:"",colorHex:"#DEAD0E"},{id:null,content:"",colorHex:"#389E0D"},{id:null,content:"",colorHex:"#0958D9"},{id:null,content:"",colorHex:"#531DAB"}]),Ot=(a,u)=>{i.value=u,Be.value=!0,lt.value=a.id,Ze.value=a.stores.id,a.orderLabelList&&(ye.value=a.orderLabelList.map(j=>j.id)),He()},Lt=a=>{H.value=!0,a.id&&(ie.value=a.id,le.value=a.content,J.value.id=a.id,J.value.colorHex=a.colorHex,ge.value=a.colorHex,Je.value=ye.value)},Bt=()=>{H.value=!0,ie.value=null,le.value=null,J.value.id=null,J.value.colorHex=null,ge.value="",Je.value=ye.value},Qe=()=>{H.value=!1,ye.value=Je.value,ie.value=null,we.value.length=0,le.value=null,ge.value="",He()},dt=()=>{Be.value=!1,ie.value=null,ye.value=[],He(),f.value.onLoadTagList()},He=()=>{we.value=[],ns({page:1,size:300,shopId:Ze.value}).then(a=>{a==null||a.data.forEach(u=>{we.value.push({id:u.id,content:u.content,colorHex:u.colorHex})})})},Et=()=>{var a;if(!fe.value){if(((a=ge.value)==null?void 0:a.length)===0){T.fail(e("order.Please select a color"));return}else J.value.colorHex=ge.value,J.value.id=ie.value,J.value.content=le.value,J.value.shopId=Ze.value;J.value.content&&(J.value.content=J.value.content.trim()),ie.value||delete J.value.id,fe.value=!0,rs(J.value).then(u=>{u.msg==="SUCCESS"&&(H.value=!1,we.value=[],ge.value="",le.value=null,He(),p.value=!0,xe(q.value),T(e("order.Save success")))}).finally(()=>{fe.value=!1})}},Pt=()=>{fe.value||(fe.value=!0,ls({id:ie.value}).then(a=>{a.msg==="SUCCESS"?(T(e("order.Delete success")),p.value=!0,xe(q.value),Qe()):T(e("order.Delete failed"))}).finally(()=>{fe.value=!1}))},Dt=async()=>{fe.value||(fe.value=!0,await is({orderId:lt.value,orderLabelIds:ye.value.join(",")}).then(a=>{if((a==null?void 0:a.msg)==="SUCCESS")Be.value=!1,H.value=!1,le.value="",T(e("order.Save success")),p.value=!0,xe(q.value);else{T(e("order.Save failed"));return}}).finally(()=>{fe.value=!1}))},Ft=()=>{d.value=!1,$.value=1,N.value=[],xe({})},Xe=y(new Date().getTime()/1e3),ct=async()=>{Xe.value=await ss()};ht(()=>{Xe.value+=1},1e3),ht(()=>{ct()},6e4);const Vt=y(null),Ht=async()=>{var u,j,pe,ne,Z,F,X;const a=sessionStorage.getItem("modifiedOrderId");if(a)try{const w=await ds({id:a});if(w.success&&w.data){if((u=w.data)!=null&&u.userAddress&&(w.data.userAddress.postscript=w.data.postscript),(j=w.data)!=null&&j.userAddress&&((ne=(pe=w.data)==null?void 0:pe.userAddress)!=null&&ne.encryptFlag)){const G=await S(w.data.address,(Z=w.data)==null?void 0:Z.submitUserPubKey);G&&(w.data.userAddress=_(w.data.userAddress,G))}if((F=w.data)!=null&&F.shippingHash){const G=await S(w.data.address,(X=w.data)==null?void 0:X.shippingUserPubKey);if(G){const ee=B(w.data.expressNo,G);ee.hash===w.data.shippingHash&&(w.data.expressNo=ee.decrypt,w.data.expressCompany=B(w.data.expressCompany,G).decrypt)}}const de=N.value.findIndex(G=>G.id===parseInt(a));de!==-1?Object.assign(N.value[de],w.data):console.log("未找到要更新的订单，ID:",a)}}catch{}finally{sessionStorage.removeItem("modifiedOrderId")}},jt=async()=>{N.value.length>0&&await Ht()};return kt(async()=>{var a;ct(),xe({}),Vt.value=(a=await C())==null?void 0:a.merchant}),V({handleChangeTab:Oe,active:g,updateModifiedOrders:jt}),(a,u)=>{const j=O("Empty"),pe=O("VanList"),ne=O("VanTab"),Z=O("VanTabs"),F=O("van-field"),X=O("van-icon"),w=O("van-radio"),de=O("van-radio-group"),G=O("van-checkbox"),ee=O("van-checkbox-group"),Te=O("van-button"),be=O("van-action-sheet");return r(),c(re,null,[A(Z,{active:g.value,"onUpdate:active":u[2]||(u[2]=x=>g.value=x),onChange:Oe,background:"#f2f0ef",sticky:"","offset-top":"44"},{"nav-bottom":I(()=>[o("div",oo,[A(cs,{modelValue:R.value,"onUpdate:modelValue":u[0]||(u[0]=x=>R.value=x),onOnSubmit:Ae,onGetList:he,noType:!0,ref:(x,P)=>{P.searchBox=x,f.value=x},active:g.value,onOnExport:_t},null,8,["modelValue","active"])])]),default:I(()=>[(r(!0),c(re,null,ke(m(se),x=>(r(),L(ne,{title:x.name,key:x.id},{default:I(()=>[N.value.length===0&&!Y.value?(r(),L(j,{key:0,name:"没有订单",class:"py-6"})):k("",!0),A(pe,{loading:Y.value,"onUpdate:loading":u[1]||(u[1]=P=>Y.value=P),finished:d.value,"finished-text":a.$t("common.noMore"),"loading-text":a.$t("common.loading"),onLoad:ae},{default:I(()=>[(r(!0),c(re,null,ke(N.value,(P,te)=>(r(),L(so,{key:P.id,order:P,onOpen:s=>Ot(s,te),nowTime:Xe.value,tab:x},null,8,["order","onOpen","nowTime","tab"]))),128))]),_:2},1032,["loading","finished","finished-text","loading-text"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"]),A(be,{show:Be.value,"onUpdate:show":u[8]||(u[8]=x=>Be.value=x),closeable:!1,class:"h-[70vh]",onCancel:Qe,onClose:dt},{default:I(()=>[o("div",ao,[ce(o("div",{class:"text-[#5D5A56] w-[60px]",onClick:Qe},n(a.$t("common.closed")),513),[[ue,H.value]]),ce(o("div",{class:"text-[#5D5A56] w-[30px]",onClick:dt},n(a.$t("common.closed")),513),[[ue,!H.value]]),o("div",no,n(ie.value?a.$t("common.editTag"):a.$t("common.addTag")),1),ce(o("div",{class:"text-[#A45E00] w-[30px]",onClick:Bt},n(a.$t("piggy.add")),513),[[ue,!H.value]]),ce(o("div",{class:"text-[#A45E00] w-[30px]",onClick:Et},n(a.$t("common.save")),513),[[ue,H.value]])]),o("div",{class:Ce(["mt-[53px] px-[20px]",H.value&&ie.value?"pb-[96px]":"pb-[72px]"])},[A(qt,{name:"van-slide-up"},{default:I(()=>[ce(o("div",ro,[o("div",lo,n(a.$t("common.NameOptional")),1),A(F,{modelValue:le.value,"onUpdate:modelValue":u[3]||(u[3]=x=>le.value=x),maxlength:"5",placeholder:a.$t("common.pleaseEnter")},null,8,["modelValue","placeholder"]),o("div",io,n(a.$t("common.color")),1)],512),[[ue,H.value]])]),_:1}),ce(A(de,{modelValue:ge.value,"onUpdate:modelValue":u[4]||(u[4]=x=>ge.value=x),max:1},{default:I(()=>[(r(!0),c(re,null,ke(it.value,(x,P)=>(r(),L(w,{name:x.colorHex,key:P,class:"relative flex checkedList"},{icon:I(te=>[te.checked?(r(),L(X,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[23px] border-0 top-[1px] bg-transparent",size:"30"})):k("",!0)]),default:I(()=>[o("div",{style:et({backgroundColor:m(at)(x.colorHex,.12),color:x.colorHex}),class:Ce(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",P<it.value.length-1?"mb-[16px]":""])},n(x.content||le.value),7)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),[[ue,H.value]]),!H.value&&we.value.length==0?(r(),c("div",co,n(a.$t("common.NoLabels")),1)):k("",!0),ce(A(ee,{modelValue:ye.value,"onUpdate:modelValue":u[5]||(u[5]=x=>ye.value=x),max:5},{default:I(()=>[(r(!0),c(re,null,ke(we.value,(x,P)=>(r(),L(G,{name:x.id,key:P,class:"relative flex radioList"},{icon:I(te=>[te.checked?(r(),L(X,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[40px] border-0 top-[1px] bg-transparent",size:"30"})):k("",!0)]),default:I(()=>[o("div",{style:et({backgroundColor:m(at)(x.colorHex,.12),color:x.colorHex}),class:Ce(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",P<we.value.length-1?"mb-[16px]":""])},n(x.content||le.value),7),o("div",null,[A(X,{name:"edit",class:"absolute right-[1px] top-[1px]",color:"#543E3E",size:"30",onClick:ve(te=>Lt(x),["stop"])},null,8,["onClick"])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),[[ue,!H.value]]),ce(o("div",uo,[A(Te,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"shrink-0 w-[180px] my-0 h-[40px] rounded-[20px]",onClick:u[6]||(u[6]=x=>Pt()),block:""},{default:I(()=>[z(n(a.$t("common.RemoveTag")),1)]),_:1}),o("div",mo,[A(X,{name:"question-o",size:"12",class:"mr-[8px]"}),z(n(a.$t("common.AllOrderLabelsCannotBeViewedAfterRemoval")),1)])],512),[[ue,H.value&&ie.value]])],2),ce(o("div",fo,[A(Te,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"w-[180px] my-0 h-[40px] rounded-[20px]",onClick:u[7]||(u[7]=x=>Dt()),block:""},{default:I(()=>[z(n(a.$t("common.ConfirmSelection")),1)]),_:1})],512),[[ue,!H.value&&we.value.length>0]])]),_:1},8,["show"]),A(ts,{show:m(me),title:"导出账单",content:"请在PC端操作账单导出",showConfirm:!0,showReject:!1,confirmText:"我知道了",rejectText:"拒绝",onClose:rt,onConfirm:rt},null,8,["show"])],64)}}}),vo=Ne(po,[["__scopeId","data-v-0f54cada"]]),ho={},xo={class:"dot w-[8px] h-[8px] rounded-full bg-[red] absolute top-0 right-[-10px]"};function yo(t,V){return r(),c("div",xo)}const go=Ne(ho,[["render",yo]]),wo={class:"py-[20px] flex-start gap-2"},bo={class:"w-20 h-20"},$o={class:"flex flex-col justify-between flex-1 h-20 gap-2"},ko={class:"flex-1 text-sm text-default"},Co={class:"w-full flex flex-row justify-start items-center gap-2 line-clamp-1"},Ao={class:"max-w-[150px] font-semibold line-clamp-1"},To={key:0,class:"flex-shrink-0 flex items-center text-xs text-[#34C2A9]"},Io=o("img",{src:fs,class:"w-5 h-5"},null,-1),So={class:"ml-auto text-sm text-default opacity-60 whitespace-nowrap"},_o={class:"mt-0 text-sm font-normal text-[#a6a6a6]"},Ro={class:"flex flex-row justify-end"},No={class:"text-sm text-[#a6a6a6] font-normal mr-1"},Oo={key:0,class:"text-newOrigin text-sm flex-start gap-[2px]"},Lo=["src"],Bo={class:"font-semibold"},Eo={class:"text-sm font-normal"},Po={key:1,class:"text-primary text-sm flex-start gap-[2px]"},Do=o("img",{src:ps,class:"w-4 h-4 mr-[3px]",alt:"MCOIN"},null,-1),Fo={class:"font-semibold"},Vo=_e({props:{payType:null,goods:null,storeCard:null,creditFlag:{default:0}},setup(t){const V=e=>{const f=e.number??1,C=e.cardPrice??0,S=e.goodsActivityReduceAmount??0,_=new Re(C*f-S).toNumber();return xt(_)},v=e=>{const f=new Re(e.price).times(e.number).minus(e.goodsActivityReduceAmount||0).plus(e.goodsAdjustChangeAmount||0).toNumber();return xt(f||0)};return(e,f)=>{var S,_,B;const C=O("VanImage");return r(),c("div",wo,[o("div",bo,[A(C,{src:(t.goods.icons||"").split(",")[0],radius:"10",class:"w-full h-full",alt:"",fit:"cover"},null,8,["src"])]),o("div",$o,[o("div",ko,[o("div",null,[o("div",Co,[o("div",Ao,n(t.goods.goodsName),1),t.creditFlag?(r(),c("div",To,[Io,z(" "+n(e.$t("order.Credit Collection")),1)])):k("",!0),o("div",So,[o("span",null,n(t.goods.price)+" Mcoin",1)])])]),o("div",_o,n(e.$t("order.quantity",{number:t.goods.number})),1)]),o("div",Ro,[o("div",No,n(e.$t("order.actual payment")),1),t.payType===m(Me).STORE_CARD?(r(),c("div",Oo,[(S=t.storeCard)!=null&&S.symbolLogo?(r(),c("img",{key:0,src:(_=t.storeCard)==null?void 0:_.symbolLogo,class:"w-3 h-3",alt:""},null,8,Lo)):k("",!0),o("span",Bo,n(V(t.goods)),1),o("span",Eo,n((B=t.storeCard)==null?void 0:B.symbol),1)])):(r(),c("div",Po,[Do,o("span",Fo,n(v(t.goods)),1)]))])])])}}}),Ho=t=>(bt("data-v-1a205182"),t=t(),$t(),t),jo={class:"gap-2 flex-center-bw"},Go={key:0,class:"w-4 h-4",src:St,alt:""},Mo={key:1,class:"w-4 h-4 border border-solid rounded-full border-[#000]/40"},qo=Ho(()=>o("div",{class:"w-8 h-8"},[o("img",{src:Ct,class:"w-full h-full rounded-md",alt:"",fit:"cover"})],-1)),Ko={class:"flex flex-col justify-center flex-1 h-8 text-default"},zo={class:"text-sm font-normal flex-center-bw"},Uo={key:0},Yo={class:"text-primary"},Wo={class:"text-xs font-normal opacity-60"},Jo={key:0},Zo={key:1},Qo={key:2},Xo=_e({props:{order:null,isService:{type:Boolean},nowTime:null,selectIds:null},emits:["select"],setup(t,{emit:V}){const v=t;ze();const e=gt(),f=It(v.order.refundStatus,v.order.payType),{t:C}=Ye(),S=b=>{v.isService||e.push(b)},_=()=>{if(v.isService){const b=v.order;B(b)}else e.push(`/sellerOrderDetail?id=${v.order.id}`)};wt("openBatchReceiptPop",null),nt();const B=b=>{V("select",b)};return(b,me)=>(r(),c("div",{class:Ce(["p-3 mt-3 bg-white rounded-xl box-border default-border",{"border-orange":t.selectIds&&t.selectIds.includes(t.order.id)}]),onClick:_},[o("div",jo,[o("div",null,[t.selectIds&&t.selectIds.includes(t.order.id)?(r(),c("img",Go)):(r(),c("div",Mo))]),qo,o("div",Ko,[o("div",zo,[t.order.userAddress&&t.order.userAddress.address?(r(),c("div",Uo,n(m(tt)(t.order.userAddress.address,"...",5,5)),1)):k("",!0),o("div",Yo,n(m(f)[t.order.status+""]),1)]),o("div",Wo,[t.order.status==4?(r(),c("span",Jo,n(m(Q)(t.order.finishTime))+" "+n(b.$t("common.finish")),1)):t.order.status==2?(r(),c("span",Zo,n(m(Q)(t.order.expressTime))+" "+n(b.$t("order.Ship")),1)):(r(),c("span",Qo,n(m(Q)(t.order.createTime))+" "+n(b.$t("order.buied")),1))])])]),(r(!0),c(re,null,ke(t.order.orderGoods,h=>(r(),L(Vo,{class:"goods-item",creditFlag:t.order.creditFlag,payType:t.order.payType,key:h.goodsName,goods:h,storeCard:t.order.fmStoredCard,onHandleTo:S},null,8,["creditFlag","payType","goods","storeCard"]))),128))],2))}}),yt=Ne(Xo,[["__scopeId","data-v-1a205182"]]),ea={class:"px-3 text-base"},ta={class:"flex justify-center items-center h-[44px]"},sa={class:"flex items-center font-bold"},oa={class:"overflow-y-scroll max-h-[70vh] pb-[100px]"},aa={class:"mt-3 text-sm font-normal"},na={class:"text-primary font-semibold"},ra={class:"text-primary font-semibold"},la={class:"flex flex-col"},ia={class:"receipt__wrap flex flex-col items-center justify-center gap-3 py-5 px-6 fixed bottom-0 left-0 right-0"},da={class:"text-sm font-normal text-black"},ca={class:"w-full flex flex-row justify-between items-center"},ua={class:"flex items-center justify-center"},ma={key:0,class:"w-4 h-4",src:St,alt:""},fa={key:1,class:"w-4 h-4 border border-solid rounded-full border-[#000]/40"},pa={key:0,class:"text-default"},va=_e({props:{show:{type:Boolean},list:null,currentId:null,loading:{type:Boolean}},emits:["close","receipt","update:show"],setup(t,{emit:V}){const v=t,e=Se({get:()=>v.show,set:h=>V("update:show",h)}),f=y([]),C=Se(()=>v.list&&v.currentId?v.list.filter(h=>+h.id!=+v.currentId):[]),S=Se(()=>{const h=[v.currentId,...C.value.map(g=>g.id)];return f.value.length===h.length&&h.every(g=>f.value.includes(g))}),_=()=>{if(S.value)f.value=[];else{const h=[v.currentId,...C.value.map(g=>g.id)];f.value=h}};Ke(()=>v.show,h=>{if(h){const g=document.getElementById("container");Yt(()=>{g&&g.scrollIntoView()}),f.value=[],f.value.push(v.currentId)}},{deep:!0});const B=h=>{const g=h.id;f.value.includes(g)?f.value=f.value.filter(U=>U!==g):f.value.push(g)},b=()=>{V("receipt",f.value)},me=Se(()=>v.list&&v.currentId?v.list.find(h=>+h.id==+v.currentId):[]);return(h,g)=>{const U=O("van-icon"),se=O("VanButton"),E=O("van-popup");return r(),L(E,{show:m(e),"onUpdate:show":g[1]||(g[1]=oe=>Ut(e)?e.value=oe:null),round:"",class:"bg-[#F3F3F3]",position:"bottom",onClose:g[2]||(g[2]=oe=>V("close")),"safe-area-inset-bottom":"","stop-propagation":!1},{default:I(()=>[o("div",ea,[o("div",ta,[o("div",sa,n(h.$t("order.you_have_other_pending_orders")),1),A(U,{class:"absolute right-2.5",name:"cross",size:"20",color:"#000",onClick:g[0]||(g[0]=ve(()=>V("close"),["stop"]))})]),o("div",oa,[m(me)?(r(),L(yt,{key:0,id:"container",onSelect:B,selectIds:f.value,order:m(me),isService:""},null,8,["selectIds","order"])):k("",!0),o("div",aa,[z(n(h.$t("order.there are"))+" ",1),o("span",na,n(m(C).length),1),z(" "+n(h.$t("order.order merchant"))+" ",1),o("span",ra,n(h.$t("order.already")),1),z(" "+n(h.$t("order.can confirm receipt in batches")),1)]),o("div",la,[(r(!0),c(re,null,ke(m(C),oe=>(r(),c("div",{key:oe.id},[A(yt,{onSelect:B,selectIds:f.value,order:oe,isService:""},null,8,["selectIds","order"])]))),128))]),o("div",ia,[o("div",da,n(h.$t("order.follow orders")),1),o("div",ca,[o("div",{class:"flex flex-col items-center justify-center cursor-pointer",onClick:_},[o("div",ua,[m(S)?(r(),c("img",ma)):(r(),c("div",fa))])]),A(se,{loading:t.loading,round:"",disabled:!f.value||f.value&&f.value.length<=0,class:"ml-2 h-10 text-default min-w-[calc(100%-32px)] bg-btnOrBg rounded-[60px] font-semibold",onClick:b},{default:I(()=>[z(n(h.$t("order.oneKeyConfirmGeted")),1),f.value.length?(r(),c("span",pa,n(h.$t("order.selected count num",{count:f.value.length||0})),1)):k("",!0)]),_:1},8,["loading","disabled"])])])])])]),_:1},8,["show"])}}}),ha=Ne(va,[["__scopeId","data-v-5dc12824"]]),xa={class:"relative"},ya={class:"px-3 bg-[#f2f0ef] pb-1 parent-view"},ga={class:"gap-2 pt-2 flex-start bg-[#f2f0ef] sticky top-0 z-10"},wa=_e({name:"SellerOrderList"});function ba(t){const{t:V}=Ye(),{getCurrentStoreId:v}=At(),e=y(0),f=y(1),{clerkStore:C}=ze(),[S,_]=Ge(!1),[B,b]=Ge(!1),[me,h]=Ge(!1),g=y(null),U=y([]),se=y([]),E=y(null),oe=y(new Date().getTime()/1e3),R=Wt();R.query.active&&(e.value=Number(R.query.active)),R.query.type&&(f.value=Number(R.query.type));const N=p=>{console.log("changeType",p),f.value=p,Tt.replace({path:"sellerOrderList",query:{type:p}})},{merchantConfirm:Y}=nt(),d=async()=>{var i;const p=await Ue({page:1,size:999,status:2,type:1,storeId:(i=await v())==null?void 0:i.id});p.success&&(se.value=p.data)},$=async p=>{g.value=p.id,se.value.length===0&&(p.loading=!0,await d(),p.loading=!1),U.value=se.value.filter(i=>{if(!i.merchantsConfirm&&!(qe(i.expressTime,i.confirmLimit,oe.value)>0))return!0}),U.value.length<=1?D(p):b(!0)},D=async p=>{p.loading=!0;try{const ae=(await st({orderIds:p.id.toString()})).data.ordIds,K=await Y(ae);if(!K.success||!(await ot({ordIds:ae,hash:K.result.hash})).success)return;p.merchantsConfirm=1,T.success(V("order.confirmSuccess")),setTimeout(()=>{var Ae;E.value?(Ae=E.value)==null||Ae.handleChangeTab(3):location.reload()},1e3)}finally{p.loading=!1}},W=async p=>{var i;h(!0);try{const ae=p.map(String).join(),he=(await st({orderIds:ae})).data.ordIds,Ae=await Y(he);if(!Ae.success||!(await ot({ordIds:he,hash:Ae.result.hash})).success)return;U.value.forEach(Oe=>{p.includes(Oe.id)&&(Oe.merchantsConfirm=1)}),b(!1),T.success(V("order.confirmSuccess")),await d(),E.value?(i=E.value)==null||i.handleChangeTab(3):location.reload()}finally{h(!1)}},q=async()=>{var ae;const{success:p,total:i}=await Ue({page:1,size:3,status:-1,refundStatus:1,type:1,tab:2,storeId:(ae=await v())==null?void 0:ae.id});p&&i>0?_(!0):_(!1)};return Jt("openBatchReceiptPop",$),Ke(()=>R.query.active,p=>{var i;+p&&E.value&&E.value.active&&R.path==="/sellerOrderList"&&((i=E.value)==null?void 0:i.active)!==+p&&E.value.handleChangeTab(+p)},{immediate:!1,deep:!0}),Ke(()=>R.path,(p,i)=>{p==="/sellerOrderList"&&i!=="/sellerOrderList"&&(console.log("从子页面返回，刷新订单列表"),E.value&&sessionStorage.getItem("modifiedOrderId")&&E.value.updateModifiedOrders())},{immediate:!1}),kt(()=>{q(),d(),C.checkClerkAuth()}),(p,i)=>{const ae=O("router-view");return r(),c("div",xa,[o("div",ya,[o("div",ga,[A(vs),o("div",{class:Ce(["text",{"active-text":f.value==1}]),onClick:i[0]||(i[0]=K=>N(1))},n(p.$t("order.order")),3),o("div",{class:Ce(["relative ml-2 text",{"active-text":f.value==2}]),onClick:i[1]||(i[1]=K=>N(2))},[z(n(p.$t("order.Refund/After-sale"))+" ",1),ce(A(go,null,null,512),[[ue,m(S)]])],2),A(hs,{showIcon:!0,showDownIcon:!1,class:"ml-auto bg-gray1 px-2 rounded-[20px] border-2 border-solid border-white",style:{"box-shadow":"0px 0px 15px 0px rgba(51, 47, 42, 0.3) inset"}})]),f.value==1?(r(),L(vo,{key:0,ref:(K,he)=>{he.sellOrderRef=K,E.value=K},value:e.value},null,8,["value"])):f.value==2?(r(),L(us,{key:1,onRecompute:q})):f.value==3?(r(),L(xs,{key:2})):k("",!0)]),A(ae,{class:"child-view bg-[#f2f0ef]"}),A(ha,{show:m(B),list:U.value,currentId:g.value,loading:m(me),onClose:i[2]||(i[2]=K=>m(b)(!1)),onReceipt:W},null,8,["show","list","currentId","loading"])])}}const $a=_e({...wa,setup:ba}),tn=Ne($a,[["__scopeId","data-v-7214e9d6"]]);export{tn as default};
