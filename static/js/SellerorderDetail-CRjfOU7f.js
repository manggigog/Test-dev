import{x as L,y as g,r as M,D as U,F as O,G as f,U as w,O as a,H as i,I as e,P as I,$ as F,Q as o,_ as be,z as ue,J as E,X as Ae,Y as Pe,B as Xe,a4 as j,Z as R,a3 as K,T as D,bj as We,bt as et,o as tt,bo as st,a2 as le,E as ot,N as rt,q as nt}from"./vendor-Dr_RpJ_Y.js";import{g as at,a as Re,b as it,c as dt,d as lt}from"./useOrderStatus-B4sCDXOr.js";import{u as ct,a as ut,b as mt,c as ft,d as Ne,e as Fe,f as ht,g as pt,h as vt,i as xt}from"./useOrderActionButtons-CBZMA2Vd.js";import{_ as z}from"./copy-w-F2Lv8QkV.js";import{h as G,e as ae,g as yt,f as xe,r as ce,a as ye,u as Me,k as Te,V as bt,i as Ce,b as wt,a8 as gt}from"./index-BckdT6oc.js";import{_ as _t,R as kt,a as Tt,b as Ct,c as St}from"./remark-2opyrALq.js";import{_ as me}from"./MCOIN-Bodfn-v1.js";import{_ as It}from"./link-DvRTrysK.js";import{_ as At}from"./CountdownLabel-BEWGrnUw.js";import{B as Pt}from"./BackIcon-CDrGaEPo.js";import{U as Rt}from"./UnfreezePop-Bd2qjgen.js";import{a as Nt,b as Ft,c as Se,n as Ie,d as Mt,e as Dt}from"./order-BTAcEDew.js";import{P as jt}from"./flashSale-DDyqLyYN.js";import{s as Bt}from"./refund-DnmzK6ip.js";import"./credit-EZuPIBEN.js";import"./order-H59PKTFP.js";import"./useShipTemplate-4sMa-Tzi.js";import"./enums-DlE-aiss.js";import"./default-avatar-BIKCDGrQ.js";import"./USDT-Dlu99aCg.js";import"./FMCP-f3k58DsE.js";import"./useRefund-DuvymEPl.js";import"./edit-line-afMYMtOA.js";import"./useKeyboard-DcWqtm11.js";import"./ApproveButton-SJn4FNwL.js";const qt={key:0,class:"p-3 break-all bg-white rounded-xl"},Ot={class:"font-semibold text-base text-b1"},Lt={class:"mr-1"},Vt={key:0},Ut={class:"text-[#FF8812] mx-1"},Et={key:1},Ht=e("span",null,null,-1),Kt={class:"mt-1 font-normal text-sm text-b2"},Gt={key:0},zt={key:1},Yt={props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0}},emits:["timeDone"],setup(t,{emit:y}){const h=t,{t:b}=L(),l=g(()=>{const n=h.order||{};return ct(n,h.nowTime)}),p=g(()=>{var d;const n=new Date((d=h.order.refundInfo)==null?void 0:d.submitTime).getTime()/1e3;return at(n,h.nowTime)}),v=g(()=>{const n=p.value;if(n<=0)return`00${b("common.seconds")}`;const m=Math.floor(n/(1e3*60*60*24)),d=Math.floor(n%(1e3*60*60*24)/(1e3*60*60)),c=Math.floor(n%(1e3*60*60)/(1e3*60)),s=Math.floor(n%(1e3*60)/1e3);let u="";return m>0&&(u+=`${m}${b("common.day")}`),(d>0||m>0)&&(u+=`${d.toString().padStart(2,"0")}${b("common.hours")}`),(c>0||d>0||m>0)&&(u+=`${c.toString().padStart(2,"0")}${b("common.minutes")}`),u+=`${s.toString().padStart(2,"0")}${b("common.seconds")}`,u}),$=M(!0);return U(()=>p.value,(n,m)=>{n>0?$.value=!1:!$.value&&n<=0&&($.value=!0,y("timeDone"))},{immediate:!0,deep:!0}),(n,m)=>{const d=O("i18n-t");return a(l)?(i(),f("div",qt,[e("div",Ot,[e("span",Lt,[a(v)?(i(),f("span",Vt,[I(d,{keypath:"afterSale.Please process your after-sales request within x days",tag:"span"},{time:F(()=>[e("span",Ut,o(a(v)),1)]),_:1})])):(i(),f("span",Et,o(n.$t("afterSale.Please process after-sales requests promptly")),1))]),Ht]),e("div",Kt,[a(v)?(i(),f("span",Gt,o(n.$t("afterSale.Please monitor your order status Once the countdown ends the buyer can apply for a mandatory refund")),1)):(i(),f("span",zt,o(n.$t("afterSale.Please check your order status Buyers can apply for a forced refund")),1))])])):w("",!0)}}},Zt=t=>(Ae("data-v-cdcca3be"),t=t(),Pe(),t),Jt={class:"p-3 break-all bg-white rounded-xl"},Qt={class:"title text-b1 text-sm font-semibold flex justify-between mb-2"},Xt={key:0,class:"mr-0.5"},Wt=Zt(()=>e("img",{src:z,class:"w-5 h-5",alt:""},null,-1)),es={class:"text-sm text-b3 font-normal"},ts={class:"font-normal text-sm text-b2"},ss={class:"text-b2 text-sm font-normal"},os={class:"ml-1"},rs={class:"mt-2 text-sm text-b3 font-normal"},ns={class:"font-normal text-sm text-b1"},as={class:"text-b1 text-sm font-normal"},is={class:"ml-1"},ds={key:0,class:"tipsCard w-full h-fit p-2 mb-1 text-left"},ls={class:"text-sm text-[#FF8812] font-normal font-Puhui"},cs={class:"font-normal text-sm text-b1"},us={class:"text-b1 text-sm font-normal"},ms={class:"ml-1"},fs=ue({props:{order:null,nowTime:null},setup(t){const y=t,h=g(()=>`${y.order.userAddress.provinceName??""}${y.order.userAddress.cityName??""}${y.order.userAddress.countyName??""}${y.order.userAddress.detailInfo??""} ${y.order.userAddress.userName??""} ${y.order.userAddress.telNumber??""}`),b=()=>{G(h.value)},l=g(()=>{var v;return((v=y.order.modifyInfo)==null?void 0:v.status)===1||y.order.orderPostscriptUpdateReviewId}),p=g(()=>{var $,n;let v=($=y.order.modifyInfo)!=null&&$.type?(n=y.order.modifyInfo)==null?void 0:n.type:y.order.orderPostscriptUpdateReviewType;return(v==1||v==3)&&ut(y.order,y.nowTime)});return(v,$)=>{var n,m,d,c,s,u,_,C,x,S,A,T;return i(),f("div",Jt,[e("div",Qt,[e("span",null,o(v.$t("order.buyerAddressInfo")),1),e("div",{class:"text-[#FF8812] text-sm font-normal text-right flex items-center",onClick:b},[a(p)?(i(),f("div",Xt,o(v.$t("order.copy new address")),1)):w("",!0),Wt])]),a(l)&&a(p)?(i(),f(E,{key:0},[e("div",es,o(v.$t("order.old adress")),1),e("div",ts,o(((m=(n=t.order.modifyInfo)==null?void 0:n.oldPostscript)==null?void 0:m.provinceName)??"")+o(((c=(d=t.order.modifyInfo)==null?void 0:d.oldPostscript)==null?void 0:c.cityName)??"")+o(((u=(s=t.order.modifyInfo)==null?void 0:s.oldPostscript)==null?void 0:u.countyName)??"")+o(((C=(_=t.order.modifyInfo)==null?void 0:_.oldPostscript)==null?void 0:C.detailInfo)??""),1),e("div",ss,[e("span",null,o((S=(x=t.order.modifyInfo)==null?void 0:x.oldPostscript)==null?void 0:S.userName),1),e("span",os,o(((T=(A=t.order.modifyInfo)==null?void 0:A.oldPostscript)==null?void 0:T.telNumber)??""),1)]),e("div",rs,o(v.$t("order.new address")),1),e("div",ns,o(t.order.userAddress.provinceName??"")+o(t.order.userAddress.cityName??"")+o(t.order.userAddress.countyName??"")+o(t.order.userAddress.detailInfo??""),1),e("div",as,[e("span",null,o(t.order.userAddress.userName),1),e("span",is,o(t.order.userAddress.telNumber??""),1)])],64)):(i(),f(E,{key:1},[a(p)?(i(),f("div",ds,[e("span",ls,o(v.$t("order.buyer already modify receive address please check")),1)])):w("",!0),e("div",cs,o(t.order.userAddress.provinceName??"")+o(t.order.userAddress.cityName??"")+o(t.order.userAddress.countyName??"")+o(t.order.userAddress.detailInfo??""),1),e("div",us,[e("span",null,o(t.order.userAddress.userName),1),e("span",ms,o(t.order.userAddress.telNumber??""),1)])],64))])}}}),hs=be(fs,[["__scopeId","data-v-cdcca3be"]]),ps={class:"p-3 break-all bg-white rounded-xl"},vs={class:"title text-b1 text-sm font-semibold"},xs={class:"content"},ys={class:"flex justify-between items-center mt-[16px]"},bs={class:"text-b3 text-sm font-normal"},ws={class:"text-b1 text-sm font-normal text-right flex items-center"},$s=e("div",{class:"flex-shrink-0"},[e("img",{class:"w-[16px] h-[16px]",src:me})],-1),gs={class:"ml-1"},_s={key:0,class:"flex justify-between items-center mt-[16px]"},ks={class:"text-b3 text-sm font-normal line-clamp-1 max-w-[100px]"},Ts={class:"text-b1 text-sm font-normal text-right flex items-center"},Cs={class:"mr-1"},Ss=e("div",{class:"flex-shrink-0"},[e("img",{class:"w-[16px] h-[16px]",src:me})],-1),Is={class:"ml-1"},As={key:1,class:"flex justify-between items-center mt-[16px]"},Ps={class:"text-b3 text-sm font-normal line-clamp-1 max-w-[100px]"},Rs={class:"text-b1 text-sm font-normal text-right flex items-center"},Ns=e("div",{class:"mr-1"},"-",-1),Fs=e("div",{class:"flex-shrink-0"},[e("img",{class:"w-[16px] h-[16px]",src:me})],-1),Ms={class:"ml-1"},Ds={class:"flex justify-between items-center mt-[16px]"},js={class:"text-b3 text-sm font-normal"},Bs={class:"text-b1 text-sm font-normal text-right flex items-center"},qs=e("div",{class:"flex-shrink-0"},[e("img",{class:"w-[16px] h-[16px]",src:me})],-1),Os={class:"ml-1"},Ls={class:"flex justify-between items-center mt-[16px]"},Vs={class:"text-b3 text-sm font-normal"},Us={class:"text-b1 text-sm font-normal text-right"},Es={class:"flex items-center"},Hs={class:"flex justify-between items-center mt-[16px]"},Ks={class:"text-b3 text-sm font-normal"},Gs=["href"],zs=e("img",{src:It,class:"w-5 h-5 ml-1",alt:""},null,-1),Ys={key:1},Zs={class:"flex justify-between items-center mt-4"},Js={class:"text-b3 text-sm font-normal"},Qs=e("img",{src:z,class:"w-5 h-5 ml-1",alt:""},null,-1),Xs={class:"flex justify-between items-center mt-[16px]"},Ws={class:"text-b3 text-sm font-normal"},eo=e("img",{src:z,class:"w-5 h-5 ml-1",alt:""},null,-1),to={key:1},so={key:2,class:"flex justify-between items-center mt-[16px]"},oo={class:"text-b3 text-sm font-normal"},ro={class:"text-b1 text-sm font-normal text-right"},no={key:3,class:"flex justify-between items-center mt-[16px]"},ao={class:"text-b3 text-sm font-normal"},io={class:"text-b1 text-sm font-normal text-right"},lo={key:4,class:"flex justify-between items-center mt-[16px]"},co={class:"text-b3 text-sm font-normal"},uo={class:"text-b1 text-sm font-normal text-right"},mo={key:5,class:"flex justify-between items-center mt-[16px]"},fo={class:"text-b3 text-sm font-normal"},ho={class:"text-b1 text-sm font-normal text-right"},po={key:6,class:"flex justify-between items-center mt-[16px]"},vo={class:"text-b3 text-sm font-normal whitespace-nowrap"},xo={class:"text-b1 text-sm font-normal text-right flex items-center"},yo={class:"break-all flex-1"},bo=e("img",{src:z,class:"w-5 h-5",alt:""},null,-1),wo=[bo],$o={key:7,class:"flex justify-between items-center mt-[16px]"},go=e("div",{class:"text-b3 text-sm font-normal whitespace-nowrap"}," 发货物流公司 ",-1),_o={class:"text-b1 text-sm font-normal text-right break-all"},ko={key:8,class:"flex justify-between items-center mt-[16px]"},To=e("div",{class:"text-b3 text-sm font-normal whitespace-nowrap"}," 发货运单号 ",-1),Co={class:"text-b1 text-sm font-normal text-right flex items-center"},So={class:"break-all flex-1"},Io=e("img",{src:z,class:"w-5 h-5",alt:""},null,-1),Ao=[Io],Po={key:9,class:"flex justify-between items-center mt-[16px]"},Ro=e("div",{class:"text-b3 text-sm font-normal whitespace-nowrap"}," 退货物流公司 ",-1),No={class:"text-b1 text-sm font-normal text-right break-all"},Fo={key:10,class:"flex justify-between items-center mt-[16px]"},Mo=e("div",{class:"text-b3 text-sm font-normal whitespace-nowrap"}," 退货运单号 ",-1),Do={class:"text-b1 text-sm font-normal text-right flex items-center"},jo={class:"break-all flex-1"},Bo=e("img",{src:z,class:"w-5 h-5",alt:""},null,-1),qo=[Bo],Oo={props:{order:{type:Object,required:!0}},setup(t){const y=t,h=g(()=>{let l=0;return l=new Xe(y.order.totalAmount||0),ae(l)}),b=g(()=>{var p;const l=y.order.orderGoods||[];return l.length>0?l[0].discountRatio||0:((p=y.order.stores)==null?void 0:p.discountRatio)||0});return(l,p)=>{var v,$,n,m,d,c,s;return i(),f("div",ps,[e("div",vs,o(l.$t("order.orderInfo")),1),e("div",xs,[e("div",ys,[e("div",bs,o(l.$t("order.total price detail")),1),e("div",ws,[$s,e("div",gs,o(a(ae)(t.order.totalAmountOriginal||t.order.totalAmount)),1)])]),t.order.merchantAdjustAmount?(i(),f("div",_s,[e("div",ks,o(l.$t("order.merchant modify price")),1),e("div",Ts,[e("div",Cs,o(t.order.merchantAdjustAmount>0?"+":"-"),1),Ss,e("div",Is,o(Math.abs(t.order.merchantAdjustAmount)||0),1)])])):w("",!0),t.order.fmGeneralActivity&&t.order.activityReduceAmount?(i(),f("div",As,[e("div",Ps,o(((v=t.order.fmGeneralActivity)==null?void 0:v.name)||"-"),1),e("div",Rs,[Ns,Fs,e("div",Ms,o(a(ae)(t.order.activityReduceAmount)),1)])])):w("",!0),e("div",Ds,[e("div",js,o(l.$t("order.total price actual")),1),e("div",Bs,[qs,e("div",Os,o(a(h)),1)])]),e("div",Ls,[e("div",Vs,o(l.$t("common.ratio")),1),e("div",Us,[e("div",Es,o(a(b))+"%",1)])]),e("div",Hs,[e("div",Ks,o(l.$t("order.hash")),1),t.order.hash?(i(),f("a",{key:0,class:"text-sm font-normal text-right flex items-center underline text-[#FF8812]",href:`${a(yt).chainConfig.blockExplorerUrls[0]}/tx/${t.order.hash}`},[j(o(a(xe)(t.order.hash,"***",9,5)||"--")+" ",1),zs],8,Gs)):(i(),f("span",Ys," -- "))]),e("div",Zs,[e("div",Js,o(l.$t("order.orderAddress")),1),e("div",{class:"text-b1 text-sm font-normal text-right flex items-center",onClick:p[0]||(p[0]=u=>a(G)(t.order.address))},[j(o(a(xe)(t.order.address,"...",5,5))+" ",1),Qs])]),e("div",Xs,[e("div",Ws,o(l.$t("order.payAddress")),1),($=t.order)!=null&&$.payAddress?(i(),f("div",{key:0,class:"text-b1 text-sm font-normal text-right flex items-center",onClick:p[1]||(p[1]=u=>{var _;return a(G)((_=t.order)==null?void 0:_.payAddress)})},[j(o(a(xe)((n=t.order)==null?void 0:n.payAddress,"...",5,5))+" ",1),eo])):(i(),f("div",to,"--"))]),t.order.createTime?(i(),f("div",so,[e("div",oo,o(l.$t("order.createTime")),1),e("div",ro,o(a(ce)(t.order.createTime)),1)])):w("",!0),t.order.chainCreateTime?(i(),f("div",no,[e("div",ao,o(l.$t("order.chainFinishTime")),1),e("div",io,o(a(ce)(t.order.chainCreateTime)),1)])):w("",!0),t.order.expressTime?(i(),f("div",lo,[e("div",co,o(l.$t("order.expressTime")),1),e("div",uo,o(a(ce)(t.order.expressTime)),1)])):w("",!0),t.order.finishTime?(i(),f("div",mo,[e("div",fo,o(l.$t("order.finishTime")),1),e("div",ho,o(a(ce)(t.order.finishTime)),1)])):w("",!0),t.order.id?(i(),f("div",po,[e("div",vo,o(l.$t("order.orderNumber")),1),e("div",xo,[e("div",yo,o(t.order.id),1),e("div",{class:"ml-1 w-5 h-5 min-w-5 min-h-5",onClick:p[2]||(p[2]=u=>a(G)(t.order.id))},wo)])])):w("",!0),t.order.expressCompany?(i(),f("div",$o,[go,e("div",_o,o(t.order.expressCompany),1)])):w("",!0),t.order.expressNo?(i(),f("div",ko,[To,e("div",Co,[e("div",So,o(t.order.expressNo),1),e("div",{class:"ml-1 w-5 h-5 min-w-5 min-h-5",onClick:p[3]||(p[3]=u=>a(G)(t.order.expressNo))},Ao)])])):w("",!0),(m=t.order.refundInfo)!=null&&m.expressCompany?(i(),f("div",Po,[Ro,e("div",No,o((d=t.order.refundInfo)==null?void 0:d.expressCompany),1)])):w("",!0),(c=t.order.refundInfo)!=null&&c.expressNo?(i(),f("div",Fo,[Mo,e("div",Do,[e("div",jo,o((s=t.order.refundInfo)==null?void 0:s.expressNo),1),e("div",{class:"ml-1 w-5 h-5 min-w-5 min-h-5",onClick:p[4]||(p[4]=u=>{var _;return a(G)((_=t.order.refundInfo)==null?void 0:_.expressNo)})},qo)])])):w("",!0)])])}}},Lo={class:"p-3 break-all bg-white rounded-xl"},Vo={key:0},Uo={class:"font-semibold text-base text-b1"},Eo={class:"text-[#FF8812] mr-1"},Ho={class:"mt-1 font-normal text-sm text-b2"},Ko={key:1,class:"font-semibold text-base text-b1"},Go={props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0}},emits:["timeDone"],setup(t,{emit:y}){const h=t,{t:b}=L(),l=g(()=>Re(h.order.expressTime,h.order.confirmLimit,h.nowTime)),p=g(()=>l.value>0),v=g(()=>{const n=l.value;if(n<=0)return`00${b("common.seconds")}`;const m=Math.floor(n/(1e3*60*60*24)),d=Math.floor(n%(1e3*60*60*24)/(1e3*60*60)),c=Math.floor(n%(1e3*60*60)/(1e3*60)),s=Math.floor(n%(1e3*60)/1e3);let u="";return m>0&&(u+=`${m}${b("common.day")}`),(d>0||m>0)&&(u+=`${d.toString().padStart(2,"0")}${b("common.hours")}`),(c>0||d>0||m>0)&&(u+=`${c.toString().padStart(2,"0")}${b("common.minutes")}`),u+=`${s.toString().padStart(2,"0")}${b("common.seconds")}`,u}),$=M(!0);return U(()=>l.value,(n,m)=>{n>0?$.value=!1:!$.value&&n<=0&&($.value=!0,y("timeDone"))},{immediate:!0,deep:!0}),(n,m)=>{const d=O("i18n-t");return i(),f("div",Lo,[a(p)?(i(),f("div",Vo,[e("div",Uo,[e("span",null,[I(d,{keypath:"afterSale.You can confirm receipt after x days",tag:"span"},{time:F(()=>[e("span",Eo,o(a(v)),1)]),_:1})])]),e("div",Ho,o(n.$t("afterSale.Please check your order status")),1)])):(i(),f("div",Ko,o(n.$t("afterSale.If the buyer has not processed the order for an extended period you can confirm receipt")),1))])}}},zo={class:"p-3 break-all bg-white rounded-xl"},Yo={class:"font-semibold text-base text-b1"},Zo={key:0},Jo={class:"text-[#FF8812] mx-1"},Qo={key:0,class:"mt-1 font-normal text-sm text-b2"},Xo={props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0}},emits:["timeDone"],setup(t,{emit:y}){const h=t,{t:b}=L(),l=g(()=>{var d;const n=new Date((d=h.order.refundInfo)==null?void 0:d.reviewTime).getTime()/1e3;return it(n,h.nowTime)}),p=g(()=>l.value>0),v=g(()=>{const n=l.value;if(n<=0)return`00${b("common.seconds")}`;const m=Math.floor(n/(1e3*60*60*24)),d=Math.floor(n%(1e3*60*60*24)/(1e3*60*60)),c=Math.floor(n%(1e3*60*60)/(1e3*60)),s=Math.floor(n%(1e3*60)/1e3);let u="";return m>0&&(u+=`${m}${b("common.day")}`),(d>0||m>0)&&(u+=`${d.toString().padStart(2,"0")}${b("common.hours")}`),(c>0||d>0||m>0)&&(u+=`${c.toString().padStart(2,"0")}${b("common.minutes")}`),u+=`${s.toString().padStart(2,"0")}${b("common.seconds")}`,u}),$=M(!0);return U(()=>l.value,(n,m)=>{n>0?$.value=!1:!$.value&&n<=0&&($.value=!0,y("timeDone"))},{immediate:!0,deep:!0}),(n,m)=>{const d=O("i18n-t");return i(),f("div",zo,[e("div",Yo,[a(p)?(i(),f("span",Zo,[I(d,{keypath:"afterSale.Return and refund agreed x days remaining",tag:"span"},{time:F(()=>[e("span",Jo,o(a(v)),1)]),_:1})])):(i(),f(E,{key:1},[j(o(n.$t("afterSale.The buyer fails to return the item within a specified period the after-sales service will automatically terminate")),1)],64))]),a(p)?(i(),f("div",Qo,o(n.$t("afterSale.If the buyer does not return the item within a specified period the after-sales service will automatically terminate")),1)):w("",!0)])}}},Wo={key:0,class:"flex justify-between items-center gap-3 mt-5 fixed left-0 right-0 bottom-0 safe-bottom px-3"},er={class:"whitespace-nowrap"},tr={props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0},shopAddress:{type:String,default:null},btnLoading:{type:Boolean,default:!1},mrLoading:{type:Boolean,default:!1}},emits:["handleTo","handleConfirm","handleModifyPrice","handleRefresh","modifyReview"],setup(t,{emit:y}){const h=t,{t:b}=L(),{accountStore:l}=ye(),{clerkStore:p}=ye();Me();const v=g(()=>{const x=h.order||{};return mt(x)}),$=g(()=>{const x=h.order||{};return ft(x)}),n=g(()=>{const x=h.order||{};return Ne(x)}),m=g(()=>{const x=h.order||{};return Fe(x)}),d=g(()=>{const x=h.order||{};return ht(x)}),c=()=>{if(l.isOnlyView)return D($t("order.Requires merchant account operation"));y("handleConfirm",h.order)},s=()=>{if(l.isOnlyView)return D($t("order.Requires merchant account operation"));if(p.isClerk&&!p.clerkAuth)return D(b("order.Requires merchant account operation"));y("handleMerchantReceive",h.order)},u=()=>{if(l.isOnlyView)return D($t("order.Requires merchant account operation"));if(p.isClerk&&!p.clerkAuth)return D(b("order.Requires merchant account operation"));y("handlePlatformIntervene",h.order)},_=x=>{y("modifyReview",x)},C=g(()=>{var x;return((x=h.order.modifyInfo)==null?void 0:x.status)===1||h.order.orderPostscriptUpdateReviewId});return(x,S)=>{const A=O("VanButton");return a(l).isOnlyView?w("",!0):(i(),f("div",Wo,[a(C)&&a(pt)(t.order,t.nowTime)?(i(),f(E,{key:0},[I(A,{round:"",class:"flex-1 main-btn font-semibold text-white text-base h-[46px] rounded-full !bg-[#07C160]",onClick:S[0]||(S[0]=T=>_(!0)),loading:t.mrLoading},{default:F(()=>[j(o(x.$t("order.agree modify")),1)]),_:1},8,["loading"]),I(A,{round:"",class:"flex-1 main-btn font-semibold text-white text-base h-[46px] rounded-full !bg-[#FF4444]",onClick:S[1]||(S[1]=T=>_(!1)),loading:t.mrLoading},{default:F(()=>[j(o(x.$t("order.reject modify")),1)]),_:1},8,["loading"])],64)):(i(),f(E,{key:1},[t.order.status===0&&!t.order.hash?(i(),R(A,{key:0,round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full",onClick:S[3]||(S[3]=K(T=>x.$emit("handleModifyPrice"),["stop"])),disabled:t.order.hash},{default:F(()=>[j(o(x.$t("order.modifyPrice"))+" ",1),I(At,{class:"inline-block ml-1",startTime:t.order.createTime,duration:15,durationType:"minutes",showZero:!1,onDone:S[2]||(S[2]=T=>x.$emit("handleRefresh"))},null,8,["startTime"])]),_:1},8,["disabled"])):w("",!0),a(v)?(i(),R(A,{key:1,round:"",class:"flex-1 gray-btn border-btn font-normal text-base h-[46px] rounded-full",loading:t.btnLoading,onClick:S[4]||(S[4]=K(T=>x.$emit("handleCancel"),["stop"]))},{default:F(()=>[j(o(x.$t("order.cancelOrder")),1)]),_:1},8,["loading"])):w("",!0),a($)?(i(),R(A,{key:2,round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full",onClick:S[5]||(S[5]=K(T=>x.$emit("handleDelivery"),["stop"]))},{default:F(()=>[j(o(x.$t("order.Ship")),1)]),_:1})):w("",!0),a(n)?(i(),R(A,{key:3,round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full",disabled:a(Re)(t.order.expressTime,t.order.confirmLimit,t.nowTime)>0,loading:t.order.loading,onClick:K(c,["stop"])},{default:F(()=>[j(o(x.$t("order.confirmGeted")),1)]),_:1},8,["disabled","loading","onClick"])):w("",!0),a(d)?(i(),R(A,{key:4,round:"",class:"flex-1 gray-btn border-btn font-normal text-base h-[46px] rounded-full",loading:t.btnLoading,onClick:K(u,["stop"])},{default:F(()=>[j(o(x.$t("order.Platform intervention")),1)]),_:1},8,["loading","onClick"])):w("",!0),a(m)?(i(),R(A,{key:5,round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full",loading:t.order.loading||t.btnLoading,onClick:K(s,["stop"])},{default:F(()=>[e("span",er,o(x.$t("afterSale.Received returned goods and confirmed refund")),1)]),_:1},8,["loading","onClick"])):w("",!0)],64))]))}}},sr={key:0,class:"p-3 break-all bg-white rounded-xl"},or={class:"font-semibold text-base text-b1"},rr={class:"mt-1 font-normal text-sm text-b2"},nr={props:{order:{type:Object,required:!0}},setup(t){return(y,h)=>t.order.status===0?(i(),f("div",sr,[e("div",or,[e("span",null,o(y.$t("order.seller count down label 1")),1)]),e("div",rr,[e("span",null,o(y.$t("order.seller count down label 2")),1)])])):w("",!0)}},ar={key:0,class:"p-3 break-all bg-white rounded-xl"},ir={class:"font-semibold text-base text-b1"},dr={class:"text-b1"},lr={key:0},cr={class:"text-[#FF8812] mx-1"},ur={key:0,class:"mt-1 font-normal text-sm text-b2"},mr=ue({props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0}},emits:["timeDone"],setup(t,{emit:y}){const h=t,{t:b}=L(),l=g(()=>{var s;const d=new Date((s=h.order.refundInfo)==null?void 0:s.expressTime).getTime()/1e3;return dt(d,h.nowTime)}),p=g(()=>l.value>0),v=g(()=>{const d=l.value;if(d<=0)return`00${b("common.seconds")}`;const c=Math.floor(d/(1e3*60*60*24)),s=Math.floor(d%(1e3*60*60*24)/(1e3*60*60)),u=Math.floor(d%(1e3*60*60)/(1e3*60)),_=Math.floor(d%(1e3*60)/1e3);let C="";return c>0&&(C+=`${c}${b("common.day")}`),(s>0||c>0)&&(C+=`${s.toString().padStart(2,"0")}${b("common.hours")}`),(u>0||s>0||c>0)&&(C+=`${u.toString().padStart(2,"0")}${b("common.minutes")}`),C+=`${_.toString().padStart(2,"0")}${b("common.seconds")}`,C}),$=g(()=>n.value),n=g(()=>{const d=h.order||{};return Fe(d)}),m=M(!0);return U(()=>l.value,(d,c)=>{d>0?m.value=!1:!m.value&&d<=0&&(m.value=!0,y("timeDone"))},{immediate:!0,deep:!0}),(d,c)=>{const s=O("i18n-t");return a($)?(i(),f("div",ar,[e("div",ir,[e("span",dr,[a(p)?(i(),f("span",lr,[I(s,{keypath:"afterSale.Please confirm receipt within x days",tag:"span"},{time:F(()=>[e("span",cr,o(a(v)),1)]),_:1})])):(i(),f(E,{key:1},[j(o(d.$t("afterSale.Please confirm receipt promptly")),1)],64))])]),a(p)?(i(),f("div",ur,o(d.$t("afterSale.Buyers can apply for a forced refund once the countdown ends")),1)):w("",!0)])):w("",!0)}}}),fr={key:0,class:"p-3 break-all bg-white rounded-xl"},hr={class:"font-semibold text-base text-b1 flex items-center justify-between"},pr=e("span",null,"等待",-1),vr={class:"text-[#FF8812] mx-1"},xr=e("span",null,"自动收货",-1),yr=e("div",{class:"mt-1 font-normal text-sm text-b2"}," 倒计时结束后买家不收货将自动确认收货 ",-1),br={props:{order:{type:Object,required:!0},nowTime:{type:Number,required:!0}},emits:["timeDone"],setup(t,{emit:y}){const h=t,{t:b}=L(),l=g(()=>{const n=lt(h.order.merchantsConfirm,h.nowTime);return n>0?n:0}),p=g(()=>l.value>0),v=g(()=>{const n=l.value;if(n<=0)return"00天00时00分00秒";const m=Math.floor(n/(1e3*60*60*24)),d=Math.floor(n%(1e3*60*60*24)/(1e3*60*60)),c=Math.floor(n%(1e3*60*60)/(1e3*60)),s=Math.floor(n%(1e3*60)/1e3);return`${m.toString().padStart(2,"0")}天${d.toString().padStart(2,"0")}时${c.toString().padStart(2,"0")}分${s.toString().padStart(2,"0")}秒`}),$=M(!0);return U(()=>l.value,(n,m)=>{n>0?$.value=!1:!$.value&&n<=0&&($.value=!0,y("timeDone"))},{immediate:!0,deep:!0}),(n,m)=>a(p)?(i(),f("div",fr,[e("div",hr,[e("div",null,[pr,e("span",vr,o(a(v)),1),xr])]),yr])):w("",!0)}},De=t=>(Ae("data-v-77d0f6f8"),t=t(),Pe(),t),wr={class:"popup-header"},$r={class:"title text-base font-semibold text-b1 whitespace-nowrap"},gr={class:"popup-body"},_r={class:"gap-1 text-sm flex justify-between w-full"},kr={class:"text-b2 font-normal text-sm whitespace-nowrap"},Tr={class:"flex items-center gap-1 text-b1 text-sm font-normal"},Cr=["src"],Sr={class:""},Ir=De(()=>e("div",{class:"divider"},null,-1)),Ar={class:"gap-1 text-sm flex justify-between w-full"},Pr={class:"text-b2 font-normal text-sm whitespace-nowrap"},Rr={class:"flex items-center gap-1 text-b1 text-sm font-normal"},Nr=["src"],Fr={class:""},Mr=De(()=>e("div",{class:"divider"},null,-1)),Dr={class:"gap-1 text-sm flex justify-between w-full"},jr={class:"text-b2 font-normal text-sm whitespace-nowrap"},Br={class:"flex items-center justify-end text-b1 text-sm font-normal"},qr=["placeholder","disabled"],Or={class:"popup-footer w-full mt-4"},Lr=ue({props:{show:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},order:{type:Object,default:()=>{}}},emits:["update:show","submit"],setup(t,{expose:y,emit:h}){const b=t,{t:l}=L(),p=M(!1),v=M(null);U(()=>b.show,c=>{p.value=c,v.value=null},{immediate:!0}),U(()=>p.value,c=>{h("update:show",c)});const $=()=>{p.value=!1,v.value=0},n=c=>{const s=c.target;let u=s.value;u=u.replace(/[^\d.]/g,"");const _=u.split(".");_.length>2&&(u=_[0]+"."+_.slice(1).join("")),u.indexOf("-")>0&&(u=u.replace(/-/g,"")),_.length===2&&_[1].length>8&&(u=_[0]+"."+_[1].substring(0,8)),v.value=u,s.value=u},m=c=>{const s=c.key,u=c.target.value,_=/[\d.-]/,C=["Backspace","Delete","Tab","Enter","ArrowLeft","ArrowRight","ArrowUp","ArrowDown"];if(!_.test(s)&&!C.includes(s)){c.preventDefault();return}if(s==="."&&u.includes(".")){c.preventDefault();return}if(s==="-"&&u.length>0){c.preventDefault();return}},d=()=>{h("submit",v.value)};return y({onClose:$}),(c,s)=>{const u=O("van-icon"),_=O("VanButton"),C=O("van-popup");return i(),R(C,{show:p.value,"onUpdate:show":s[1]||(s[1]=x=>p.value=x),position:"bottom",round:"",style:{width:"100%",borderRadius:"20px 20px 0 0"}},{default:F(()=>[e("div",wr,[e("span",$r,o(c.$t("order.modifyPrice")),1),I(u,{name:"cross",class:"close-icon",onClick:$})]),e("div",gr,[e("div",_r,[e("div",kr,o(c.$t("order.rigin price")),1),e("div",Tr,[e("img",{src:a(Te)("images/tokens/MCOIN.png"),class:"w-5"},null,8,Cr),e("span",Sr,o(a(ae)(t.order.totalAmountOriginal||0)),1)])]),Ir,e("div",Ar,[e("div",Pr,o(c.$t("order.last price")),1),e("div",Rr,[e("img",{src:a(Te)("images/tokens/MCOIN.png"),class:"w-5"},null,8,Nr),e("span",Fr,o(a(ae)(t.order.totalAmount||0)),1)])]),Mr,e("div",Dr,[e("div",jr,o(c.$t("order.new price")),1),e("div",Br,[We(e("input",{type:"text",placeholder:c.$t("order.new price placeholder"),class:"text-right text-[#FF8812] text-sm font-normal max-w-[150px]","onUpdate:modelValue":s[0]||(s[0]=x=>v.value=x),disabled:t.loading,onInput:n,onKeypress:m},null,40,qr),[[et,v.value]])])])]),e("div",Or,[I(_,{round:"",class:"flex-1 main-btn font-semibold text-b1 text-base h-[46px] rounded-full w-full",loading:t.loading,onClick:d},{default:F(()=>[j(o(c.$t("common.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["show"])}}}),Vr=be(Lr,[["__scopeId","data-v-77d0f6f8"]]),Ur={class:"absolute left-4 flex items-center gap-1 -translate-y-1/2 top-1/2"},Er={class:"font-bold text-base text-b1"},Hr={class:"px-3 safe-bottom pt-[50px] flex flex-col gap-3"},Kr=ue({setup(t){const{getCurrentStoreId:y}=Me(),{getMerchantDhKey:h,decryptAddressKey:b,decryptKey:l}=bt(),{cancel:p}=Ce(),{clerkStore:v}=ye(),{checkLoginAuth:$}=wt(),n=tt(),m=nt(),{t:d}=L(),c=n.query.id,s=M(null),u=M(!1),_=r=>{const k=r.target.scrollTop;u.value=k>25},C=M(!1),x=async()=>{var k,P,N,V,H,Y,Z,J,Q,X,W,ee,te,se,oe,re,q,ke;if(C.value)return;C.value=!0;const r=await Nt({id:c});if(C.value=!1,(k=r.data)!=null&&k.userAddress&&(r.data.userAddress.postscript=r.data.postscript),(P=r.data)!=null&&P.userAddress&&((V=(N=r.data)==null?void 0:N.userAddress)!=null&&V.encryptFlag)){const B=await h((H=r.data)==null?void 0:H.address,(Y=r.data)==null?void 0:Y.submitUserPubKey);B&&(r.data.userAddress=b(r.data.userAddress,B))}if(r.data.shippingHash){const B=await h(r.data.address,(Z=r.data)==null?void 0:Z.shippingUserPubKey);if(B){const ne=l(r.data.expressNo,B);ne.hash===r.data.shippingHash&&(r.data.expressNo=ne.decrypt,r.data.expressCompany=l(r.data.expressCompany,B).decrypt)}}if((Q=(J=r.data)==null?void 0:J.refundInfo)!=null&&Q.shippingHash){const B=await h((X=r.data)==null?void 0:X.address,(ee=(W=r.data)==null?void 0:W.refundInfo)==null?void 0:ee.shippingUserPubKey);if(B){const ne=l((se=(te=r.data)==null?void 0:te.refundInfo)==null?void 0:se.expressNo,B);ne.hash===((re=(oe=r.data)==null?void 0:oe.refundInfo)==null?void 0:re.shippingHash)&&(r.data.refundInfo.expressNo=ne.decrypt,r.data.refundInfo.expressCompany=l((ke=(q=r.data)==null?void 0:q.refundInfo)==null?void 0:ke.expressCompany,B).decrypt)}}s.value={...r.data},r.data.orderPostscriptUpdateReviewId&&Qe()},S=r=>{m.push(r)},A=()=>{x()},T=M(new Date().getTime()/1e3);st(()=>{T.value+=1},1e3);const{merchantConfirm:je}=Ce(),Be=async r=>{if(v.isClerk&&!v.clerkAuth)return D(d("order.Requires merchant account operation"));r.loading=!0;try{const P=(await Se({orderIds:r.id})).data.ordIds,N=await je(P);if(!N.success)return;if(r.payType!==jt.STORE_CARD){if(!(await Ie({ordIds:P,hash:N.result.hash})).success)return;r.merchantsConfirm=1,D.success(d("order.confirmSuccess")),setTimeout(()=>{m.replace({path:"/sellerOrderList",query:{type:1,active:4}})},2e3)}}finally{r.loading=!1}},we=M(null),[qe,$e]=le(!1),[Oe,fe]=le(!1),ge=()=>{fe(!0)},Le=async r=>{if(!r){D.fail("请输入修改后的价格");return}if(r<=0){D.fail("价格不能小于0");return}$e(!0);const k=await Ft({orderId:s.value.id,amount:r});$e(!1),k.success&&(D.success("修改价格成功"),fe(!1),sessionStorage.setItem("modifiedOrderId",s.value.id.toString()),x())},Ve=()=>{m.push(`/sellerDelivery?id=${s.value.id}&detail=1`)},Ue=()=>{n.params.quick==="quackChange"&&ge()},[he,_e]=le(!1),[Ee,ie]=le(!1),He=async()=>{if(v.isClerk&&!v.clerkAuth)return D(d("order.Requires merchant account operation"));ve.value=!1,!he.value&&(s.value.creditFlag?ie(!0):pe())},pe=async()=>{var r;_e(!0);try{const P=(await Se({orderIds:c})).data.ordIds,N=await p(P);if(!N.success)return;if(ve.value){const H=await Bt({orderId:c,type:1,hash:(r=N.result)==null?void 0:r.transactionHash})}if(!(await Ie({ordIds:P,hash:N.result.transactionHash})).success)return;ie(!1),x(),setTimeout(()=>{m.push({path:"/sellerOrderList",query:{active:0},replace:!0})},500)}catch(k){D(k.message||k)}finally{_e(!1)}},ve=M(!1),Ke=async()=>{try{ve.value=!0,s.value.creditFlag?ie(!0):pe()}catch(r){D(r.message||r)}},Ge=async r=>{S("/refundService?&role=merchants&id="+r.id)},ze=g(()=>Ne(s.value)),Ye=g(()=>vt(s.value)),Ze=g(()=>xt(s.value)),de=M(!1),Je=async r=>{if(de.value)return;de.value=!0;const k=await Dt({id:s.value.orderPostscriptUpdateReviewId,passFlag:r});de.value=!1,k.success&&x()},Qe=async()=>{var k,P,N,V,H,Y,Z,J,Q,X,W,ee,te,se,oe,re;const r=await Mt({id:s.value.orderPostscriptUpdateReviewId});if(r.msg==="success"){if(r.data.oldPostscript&&((k=r.data.oldPostscript)!=null&&k.encryptFlag)){const q=await h((P=s.value)==null?void 0:P.address,(N=s.value)==null?void 0:N.submitUserPubKey);q&&(r.data.oldPostscript=b(r.data.oldPostscript,q))}if(r.data.newPostscript&&((V=r.data.newPostscript)!=null&&V.encryptFlag)){const q=await h((H=s.value)==null?void 0:H.address,(Y=s.value)==null?void 0:Y.submitUserPubKey);q&&(r.data.newPostscript=b(r.data.newPostscript,q))}s.value={...s.value,modifyInfo:r.data},s.value.userAddress.id=(Z=r.data.newPostscript)==null?void 0:Z.addressId,s.value.userAddress.userName=(J=r.data.newPostscript)==null?void 0:J.userName,s.value.userAddress.telNumber=(Q=r.data.newPostscript)==null?void 0:Q.telNumber,s.value.userAddress.postalCode=(X=r.data.newPostscript)==null?void 0:X.postalCode,s.value.userAddress.provinceName=(W=r.data.newPostscript)==null?void 0:W.provinceName,s.value.userAddress.cityName=(ee=r.data.newPostscript)==null?void 0:ee.cityName,s.value.userAddress.countyName=(te=r.data.newPostscript)==null?void 0:te.countyName,s.value.userAddress.detailInfo=(se=r.data.newPostscript)==null?void 0:se.detailInfo,s.value.userAddress.encryptFlag=(oe=r.data.newPostscript)==null?void 0:oe.encryptFlag,s.value.userAddress.postscript=(re=r.data.newPostscript)==null?void 0:re.postscript}};return ot(async()=>{var r;$(!0)&&(T.value=await gt(),await x(),we.value=(r=await y())==null?void 0:r.merchant,Ue())}),(r,k)=>(i(),f("div",{class:"font-Puhui main-bg safe-bottom-page",onScroll:_},[e("section",{class:rt(["header-bar fixed top-0 left-0 right-0 flex font-normal justify-center text-sm items-center h-[50px] px-4 z-50 backdrop-blur-md transition-all duration-300",{"bg-white":u.value}])},[e("div",Ur,[I(Pt)]),e("div",Er,[e("span",null,o(r.$t("order.orderDetail")),1)])],2),s.value?(i(),f(E,{key:0},[e("section",Hr,[I(Yt,{"now-time":T.value,order:s.value,onTimeDone:A},null,8,["now-time","order"]),a(ze)?(i(),R(Go,{key:0,order:s.value,"now-time":T.value,onTimeDone:A},null,8,["order","now-time"])):w("",!0),a(Ye)?(i(),R(br,{key:1,order:s.value,nowTime:T.value,onTimeDone:A},null,8,["order","nowTime"])):w("",!0),a(Ze)?(i(),R(Xo,{key:2,order:s.value,"now-time":T.value,onTimeDone:A},null,8,["order","now-time"])):w("",!0),s.value.status===0&&!s.value.hash?(i(),R(nr,{key:3,order:s.value},null,8,["order"])):w("",!0),I(_t,{order:s.value,nowTime:T.value,role:"merchant"},null,8,["order","nowTime"]),I(mr,{order:s.value,nowTime:T.value,onTimeDone:A},null,8,["order","nowTime"]),I(hs,{order:s.value,nowTime:T.value},null,8,["order","nowTime"]),I(kt,{order:s.value,nowTime:T.value},null,8,["order","nowTime"]),I(Tt,{order:s.value,"show-price":!1,"show-shipping-template":!0},null,8,["order"]),s.value.status===0&&!s.value.hash?(i(),R(Ct,{key:4,order:s.value},null,8,["order"])):w("",!0),s.value.status!==0||s.value.hash?(i(),R(Oo,{key:5,order:s.value},null,8,["order"])):w("",!0),s.value.id&&s.value.status===0?(i(),R(St,{key:6,order:s.value},null,8,["order"])):w("",!0),s.value.status==0&&s.value.hash?w("",!0):(i(),R(tr,{key:7,order:s.value,"now-time":T.value,"shop-address":we.value,btnLoading:a(he),mrLoading:de.value,onHandleTo:S,onHandleConfirm:Be,onHandleModifyPrice:ge,onHandleRefresh:x,onHandleDelivery:Ve,onHandleCancel:He,onHandleMerchantReceive:Ke,onHandlePlatformIntervene:Ge,onModifyReview:Je},null,8,["order","now-time","shop-address","btnLoading","mrLoading"]))]),I(Vr,{ref:(P,N)=>{N.changePriceRef=P},show:a(Oe),loading:a(qe),onClose:k[0]||(k[0]=P=>a(fe)(!1)),order:s.value,onSubmit:Le},null,8,["show","loading","order"]),I(Rt,{order:s.value,show:a(Ee),onClose:k[1]||(k[1]=P=>a(ie)(!1)),loading:a(he),onHandleSubmit:pe},null,8,["order","show","loading"])],64)):w("",!0)],32))}}),yn=be(Kr,[["__scopeId","data-v-2ea46d40"]]);export{yn as default};
