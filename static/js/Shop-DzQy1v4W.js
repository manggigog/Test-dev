import{_ as Z,z as H,F as R,Z as D,H as o,$ as q,I as t,G as d,K as te,a4 as j,Q as f,O as l,J as se,P as y,X as oe,Y as ne,U as w,a2 as Q,r as m,E as _e,a1 as ye,a3 as X,N as $e,by as je,o as ke,x as be,q as Ie,y as ae,bA as Se,bj as Ce,T as P,R as He,bT as Me,bs as Ee,V as Ve,a0 as Ne,D as we,ad as Pe,n as Ue}from"./vendor-Dr_RpJ_Y.js";import{_ as Qe}from"./auth-icon-Bx5iOxx7.js";import{_ as Xe}from"./member-CkdtKF8y.js";import{f as Ke,y as Ye,k as E,a as de,bB as Ze,ar as Je,av as We,as as et,w as Te,b as tt,u as st,bC as ot,aO as nt,bD as at,Y as re,bE as lt,a0 as it,aU as ct,$ as rt,bF as ut}from"./index-CU2nzZe6.js";import{R as ee}from"./rangking-soiwLY3n.js";import{_ as dt,M as ft}from"./MetaKeyTag-DnBwtzWh.js";import{_ as mt}from"./ExpressMinutesTag-DqYOjPIv.js";import{R as Be}from"./RatioBox-BwMA7vB_.js";import{_ as ht}from"./ApproveInfo-8wQfAir7.js";import{B as pt}from"./BoutiqueLabelInLogo-6zoXLJ5H.js";import{q as vt}from"./beiRanking-B5hPI_dv.js";import{_ as gt}from"./MCOIN-BOqZVkND.js";import{_ as yt}from"./ImgBoutiqueLable-B-2xCcw4.js";import{C as wt}from"./CommonVanProvider-KZuKVOde.js";import{_ as xt}from"./logo-JjZ15zkW.js";import{c as _t,i as $t,s as kt}from"./convertToImage-Cfv7lGZo.js";import{M as bt}from"./MallTabBar-DzVMF8TV.js";import{R as It}from"./RemovedShelves-CK5gRgpW.js";import{c as xe}from"./mall-COk3vM6s.js";import{s as St}from"./useOrderStatus-CfUN23nj.js";import{_ as Ct}from"./ServiceIcon-Ce2ytRnc.js";import{O as Tt,c as Bt}from"./offlineGoods-DvT2Go6q.js";import"./shop-CeqcS6K2.js";import"./BackIcon-CDrGaEPo.js";import"./upload-GBdaxjFw.js";import"./active_empty-ofPcrP74.js";import"./HelpPop-DStj4MIe.js";const Dt="/static/images/collect-oXqS1C1N.png",Ft="/static/images/collected-BX-G0Q8O.png",Lt="/static/images/share-tVl568Cu.svg",qt="/static/images/governance-BAxxHEE2.svg",Rt=e=>(oe("data-v-754a2b67"),e=e(),ne(),e),zt={class:"py-8 text-base text-center text-black"},Gt={class:"flex flex-wrap items-center justify-center flex-1 gap-x-4 gap-y-1"},At={class:"w-[30px] flex-center bg-[#FED73A] rounded-3xl ml-1"},Ot=Rt(()=>t("img",{src:Xe,class:"w-2.5 h-2.5"},null,-1)),jt={class:"text-xs"},Ht={class:"mt-5"},Mt={class:"flex justify-center"},Et=H({props:{show:{type:Boolean},list:{default:()=>[]}},emits:["close"],setup(e,{emit:c}){return(h,r)=>{const L=R("van-button");return o(),D(Ye,{width:"90%",show:e.show,name:h.$t("shop.Service Guarantee"),teleport:"body",onClose:r[1]||(r[1]=()=>{c("close")})},{default:q(()=>[t("div",zt,[t("div",Gt,[(o(!0),d(se,null,te(e.list,p=>(o(),d("div",{class:"flex items-center text-sm",key:p},[j(f(p.address&&l(Ke)(p.address,"....",4,3))+" ",1),t("div",At,[Ot,t("span",jt,"v"+f(p.memberLevel),1)])]))),128))]),t("div",Ht,f(h.$t("shop.Already guaranteed for this store")),1)]),t("div",Mt,[y(L,{class:"w-1/2 mx-2.5 btn-orange btn-shadow text-white font-semibold",onClick:r[0]||(r[0]=p=>c("close"))},{default:q(()=>[j(f(h.$t("common.confirm")),1)]),_:1})])]),_:1},8,["show","name"])}}}),Vt=Z(Et,[["__scopeId","data-v-754a2b67"]]),Nt={key:0,class:"flex items-center min-w-fit"},Pt=["src"],Ut={class:"bg-[#FFF1D6] rounded-2xl text-xs font-normal py-0.5 px-1.5 pl-3.5"},Qt=H({props:{rankNum:null,type:{default:ee.SR},showHelpButton:{type:Boolean,default:!1},isLogin:{type:Boolean,default:!1}},emits:["help"],setup(e){return(c,h)=>+e.rankNum>0?(o(),d("div",Nt,[t("img",{src:l(E)(`images/shop/rank${e.rankNum>3?4:e.rankNum}.png`),class:"inline-block w-[14px] h-[16px] -mr-2.5 z-10"},null,8,Pt),t("div",Ut,[j(f(e.type===l(ee).EBR?c.$t("ranking.store boost",{num:e.rankNum}):c.$t("ranking.recently hot sales",{num:e.rankNum}))+" ",1),e.showHelpButton&&e.isLogin?(o(),d("span",{key:0,onClick:h[0]||(h[0]=r=>c.$emit("help")),class:"ml-1 text-newOrigin text-xs font-normal cursor-pointer text-left"},f(e.type===l(ee).EBR?c.$t("ranking.power_to"):c.$t("mall.Help TA")),1)):w("",!0)])])):w("",!0)}}),Xt=e=>(oe("data-v-054950fa"),e=e(),ne(),e),Kt={class:"relative"},Yt={class:"py-3 z-[999]"},Zt={class:"w-full flex justify-start items-center px-2.5"},Jt={class:"w-10 h-10 rounded-[4px] overflow-hidden flex-shrink-0 relative"},Wt=["src"],es={class:"absolute right-0 top-0"},ts={class:"ml-2 flex flex-col justify-between items-start"},ss={key:0,src:qt,class:"w-4 mr-1 align-text-top"},os={class:"flex items-center bg-[#FED73A] rounded-xl py-[0.20rem] px-1.5"},ns=Xt(()=>t("img",{src:Qe,class:"inline-block w-3 h-3 mr-0.5"},null,-1)),as={class:"text-xxs text-default"},ls={class:"flex items-center text-sm text-primary"},is={class:"ml-1"},cs={class:"h-10 flex flex-col justify-start items-center ml-auto flex-shrink-0"},rs={class:"w-full flex justify-start items-center mt-2 gap-1.5 overflow-x-auto px-2.5"},us={class:"mt-3 overflow-x-auto px-2.5"},ds={key:0,class:"flex"},fs=["onClick"],ms=["src"],hs={key:1,class:"flex"},ps={class:"flex-shrink-0 w-[calc((100%-16px)/3)] h-[105px]"},vs=["src"],gs=H({props:{info:null,list:{default:()=>[]},authorizeInfo:null},emits:["handleTo"],setup(e,{expose:c,emit:h}){const r=e,{accountStore:L}=de(),[p,a]=Q(!1),[S,b]=Q(!1),$=m({}),I=async()=>{var A,v,i,C,k;if(!((A=r.info)!=null&&A.id))return;const{success:x,data:u}=await vt({shopId:(v=r.info)==null?void 0:v.id,month:Ze()});!x||(u==null?void 0:u.status)!==1||($.value={...u,mai:u.allMai,type:2,id:u.rankingId,avatar:(i=r.info)==null?void 0:i.logo,nickname:(C=r.info)==null?void 0:C.storeName,address:(k=r.info)==null?void 0:k.merchant})},z=x=>{const u=r.info.scenery.split(",")||[];je({images:u,startPosition:x||0,loop:!1,closeOnPopstate:!0})};return _e(()=>{I()}),c({getMyRanking:I}),(x,u)=>{var v,i,C;const A=R("van-rate");return o(),d("div",Kt,[t("div",Yt,[t("div",Zt,[t("div",Jt,[t("img",{src:e.info.logo||e.info.scenery&&e.info.scenery.split(",")[0]||l(E)("images/goods/defaultImg.png"),class:"w-10 h-full object-cover"},null,8,Wt),t("div",es,[y(pt,{type:e.info.type},null,8,["type"])])]),t("div",ts,[t("div",{class:"text-base font-semibold text-black line-clamp-1 max-w-max leading-[22px] inline-flex",onClick:u[1]||(u[1]=X(k=>e.list&&e.list.length>0?l(b)(!0):null,["stop"]))},[e.list&&e.list.length>0?(o(),d("img",ss)):w("",!0),j(" "+f(e.info.storeName)+" ",1),(v=e.authorizeInfo)!=null&&v.authorizeAddress?(o(),d("div",{key:1,onClick:u[0]||(u[0]=X(()=>{l(a)(!0)},["stop"])),class:"inline-block ml-1.5 lex-shrink-0 align-text-bottom"},[t("div",os,[ns,t("span",as,f(x.$t("ecology.authorized")),1)])])):w("",!0)]),t("div",ls,[y(A,{class:"flex-shrink-0",readonly:"","allow-half":"",modelValue:e.info.star,"onUpdate:modelValue":u[2]||(u[2]=k=>e.info.star=k),size:16,gutter:"0",color:"#FEA021"},null,8,["modelValue"]),t("span",is,f(e.info.star),1)])]),t("div",cs,[y(Be,{tag:x.$t("common.rebate"),ratio:e.info.discountRatio||0},null,8,["tag","ratio"])])]),t("div",rs,[(i=$.value)!=null&&i.sort?(o(),D(Qt,{key:0,"rank-num":(C=$.value)==null?void 0:C.sort,type:l(ee).EBR,"show-help-button":!0,"is-login":l(L).isLogin,onHelp:u[3]||(u[3]=k=>h("handleTo",`/talentRanking/rankingShop?shopId=${e.info.id}`))},null,8,["rank-num","type","is-login"])):w("",!0),ye(x.$slots,"like",{},void 0,!0),y(dt,{type:e.info.buyFlag?1:e.info.watchFlag?2:e.info.followFlag?3:0},null,8,["type"]),e.info.recentExpressSeconds?(o(),D(mt,{key:1,time:e.info.recentExpressSeconds},null,8,["time"])):w("",!0),e.info.metakeyFlag?(o(),D(ft,{key:2})):w("",!0)]),t("div",us,[e.info.scenery?(o(),d("div",ds,[(o(!0),d(se,null,te(e.info.scenery.split(","),(k,G)=>(o(),d("div",{key:k,class:$e(["flex-shrink-0 w-[calc((100%-16px)/3)] h-[105px]",e.info.scenery.split(",").length-1===G?"":"mr-2"]),onClick:O=>z(G)},[t("img",{src:k||l(E)("images/goods/defaultImg.png"),class:"object-cover w-full h-full aspect-square rounded-xl",alt:""},null,8,ms)],10,fs))),128))])):(o(),d("div",hs,[t("div",ps,[t("img",{src:e.info.logo||l(E)("images/goods/defaultImg.png"),class:"w-full h-full aspect-square rounded-xl object-cover"},null,8,vs)])]))]),ye(x.$slots,"default",{},void 0,!0)]),y(Vt,{list:e.list,show:l(S),onClose:u[4]||(u[4]=k=>l(b)(!1))},null,8,["list","show"]),l(p)&&e.authorizeInfo?(o(),D(ht,{key:0,show:l(p),info:e.authorizeInfo,onClose:u[5]||(u[5]=k=>l(a)(!1))},null,8,["show","info"])):w("",!0)])}}}),ys=Z(gs,[["__scopeId","data-v-054950fa"]]),ws="/static/images/plus-DOIrZp3k.png",xs={key:0,class:"bg-white rounded-xl p-3 my-3"},_s={class:"text-base font-semibold"},$s=["onClick"],ks={class:"relative w-[80px] h-[80px] flex-shrink-0 bg-b5 overflow-hidden rounded-lg"},bs={class:"object-cover w-full h-full aspect-square",fit:"cover"},Is={class:"w-full min-h-[80px] flex flex-col justify-between ml-2"},Ss={class:"text-b1 font-semibold line-clamp-1"},Cs={class:"text-b3 font-normal line-clamp-1"},Ts={class:"text-b3 font-normal"},Bs={class:"flex justify-between items-center"},Ds={class:"flex-start"},Fs=t("img",{class:"w-4 h-4 mr-1",src:gt},null,-1),Ls={class:"font-semibold mr-1"},qs=["onClick"],Rs=t("img",{src:ws,class:"w-5 h-5"},null,-1),zs=[Rs],Gs={key:0},As={key:1},Os=H({props:{merchantAddress:null},setup(e,{expose:c}){const h=e,r=ke(),{t:L}=be(),p=Ie(),a=Je(),S=m([]),b=m(!1),$=m(!1),I=m(0),z=m(10),x=m(0),[u,A]=Q(!1),v=()=>{A(!u.value)},i=g=>{p.push(`/goodsDetail?id=${g.id}`)},C=async()=>{b.value=!0,I.value+=1,await O(),b.value=!1},k=ae(()=>{var g;return u.value?S.value:(g=S.value)==null?void 0:g.slice(0,2)}),G=m([]),O=async()=>{const g=await We({page:I.value,size:z.value,isActivity:1,boutiqueTop:!0,merchantAddress:h.merchantAddress});if(b.value=!1,!g.success){$.value=!0;return}if(!g.data||!g.total){$.value=!0;return}x.value=g.total,G.value=g.data||[],S.value=I.value===1?G.value:S.value.concat(G.value),S.value.length>=x.value&&($.value=!0)},K=()=>{I.value=0,x.value=0,$.value=!1,S.value=[],C()},M=async g=>{if(g.stock===0&&g.goodsTypes!==2){P(L("order.Insufficient stock"));return}P.loading({duration:0});const V={needlogin:"true",...r.query};p.replace({path:r.path,query:V});const U=await et(g.id);P.clear(),U.success&&(P(L("cart.addTips")),a.getCartCount())};return c({init:K}),(g,V)=>{const U=R("van-icon"),le=R("VanList"),J=Se("lazy");return $.value&&x.value===0?w("",!0):(o(),d("div",xs,[t("div",_s,f(g.$t("shop.curactive")),1),y(le,{loading:b.value,"onUpdate:loading":V[0]||(V[0]=B=>b.value=B),finished:$.value,"loading-text":g.$t("common.loading"),onLoad:C},{default:q(()=>[(o(!0),d(se,null,te(l(k),B=>(o(),d("div",{class:"flex mt-3",key:B.id,onClick:N=>i(B)},[t("div",ks,[Ce(t("img",bs,null,512),[[J,B.icons&&B.icons.split(",")[0]||l(E)("images/goods/defaultImg.png")]]),y(yt,{activity:!0,type:2})]),t("div",Is,[t("section",null,[t("div",Ss,f(B.goodsName),1),t("div",Cs,f(B==null?void 0:B.goodsDesc),1),t("div",Ts,f(g.$t("mall.15th sale",{salesVolume:B.volume15})),1)]),t("div",Bs,[t("div",Ds,[Fs,t("span",Ls,f(B.price),1),y(Be,{tag:g.$t("common.rebate"),ratio:B.discountRatio||0},null,8,["tag","ratio"])]),t("div",{onClick:X(N=>M(B),["stop"])},zs,8,qs)])])],8,$s))),128)),S.value.length>2?(o(),d("div",{key:0,onClick:v,class:"text-xs text-b3 font-normal text-center mt-3.5"},[l(k).length==2?(o(),d("div",Gs,[j(f(g.$t("shop.chakanhuodongshsangpin"))+" ",1),y(U,{name:"arrow-down"})])):(o(),d("div",As,[j(f(g.$t("refund.put way"))+" ",1),y(U,{name:"arrow-up"})]))])):w("",!0)]),_:1},8,["loading","finished","loading-text"])]))}}}),js={class:"bg-white rounded-xl my-3 py-3"},Hs={class:"flex-center-bw px-3"},Ms={class:"text-base font-semibold"},Es={class:"pl-3 pt-3"},Vs=["onClick"],Ns={class:"object-cover w-full h-full aspect-square",fit:"cover"},Ps=H({props:{boutiqueGoods:null,title:null,type:null},emits:["toMore","toDetail"],setup(e,{emit:c}){const h=e,r=()=>{c("toMore",h.type)};return(L,p)=>{const a=R("van-icon"),S=R("van-swipe-item"),b=R("van-swipe"),$=Se("lazy");return o(),d("div",js,[t("div",Hs,[t("div",Ms,f(e.title),1),t("div",{class:"text-xs text-b3 whitespace-nowrap",onClick:r},[j(f(L.$t("common.check more")),1),y(a,{name:"arrow"})])]),t("div",Es,[y(b,{class:"flex-start",loop:!1,width:126,"show-indicators":!1},{default:q(()=>[(o(!0),d(se,null,te(e.boutiqueGoods,(I,z)=>(o(),D(S,{class:"flex",key:I.id},{default:q(()=>[t("div",{class:$e(["flex-1 w-full",{"mr-4":z<e.boutiqueGoods.length-1}])},[t("div",{onClick:()=>c("toDetail",I),class:"relative w-[110px] h-[110px] flex-shrink-0 bg-black-100 overflow-hidden rounded-lg"},[Ce(t("img",Ns,null,512),[[$,I&&I.goods&&I.goods.icons&&I.goods.icons.split(",")[0]||l(E)("images/goods/defaultImg.png")]])],8,Vs)],2)]),_:2},1024))),128))]),_:1})])])}}}),ue=Z(Ps,[["__scopeId","data-v-9f70f930"]]),Us="/static/images/shop-zan-CIPmIHxz.svg",Qs=t("img",{src:Us,class:"w-[14px] h-[14px]"},null,-1),Xs={key:0,class:"text-newOrigin text-xs cursor-pointer text-left"},Ks=H({props:{likeFlag:{type:Boolean,default:!0},likeCount:{default:0},isLogin:{type:Boolean,default:!1}},emits:["onLike"],setup(e){return(c,h)=>(o(),d("div",{class:"bg-[#FFF1D6] rounded-2xl text-xs py-0.5 px-1.5 flex items-center gap-x-1 min-w-fit",onClick:h[0]||(h[0]=r=>c.$emit("onLike"))},[Qs,t("span",null,f(e.likeCount),1),!e.likeFlag&&e.isLogin?(o(),d("span",Xs,f(c.$t("shop.like")),1)):w("",!0)]))}}),Ys={class:"flex items-center justify-between text-b3 text-xs mt-3"},Zs={class:"w-[70%] flex items-center"},Js={key:0,class:"shrink-0"},Ws={class:"w-fit line-clamp-1 truncate"},eo={key:1,class:"shrink-0"},to={class:"shrink-0 flex items-center whitespace-nowrap ml-3"},so=H({props:{commentReview:null,commentTotal:null},setup(e){const c=e,h=ae(()=>{var r;return!!((r=c.commentReview)!=null&&r.commentContent)});return(r,L)=>{const p=R("van-icon");return o(),d("div",Ys,[t("div",Zs,[l(h)?(o(),d("div",Js,"“")):w("",!0),t("div",Ws,f(e.commentReview.commentContent),1),l(h)?(o(),d("div",eo,"”")):w("",!0)]),t("div",to,[t("span",null,f(r.$t("offline.shop_evaluate_num",{num:e.commentTotal||0})),1),y(p,{name:"arrow",class:"text-xxs text-[#666] ml-1"})])])}}}),De=e=>(oe("data-v-7b7b2fc0"),e=e(),ne(),e),oo={class:"w-full h-[190px] overflow-hidden"},no=["src"],ao={key:0,class:"absolute left-0 w-full px-3 flex-center-bw top-3"},lo={class:"ml-1 text-sm"},io={class:"mt-[-45px]"},co={class:"border-4 rounded-2xl border-solid border-[#FFF] drop-shadow-lg w-[90px] h-[90px] bg-[#D9D9D9] m-auto"},ro=["src"],uo={class:"text-[#2E2008] font-medium text-lg text-center mt-5"},fo={class:"flex items-center justify-between px-5 pt-10 pb-5"},mo={class:"flex items-center"},ho={class:"border border-solid border-[#D9D9D9] p-1"},po={class:"text-[#2E2008] opacity-80 ml-3"},vo=De(()=>t("br",null,null,-1)),go=De(()=>t("img",{src:xt,class:"w-[60px] h-[60px] object-contain"},null,-1)),yo=H({props:{show:{type:Boolean},shopInfo:null},emits:["close","onSuceess"],setup(e,{emit:c}){const{shopInfo:h,show:r}=e,{width:L,height:p}=He(),a=m(null),S=m(100);Me(a,v=>{const i=v[0],{height:C}=i.contentRect;S.value=C||100});const b=ae(()=>window.location.origin+"/#/category?deliveryType=1&init=1&shopId="+h.id),{loadingToggle:$}=Te(),[I,z]=Q(!1),x=()=>{c("close")},u=()=>{z(!0),$(!0),document.getElementById("saveHtml")?setTimeout(()=>{A()},200):setTimeout(()=>{A()},3e3)},A=async()=>{let v=document.getElementById("saveHtml");v.style.display="block";const i=await _t(v);await $t(i)&&(v.style.display="none",kt(i,h.storeName||""),x(),v.style.display="block",z(!1),$(!1),c("onSuceess"))};return(v,i)=>{const C=R("van-icon"),k=R("VanButton"),G=R("van-popup");return o(),D(G,{show:e.show,"onUpdate:show":i[1]||(i[1]=O=>Ne(r)?r.value=O:null),onClickOverlay:x,class:"w-full h-full bg-default/20",style:Ve({paddingLeft:`${(l(L)-300)/2}px`,paddingTop:`${(l(p)-S.value)/2}px`}),onClick:x},{default:q(()=>[t("div",{class:"w-[300px] rounded-lg overflow-hidden",onClick:i[0]||(i[0]=X(()=>{},["stop"]))},[t("div",{class:"w-[300px] relative bg-white",id:"saveHtml",ref:(O,K)=>{K.saveHtml=O,a.value=O}},[t("div",oo,[t("img",{src:(e.shopInfo.shareImg||e.shopInfo.scenery||l(E)("images/shop/shop_bg.png"))+"?"+new Date().getTime(),class:"object-cover w-full",alt:"",crossOrigin:"anonymous"},null,8,no)]),l(I)?w("",!0):(o(),d("div",ao,[y(k,{class:"text-sm h-[30px] min-w-[65px] rounded-2xl text-white share-btn",onClick:u},{default:q(()=>[y(C,{name:"back-top",class:"rotate-180",size:"18"}),t("span",lo,f(v.$t("common.save")),1)]),_:1}),t("div",{class:"share-btn w-[30px] h-[30px] rounded-full flex justify-center items-center text-white text-lg",onClick:x},[y(C,{name:"cross"})])])),t("div",io,[t("div",co,[t("img",{src:(e.shopInfo.logo||l(E)("images/goods/defaultImg.png"))+"?"+new Date().getTime(),class:"h-[82px] aspect-square rounded-xl object-cover",crossOrigin:"anonymous"},null,8,ro)]),t("div",uo,f(e.shopInfo.storeName||"-"),1),t("div",fo,[t("div",mo,[t("div",ho,[y(Ee,{value:l(b),size:60,level:"H"},null,8,["value"])]),t("div",po,[j(f(v.$t("common.new found")),1),vo,j(f(v.$t("common.share you")),1)])]),go])])],512)])]),_:1},8,["show","style"])}}}),wo=Z(yo,[["__scopeId","data-v-7b7b2fc0"]]),xo=e=>(oe("data-v-4fff2aac"),e=e(),ne(),e),_o={class:"flex items-center gap-4"},$o={key:0,class:"w-5 h-5",src:Dt},ko={key:1,class:"w-5 h-5",src:Ft},bo=xo(()=>t("img",{class:"w-5 h-5",src:Lt},null,-1)),Io=[bo],So={key:0,class:"px-3 safe-body overflow-y-scroll"},Co={class:"px-2.5"},To=H({name:"Shop"});function Bo(e){const{checkLoginAuth:c,checkRegisterAuth:h}=tt(),{orderGoodsStore:r}=de(),{t:L}=be(),{loadingToggle:p}=Te(),a=m({}),S=ke(),b=Ie(),$=m(null),{login:I}=st(),[z,x]=Q(!1),[u,A]=Q(!1),v=m(),i=ae(()=>S.query.shopId),C=s=>{s===2?b.push(`category?shopId=${+i.value}&deliveryType=1`):s===3?b.push(`category?shopId=${+i.value}&deliveryType=2`):b.push(`boutique-goods?shopId=${+i.value}`)},k=m(null),G=m(null);we(i,async s=>{var n,T;s&&s!==G.value&&(p(!0),G.value=s,$.value&&($.value.list=[]),await he(),$.value&&$.value.resetData(),v.value&&((n=v.value)==null||n.getMyRanking()),k.value&&((T=k.value)==null||T.init()),p(!1))});const O=m(null),K=async()=>{const s=await rt(a.value.merchant);s.success&&s.data&&(O.value=s.data)},M=s=>{b.push(s)},g=async()=>{const s=await it(i.value);!s.success||!s.data||(a.value=s.data,await Ue(),qe())},V=async s=>{if(!c(!0))return;p(!0);const{success:n}=await at({shopIds:[s.id||i.value],type:s.isFollow?2:1});p(!1),n&&(s.isFollow=!s.isFollow,s.isFollow?P({message:"收藏成功",icon:re("toast-success.svg"),duration:3e3}):P({message:"取消收藏",icon:re("toast-success.svg"),duration:3e3}))},U=()=>{P({message:L("common.Saved successfully"),icon:re("toast-success.svg"),duration:3e3})},le=async()=>{if(!c(!0)||!await h(!0))return;r.changeOfflineInfo({shop:a.value});const s={key:i.value,orderType:Tt.STORE};b.push({path:"/offlineSubmit",query:s})},J=m([]),B=async()=>{var n,T,F;if(!((n=a.value)!=null&&n.type))return;const s=await xe({merchant:(T=a.value)==null?void 0:T.merchant,status:1,page:1,size:12,type:(F=a.value)==null?void 0:F.type,sortType:3,orderBy:1,deleteFlag:!1});s.success&&(J.value=s.data)},N=m(null),fe=async()=>{var n;N.value=[];const s=await xe({merchant:(n=a.value)==null?void 0:n.merchant,status:1,page:1,size:12,deliveryType:1,deleteFlag:!1});s.success&&(N.value=s.data)},ie=m([]),Fe=async()=>{if(!i.value)return;N.value=[];const{success:s,data:n}=await ct({shopId:Number(i.value),goodsStatus:Bt.Published,page:1,size:12,sortBy:"desc|goods_sales_volume",distinctFlag:!0});s&&(ie.value=(n.records||[]).map(T=>({...T,goods:{icons:(T==null?void 0:T.goodsIcons)||""}})))},me=m([]),Le=async()=>{if(!c(!1))return;const{success:s,data:n}=await ut({page:1,size:10,shopId:S.query.shopId});s&&(me.value=n&&n[0].guaranteeList||[])},he=async()=>{await g(),B(),fe(),Fe(),K(),Le()},pe=m(null),qe=()=>{pe.value&&pe.value.addEventListener("scroll",ze)},Re=m(1),ve=m([]),ze=s=>{const{scrollTop:n}=s.target,{length:T}=ve.value;for(let F=0;F<T;F++)if(n<ve.value[F].offsetTop){Re.value=F+1;break}},{accountStore:Ge}=de(),Ae=async()=>{c(!0)&&(a.value.likeFlag||(lt({shopId:i.value}),a.value.likeCount++,a.value.likeFlag=!0))};we(()=>{var s;return(s=a.value)==null?void 0:s.merchant},async s=>{s&&await fe()});const ge=m(0),W=m(null),Oe=async()=>{var T,F,Y,_;const s={page:1,size:1,shopId:i.value,sortBy:"desc|comment_time",havePicsFlag:null,commentStatus:1},n=await nt(s);n.success?(T=n.data)!=null&&T.records&&((F=n.data)==null?void 0:F.records.length)>0&&(W.value=(Y=n.data)==null?void 0:Y.records[0],ge.value=((_=n.data)==null?void 0:_.total)||0):W.value=null};return _e(async()=>{p(!0),await he(),await Oe(),p(!1)}),Pe(()=>{N.value=[]}),(s,n)=>{const T=R("VanButton");return o(),D(wt,{class:"h-full font-Puhui font-normal safe-bottom-page relative",style:{background:"linear-gradient(180deg, #fed73a 0%, #f2f0ef 50%)"},title:s.$t("shop.Shop Details"),themeVars:{navBarBackgroundColor:"transparent"}},{right:q(()=>[t("div",_o,[y(Ct,{shop:a.value,showInfo:"",onHandleTo:M},null,8,["shop"]),t("div",{onClick:n[0]||(n[0]=F=>V(a.value))},[a.value.isFollow?(o(),d("img",ko)):(o(),d("img",$o))]),t("div",{onClick:n[1]||(n[1]=X(F=>l(x)(!0),["stop"]))},Io)])]),default:q(()=>{var F,Y;return[a.value&&Object.keys(a.value).length!==0&&a.value.status==1?(o(),d("div",So,[a.value&&Object.keys(a.value).length!==0?(o(),D(ys,{key:0,ref:(_,ce)=>{ce.shopHeader=_,v.value=_},info:a.value,list:me.value,authorizeInfo:O.value,onHandleTo:n[3]||(n[3]=_=>M(_)),onFollowShop:V,class:"bg-white rounded-xl"},{like:q(()=>{var _;return[y(Ks,{"like-flag":a.value.likeFlag,"like-count":(_=a.value)==null?void 0:_.likeCount,"is-login":l(Ge).isLogin,onOnLike:Ae},null,8,["like-flag","like-count","is-login"])]}),default:q(()=>[t("div",Co,[y(T,{round:"",class:"w-full text-b1 h-[46px] px-[1.125rem] bg-yellow text-base font-semibold mt-3",onClick:le},{default:q(()=>[j(f(s.$t("common.payBill")),1)]),_:1}),W.value?(o(),D(so,{key:0,commentTotal:+ge.value,commentReview:W.value,onClick:n[2]||(n[2]=X(_=>M("/offline-evaluate-home?shopId="+l(i)),["stop"]))},null,8,["commentTotal","commentReview"])):w("",!0)])]),_:1},8,["info","list","authorizeInfo"])):w("",!0),y(Os,{ref:(_,ce)=>{ce.shopActivity=_,k.value=_},merchantAddress:(F=a.value)==null?void 0:F.merchant},null,8,["merchantAddress"]),a.value.type?(o(),D(ue,{key:1,boutiqueGoods:J.value,title:s.$t("shop.Main Store")+l(St)(a.value.type),onToMore:C,onToDetail:n[4]||(n[4]=_=>M(`/goodsDetail?id=${_.goods.id}`))},null,8,["boutiqueGoods","title"])):w("",!0),y(ue,{boutiqueGoods:N.value,type:2,onToMore:C,title:s.$t("shop.our_products"),onToDetail:n[5]||(n[5]=_=>M(`/goodsDetail?id=${_.goods.id}`))},null,8,["boutiqueGoods","title"]),(ie.value||[]).length?(o(),D(ue,{key:2,boutiqueGoods:ie.value,type:3,onToMore:C,title:s.$t("shop.offline_services"),onToDetail:n[6]||(n[6]=_=>M(`/offlineGoodsDetail?goodsId=${_.goodsId}`))},null,8,["boutiqueGoods","title"])):w("",!0)])):a.value&&Object.keys(a.value).length!==0?(o(),D(It,{key:1,type:"shop"})):w("",!0),l(z)?(o(),D(wo,{key:2,show:l(z),shopInfo:a.value,onClose:n[7]||(n[7]=_=>l(x)(!1)),onOnSuceess:U},null,8,["show","shopInfo"])):w("",!0),l(i)?(o(),D(bt,{key:3,shopId:+l(i),shopType:(Y=a.value)==null?void 0:Y.type},null,8,["shopId","shopType"])):w("",!0),l(u)?(o(),D(ot,{key:4,onLogin:l(I)},null,8,["onLogin"])):w("",!0)]}),_:1},8,["title"])}}const Do=H({...To,setup:Bo}),nn=Z(Do,[["__scopeId","data-v-4fff2aac"]]);export{nn as default};
