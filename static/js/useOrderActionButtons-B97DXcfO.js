import{au as E,a as V}from"./index-7OiUoGXy.js";import{a9 as S}from"./vendor-Dr_RpJ_Y.js";import{P as y}from"./flashSale-DDyqLyYN.js";import{b as p,d as L,g as h,c as D,i as P,e as A}from"./useOrderStatus-CUBDjZMz.js";const{t:m}=E.global;V();const R=t=>{var f,o;if(!t)return!1;const n=Date.now()/1e3,{refundInfo:e,status:a,merchantsConfirm:i}=t;if(a!==2)return!1;if(!i&&S.isEmpty(e)||L(i,n)>0&&S.isEmpty(e)||(e==null?void 0:e.refundStatus)==3&&!(e!=null&&e.interveneStatus)||(e==null?void 0:e.refundStatus)==6&&!(e!=null&&e.interveneStatus)||(e==null?void 0:e.interveneStatus)==3||(e==null?void 0:e.merchantInterveneStatus)==3)return!0;const s=new Date((f=t.refundInfo)==null?void 0:f.reviewTime).getTime()/1e3,r=p(s,n);if((e==null?void 0:e.refundType)==2&&(e==null?void 0:e.refundStatus)==2&&(e==null?void 0:e.returnStatus)==1&&r<=0)return!0;const u=new Date((o=t.refundInfo)==null?void 0:o.interveneSubmitTime).getTime()/1e3,l=p(u,n);return(e==null?void 0:e.refundType)==2&&(e==null?void 0:e.refundStatus)==3&&(e==null?void 0:e.interveneStatus)==2&&(e==null?void 0:e.returnStatus)==1&&l<=0},Y=t=>{if(!t||t.payType===y.STORE_CARD||P(t.chainCreateTime,t.confirmLimit))return!1;const n=Date.now()/1e3;return A(t.expressTime,n)<=0||t.merchantsConfirm?!1:R(t)},F=(t,n)=>{if(!t)return!1;const{refundInfo:e,status:a}=t,i=C(t,n),r=+t.chainCreateTime+86400*10-n,u=a===1&&r<=0&&(S.isEmpty(e)||(e==null?void 0:e.refundStatus)==6&&!(e!=null&&e.interveneStatus)||(e==null?void 0:e.refundStatus)==3&&!(e!=null&&e.interveneStatus)),l=t.status===0;return i||u||l},M=(t,n)=>{if(!t)return!1;const{refundInfo:e,status:a}=t,i=C(t,n),r=+t.chainCreateTime+86400*10-n,u=a===1&&r<=0&&(S.isEmpty(e)||(e==null?void 0:e.refundStatus)==6&&!(e!=null&&e.interveneStatus)||(e==null?void 0:e.refundStatus)==3&&!(e!=null&&e.interveneStatus));return i||u},C=(t,n)=>{if(!t)return!1;const{refundInfo:e,status:a}=t;return a!==1||(e==null?void 0:e.interveneStatus)==1||!v(t,n).disabled?!1:S.isEmpty(e)?t.payType!==y.STORE_CARD:(e==null?void 0:e.refundStatus)==3&&!e.interveneStatus||(e==null?void 0:e.refundStatus)==6&&!e.interveneStatus||(e==null?void 0:e.interveneStatus)==3},j=t=>{var r,u,l,f,o,T,c,d,b,g,w;if(t.merchantsConfirm||((r=t.refundInfo)==null?void 0:r.interveneStatus)==3||((u=t.refundInfo)==null?void 0:u.merchantInterveneStatus)==3)return!1;const n=Date.now()/1e3,e=new Date((l=t.refundInfo)==null?void 0:l.reviewTime).getTime()/1e3,a=p(e,n);if(((f=t.refundInfo)==null?void 0:f.refundType)==2&&((o=t.refundInfo)==null?void 0:o.refundStatus)==2&&((T=t.refundInfo)==null?void 0:T.returnStatus)==1&&a<=0)return!1;const i=new Date((c=t.refundInfo)==null?void 0:c.interveneSubmitTime).getTime()/1e3,s=p(i,n);return((d=t.refundInfo)==null?void 0:d.refundType)==2&&((b=t.refundInfo)==null?void 0:b.refundStatus)==3&&((g=t.refundInfo)==null?void 0:g.interveneStatus)==2&&((w=t.refundInfo)==null?void 0:w.returnStatus)==1&&s<=0?!1:R(t)},k=(t,n)=>{var e,a,i;return!t||S.isEmpty(t.refundInfo)||(((e=t.refundInfo)==null?void 0:e.refundStatus)==3||((a=t.refundInfo)==null?void 0:a.refundStatus)==6)&&!((i=t.refundInfo)!=null&&i.interveneStatus)?!1:v(t,n).visible},B=t=>{var n,e,a;return t?((n=t.refundInfo)==null?void 0:n.refundType)==2&&((e=t.refundInfo)==null?void 0:e.refundStatus)==2&&((a=t.refundInfo)==null?void 0:a.returnStatus)==1&&!t.merchantsConfirm&&t.status!=4:!1},O=t=>{var n,e,a;return t?((n=t.refundInfo)==null?void 0:n.refundType)==2&&((e=t.refundInfo)==null?void 0:e.interveneStatus)==2&&((a=t.refundInfo)==null?void 0:a.returnStatus)==1&&!t.merchantsConfirm&&t.status!=4:!1},z=t=>{var l,f;if(t.payType===y.STORE_CARD)return!1;const n=Date.now()/1e3,e=new Date((l=t.refundInfo)==null?void 0:l.reviewTime).getTime()/1e3,a=p(e,n),i=new Date((f=t.refundInfo)==null?void 0:f.interveneSubmitTime).getTime()/1e3,s=p(i,n),r=B(t),u=O(t);return r&&a>0||u&&s>0},v=(t,n)=>{let e={visible:!1,disabled:!0,type:0,time:0,title1:m("afterSale.Pending merchant confirmation"),tips1:m("afterSale.If the merchant does not confirm your refund after the countdown ends you can apply for a forced refund"),title2:m("afterSale.You can apply for a forced refund if the merchant has not confirmed")};if(!t)return e;const{status:a,creditFlag:i}=t,s=t.refundInfo||{},{refundType:r,refundStatus:u,returnStatus:l,interveneStatus:f,merchantInterveneStatus:o,refundTriggerType:T}=s;if(a===4&&(f==3||o==3)||u==5||T||f==1||o==1)return e;if(a===1&&(S.isEmpty(s)||u==6&&!f||u==3&&!f)){e.visible=!0,e.type=1,e.title1=m("afterSale.Pending merchant confirmation"),e.tips1=m("afterSale.If the merchant does not confirm your refund after the countdown ends you can apply for a forced refund"),e.title2=m("afterSale.If the seller fails to ship the goods within 10 days you can apply for a forced refund");const c=+t.chainCreateTime+86400*10;e.time=c-n,e.time=e.time>0?e.time*1e3:0,e.time<=0&&(e.disabled=!1)}else if(a===1&&r==1&&u==1&&!f){e.visible=!0,e.type=2,e.title1=m("afterSale.Pending merchants processing of refund request"),e.tips1=m("afterSale.If the merchant fails to process your request after the countdown ends you can apply for a forced refund"),e.title2=m("afterSale.If the merchant fails to process your request you can apply for a forced refund");const c=new Date(s.submitTime).getTime()/1e3;e.time=h(c,n),e.time<=0&&(e.disabled=!1)}else if(a===2&&(r==1||r==2)&&u==1&&!f){e.visible=!0,e.type=3,e.title1=m("afterSale.Pending merchants processing of refund request"),e.tips1=m("afterSale.If the merchant fails to process your request after the countdown ends you can apply for a forced refund"),e.title2=m("afterSale.If the merchant fails to process your request you can apply for a forced refund");const c=new Date(s.submitTime).getTime()/1e3;e.time=h(c,n),e.time<=0&&(e.disabled=!1)}else if(r==2&&l==2&&!f&&!o){e.visible=!0,e.type=4,e.title1=m("afterSale.Pending merchant confirmation"),e.tips1=m("afterSale.If the merchant does not confirm your refund after the countdown ends you can apply for a forced refund"),e.title2=m("afterSale.You can apply for a forced refund if the merchant has not confirmed");const c=new Date(s==null?void 0:s.expressTime).getTime()/1e3;e.time=D(c,n),e.time<=0&&(e.disabled=!1)}else if(i&&r==1&&f==2){e.visible=!0,e.type=5,e.title1=m("afterSale.Pending merchant confirmation"),e.tips1=m("afterSale.If the merchant does not confirm your refund after the countdown ends you can apply for a forced refund"),e.title2=m("afterSale.You can apply for a forced refund if the merchant has not confirmed");const c=new Date(s==null?void 0:s.interveneHandleTime).getTime()/1e3;e.time=c+86400*10-n,e.time=e.time>0?e.time*1e3:0,e.time<=0&&(e.disabled=!1)}else if(!i&&r==1&&f==2){e.visible=!0,e.type=6,e.title1=m("afterSale.Waiting for the merchant to agree to the refund"),e.tips1=m("afterSale.If the merchant does not agree after the countdown ends you can apply for a forced refund"),e.title2=m("afterSale.The platform intervenes to support buyers you can apply for a mandatory refund");const c=new Date(s==null?void 0:s.interveneHandleTime).getTime()/1e3;e.time=c+86400*10-n,e.time=e.time>0?e.time*1e3:0,e.time<=0&&(e.disabled=!1)}else if(r==2&&f==2&&l==2&&!o){e.visible=!0,e.type=7,e.title1=m("afterSale.Pending merchant confirmation"),e.tips1=m("afterSale.If the merchant does not confirm your refund after the countdown ends you can apply for a forced refund"),e.title2=m("afterSale.You can apply for a forced refund if the merchant has not confirmed");const c=new Date(s==null?void 0:s.expressTime).getTime()/1e3;e.time=D(c,n),e.time<=0&&(e.disabled=!1)}else if(r==2&&o==2){e.visible=!0,e.type=8,e.title1=m("afterSale.Pending merchant confirmation"),e.tips1=m("afterSale.If the merchant does not confirm your refund after the countdown ends you can apply for a forced refund"),e.title2=m("afterSale.You can apply for a forced refund if the merchant has not confirmed");const c=new Date(s==null?void 0:s.merchantInterveneHandleTime).getTime()/1e3;e.time=c+86400*10-n,e.time=e.time>0?e.time*1e3:0,e.time<=0&&(e.disabled=!1)}return e},N=(t,n)=>{var i,s;if(!t)return!1;const e=new Date((i=t.refundInfo)==null?void 0:i.submitTime).getTime()/1e3,a=h(e,n);return(t.status===1||t.status===2)&&((s=t.refundInfo)==null?void 0:s.refundStatus)==1&&a>0},U=t=>{if(!t)return!1;const{refundInfo:n,status:e}=t;return e!==1||(n==null?void 0:n.interveneStatus)==1?!1:S.isEmpty(n)?t.payType!==y.STORE_CARD:(n==null?void 0:n.refundStatus)==3&&!n.interveneStatus||(n==null?void 0:n.refundStatus)==6&&!n.interveneStatus||(n==null?void 0:n.interveneStatus)==3},W=t=>{var f,o;if(!t)return!1;const n=Date.now()/1e3,{refundInfo:e,status:a,merchantsConfirm:i}=t;if(a!==2||t.payType===y.STORE_CARD||i)return!1;if(S.isEmpty(e)||(e==null?void 0:e.refundStatus)==3&&!(e!=null&&e.interveneStatus)||(e==null?void 0:e.refundStatus)==6&&!(e!=null&&e.interveneStatus)||(e==null?void 0:e.interveneStatus)==3||(e==null?void 0:e.merchantInterveneStatus)==3)return!0;const s=new Date((f=t.refundInfo)==null?void 0:f.reviewTime).getTime()/1e3,r=p(s,n);if((e==null?void 0:e.refundType)==2&&(e==null?void 0:e.refundStatus)==2&&(e==null?void 0:e.returnStatus)==1&&r<=0)return!0;const u=new Date((o=t.refundInfo)==null?void 0:o.interveneSubmitTime).getTime()/1e3,l=p(u,n);return(e==null?void 0:e.refundType)==2&&(e==null?void 0:e.refundStatus)==3&&(e==null?void 0:e.interveneStatus)==2&&(e==null?void 0:e.returnStatus)==1&&l<=0},J=t=>t?B(t):!1,x=t=>{var n,e,a,i,s,r,u,l,f,o;return t?((n=t.refundInfo)==null?void 0:n.refundType)==2&&((e=t.refundInfo)==null?void 0:e.refundStatus)==2&&((a=t.refundInfo)==null?void 0:a.returnStatus)==2&&!((i=t.refundInfo)!=null&&i.interveneStatus)&&!((s=t.refundInfo)!=null&&s.merchantInterveneStatus)||((r=t.refundInfo)==null?void 0:r.refundType)==2&&((u=t.refundInfo)==null?void 0:u.refundStatus)==3&&((l=t.refundInfo)==null?void 0:l.interveneStatus)==2&&((f=t.refundInfo)==null?void 0:f.returnStatus)==2&&!((o=t.refundInfo)!=null&&o.merchantInterveneStatus):!1},K=t=>{var n,e,a,i,s,r,u,l,f;return!t||((n=t.refundInfo)==null?void 0:n.refundStatus)==5||(e=t.refundInfo)!=null&&e.refundTriggerType?!1:((a=t.refundInfo)==null?void 0:a.refundType)==2&&((i=t.refundInfo)==null?void 0:i.refundStatus)==2&&((s=t.refundInfo)==null?void 0:s.merchantInterveneStatus)==2||((r=t.refundInfo)==null?void 0:r.refundType)==2&&((u=t.refundInfo)==null?void 0:u.refundStatus)==3&&((l=t.refundInfo)==null?void 0:l.interveneStatus)==2&&((f=t.refundInfo)==null?void 0:f.merchantInterveneStatus)==2?!0:x(t)},Q=t=>{if(!("id"in t)||!t.id)return!1;const n=t.refundInfo||{};if(S.isEmpty(n))return!1;const{status:e}=t,{refundStatus:a}=n;if(e===5||a===1)return!1;const i=Date.now()/1e3,s=v(t,i);return!!(s.visible&&(s.type==4||s.type==5||s.type==6||s.type==7||s.type==8))},X=t=>{if(!t||t.payType===y.STORE_CARD)return!1;const n=t.refundInfo||{};if(S.isEmpty(n))return!1;const{status:e}=t,{refundTriggerType:a}=n;return e===1&&a==3},Z=t=>{const{status:n,payType:e,merchantsConfirm:a}=t;if(e===y.STORE_CARD||a)return!1;const i=t.refundInfo||{},{refundStatus:s,interveneStatus:r,merchantInterveneStatus:u,refundTriggerType:l}=i;return n===4&&!(i!=null&&i.interveneStatus)&&!(i!=null&&i.merchantInterveneStatus)||n===4&&(r==3||u==3)||n===4&&(i==null?void 0:i.refundType)==2&&((i==null?void 0:i.refundStatus)==2||(i==null?void 0:i.refundStatus)==3&&(i==null?void 0:i.interveneStatus)==2)&&(i==null?void 0:i.returnStatus)==1||l?!1:!!((n===1||n===2)&&S.isEmpty(t.refundInfo)||(s==3||s==6)&&!r||r==3||u==3)},$=t=>{var n;return t?t.refundInfo&&t.refundInfo.interveneStatus==1&&((n=t.refundInfo.phase)==null?void 0:n.code)!=999:!1},I=t=>{if(!t)return!1;const n=t.refundInfo||{},{refundType:e,refundStatus:a,returnStatus:i,interveneStatus:s,merchantInterveneStatus:r,refundTriggerType:u}=n;return a==5||u?!1:s==1||r==1?!0:e==2&&s==2&&i==1&&!t.merchantsConfirm&&t.status!=4};export{F as a,Z as b,U as c,W as d,K as e,x as f,M as g,R as h,J as i,I as j,O as k,v as l,Q as m,z as n,Y as o,j as p,C as q,k as r,B as s,X as t,N as u,$ as v};
