import{y as T,F as i,G as n,H as s,a2 as N,a4 as I,O as m,E as g,P as v,Q as x,_ as z,w as M,x as S,a1 as Y,r as h,D as Z,bj as J,by as K,R as Q,N as F,K as E,l as U,Y as W,Z as X,I as ee,J as te,a0 as se,aH as ae,T as oe}from"./vendor-BUT0HZ5j.js";import{g as le,b as ne,l as ce,e as ie,au as ue,r as re,ar as de,ap as me,aq as fe,V as ve}from"./index-k1FFr-1T.js";import{B as pe}from"./BackIcon-biFt6cm7.js";import{_ as _e,a as he}from"./GoodItem-BPXGswPC.js";import"./collect-CqBtZyCF.js";import"./useCityMap-Bg4gSYAn.js";import"./MCOIN-BcbOHmhy.js";import"./ImgBoutiqueLable-BF5Xoxsv.js";import"./shop-CeqcS6K2.js";const ge="/Test-dev/static/images/dark-delete-Bo7Z4RyI.svg",xe={class:"w-full bg-white"},we=T({props:{data:{default:{}}},emits:["handleTo"],setup(a,{emit:p}){return(w,o)=>{var u,r,d,_,t;return n(),i("div",null,[s("div",xe,[(u=a.data)!=null&&u.store?(n(),i("div",{key:0,class:"w-full bg-[#F5F5F5] rounded-[10px] p-3",onClick:o[0]||(o[0]=I(y=>{var l;return p("handleTo","/city/storefront?storeId="+((l=a.data)==null?void 0:l.storeId))},["stop"]))},[m(_e,{store:(r=a.data)==null?void 0:r.store},null,8,["store"])])):N("",!0),(d=a.data)!=null&&d.goods?(n(),i("div",{key:1,class:"w-full bg-[#F5F5F5] rounded-[10px] p-3 mt-3",onClick:o[1]||(o[1]=I(y=>{var l,b;return p("handleTo","/offlineGoodsDetail"+("?goodsId="+((l=a.data)==null?void 0:l.goodsId))+("&storeId="+((b=a.data)==null?void 0:b.storeId)))},["stop"]))},[m(he,{goods:(_=a.data)==null?void 0:_.goods,store:(t=a.data)==null?void 0:t.store},null,8,["goods","store"])])):N("",!0)])])}}}),ye={class:"flex justify-between items-center"},be={class:"flex items-center gap-1"},ke={class:"text-sm font-normal text-b2"},Ce={class:"text-sm font-normal text-b3"},Ie=T({props:{data:{default:{}}},setup(a){return(p,w)=>{var u,r;const o=g("VanImage");return n(),i("div",ye,[s("div",be,[m(o,{src:v(le)("images/avatar.png"),class:"w-5 h-5 rounded-full overflow-hidden",alt:"头像"},null,8,["src"]),s("span",ke,x(v(ne)(((u=a.data)==null?void 0:u.userAddress)||"","***",4,4)),1)]),s("div",null,[s("span",Ce,x(v(ce)(((r=a.data)==null?void 0:r.releaseTime)||"")),1)])])}}}),D=a=>(W("data-v-43e5af3a"),a=a(),X(),a),Be={class:"relative w-full bg-white detail-page"},Fe={class:"flex flex-wrap items-center w-10"},Ne=D(()=>s("p",{class:"text-base font-bold text-b1 text-center"},"笔记详情",-1)),Te=["onClick"],De=D(()=>s("img",{src:ge,alt:"删除",class:"w-5 h-5"},null,-1)),Le=[De],Ve={key:1,class:"w-10"},$e={class:"w-full bg-white"},Ae={class:"w-full h-fit bg-white p-4"},Se={class:"text-base font-semibold text-b1"},Ee={class:"text-sm font-normal text-b2 mt-4 min-h-[60px]"},je={class:"mt-4 flex flex-col gap-3"},qe={class:"authors mt-4"},Pe=D(()=>s("div",{class:"h-[78px]"},null,-1)),Re={key:0,class:"fixed bottom-0 sm:w-[375px] w-full bg-white"},Ge={class:"py-4 px-3 flex justify-between"},He=se(" 感兴趣 "),Oe={key:1,round:"",class:"w-full font-semibold text-b1 text-base h-[46px] bg-[#D9D9D9] rounded-full flex justify-center items-center",disabled:""},ze=T({setup(a){const{t:p}=M(),w=Y(),o=U(),{loadingToggle:u}=re(),{accountStore:r}=ie(),d=S(()=>{var e;return(e=w.query)!=null&&e.child?document.querySelector(".detail-page"):document.getElementById("fm-page")}),_=S(()=>{var e;return((e=w.query)==null?void 0:e.noteId)||""}),t=h({}),y=h([]),l=h(!1),b=async()=>{var c,f;const e=await ue({id:_.value});e.success&&(t.value=e.data||{},y.value=(c=e.data)!=null&&c.storeNotePics?(f=e.data)==null?void 0:f.storeNotePics.split(","):[])},j=()=>{l.value||ae.confirm({messageAlign:"center",message:"确认将这篇笔记删除？",confirmButtonText:p("shop.delete"),confirmButtonColor:"#FF507A",cancelButtonText:p("cart.thinkAgain"),cancelButtonColor:"#2E2008"}).then(async()=>{l.value=!0,u(!0);const e=await de({id:_.value});l.value=!1,u(!1),e.success&&(P("删除成功","toast-success.svg"),setTimeout(()=>{var c,f,C;((C=(f=(c=o.options)==null?void 0:c.history)==null?void 0:f.state)==null?void 0:C.back.indexOf("/city/myNote"))>-1?(o.back(),setTimeout(()=>{o.replace("/city/myNote")},50)):o.replace("/city/myNote")},1e3))}).catch(()=>{})},q=async()=>{if(l.value)return;let e=t.value.addLikeCountFlag;t.value.addLikeCountFlag=!t.value.addLikeCountFlag,l.value=!0,e?(t.value.likeCount++,await me({id:t.value.storeNoteId})):(t.value.likeCount--,await fe({id:t.value.storeNoteId})),l.value=!1},P=(e="",c="toast-warn.svg")=>{oe({message:e,icon:ve(c),duration:2e3,overlay:!0,overlayClass:"toastOverlay",className:"toastCard",type:"html"})},R=e=>{o.push(e)},L=h(0);let k=h(!0);const G=()=>{var e;(e=d.value)==null||e.addEventListener("scroll",B),B()},B=K(()=>{var e,c;L.value=((e=d.value)==null?void 0:e.scrollY)||((c=d.value)==null?void 0:c.scrollTop),L.value<100?k.value=!1:k.value=!0},100);return Z(()=>{G(),b()}),J(()=>{var e;d.value&&((e=d.value)==null||e.removeEventListener("scroll",B))}),(e,c)=>{var V,$;const f=g("VanImage"),C=g("van-swipe-item"),H=g("van-swipe"),O=g("VanButton");return n(),i("div",Be,[s("header",{class:Q(["flex items-center sm:w-[375px] w-full justify-between top-0 z-50 h-[50px] px-4 fixed",{"bg-white":v(k)," bg-transparent":!v(k)}])},[s("div",Fe,[m(pe)]),Ne,(V=t.value)!=null&&V.userAddress&&(($=v(r))!=null&&$.account)&&t.value.userAddress.toLocaleLowerCase()===v(r).account.toLocaleLowerCase()?(n(),i("div",{key:0,onClick:I(j,["stop"])},Le,8,Te)):(n(),i("div",Ve))],2),s("section",$e,[m(H,{class:"note-imgs-swiper",autoplay:3e3,"indicator-color":"white"},{default:F(()=>[(n(!0),i(ee,null,te(y.value,A=>(n(),E(C,{key:A},{default:F(()=>[m(f,{src:A,class:"w-full h-full overflow-hidden",alt:"",fit:"cover"},null,8,["src"])]),_:2},1024))),128))]),_:1})]),s("section",Ae,[s("p",Se,x(t.value.storeNoteTopic||""),1),s("div",Ee,x(t.value.storeNoteContent||""),1),s("div",je,[m(we,{data:t.value,onHandleTo:R},null,8,["data"])]),s("div",qe,[m(Ie,{data:t.value},null,8,["data"])])]),Pe,t.value.storeNoteId?(n(),i("section",Re,[s("div",Ge,[t.value.addLikeCountFlag?(n(),E(O,{key:0,round:"",class:"w-full main-btn font-semibold text-b1 text-base h-[46px] rounded-full",onClick:I(q,["stop"])},{default:F(()=>[He]),_:1},8,["onClick"])):(n(),i("div",Oe," 已点赞 "+x(t.value.likeCount||0),1))])])):N("",!0)])}}}),et=z(ze,[["__scopeId","data-v-43e5af3a"]]);export{et as default};
