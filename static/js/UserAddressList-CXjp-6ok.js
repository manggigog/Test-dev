import{z as V,F as S,G as h,H as l,I as t,U as g,Q as d,a3 as v,P as x,$ as p,a4 as F,_ as U,r as N,y as L,a2 as T,E as G,Z as _,q as Q,o as Y,O as i,K as Z,J as W}from"./vendor-Dr_RpJ_Y.js";import{_ as X}from"./edit-line-CBLoYbqh.js";import{C as ee}from"./CommonVanProvider-D__Wy38-.js";import{V as se,a4 as te,a as oe,w as ae,C as ne,Y as de}from"./index-CU2nzZe6.js";import{_ as re}from"./EmptyTipsPop-DC2OBzZY.js";import{q as le,a as ie,b as ce}from"./address-DDWZXZdL.js";import{u as ue}from"./useSelectAddress-CgNt0r_o.js";import"./BackIcon-CDrGaEPo.js";const me="/static/images/privacy-D-Cul_60.svg",fe={class:"w-full flex items-center justify-between gap-2"},he={class:"text-left overflow-hidden"},ye={class:"flex items-center w-full"},ge={key:0,class:"text-xs text-newOrigin min-w-fit mr-1 border border-solid border-newOrigin rounded-sm px-1 min-h-[18px]"},ve={key:1,src:me,class:"w-4 h-4 mr-1"},xe={class:"w-full text-b1 text-base font-semibold truncate"},pe={class:"mt-1 truncate text-b2 text-sm"},be=t("img",{class:"w-5 h-5",src:X,alt:""},null,-1),we=[be],Ce={key:0,class:"flex-center-bw mt-2"},De=["onClick"],$e={class:"ml-1 text-b2 text-sm"},ke={class:"flex items-center justify-end ml-1"},Ae=V({props:{address:null,selectFlag:{type:Boolean}},emits:["handleDel","handleEdit","handleSetDefault","select"],setup(e,{emit:u}){const b=e,C=()=>{b.address.isDefault||u("handleSetDefault",b.address)};return(o,a)=>{const w=S("van-radio"),m=S("van-button");return l(),h("div",{class:"bg-white p-3 rounded-xl relative text-b2",onClick:a[3]||(a[3]=v(()=>u("select",e.address),["stop"]))},[t("div",fe,[t("div",he,[t("div",ye,[e.address.isDefault===1?(l(),h("div",ge,d(o.$t("common.default")),1)):g("",!0),e.address.encryptFlag&&e.address.success?(l(),h("img",ve)):g("",!0),t("div",xe,d(e.address.userName)+" "+d(e.address.telNumber),1)]),t("div",pe,d(`${e.address.provinceName??""}${e.address.cityName??""}${e.address.countyName??""}${e.address.detailInfo??""}`),1)]),e.selectFlag?(l(),h("div",{key:0,class:"shrink-0",onClick:a[0]||(a[0]=v(n=>u("handleEdit",e.address),["stop"]))},we)):g("",!0)]),e.selectFlag?g("",!0):(l(),h("div",Ce,[t("div",{class:"text-xs flex",onClick:v(C,["stop"])},[x(w,{checked:e.address.isDefault===1,"checked-color":"#FF8812","icon-size":"16px"},null,8,["checked"]),t("span",$e,d(e.address.isDefault?o.$t("common.setAsDefault"):o.$t("common.setDefault")),1)],8,De),t("div",ke,[x(m,{class:"bg-b5 text-b2 h-8 rounded-md",onClick:a[1]||(a[1]=v(()=>u("handleDel",e.address),["stop"]))},{default:p(()=>[F(d(o.$t("common.delete")),1)]),_:1}),x(m,{class:"bg-b5 text-b2 h-8 rounded-md ml-2",onClick:a[2]||(a[2]=v(()=>u("handleEdit",e.address),["stop"]))},{default:p(()=>[F(d(o.$t("shop.modify")),1)]),_:1})])]))])}}}),_e=["src"],Se={class:"text-b3"},Fe={class:"p-3 relative text-center safe-page-body overflow-y-auto",id:"addressLst"},Ee={key:0,class:"tipsCard w-full h-fit p-2 mb-3 text-left"},Be={class:"text-sm text-[#FF8812] font-normal font-Puhui"},Oe={class:"relative px-3 pt-4"},Ne=V({setup(e){const{decryptAddressKey:u,generateKey:b}=se(),C=Y(),o=Q(),{setAddress:a}=ue(),{loadingToggle:w}=ae(),m=N([]),n=te(o);L(()=>!(n!=null&&n.includes("submitOrder")||n!=null&&n.includes("redeemPrize")));const q=L(()=>n.indexOf("buyerOrderDetail")>=0),{regionStore:D}=oe(),I=s=>{n.indexOf("redeemPrize")>=0&&(a(s),o.push(n)),n.indexOf("submitOrder")>=0&&(a(s),o.back()),n.indexOf("buyerOrderDetail")>=0&&(a(s),o.back())},$=async()=>{const s=o.currentRoute.value.path,c=await le();if(!c.success)return;m.value=(c.data||[]).sort((r,f)=>(f==null?void 0:f.isDefault)-(r==null?void 0:r.isDefault));const y=await b("user",s);y?m.value=c.data.map(r=>r.encryptFlag?u(r,y):r):m.value=c.data},E=s=>{o.push(s)},P=()=>{sessionStorage.removeItem("editAddress"),E("/editAddress")},j=s=>{sessionStorage.setItem("editAddress",JSON.stringify(s)),E("/editAddress")},R=async s=>{if((await ie(s.id)).success){$();try{document.getElementById("addressLst").scrollTo({top:0})}catch(y){console.log(y)}}},[z,k]=T(!1),[H,A]=T(!1),B=N({}),K=async s=>{B.value=s,k(!0)},O=()=>{k(!1)},M=()=>{J(),k(!1)},J=async()=>{(await ce(B.value.id)).success&&($(),A(!0),setTimeout(()=>{A(!1)},1e3))};return G(async()=>{w(!0),await $(),w(!1)}),(s,c)=>{const y=S("VanButton");return l(),_(ee,{title:s.$t("common.address"),class:"bg-gray1 font-Puhui font-normal relative text-b2","theme-vars":{"field-placeholder-text-color":"#A6A6A6"}},{right:p(()=>[t("img",{src:i(de)(`mall/${i(D).country}-flag.svg`),class:"w-5 h-auto mr-1"},null,8,_e),t("span",Se,d(s.$t(`country.${i(D).country}`))+d(i(D).country),1)]),default:p(()=>{var r;return[t("div",Fe,[(r=i(C).query)!=null&&r.orderModify?(l(),h("div",Ee,[t("span",Be,d(s.$t("order.modify order info select address tips")),1)])):g("",!0),(l(!0),h(W,null,Z(m.value,f=>(l(),_(Ae,{address:f,selectFlag:i(q),key:f.id,class:"mb-3",onHandleDel:K,onHandleEdit:j,onHandleSetDefault:R,onSelect:I},null,8,["address","selectFlag"]))),128))]),t("div",Oe,[x(y,{type:"primary",round:"",class:"w-full h-[46px] bg-yellow !border-none text-b1 text-base font-semibold",onClick:P},{default:p(()=>[F(d(s.$t("address.addAddress")),1)]),_:1})]),x(ne,{show:i(z),title:"删除确认",content:"确定要删除该地址吗？",showConfirm:!0,showReject:!0,rejectText:"取消",confirmText:"确认",onClose:O,onReject:O,onConfirm:M,confirmStyle:{background:"#f44",color:"white"}},null,8,["show"]),i(H)?(l(),_(re,{key:0,isError:!1,onClose:c[0]||(c[0]=f=>i(A)(!1)),text:"删除成功"})):g("",!0)]}),_:1},8,["title"])}}}),ze=U(Ne,[["__scopeId","data-v-0a0d732c"]]);export{ze as default};
