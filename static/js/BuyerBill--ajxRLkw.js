import{_ as L}from"./BillItem-DiVhsicc.js";import{B as S}from"./BackIcon-CPUEW9je.js";import{o as w}from"./bill-26_x8tvQ.js";import{R as P,u as b}from"./index-CbIwihlz.js";import{y as D,r as a,D as I,F as g,G as u,H as d,O as y,Q as R,N as V,E as $,I as A,J as N,K as z}from"./vendor-D6JO6WHW.js";import"./useOrderStatus-DeHjEZ0k.js";const E={class:"px-3 text-sm text-default"},F={class:"gap-2 mt-2 flex-start"},j=D({setup(M){const{getUserDhKey:h,decryptKey:_}=P(),{getCurrentAccount:x,getCurrentStoreId:k}=b(),s=a([]),r=a(!1),n=a(!1),l=a(0),B=a(10),f=a(0),C=1,m=async()=>{r.value||(r.value=!0,l.value+=1,await K(),r.value=!1)},i=a([]),K=async()=>{const e=await w({page:l.value,size:B.value,orderPayAddress:x()});if(r.value=!1,!e.success){n.value=!0;return}if(!e.data||!e.data.total){n.value=!0;return}f.value=e.data.total;const c=await k();for(let o=0;o<e.data.records.length;o++){const t=e.data.records[o];if(c&&t.orderSubmitShopPubKey){const p=await h(c,t.orderSubmitShopPubKey);if(p){const{decrypt:v}=_(t.orderRemark,p);v&&(t.orderRemark=v)}}}i.value=e.data.records,console.log(l),s.value=l.value===1?i.value:s.value.concat(i.value),s.value.length>=f.value&&(n.value=!0)};return I(()=>{m()}),(e,c)=>{const o=$("VanList");return u(),g("div",E,[d("div",F,[y(S),d("div",null,R(e.$t("shop.payDetail")),1)]),d("div",null,[y(o,{finished:n.value,"finished-text":e.$t("common.noMore"),"loading-text":e.$t("common.loading"),onLoad:m},{default:V(()=>[(u(!0),g(A,null,N(s.value,t=>(u(),z(L,{key:t.id,type:C,bill:t},null,8,["bill"]))),128))]),_:1},8,["finished","finished-text","loading-text"])])])}}});export{j as default};
