import{bD as g,t as c,T as l}from"./vendor-Dr_RpJ_Y.js";import{s as d,g as p}from"./index-7OiUoGXy.js";import{u as w}from"./upload-C8f1eCjL.js";const y=(e,t={},o=1.5)=>{const i=e.offsetWidth,r=e.offsetHeight;let{width:a,height:s}=t;a=a||i,s=s||r;var n=e.getBoundingClientRect();const u={scale:o,width:a,height:s,useCORS:!0,allowTaint:!1,x:n.x,y:n.y,...t};return g(e,u).then(m=>new Promise(function(f){m.toBlob(function(h){f(h)})}))},R=e=>{let t=URL.createObjectURL(e);const o=document.createElement("a");return o.href=t,!!o.href},L=(e,t)=>{var a;if(console.log("tp.isConnected",c.isConnected()),c.isConnected()&&d.versions.android){let s=new File([e],`shareImg${new Date().getTime()}.png`,{type:"image/png"});var o=new FormData;return o.append("file",s),b(o)}else if(c.isConnected()&&d.versions.ios)return l("请长按图片保存"),setTimeout(()=>{let s=URL.createObjectURL(e),n=document.createElement("a");n.href=s,n.download=`${t}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n)},1500),!1;if((a=window.ethereum)!=null&&a.isMetaKey){l("请截图保存");return}let i=URL.createObjectURL(e),r=document.createElement("a");return r.href=i,r.download=`${t}.png`,document.body.appendChild(r),r.click(),document.body.removeChild(r),!0},b=async e=>{const t=await w(e);if(t.success)return c.saveImage({url:p.imgUrl+t.data}),!0};export{y as c,R as i,L as s};
