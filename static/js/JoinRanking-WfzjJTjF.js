import{_ as j}from"./member-BMygrgIC.js";import{_ as z,y as V,w as U,be as J,r as p,bf as O,D as P,E as c,F as g,G as m,H as s,a2 as Q,O as d,Q as i,P as n,K as G,N as H,a0 as K,R as Y,Y as Z,Z as W,T as I}from"./vendor-BUT0HZ5j.js";import{B as X}from"./BackIcon-biFt6cm7.js";import{f as tt,e as st,d as h,g as ot,S as et,bl as nt}from"./index-DDhEkd_5.js";import{u as at}from"./useCreditsNew-CJbpyBFj.js";import{e as it,f as lt,q as rt}from"./beiRanking-ssQ_bJ71.js";import{b as ct}from"./beiConstContract-DAjrf-Ym.js";const C=u=>(Z("data-v-155e895e"),u=u(),W(),u),dt={class:"bg-[#F2F0EF] p-2.5"},ut={class:"flex-start mb-2.5"},pt={key:0,class:"mb-2.5 px-2.5 py-2 flex border border-solid border-[#ea3323] rounded-xl bg-white text-[#ea3323]"},mt=C(()=>s("div",{class:"ml-1.5 text-sm"},[s("span",{class:"mr-2"},"当前状态："),s("span",null,"退榜")],-1)),_t={class:"pt-6 bg-white rounded-lg"},ft={class:"px-3.5"},gt={class:"flex items-center"},ht={class:"mb-2.5 font-normal opacity-60 text-sm"},bt={class:"bg-[#F3F3F3] rounded-lg font-normal mb-3.5 px-[15px] py-[8px] min-h-8"},vt={class:"mb-2.5 font-normal opacity-60 text-sm"},yt={class:"text-sm font-normal border-t border-solid border-[#F3F3F3] px-3.5 pb-3.5"},kt={class:"flex-center-bw pt-3.5"},wt={class:"font-normal opacity-60"},xt={class:"w-[40px] border-[1px] border-solid border-white flex-center bg-[#FED73A] rounded-3xl"},Ft=C(()=>s("img",{src:j,class:"w-3 h-3"},null,-1)),It={class:"flex-center-bw pt-3.5"},Vt={class:"font-normal opacity-60"},Ct={key:1},$t={class:"flex-center-bw pt-3.5"},Bt={class:"font-normal opacity-60"},Dt={class:"flex-center-bw pt-3.5"},St={class:"font-normal opacity-60"},Rt=V({name:"JoinBeiRanking"});function Lt(u){const{t:b}=U(),{memberLevels:$}=tt(),{contributesStore:_}=st(),[B,v]=J(!1),{allQuota:D}=at(),{userTotalLp:S}=ct(),y=p(null),R=async()=>{const{success:e,data:a}=await et();e&&(a!=null&&a.id&&(y.value=a),o.nickname=a==null?void 0:a.storeName,q(a==null?void 0:a.id))},k=p(0),L=async()=>{k.value=await $()},w=p(0),N=async()=>{w.value=+await S()},o=O({nickname:"",introduction:"",status:null,denialReason:""}),l=p(null),q=async e=>{const{success:a,data:t}=await rt({shoId:e,month:nt()});if(!(!a||!t)){if(t!=null&&t.status&&(t==null?void 0:t.status)===0){const r=document.getElementsByClassName("van-field__control");Object.values(r).forEach(f=>{f.setAttribute("class","myInput")})}l.value=t,t!=null&&t.introduction&&(o.introduction=t==null?void 0:t.introduction),t!=null&&t.status&&(o.status=t==null?void 0:t.status),t!=null&&t.denialReason&&(o.denialReason=t==null?void 0:t.denialReason)}},A=async()=>{var a,t,r;if(l.value&&((a=l.value)!=null&&a.id)&&l.value.status===0)return;if(o.introduction===((t=l.value)==null?void 0:t.introduction)&&o.status===1)return I(b("ranking.edit-tip"));v(!0);const{success:e}=((r=l.value)==null?void 0:r.status)===1?await it({introduction:o.introduction}):await lt({introduction:o.introduction});v(!1),e&&(x(),I({icon:ot("images/sucess_icon.png"),duration:3e3,message:b("shop.shippingTemplate.submitSuccess")}))},x=async()=>{await R(),L(),N(),_.fetchContributes()};return P(()=>{x()}),(e,a)=>{var F;const t=c("van-icon"),r=c("VanImage"),f=c("VanField"),T=c("van-loading"),E=c("VanButton");return m(),g("div",dt,[s("div",ut,[d(X),s("div",null,i(e.$t("ranking.join shop ranking")),1)]),n(o).status==2?(m(),g("div",pt,[d(t,{name:"warning",color:"red",size:"1.125rem"}),mt])):Q("",!0),s("div",_t,[s("div",ft,[s("div",gt,[d(r,{src:(((F=y.value)==null?void 0:F.logo)||"").split(",")[0],class:"mb-5 w-[90px] h-[90px] mx-auto rounded-full border border-solid border-[#e5e7e] overflow-hidden"},null,8,["src"])]),s("div",ht,i(e.$t("ranking.shop name")),1),s("div",bt,i(n(o).nickname),1),s("div",vt,i(e.$t("ranking.shop introduction")),1),d(f,{disabled:n(o).status&&n(o).status==0,modelValue:n(o).introduction,"onUpdate:modelValue":a[0]||(a[0]=M=>n(o).introduction=M),maxlength:"240",type:"textarea",row:3,class:"bg-[#F3F3F3] rounded-lg font-normal mb-3.5",placeholder:e.$t("shop.pleaseInput")+e.$t("ranking.shop introduction")},null,8,["disabled","modelValue","placeholder"])]),s("div",yt,[s("div",kt,[s("div",wt,i(e.$t("ranking.current level")),1),s("div",xt,[Ft,s("span",null,"V"+i(k.value),1)])]),s("div",It,[s("div",Vt,i(e.$t("ranking.Number of points")),1),n(_).loading?(m(),G(T,{key:0,size:"14"})):(m(),g("div",Ct,i(n(h)(n(_).contributes,2)),1))]),s("div",$t,[s("div",Bt,i(e.$t("ranking.Deposit MAI quantity")),1),s("div",null,i(n(h)(n(D))),1)]),s("div",Dt,[s("div",St,i(e.$t("ranking.Deposit LP quantity")),1),s("div",null,i(n(h)(w.value)),1)])])]),d(E,{loading:n(B),disabled:!n(o).nickname||!n(o).introduction,onClick:A,class:Y(["w-[150px] h-[40px] text-white rounded-3xl flex-center m-auto mt-[50px]",n(o).status==0?"bg-[#D9D9D9]":"btn-orange"])},{default:H(()=>[K(i(n(o).status==0?e.$t("ranking.apply await"):n(o).status==1?e.$t("common.edit"):n(o).status==2?e.$t("ranking.Re-apply"):e.$t("common.confirm")),1)]),_:1},8,["loading","disabled","class"])])}}const Nt=V({...Rt,setup:Lt}),Ut=z(Nt,[["__scopeId","data-v-155e895e"]]);export{Ut as default};
