import{y as A,E as N,F as i,G as o,H as s,O as _,Q as t,P as n,a2 as w,I as $e,_ as we,l as Ce,bc as ke,bd as Ie,K as $,N as Ve,a0 as Ee,a1 as Te,r as De,D as Ke,J as Be}from"./vendor-D6JO6WHW.js";import{_ as Me}from"./mcoin-logo-1-BPG653EL.js";import{u as Se}from"./useOrderStatus-DeHjEZ0k.js";import{P as Le}from"./flashSale-DDyqLyYN.js";import{l as Pe,R as Ae}from"./index-Ds2hFbCb.js";import{u as Fe}from"./useShipTemplate-DNIdMMsN.js";import{B as He,a as Re,v as Ue}from"./order-CiG11MXW.js";import{B as Oe}from"./BackIcon-CPUEW9je.js";import"./enums-DlE-aiss.js";const je={class:"gap-2 mt-3 flex-center-bw"},Ge={class:"flex flex-col justify-between flex-1 h-20"},qe={class:"font-semibold flex-center-bw"},Je={class:"mr-2 line-clamp-2"},Qe={key:0,class:"flex items-baseline flex-shrink-0 gap-1 text-primary"},We=["src"],ze={class:"text-xs"},Xe={key:1,class:"flex items-baseline flex-shrink-0 gap-1 text-primary"},Ye=s("img",{src:Me,class:"w-3 h-3",alt:""},null,-1),Ze=s("span",{class:"text-xs"},"Mcoin",-1),es={class:"font-semibold text-primary flex-center-bw"},ss={class:"opacity-60 text-default"},ts={class:"flex justify-end opacity-60"},as={class:"mt-1 flex-center-bw"},rs={class:"text-b3 text-sm font-normal"},ds={class:"flex items-center text-b3 text-sm font-normal"},os=A({props:{order:null,goods:null},setup(a){const{order:h,goods:g}=a,{getExpressTypeText:u}=Fe(),f=Se();return(x,v)=>{var y,e,d;const r=N("VanImage");return o(),i($e,null,[s("div",je,[_(r,{src:a.goods.icons.split(",")[0],class:"w-20 h-20 overflow-hidden rounded-xl",fit:"cover",alt:""},null,8,["src"]),s("div",Ge,[s("div",null,[s("div",qe,[s("div",Je,t(a.goods.goodsName),1),a.order.payType===n(Le).STORE_CARD?(o(),i("div",Qe,[(y=a.order.fmStoredCard)!=null&&y.symbolLogo?(o(),i("img",{key:0,src:(e=a.order.fmStoredCard)==null?void 0:e.symbolLogo,class:"w-3 h-3",alt:""},null,8,We)):w("",!0),s("span",null,t(a.goods.cardPrice),1),s("span",ze,t((d=a.order.fmStoredCard)==null?void 0:d.symbol),1)])):(o(),i("div",Xe,[Ye,s("span",null,t(a.goods.price),1),Ze]))]),s("div",es,[s("div",null,t(n(f)[a.order.status+""]),1),s("div",ss,"x"+t(a.goods.number),1)])]),s("div",ts,t(x.$t("order.deliveryTime"))+" "+t(a.order.expressTime&&n(Pe)(a.order.expressTime)||"-"),1)])]),s("div",null,[s("div",as,[s("div",rs,t(x.$t("order.expressPrice")),1),s("div",ds,t(n(u)(a.goods)),1)])])],64)}}}),ns={class:"px-3 py-4 mt-3 bg-white rounded-xl"},is={class:"flex-center-bw"},ls={class:"opacity-60"},cs={class:"mt-3 flex-center-bw"},us={class:"mr-2 opacity-60 whitespace-nowrap"},ms={key:1,class:"text-right break-all"},ps={class:"mt-3 flex-center-bw"},hs={class:"mr-2 opacity-60 whitespace-nowrap"},ys={key:1,class:"text-right break-all"},fs={class:"mt-3"},xs={class:"opacity-60"},vs={class:"bg-[#f2f0ef] rounded-md py-2 px-2 mt-2"},gs={key:0,class:"mt-5 flex-center"},bs=A({props:{order:null},setup(a){const h=a,{getMerchantDhKey:g,encryptKey:u}=Ae(),f=Ce(),[x,v]=ke(!1),r=Ie({expressCompany:"",expressNo:"",orderId:h.order.id}),y=async()=>{var p;const e=await g((p=h.order)==null?void 0:p.address);let d={expressCompany:r.expressCompany,expressNo:r.expressNo,orderId:r.orderId,shippingHash:null};if(e){const l=u(r.expressNo,e);d.expressNo=l.encrypt,d.shippingHash=l.hash;const b=u(r.expressCompany,e);d.expressCompany=b.encrypt}v(!0),(await He(d)).success&&f.back(),v(!1)};return(e,d)=>{const m=N("VanField"),p=N("VanButton");return o(),i("div",null,[s("div",ns,[s("div",is,[s("div",ls,t(e.$t("order.deliveryType")),1),s("div",null,t(e.$t("order.deliveryMyself")),1)]),s("div",cs,[s("div",us,t(e.$t("order.deliveryId")),1),a.order.status===1?(o(),$(m,{key:0,class:"flex-1","input-align":"right",modelValue:n(r).expressNo,"onUpdate:modelValue":d[0]||(d[0]=l=>n(r).expressNo=l),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])):(o(),i("div",ms,t(a.order.expressNo),1))]),s("div",ps,[s("div",hs,t(e.$t("order.deliveryCompany")),1),a.order.status===1?(o(),$(m,{key:0,class:"flex-1","input-align":"right",modelValue:n(r).expressCompany,"onUpdate:modelValue":d[1]||(d[1]=l=>n(r).expressCompany=l),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])):(o(),i("div",ys,t(a.order.expressCompany),1))]),s("div",fs,[s("div",xs,t(e.$t("order.refundAddress")),1),s("div",vs,[s("div",null,t(a.order.stores.storeName),1),s("div",null,t(a.order.stores.contact)+" "+t(a.order.stores.location)+" "+t(a.order.stores.contactAddress),1)])])]),a.order.status===1?(o(),i("div",gs,[_(p,{class:"mb-[50px] inline-block btn-orange btn-shadow w-[150px] h-[40px] text-white",loading:n(x),disabled:!n(r).expressNo||!n(r).expressCompany,onClick:y},{default:Ve(()=>[Ee(t(e.$t("order.Ship")),1)]),_:1},8,["loading","disabled"])])):w("",!0)])}}}),_s=we(bs,[["__scopeId","data-v-6da57c35"]]),Ns={key:0,class:"h-full px-3 bg-[#f2f0ef]"},$s={class:"gap-2 mt-2 flex-start"},As={class:"px-3 py-4 mt-3 bg-white rounded-xl"},ws={class:"flex-center-bw"},Cs={class:"opacity-60"},ks={class:"font-semibold"},Is={class:"break-all"},Vs={class:"mt-4 text-base font-semibold text-black"},Es={class:"mt-1 opacity-60"},Hs=A({setup(a){const{getMerchantDhKey:h,decryptAddressKey:g,decryptKey:u,cryptoAESWithSearch:f}=Ae(),v=Te().query.id,r=De(null),y=async()=>{var l,b,C,k,I,V,E,T,D,K,B,M,S,L,P,F,H,R,U,O,j,G,q,J,Q,W,z,X,Y,Z,ee,se,te,ae,re,de,oe,ne,ie,le,ce,ue,me,pe,he,ye,fe,xe,ve,ge,be,_e;const e=await Re({id:v});let d="";if((l=e.data)!=null&&l.userAddress&&(e.data.userAddress.postscript=e.data.postscript),(b=e.data)!=null&&b.userAddress&&((k=(C=e.data)==null?void 0:C.userAddress)!=null&&k.encryptFlag)){const c=await h(e.data.address,(I=e.data)==null?void 0:I.submitUserPubKey);c&&(e.data.userAddress=g(e.data.userAddress,c),(E=(V=e.data)==null?void 0:V.userAddress)!=null&&E.success&&!((T=e.data)!=null&&T.merchantEns)&&(d+=((K=(D=e.data)==null?void 0:D.userAddress)==null?void 0:K.userName)+((M=(B=e.data)==null?void 0:B.userAddress)==null?void 0:M.telNumber)+(((L=(S=e.data)==null?void 0:S.userAddress)==null?void 0:L.postalCode)??"")+((F=(P=e.data)==null?void 0:P.userAddress)==null?void 0:F.provinceName)+((R=(H=e.data)==null?void 0:H.userAddress)==null?void 0:R.cityName)+((O=(U=e.data)==null?void 0:U.userAddress)==null?void 0:O.countyName)+((G=(j=e.data)==null?void 0:j.userAddress)==null?void 0:G.detailInfo)+((J=(q=e.data)==null?void 0:q.userAddress)==null?void 0:J.postscript)))}else(Q=e.data)!=null&&Q.merchantEns||(d+=((z=(W=e.data)==null?void 0:W.userAddress)==null?void 0:z.userName)+((Y=(X=e.data)==null?void 0:X.userAddress)==null?void 0:Y.telNumber)+(((ee=(Z=e.data)==null?void 0:Z.userAddress)==null?void 0:ee.postalCode)??"")+((te=(se=e.data)==null?void 0:se.userAddress)==null?void 0:te.provinceName)+((re=(ae=e.data)==null?void 0:ae.userAddress)==null?void 0:re.cityName)+((oe=(de=e.data)==null?void 0:de.userAddress)==null?void 0:oe.countyName)+((ie=(ne=e.data)==null?void 0:ne.userAddress)==null?void 0:ie.detailInfo)+((ce=(le=e.data)==null?void 0:le.userAddress)==null?void 0:ce.postscript));if(e.data.shippingHash){const c=await h(e.data.address,(ue=e.data)==null?void 0:ue.shippingUserPubKey);if(c){const Ne=u(e.data.expressNo,c);Ne.hash===e.data.shippingHash&&(e.data.expressNo=Ne.decrypt,e.data.expressCompany=u(e.data.expressCompany,c).decrypt,(me=e.data)!=null&&me.merchantEns||(d+=((pe=e.data)==null?void 0:pe.expressNo)+((he=e.data)==null?void 0:he.expressCompany)))}else(ye=e.data)!=null&&ye.merchantEns||(d+=((fe=e.data)==null?void 0:fe.expressNo)+((xe=e.data)==null?void 0:xe.expressCompany));(ve=e.data)!=null&&ve.merchantEns||(d+=((ge=e.data)==null?void 0:ge.hash)+((be=e.data)==null?void 0:be.address))}const p=[{id:(_e=e.data)==null?void 0:_e.id,merchantEns:await f(d)}].filter(c=>c.merchantEns);p.length>0&&Ue({enInfoList:p}),r.value=e.data};return Ke(async()=>{await y()}),(e,d)=>r.value?(o(),i("div",Ns,[s("div",$s,[_(Oe),s("div",null,t(e.$t("order.deliver")),1)]),s("div",As,[s("div",ws,[s("div",Cs,t(e.$t("order.orderNumber")),1),s("div",ks,t(r.value.id),1)]),(o(!0),i($e,null,Be(r.value.orderGoods,m=>(o(),$(os,{key:m.goodsName,goods:m,order:r.value},null,8,["goods","order"]))),128)),s("div",Is,[s("div",Vs,t(r.value.userAddress.provinceName??"")+t(r.value.userAddress.cityName)+" "+t(r.value.userAddress.countyName)+t(r.value.userAddress.detailInfo),1),s("div",Es,t(r.value.userAddress.userName)+t(r.value.userAddress.telNumber),1)])]),_(_s,{order:r.value},null,8,["order"])])):w("",!0)}});export{Hs as default};
