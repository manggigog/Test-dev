import{y as G,F as n,G as l,a2 as C,H as t,P as k,Q as _,r as d,D as ee,E as q,bs as ne,ba as j,K as N,O as b,I as V,J as E,a4 as ie,_ as te,N as H,Y as se,Z as ae,w as le,x as K,R as O,a0 as ce,l as re,bv as Y,bd as ue,X as de,bb as Q}from"./vendor-D6JO6WHW.js";import{a as ve,_ as he}from"./GoodsList-B7XSsxhX.js";import{_ as fe}from"./MCOIN-BOqZVkND.js";import{_ as me}from"./ImgBoutiqueLable-Dod52ZXF.js";import{g as X,e as pe}from"./index-CybuWkSo.js";import{R as ge}from"./RatioBox-C9aLwz0w.js";import{R as U,M as ye,_ as xe}from"./rangking-DQObfTIy.js";import{a as J}from"./mall-DnMZRkyz.js";const ke="/static/images/shop-more-CVTCr4GK.png",we="/static/images/good-hot-DcLXI72v.png",_e="/static/images/card-DHSisX3c.png",be={key:0,class:"flex items-center justify-center"},Te=["src"],$e={class:"bg-[#FFF1D6] rounded-2xl text-xxs font-bold py-0.5 px-2 pl-3.5"},Se=G({props:{rankNum:null,type:{default:U.SR}},setup(e){return(g,h)=>(l(),n("div",null,[+e.rankNum>0?(l(),n("div",be,[t("img",{src:k(X)(`images/shop/rank${e.rankNum>3?4:e.rankNum}.png`),class:"inline-block w-[14px] h-[16px] -mr-2 z-10"},null,8,Te),t("div",$e,_(e.type===k(U).EBR?g.$t("ranking.ecology boost",{num:e.rankNum}):g.$t("ranking.recently hot sales",{num:e.rankNum})),1)])):C("",!0)]))}}),Pe={class:"relative"},Ce={class:"flex items-start w-full"},Ie={class:"relative w-[85px] h-[85px] flex-shrink-0 bg-black-100 overflow-hidden rounded-lg"},Re={class:"object-cover w-full h-full aspect-square",fit:"cover"},Fe={class:"flex flex-col items-start justify-between w-[calc(100%-85px-1rem)] ml-4 text-sm"},Le={class:"flex items-center w-full text-sm font-semibold text-black-900"},Ae={class:"mr-2 truncate"},Be={class:"flex-shrink-0 ml-auto"},Ne={class:"flex w-full mt-1 text-xs text-primary"},Ve={class:"self-start mr-3 flex-center text-black-400"},ze={class:"ml-1"},De={class:"mt-2.5 min-h-[17px] flex items-center gap-2"},Ge={key:0,class:"flex flex-col gap-2.5 mt-3 w-full"},Me=["onClick"],qe=t("img",{src:we,class:"flex-shrink-0 w-3 h-3"},null,-1),Ee={class:"truncate text-xs text-[#999] mx-1"},He={class:"flex-shrink-0 ml-auto"},je={key:0,class:"text-xs font-bold text-black flex-center-bw min-w-fit"},Ke=t("div",{class:"gray-ball font-normal mr-0.5"},[t("img",{class:"w-4 h-4",src:_e})],-1),Oe={class:""},Xe={key:1,class:"flex text-xs font-bold text-black min-w-fit"},Ye=t("div",{class:"mr-1 gray-ball"},[t("img",{class:"w-4 h-4",src:fe})],-1),Qe=t("div",{class:"flex items-center h-2.5"},null,-1),Ue=G({props:{shop:null,goods:null},emits:["handleTo","click"],setup(e,{emit:g}){const h=e,o=d(0),p=async()=>{var m;o.value=((m=h.shop)==null?void 0:m.discountRatio)||0};return ee(()=>{p()}),(m,v)=>{var x,T;const s=q("van-rate"),y=ne("lazy");return l(),n(V,null,[t("div",{class:"rounded bg-white p-2.5",onClick:v[1]||(v[1]=r=>g("click"))},[t("section",Pe,[t("div",Ce,[t("div",Ie,[j(t("img",Re,null,512),[[y,e.shop.logo||k(X)("images/goods/defaultImg.png")]]),e.shop.type?(l(),N(me,{key:0,type:e.shop.type},null,8,["type"])):C("",!0)]),t("div",Fe,[t("div",Le,[t("div",Ae,_(e.shop.storeName),1),t("div",Be,[b(ge,{tag:m.$t("common.rebate"),ratio:e.shop.discountRatio||0},null,8,["tag","ratio"])])]),t("div",Ne,[t("span",Ve,_(m.$t("mall.15th sale",{salesVolume:e.shop.volume15||0})),1),b(s,{class:"flex-shrink-0",readonly:"","allow-half":"",modelValue:e.shop.star,"onUpdate:modelValue":v[0]||(v[0]=r=>e.shop.star=r),size:16,gutter:"0",color:"#FEA021"},null,8,["modelValue"]),t("span",ze,_(e.shop.star),1)]),t("div",De,[(x=e.shop)!=null&&x.ranking?(l(),N(Se,{key:0,class:"shrink-0","rank-num":(T=e.shop)==null?void 0:T.ranking},null,8,["rank-num"])):C("",!0),e.shop.metakeyFlag?(l(),N(ye,{key:1})):C("",!0),b(xe,{type:e.shop.buyFlag?1:e.shop.watchFlag?2:e.shop.followFlag?3:0},null,8,["type"])]),e.goods&&e.goods.length>0?(l(),n("section",Ge,[(l(!0),n(V,null,E(e.goods,r=>(l(),n("div",{class:"flex items-center",key:r.id,onClick:ie(()=>g("handleTo",`/goodsDetail?id=${r.id}`),["stop","prevent"])},[qe,t("span",Ee,_(r.goodsName),1),t("div",He,[r.payType===2||r.payType===3?(l(),n("div",je,[Ke,t("div",Oe,_(r.cardPrice)+_(r.symbol),1)])):(l(),n("div",Xe,[Ye,t("div",null,_(r.price)+"Mcoin",1)]))])],8,Me))),128))])):C("",!0)])])])]),Qe],64)}}}),Je=e=>(se("data-v-56c7ba01"),e=e(),ae(),e),We={key:0,class:"relative lieanr-bg rounded-xl mb-2.5"},Ze=Je(()=>t("img",{src:ke,class:"w-full h-full"},null,-1)),et=[Ze],tt={class:"pt-[45px] px-4"},st=["onClick"],at=["src"],lt={class:"absolute bottom-0 left-0 z-10 w-full flex-center bg-black-linear"},ot={class:"text-white text-sm font-bold text-center h-[20px] line-clamp-1 mt-1"},nt=G({props:{searchParam:{default:()=>({keyword:null,sortType:null,orderBy:null})},sortType:null,shopPath:{default:"/category"},isSearchPage:{type:Boolean,default:!1},activeInfo:null},emits:["handleTo"],setup(e,{expose:g,emit:h}){const o=e,p=d([]),m=d(!1),v=d(!1),s=d(0),y=d(10),x=d(0),T=d([]),r=d(0),R=async()=>{m.value=!0,s.value+=1,await I(),m.value=!1},I=async()=>{var f,A,z,D;const a=await J({page:s.value,size:y.value,...o.searchParam,sortType:o.sortType});if(m.value=!1,!a.success){v.value=!0;return}if(!a.data||!a.total){v.value=!0;return}if(x.value=a.total,T.value=a.data||[],s.value===2&&((f=o.activeInfo)!=null&&f.id)){const i={activeType:1,activePath:(A=o.activeInfo)==null?void 0:A.url,activeImg:((z=o.activeInfo)==null?void 0:z.activityListImgs)||null,activeImgGrid:((D=o.activeInfo)==null?void 0:D.activityWaterfallImgs)||null,...o.activeInfo};r.value+=1,T.value.unshift(i)}p.value=s.value===1?T.value:p.value.concat(T.value),p.value.length-r.value>=x.value&&(v.value=!0)},S=d([]),F=async()=>{const{success:a,data:f}=await J({page:1,size:12,sortType:null,orderBy:1,boutiqueFlag:!0});a&&(S.value=f||[])},L=async()=>{p.value=[],s.value=0,x.value=0,r.value=0,v.value=!1,await R()};return ee(()=>{F()}),g({handleSearch:L,list:p}),(a,f)=>{const A=q("van-swipe-item"),z=q("van-swipe"),D=q("VanList");return l(),n("div",null,[e.isSearchPage?C("",!0):(l(),n("div",We,[t("div",{class:"w-[49px] h-[21px] absolute top-[15px] right-[9px]",onClick:f[0]||(f[0]=i=>h("handleTo","/boutique-shop"))},et),t("div",tt,[b(z,{loop:!1,width:"95","show-indicators":!1},{default:H(()=>[(l(!0),n(V,null,E(S.value,i=>(l(),N(A,{key:i.id,class:""},{default:H(()=>[t("div",{onClick:M=>{var B;return h("handleTo",`/category?deliveryType=1&shopId=${(B=i.stores)==null?void 0:B.id}`)},class:"mr-[10px] rounded-xl border-[2px] w-[89px] h-[89px] border-white overflow-hidden relative"},[t("img",{class:"flex-shrink-0 object-cover w-full h-full aspect-square",src:i&&i.stores&&i.stores.logo||k(X)("images/activity/boutique/active_empty.png")},null,8,at),t("div",lt,[t("span",ot,_(i.stores.storeName||a.$t("avtivity.check")),1)])],8,st)]),_:2},1024))),128))]),_:1})])])),b(D,{loading:m.value,"onUpdate:loading":f[3]||(f[3]=i=>m.value=i),finished:v.value,"finished-text":a.$t("common.noMore"),"loading-text":a.$t("common.loading"),onLoad:R},{default:H(()=>[(l(!0),n(V,null,E(p.value,(i,M)=>(l(),n(V,{key:M},[i!=null&&i.activeType?(l(),N(ve,{key:0,info:i,onHandleTo:f[1]||(f[1]=B=>h("handleTo",B)),class:"mb-2.5"},null,8,["info"])):(l(),N(Ue,{key:1,shop:i.stores,goods:i.goods,onClick:()=>h("handleTo",`${e.shopPath}?shopId=${i.stores.id}&deliveryType=1`),onHandleTo:f[2]||(f[2]=B=>h("handleTo",B))},null,8,["shop","goods","onClick"]))],64))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])])}}}),it=te(nt,[["__scopeId","data-v-56c7ba01"]]),ct={class:"flex items-center gap-[8px] font-normal overflow-x-scroll"},rt=["onClick"],W=G({props:{sortType:null,listActive:null},emits:["change"],setup(e,{emit:g}){const h=e,{t:o}=le(),p=K(()=>h.listActive?[{text:o("mall.Comprehensive recommendation"),value:null},{text:o("mall.Recently popular"),value:3},{text:o("mall.star"),value:2},{text:o("mall.saleNum"),value:1},{text:o("evaluate.Good reviews"),value:4}]:[{text:o("mall.Comprehensive recommendation"),value:null},{text:o("mall.Recently popular"),value:3},{text:o("goods.Selected-Optimal Priority"),value:5},{text:o("mall.saleNum"),value:1}]),m=K(()=>p.value.find(v=>v.value===h.sortType).value);return(v,s)=>(l(),n("div",ct,[(l(!0),n(V,null,E(k(p),y=>(l(),n("div",{key:y.value,onClick:x=>g("change",y),class:O(["px-2 py-1 text-black/80 bg-[#F3F3F3] rounded-md flex-shrink-0",{"font-bold text-black":y.value===k(m)}])},_(y.text),11,rt))),128))]))}}),ut="/static/images/wave-BS6nzmaQ.png",dt="/static/images/list-icon-3aw8mu4E.svg",vt="/static/images/grid-icon-Bf3eB47x.svg",ht={class:"flex flex-1 items-center pt-2 pb-3.5 pr-4 font-light text-black-600"},ft={class:"flex items-center gap-6 text-base text-black/60"},mt=["onClick"],pt={key:0,src:ut,class:"absolute bottom-0 w-6 h-auto -translate-x-1/2 left-1/2"},gt={key:0,class:"w-6 h-6",src:dt},yt={key:1,class:"w-5 h-5",src:vt},Z=G({props:{listActived:null,viewFormat:null,isSearchPage:{type:Boolean}},emits:["changeActive","changeView"],setup(e,{emit:g}){const h=e,{t:o}=le(),p=K(()=>h.isSearchPage?[{id:0,name:o("mall.Good stuff")},{id:1,name:o("mall.Good shop")}]:[{id:1,name:o("mall.Good shop")},{id:0,name:o("mall.Good stuff")}]);return(m,v)=>(l(),n("div",ht,[t("div",ft,[(l(!0),n(V,null,E(k(p),s=>(l(),n("div",{class:O([{"active-tab text-xl text-black font-bold relative":e.listActived==s.id},"flex items-center pb-1"]),onClick:y=>g("changeActive",s.id),key:s.id},[e.listActived==s.id?(l(),n("img",pt)):C("",!0),ce(" "+_(s.name),1)],10,mt))),128))]),e.listActived==0?(l(),n("div",{key:0,class:"ml-auto",onClick:v[0]||(v[0]=s=>g("changeView"))},[e.viewFormat==0?(l(),n("img",gt)):(l(),n("img",yt))])):C("",!0)]))}}),oe=e=>(se("data-v-185bd2fe"),e=e(),ae(),e),xt={class:"text-white bg-[#f8f8f8] rounded-t-xl"},kt=oe(()=>t("div",{class:"h-2.5"},null,-1)),wt={class:"text-white bg-[#f8f8f8] px-2.5"},_t=oe(()=>t("div",{class:"h-2.5"},null,-1)),bt={class:"rounded-b-lg min-h-[60vh]"},Tt=G({props:{isSearchPage:{type:Boolean,default:!1},mode:{default:"vant"},activeInfo:null},setup(e,{expose:g}){const h=e,{scrollStore:o}=pe(),p=re(),m=Y(it),v=Y(he),s=d(h.isSearchPage?0:1),y=c=>{s.value=c,D(),s.value==0?a.sortType=L.value:s.value==1&&(a.sortType=F.value),(a.sortType===2||a.sortType===5||a.sortType===4)&&(s.value==0?(a.sortType=S.value,L.value=S.value):s.value==1&&(a.sortType=I.value,F.value=I.value),setTimeout(()=>{i()}))},x=d(0),T=()=>{x.value=1-x.value},r=d(null),R=d(null),I=d(null),S=d(3),F=d(I.value),L=d(S.value),a=ue({keyword:"",sortType:I.value,orderBy:1,classId:null});h.isSearchPage&&(a.sortType=S.value);const f=d(null),A=async c=>{a.sortType!==c.value&&(a.sortType=c.value,s.value==0?L.value=c.value:s.value==1&&(F.value=c.value),setTimeout(()=>{z(),i()}))},z=()=>{const c=document.getElementById("fm-page"),P=c.scrollY||c.scrollTop;let w=f.value.offsetParent,u=0;if(w.nodeName.toLowerCase()==="body")u+=f.value.offsetTop;else for(;w;)u+=w.offsetTop,w=w.offsetParent;P>u&&(o.setMallScroll("goods",u),o.setMallScroll("shop",u),c.scrollTo({top:u,behavior:"smooth"}))},D=()=>{const c=document.getElementById("fm-page"),P=c.scrollY||c.scrollTop;let w=s.value===1?"goods":"shop",u=s.value===1?"shop":"goods";o.setMallScroll(w,P);const $=o.getScroll(u)||0;c.scrollTo({top:$})},i=async()=>{var c,P,w,u,$;if(await R.value.handleSearch(),a.sortType!==5&&await r.value.handleSearch(),h.isSearchPage&&((c=r.value.list)==null?void 0:c.length)<=0&&s.value===1){y(0);return}(((P=R.value.list)==null?void 0:P.length)<=0&&((w=r.value.list)==null?void 0:w.length)>0&&s.value===0||((u=R.value.list)==null?void 0:u.length)>0&&(($=r.value.list)==null?void 0:$.length)<=0&&s.value===1)&&y(s.value)},M=c=>{p.push(c)};return g({setParam:({keyword:c,classId:P})=>{a.keyword=c||null,a.classId=P||null,i()},onRefresh:async()=>{a.keyword="",F.value=I.value,L.value=S.value,s.value==0?a.sortType=S.value:s.value==1&&(a.sortType=I.value),a.orderBy=1,a.classId=null,o.setMallScroll("goods",0),o.setMallScroll("shop",0),setTimeout(async()=>{await i()})}}),(c,P)=>{const w=q("van-sticky");return l(),n("div",{ref:(u,$)=>{$.listPageRef=u,f.value=u},class:"RecommendsPage"},[e.mode==="vant"?(l(),N(w,{key:0,"offset-top":e.isSearchPage?90:0},{default:H(()=>[t("div",xt,[b(Z,{isSearchPage:e.isSearchPage,listActived:s.value,viewFormat:x.value,onChangeActive:y,onChangeView:T},null,8,["isSearchPage","listActived","viewFormat"]),b(W,{sortType:k(a).sortType,listActive:s.value,onChange:A},null,8,["sortType","listActive"]),kt])]),_:1},8,["offset-top"])):e.mode==="div"?(l(),n("div",{key:1,class:"sticky__wrapper",style:de(e.isSearchPage?"top: 90px":"top: 0")},[t("div",wt,[b(Z,{isSearchPage:e.isSearchPage,listActived:s.value,viewFormat:x.value,onChangeActive:y,onChangeView:T},null,8,["isSearchPage","listActived","viewFormat"]),b(W,{sortType:k(a).sortType,listActive:s.value,onChange:A},null,8,["sortType","listActive"]),_t])],4)):C("",!0),t("div",{class:O(["relative z-10 pb-2 bg-[#f8f8f8] hardware-accelerated",{"min-h-[calc(100vh-126px)] pb-8 overflow-y-hidden":e.isSearchPage}])},[t("div",bt,[j(b(k(v),{viewFormat:x.value,searchParam:k(a),sortType:L.value,onHandleTo:M,ref:(u,$)=>{$.goodListRef=u,R.value=u},isSearchPage:e.isSearchPage,"active-info":e.activeInfo},null,8,["viewFormat","searchParam","sortType","isSearchPage","active-info"]),[[Q,s.value==0]]),j(b(k(m),{searchParam:k(a),sortType:F.value,onHandleTo:M,ref:(u,$)=>{$.shopListRef=u,r.value=u},isSearchPage:e.isSearchPage,"active-info":e.activeInfo},null,8,["searchParam","sortType","isSearchPage","active-info"]),[[Q,s.value==1]])])],2)],512)}}}),Bt=te(Tt,[["__scopeId","data-v-185bd2fe"]]);export{Bt as R};
