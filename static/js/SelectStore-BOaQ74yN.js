import{_ as R,bf as L,D as $,K as k,G as c,N as A,l as z,a1 as F,E as N,H as s,O as j,bc as B,F as p,a2 as w,a4 as K,P as a,Q as x,bo as O,bz as D,J as U,I as q,Y as E,Z as G}from"./vendor-BUT0HZ5j.js";import{_ as H}from"./down-arrow-Ba_kjgtn.js";import{_ as J}from"./search-Dwmdj_3F.js";import{_ as Q}from"./delete-C3qvlPYO.js";import{C as T}from"./CommonVanProvider-BpsZUrD3.js";import{e as Y,az as Z,aC as W,as as X}from"./index-BvL8wS8a.js";import"./BackIcon-biFt6cm7.js";const v=_=>(E("data-v-64e95f9a"),_=_(),G(),_),M={class:"px-3"},ee={class:"search__wrap w-full h-[50px] pb-3"},se={class:"search__input w-full h-full bg-b5 rounded-3xl flex items-center justify-center px-3 py-2.5"},te=["onClick"],oe={class:"text-sm text-b2 font-normal min-w-[28px] max-w-[56px]"},ae={key:1,class:"text-truncate"},ne=v(()=>s("img",{src:H,class:"w-[9px] h-auto"},null,-1)),le=v(()=>s("div",{class:"mx-2 bg-b4 w-[1px] h-full"},null,-1)),ie=v(()=>s("div",{class:"search__icon flex-shrink-0"},[s("img",{src:J,class:"w-4 h-4"})],-1)),re=["placeholder","onKeyup"],ce=v(()=>s("img",{src:Q,class:"w-4 h-4",alt:""},null,-1)),de=[ce],fe={class:"text-[#FF8812] text-sm font-semibold whitespace-nowrap"},ue=["onClick"],he={class:"flex-1 flex items-center gap-1"},me={class:"line-clamp-1 text-base font-semibold"},pe={key:0,class:"text-xs text-newOrigin border border-newOrigin px-1 rounded-sm"},_e={class:"mt-1 text-b3 flex items-center justify-between gap-x-1"},ge={class:"line-clamp-1"},xe={setup(_){const{cityMapStore:e}=Y(),y=z(),I=F(),t=L({total:0,loading:!1,finished:!1,list:[]}),o=L({page:0,size:20,overseasFlag:!1,storeNameLike:void 0,longitude:e.locationCoords.lng||null,latitude:e.locationCoords.lat||null}),S=()=>{y.push({path:"/city/selectArea",query:{mode:"select",from:encodeURIComponent(I.path)}})},C=()=>{console.log(o.storeNameLike),o.page=0,o.size=20,o.finished=!1,o.list=[],b()},V=n=>{n.storeId&&e.setSelectedStore(n),y.back()},b=async()=>{console.log("onLoad"),t.loading=!0,o.page+=1,await P(),t.loading=!1},P=async()=>{var h,m;if(!((h=e==null?void 0:e.selectedArea)!=null&&h.areaId)){t.finished=!0;return}o.areaIdPreviousLastLeaf=(m=e==null?void 0:e.selectedArea)==null?void 0:m.areaId;const{success:n,data:i}=await Z(o);if(t.loading=!1,!n){t.finished=!0;return}const{records:r,total:g,current:f,pages:u}=i;(!g||!r||!(r!=null&&r.length))&&(t.finished=!0),t.total=g,t.list=o.page===1?r:t.list.concat(r),+f>=+u&&(t.finished=!0)};return $(()=>{e!=null&&e.selectedArea||e.setSelectedArea(e==null?void 0:e.currentActiveCity),b()}),(n,i)=>{const r=N("van-loading"),g=N("VanList");return c(),k(T,{title:"选择门店",class:"bg-white font-Puhui font-normal relative","theme-vars":{"nav-bar-background-color":"#fff","field-placeholder-text-color":"#A6A6A6"},ref:(f,u)=>{u.searchRef=f}},{default:A(()=>{var f,u,h,m;return[s("div",M,[s("div",ee,[s("div",se,[s("div",{class:"city-selector flex items-center justify-start gap-1",onClick:K(S,["stop"])},[s("div",oe,[(u=(f=a(e))==null?void 0:f.selectedArea)!=null&&u.areaName?(c(),p("span",ae,x((m=(h=a(e))==null?void 0:h.selectedArea)==null?void 0:m.areaName),1)):(c(),k(r,{key:0,size:"14"}))]),ne],8,te),le,ie,B(s("input",{ref:(l,d)=>{d.searchRef=l},type:"text","onUpdate:modelValue":i[0]||(i[0]=l=>a(o).storeNameLike=l),class:"flex-1 h-full bg-transparent ml-1 font-normal",placeholder:n.$t("offline.store_search"),onKeyup:D(C,["enter"]),enterkeyhint:"search"},null,40,re),[[O,a(o).storeNameLike]]),a(o).storeNameLike?(c(),p("div",{key:0,class:"flex-shrink-0 flex items-center justify-center",onClick:i[1]||(i[1]=(...l)=>n.onClear&&n.onClear(...l))},de)):w("",!0),s("div",{class:"search__btn ml-2 flex-shrink-0",onClick:C},[s("span",fe,x(n.$t("common.search")),1)])])]),j(g,{loading:a(t).loading,"onUpdate:loading":i[2]||(i[2]=l=>a(t).loading=l),finished:a(t).finished,"immediate-check":!1,"loading-text":n.$t("common.loading"),onLoad:b,class:"shopList h-[calc(100vh-100px)] overflow-y-auto"},{default:A(()=>{var l;return[s("section",null,[!((l=a(t))!=null&&l.list.length)&&!a(W)?(c(),k(X,{key:0})):w("",!0),(c(!0),p(q,null,U(a(t).list,d=>(c(),p("div",{key:d.storeId,class:"gap-1 text-sm py-3 border-b border-b-b4 first:pt-0 last:border-none",onClick:ve=>V(d)},[s("div",he,[s("div",me,x(d.storeName),1),+d.storeGoodsCount>0?(c(),p("div",pe," 商家入驻 ")):w("",!0)]),s("div",_e,[s("span",ge,x(d.storeAddress),1)])],8,ue))),128))])]}),_:1},8,["loading","finished","loading-text"])])]}),_:1},512)}}},Ne=R(xe,[["__scopeId","data-v-64e95f9a"]]);export{Ne as default};
