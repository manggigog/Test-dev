import{E as k,F as m,G as n,H as s,P as a,O as d,Q as h,K as u,a2 as w,y as E,x as X,l as Y,a1 as Z,w as ee,bf as te,r as T,z as se,be as A,D as le,bh as oe,N as b,J as ae,I as ne,a0 as ie,T as ce}from"./vendor-BUT0HZ5j.js";import{g as P,e as re,as as ue,V as de,bn as fe,by as pe,bz as me,bA as he}from"./index-k1FFr-1T.js";import{C as ve}from"./CommonVanProvider-BpsZUrD3.js";import{_ as ge}from"./EmptyTipsPop-_FH8A6A8.js";import{_ as xe,M as ye}from"./MetaKeyTag-HQQOzr5T.js";import{_ as _e}from"./ExpressMinutesTag-mEi2oDXk.js";import{R as be}from"./RatioBox-ys008e7W.js";import{B as L}from"./BoutiqueLabelInLogo-8rzV321c.js";import{B as ke}from"./BetweenTab-Bn5ZVRk8.js";import"./BackIcon-biFt6cm7.js";import"./useOrderStatus-BSCfQVBG.js";import"./shop-CeqcS6K2.js";/* empty css                                                               */const we={class:"pb-3"},$e={class:"w-full flex justify-start items-start px-3 bg-white p-3 rounded-xl"},Ce={class:"w-[60px] h-[60px] rounded-[4px] overflow-hidden flex-shrink-0 relative"},Fe=["src"],Ie={class:"absolute right-0 top-0"},Se={class:"ml-2 flex flex-col justify-between items-start w-full"},Te={class:"flex items-center justify-start w-full"},Ve={class:"max-w-[calc(100%-66px)] text-base font-semibold text-black line-clamp-1 leading-[22px] flex-shrink-0"},Ne={class:"flex items-center text-sm text-primary"},je={class:"ml-1"},Be={class:"w-full flex justify-start items-center gap-1.5 overflow-x-auto h-[18px]"},Ee={props:{shop:{type:Object,required:!0}},setup(o){return(c,v)=>{const f=k("van-rate");return n(),m("div",we,[s("div",$e,[s("div",Ce,[s("img",{src:o.shop.logo||o.shop.scenery&&o.shop.scenery.split(",")[0]||a(P)("images/goods/defaultImg.png"),class:"w-[60px] h-[60px] object-cover"},null,8,Fe),s("div",Ie,[d(L,{type:o.shop.type},null,8,["type"])])]),s("div",Se,[s("div",Te,[s("p",Ve,h(o.shop.storeName),1),d(be,{class:"ml-auto h-[22px]",tag:c.$t("common.rebate"),ratio:o.shop.discountRatio||0},null,8,["tag","ratio"])]),s("div",Ne,[d(f,{class:"flex-shrink-0",readonly:"","allow-half":"",modelValue:o.shop.star,"onUpdate:modelValue":v[0]||(v[0]=C=>o.shop.star=C),size:16,gutter:"0",color:"#FEA021"},null,8,["modelValue"]),s("span",je,h(o.shop.star),1)]),s("div",Be,[d(xe,{type:o.shop.buyFlag?1:o.shop.watchFlag?2:o.shop.followFlag?3:0},null,8,["type"]),o.shop.recentExpressSeconds?(n(),u(_e,{key:0,time:o.shop.recentExpressSeconds},null,8,["time"])):w("",!0),o.shop.metakeyFlag?(n(),u(ye,{key:1})):w("",!0)])])])])}}},ze={class:"border-[0.5px] border-solid border-[#FF8812] rounded-sm px-1 py-0.5 text-[#FF8812] text-xxs font-normal min-w-fit"},q=E({props:{text:null},setup(o){return(c,v)=>(n(),m("div",ze,h(o.text),1))}}),Ae={class:"pb-3"},qe={class:"w-full flex justify-start items-start px-3 bg-white p-3 rounded-xl"},Pe={class:"w-[60px] h-[60px] rounded-[4px] overflow-hidden flex-shrink-0 relative"},Le={class:"absolute right-0 top-0"},Oe={class:"ml-2 flex flex-col justify-between items-start w-full"},Re={class:"flex items-center justify-start w-full"},Ue={class:"max-w-[calc(100%-66px)] text-base font-semibold text-black line-clamp-1 leading-[22px] flex-shrink-0"},De=s("div",{class:"flex items-center text-sm text-primary"},null,-1),Me={class:"w-full flex justify-start items-center gap-1.5 overflow-x-auto h-[18px] mt-1"},Ge={class:"mt-1 text-sm text-b3 font-normal line-clamp-1"},Ke={props:{shop:{type:Object,required:!0}},setup(o){const c=o,v=X(()=>{let f="";return c.shop.areaName1&&(f=c.shop.areaName1),c.shop.areaName2&&c.shop.areaName2!==c.shop.areaName1&&(f+=`-${c.shop.areaName2}`),f});return(f,C)=>{const V=k("van-image");return n(),m("div",Ae,[s("div",qe,[s("div",Pe,[d(V,{width:"60",height:"60",src:o.shop.storeIcons&&o.shop.storeIcons.split(",")[0]||a(P)("images/goods/defaultImg.png"),class:"rounded-[4px] w-[60px] h-[60px]"},null,8,["src"]),s("div",Le,[d(L,{type:o.shop.type},null,8,["type"])])]),s("div",Oe,[s("div",Re,[s("p",Ue,h(o.shop.storeName),1)]),De,s("div",Me,[d(q,{text:o.shop.goodsCategoryName1},null,8,["text"]),d(q,{text:a(v)},null,8,["text"])]),s("div",Ge,h(o.shop.storeAddress||""),1)])])])}}},He={class:"flex items-center justify-start gap-1"},Je=["src"],Qe=s("span",{class:"text-b2 text-sm font-normal"},"取消",-1),We=[Qe],Xe=s("span",{class:"text-b2 text-sm font-normal"},"编辑",-1),Ye=[Xe],Ze={class:"scrollPage p-3 h-[calc(100vh-83px)] overflow-y-auto"},et={class:"flex items-center justify-start"},tt={key:0,class:"flex-shrink-0 mr-3"},st={class:"w-full"},lt={key:0,class:"fixed bottom-0 left-0 right-0 bg-[#F5F5F5] p-3 flex items-center justify-between"},ot={class:"flex-shrink-0 flex items-center justify-start gap-2 mr-3"},at=s("span",{class:"text-b3 text-sm font-normal"},"全选",-1),nt={key:0},it=E({name:"shopsCollect"});function ct(o){const c=Y(),v=Z(),{t:f}=ee(),{regionStore:C}=re(),V=[{label:f("shop.on-line"),value:1},{label:f("shop.off-line"),value:2}],O=t=>{r.value=[],g.value=[],p.value=!1,F(!1),e.type=t||1,c.replace({query:{type:t}}),N()},e=te({type:Number(v.query.type)||1,page:0,size:10,finished:!1,list:[],loading:!1,total:0}),r=T([]),g=T([]),p=T(!1),R=()=>{p.value?r.value=e.list.map(l=>e.type===2?l.collectId:l.shopId):r.value=[]};se(r,t=>{console.log(t),t.length&&t.length>=e.list.length?p.value=!0:p.value=!1});const U=(t,l)=>{$.value?g.value[l].toggle():c.push("/category?deliveryType=1&shopId="+t.shopId+"&activated=1")},D=(t,l)=>{$.value?g.value[l].toggle():c.push("/city/storefront?storeId="+t.storeId+"&activated=1")},z=async()=>{e.loading=!0,e.page+=1,await M(),e.loading=!1},M=async()=>{let t=null;if(e.type===1&&(t=await me({page:e.page,size:e.size})),e.type===2){const l=await he({page:e.page,size:e.size,sortBy:"desc|create_time"});t={success:l.success,data:l.data.records||[],total:l.data.total||0}}if(!t.success){e.finished=!0;return}if(!t.data||!t.total){e.finished=!0;return}e.total=t.total,e.list=e.page===1?t.data:e.list.concat(t.data),p.value&&(r.value=e.list.map(l=>e.type===2?l.collectId:l.shopId)),e.list.length>=e.total&&(e.finished=!0)},N=()=>{e.page=0,e.total=0,e.finished=!1,e.list=[],z()},[$,F]=A(!1),[G,j]=A(!1),K=async()=>{if(!r.value.length){ce("请选择要移除的店铺");return}let t=null;e.type===1?t=await fe({shopIds:r.value||[],type:2}):t=await pe({ids:r.value||[]}),t.success&&(N(),j(!0),r.value=[],g.value=[],p.value=!1),setTimeout(()=>{j(!1)},3e3)};let I=null;const H=async()=>{const t=localStorage.getItem("shopsCollect_scrollTop");+t?(console.log("setCacheScrollTop",+t),I.scrollTo({top:+t,left:0,behavior:"instant"})):localStorage.removeItem("shopsCollect_scrollTop")},B=T(!1),J=()=>{B.value||(B.value=!0,setTimeout(()=>{localStorage.setItem("shopsCollect_scrollTop",I.scrollTop+""),B.value=!1},500))};return le(()=>{I=document.querySelector(".scrollPage"),I.addEventListener("scroll",J)}),oe(async()=>{var t,l,y,S;H(),!(e.finished&&((S=(y=(l=(t=c==null?void 0:c.options)==null?void 0:t.history)==null?void 0:l.state)==null?void 0:y.forward)==null?void 0:S.indexOf("activated=1"))>-1)&&(r.value=[],g.value=[],p.value=!1,F(!1),N())}),(t,l)=>{const y=k("van-checkbox"),S=k("van-checkbox-group"),Q=k("van-list"),W=k("VanButton");return n(),u(ve,{class:"bg-[#F5F5F5] font-Puhui font-normal relative shopGoodsPage",title:"店铺收藏","theme-vars":{"field-placeholder-text-color":"#F5F5F5"},ref:(i,_)=>{_.shopsCollectRef=i}},{title:b(()=>[s("div",He,[s("div",null,[s("img",{src:a(de)(`mall/${a(C).country}-flag.svg`),class:"w-4 h-auto"},null,8,Je)]),s("span",null,h(t.$t("collect.shopsCollect")),1)])]),right:b(()=>[s("div",null,[a($)===!0?(n(),m("div",{key:0,onClick:l[0]||(l[0]=i=>a(F)(!1))},We)):(n(),m("div",{key:1,onClick:l[1]||(l[1]=i=>a(F)(!0))},Ye))])]),default:b(()=>[s("div",null,[d(ke,{class:"between-tab__wrap",options:V,"label-key":"label","value-key":"value",modelValue:a(e).type,"onUpdate:modelValue":l[2]||(l[2]=i=>a(e).type=i),onChange:O},null,8,["modelValue"]),s("div",Ze,[a(e).list.length===0&&!a(e).loading?(n(),u(ue,{key:0,name:t.$t("common.No data yet")},null,8,["name"])):(n(),u(Q,{key:1,loading:a(e).loading,"onUpdate:loading":l[4]||(l[4]=i=>a(e).loading=i),"finished-text":t.$t("common.noMore"),"loading-text":t.$t("common.loading"),finished:a(e).finished,onLoad:z,"immediate-check":!0},{default:b(()=>[(n(!0),m(ne,null,ae(a(e).list,(i,_)=>(n(),u(S,{key:i.shopId||i.collectId,modelValue:r.value,"onUpdate:modelValue":l[3]||(l[3]=x=>r.value=x),"checked-color":"#FEA021","icon-size":"16"},{default:b(()=>[s("div",et,[a($)?(n(),m("div",tt,[a(e).type===2?(n(),u(y,{key:0,name:i.collectId,ref:x=>g.value[_]=x},null,8,["name"])):(n(),u(y,{key:1,name:i.shopId,ref:x=>g.value[_]=x},null,8,["name"]))])):w("",!0),s("div",st,[a(e).type===2?(n(),u(Ke,{key:0,shop:i,onClick:x=>D(i,_)},null,8,["shop","onClick"])):(n(),u(Ee,{key:1,shop:i,onClick:x=>U(i,_)},null,8,["shop","onClick"]))])])]),_:2},1032,["modelValue"]))),128))]),_:1},8,["loading","finished-text","loading-text","finished"]))])]),a($)?(n(),m("div",lt,[s("div",ot,[d(y,{modelValue:p.value,"onUpdate:modelValue":l[5]||(l[5]=i=>p.value=i),"checked-color":"#FEA021","icon-size":"16",onClick:R},null,8,["modelValue"]),at]),d(W,{class:"main-btn flex-center text-white font-semibold rounded-full !bg-[#f44] text-base w-full h-[46px]",onClick:K},{default:b(()=>[ie(h(t.$t("common.delete"))+" ",1),r.value.length>0?(n(),m("span",nt," ("+h(r.value.length)+") ",1)):w("",!0)]),_:1})])):w("",!0),a(G)?(n(),u(ge,{key:1,isError:!1,onClose:l[6]||(l[6]=i=>a(j)(!1)),text:"删除成功"})):w("",!0)]),_:1},512)}}const kt=E({...it,setup:ct});export{kt as default};
