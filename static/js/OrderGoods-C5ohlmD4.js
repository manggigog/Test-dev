import{_ as U,z as q,x as G,y as w,B as R,D as H,r as Q,F as v,G as i,H as d,I as l,U as c,P as h,Z as x,a3 as k,Q as r,O as n,$ as z,a4 as A,T as X,X as Y,Y as Z}from"./vendor-Dr_RpJ_Y.js";import{_ as J}from"./MCOIN-Bodfn-v1.js";import{_ as K}from"./BoutiqueLable-DDlxeK08.js";import{P as S}from"./flashSale-DDyqLyYN.js";import{_ as L}from"./ShopMaskTips-ClYuWX9C.js";import{S as N}from"./shop-CeqcS6K2.js";import{e as W}from"./index-7OiUoGXy.js";const ee=o=>(Y("data-v-238a21f4"),o=o(),Z(),o),oe={class:"flex-center-bw"},se={key:0},te={class:"flex-1 flex justify-between flex-col min-h-[80px] relative"},ae={class:"text-left line-clamp-1 font-semibold"},ne={class:"text-left text-b3 line-clamp-1"},de={class:"flex items-center mt-1 flex-warp goods-tag"},le={key:0,class:"text-xs text-primary"},re={class:"flex items-center"},ie={key:0,class:"flex-center text-primary"},ce={key:1,class:"flex-center"},ue=ee(()=>l("img",{src:J,class:"w-4 h-4 mr-1"},null,-1)),me={class:"input-wrapper"},ge={key:3},pe=q({props:{goods:null,number:null,isDisabledEdit:{type:Boolean,default:!1},payType:null,card:null,needMask:{type:Boolean,default:!0},shopType:{default:N.SD}},emits:["changeNumber","handleTo"],setup(o,{emit:u}){const e=o,{t:O}=G(),T=9999999,p=w(()=>{var s;return(s=e.goods)==null?void 0:s.goodsType}),P=w(()=>+e.goods.goodsTypes!=2&&(e.goods.warnType===2&&e.goods.stock<=e.goods.warnValue||e.goods.warnType===1&&e.goods.stock<=+new R(e.goods.totalStock).times(e.goods.warnValue).div(100)||!e.goods.warnType&&e.goods.stock<=50));H(()=>e.number,s=>{a.value=s});const a=Q(e.number),j=s=>{try{return s.data.replace(/\d/g,"")}catch{return""}},M=()=>{var s,t,y,m,g,f;if(+a.value>=T&&(a.value=T),(((s=e.card)==null?void 0:s.stock)||((t=e.goods)==null?void 0:t.stock))<+a.value&&(+((y=e.card)==null?void 0:y.goodsTypes)||+((m=e.goods)==null?void 0:m.goodsTypes))!=2)return a.value=Number(((g=e.card)==null?void 0:g.stock)||((f=e.goods)==null?void 0:f.stock)||e.number),u("changeNumber",a.value),X(O("order.Insufficient stock"));if(a.value<=0){a.value=+e.number;return}u("changeNumber",a.value)},D=w(()=>{var s;return e.shopType!==N.SD?new R(e.goods.price).times(a.value).times((s=e.goods)!=null&&s.goodsType?e.goods.balanceDiscountRatio:e.goods.discountRatio).div(100).times(.5).toNumber():0});return(s,t)=>{var V,C,I,$,B,F,_,E;const y=v("VanImage"),m=v("VanTag"),g=v("van-button"),f=v("VanField");return d(),i("div",oe,[l("div",{class:"w-[80px] h-[80px] rounded-lg overflow-hidden mr-2 relative",onClick:t[0]||(t[0]=k(b=>u("handleTo",`/goodsDetail?id=${o.goods.id}`),["stop"]))},[o.needMask?(d(),i("div",se,[!+o.goods.stock&&+o.goods.goodsTypes!=2||o.goods.shopStatus==3||o.goods.shopStatus==4||o.goods.shopStatus==0||o.goods.status!=1?(d(),x(L,{key:0,status:o.goods.status,stock:o.goods.stock,shopStatus:o.goods.shopStatus},null,8,["status","stock","shopStatus"])):c("",!0)])):c("",!0),h(y,{src:(((V=o.goods)==null?void 0:V.icons)||((C=o.goods)==null?void 0:C.mainImageUrls)||"").split(",")[0],fit:"cover",class:"object-cover w-full h-full overflow-hidden"},null,8,["src"])]),l("div",te,[l("section",null,[l("div",ae,r(((I=e.goods)==null?void 0:I.goodsName)||(($=e.goods)==null?void 0:$.title)),1),l("div",ne,r(((B=e.goods)==null?void 0:B.goodsDesc)||((F=e.goods)==null?void 0:F.describe)),1),l("div",de,[o.payType!==n(S).STORE_CARD&&n(p)?(d(),x(K,{key:0,type:+n(p)},null,8,["type"])):c("",!0),o.payType!==n(S).STORE_CARD&&n(p)&&n(p)!==n(N).SD?(d(),x(m,{key:1,class:"flex-shrink-0 text-xs",size:"medium",color:"#FFF7D2","text-color":"#AD941A"},{default:z(()=>[A(r(s.$t("cart.Pay with points")),1)]),_:1})):c("",!0),o.goods.goodsType>0&&n(D)>0?(d(),x(m,{key:2,class:"flex-shrink-0 text-xs",size:"medium",color:"#FFF7EC","text-color":"#FEA021"},{default:z(()=>[l("span",null,r(s.$t("voucher.can_use",{amount:n(W)(n(D))})),1)]),_:1})):c("",!0)])]),l("section",null,[n(P)?(d(),i("div",le,r(e.goods.stock<=0?s.$t("order.zero inventory"):s.$t("order.Tight inventory")),1)):c("",!0)]),l("section",re,[o.payType===n(S).STORE_CARD?(d(),i("div",ie,r((_=e.goods)==null?void 0:_.cardPrice)+r(o.card&&o.card.symbol),1)):(d(),i("div",ce,[ue,A(" "+r((E=e.goods)==null?void 0:E.price),1)])),e.isDisabledEdit?(d(),i("div",ge,"x"+r(e.number),1)):(d(),i("div",{key:2,class:"ml-auto flex items-center justify-end gap-x-[1px]",onClick:t[4]||(t[4]=k(()=>{},["stop"]))},[h(g,{icon:"minus",size:"mini",type:"primary",class:"num-btn w-8 h-8 border-none aspect-square bg-b5 text-b1 rounded-l",disabled:+e.number==1,onClick:t[1]||(t[1]=k(b=>u("changeNumber",+e.number-1),["stop"]))},null,8,["disabled"]),l("div",me,[h(f,{class:"text-center input-box",type:"digit",min:"1",modelValue:a.value,"onUpdate:modelValue":[t[2]||(t[2]=b=>a.value=b),j],onBlur:M},null,8,["modelValue"])]),h(g,{icon:"plus",size:"mini",type:"primary",class:"w-8 h-8 border-none aspect-square bg-b5 text-b1 rounded-r",disabled:a.value>=T,onClick:t[3]||(t[3]=k(b=>u("changeNumber",+e.number+1),["stop"]))},null,8,["disabled"])]))])])])}}}),Te=U(pe,[["__scopeId","data-v-238a21f4"]]);export{Te as O};
