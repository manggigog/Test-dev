import{z as x,r as t,o as C,E as k,G as _,H as v,P as y,I as F,Q as T,$ as V,F as B,q,J as z,K as E,Z as N,V as P}from"./vendor-Dr_RpJ_Y.js";import{_ as R}from"./GoodsEvaluateItem-aGarH2zl.js";import{_ as S}from"./EvalHeader-BnKRlnel.js";import{aO as D}from"./index-CU2nzZe6.js";import"./BackIcon-CDrGaEPo.js";const M={class:"px-2.5 font-normal"},O={class:"bg-white rounded-xl p-2.5 min-h-[calc(100%-44px)]"},G={class:"mb-2 pb-2 border-b border-solid border-[#F6F6F5]"},j=x({setup(H){var h;const r=C(),$=q(),l=t(!1),u=t(!1),s=t([]),c=t(0),b=t(10),d=t(0),p=t((h=r.query)==null?void 0:h.commentLevel),w=async()=>{var i,m;const e={page:c.value,size:b.value,goodsId:f.value||null,shopId:g.value||null,commentStatus:1,commentType:null,sortBy:"desc|comment_time",havePicsFlag:null,haveContentFlag:null,havePicOrTextFlag:!1};p.value==2&&(e.commentType=2),p.value==3&&(e.commentType=1);const o=await D(e);if(!o.success){u.value=!0;return}const n=((i=o.data)==null?void 0:i.records)||[],a=((m=o.data)==null?void 0:m.total)||0;if(!n||!a){u.value=!0;return}d.value=a,s.value=c.value===1?n:s.value.concat(n),s.value.length>=d.value&&(u.value=!0)},I=async()=>{l.value=!0,c.value+=1,await w(),setTimeout(()=>{l.value=!1},1e3)},L=e=>{$.push(e)},f=t(null),g=t(null);return k(()=>{f.value=r.query.goodsId,g.value=r.query.shopId}),(e,o)=>{const n=B("VanList");return v(),_("div",M,[y(S,{title:e.$t("evaluate.Folded Reviews")},null,8,["title"]),F("div",O,[F("div",G,T(e.$t("evaluate.reviews without content",{num:d.value||"-"})),1),y(n,{class:"mt-4",loading:l.value,"onUpdate:loading":o[0]||(o[0]=a=>l.value=a),finished:u.value,"finished-text":e.$t("common.noMore"),"loading-text":e.$t("common.loading"),onLoad:I},{default:V(()=>[(v(!0),_(z,null,E(s.value,(a,i)=>(v(),N(R,{style:P(i===s.value.length-1?"margin-bottom: 0.5rem":""),onClick:m=>L(`/offlineEvaluateView?id=${a.orderId}`),data:a,key:a.id},null,8,["style","onClick","data"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])])])}}});export{j as default};
