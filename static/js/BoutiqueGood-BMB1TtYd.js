import{_ as U,z as G,G as C,H as l,I as o,N as d,Q as f,x as W,q as X,o as Y,r as a,y as D,D as ee,E as te,F as E,Z as B,U as q,P as S,$ as L,O as oe,J as ae,K as se,T as P}from"./vendor-Dr_RpJ_Y.js";import{B as ne}from"./BoutiqueGoodItemv2-Bkb-DIU8.js";import{B as re}from"./BackIcon-CDrGaEPo.js";import{ar as le,a0 as ue,w as ie,as as de,av as ce}from"./index-7OiUoGXy.js";import{M as pe}from"./MallTabBar-CQAItyY3.js";import{c as ve}from"./mall-BRPa8DWq.js";import{_ as fe}from"./DefaultPage-BbbCICPU.js";import{_ as me}from"./ServiceIcon-CvkX1nAR.js";import"./RatioBox-C8BvsGJW.js";import"./GoodsPrice-Dz5PcG19.js";import"./MCOIN-Bodfn-v1.js";import"./ShopMaskTips-ClYuWX9C.js";import"./goods-BVwS8oFG.js";import"./convertToImage-BdAJcJnz.js";import"./upload-C8f1eCjL.js";import"./active_empty-OYjsVrLW.js";import"./HelpPop-CAuHPFSL.js";const ye={class:"bg-origin5 w-full"},he={class:"bg-white rounded-t-[12px] flex items-center gap-3 text-sm text-gray-500 p-2.5 overflow-x-auto"},ge={class:"flex flex-col justify-between ml-1 h-3"},be=G({props:{orderBy:null},emits:["change"],setup(n,{emit:r}){const m=n,c=()=>{m.orderBy!==4&&m.orderBy!==5||m.orderBy===4?r("change",5):r("change",4)};return(p,t)=>(l(),C("div",ye,[o("div",he,[o("div",{class:d(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":n.orderBy===1}]]),onClick:t[0]||(t[0]=v=>r("change",1))},f(p.$t("goods.comprehensive")),3),o("div",{class:d(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":n.orderBy===2}]]),onClick:t[1]||(t[1]=v=>r("change",2))},f(p.$t("mall.saleNum")),3),o("div",{class:d(["min-w-1/4 flex items-center justify-center rounded-[6px] bg-[#F4F4F4] whitespace-nowrap",["px-4 py-1 cursor-pointer",{"text-black font-medium":n.orderBy===3}]]),onClick:t[2]||(t[2]=v=>r("change",3))},f(p.$t("flashSale.newGood")),3),o("div",{class:d(["min-w-1/4 flex items-center justify-center rounded-[6px] px-4 py-1 bg-[#F4F4F4] whitespace-nowrap",{"text-black font-medium":n.orderBy===4||n.orderBy===5}]),onClick:c},[o("span",null,f(p.$t("goods.price")),1),o("div",ge,[o("div",{class:d(["w-0 h-0 border-x-[4px] border-x-transparent border-b-[4px]",n.orderBy===5?"border-b-black":"border-b-gray-400"])},null,2),o("div",{class:d(["w-0 h-0 border-x-[4px] border-x-transparent border-t-[4px]",n.orderBy===4?"border-t-black":"border-t-gray-400"])},null,2)])],2)])]))}}),xe=U(be,[["__scopeId","data-v-3e699e18"]]),we={class:"sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50 bg-origin5"},ke={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},Be={key:0,class:"font-semibold"},_e={class:"absolute right-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},$e={class:"overflow-hidden"},Ie={class:"mall-header-bg mall-header-bg-box"},Ce={class:"bg-white h-full"},Te=G({name:"BoutiqueGood"});function Fe(n){var A,H;const{t:r}=W(),m=X(),c=Y(),p=le(),t=a(null),v=a(null);t.value=((A=c.query)==null?void 0:A.shopId)||null,v.value=((H=c.query)==null?void 0:H.shopId)||null;const J=D(()=>!!t.value);ee(()=>{var e;return(e=c.query)==null?void 0:e.shopId},e=>{c.path==="/boutique-goods"&&(t.value=e||null,v.value!==t.value&&(v.value=t.value,s.value=null,t.value||T(),N()))},{deep:!0});const s=a(null),N=async()=>{if(!t.value)return;const e=await ue(t.value);!e.success||!e.data||(s.value=e.data,T())},y=a(1),K=e=>{y.value!==e&&(y.value=e,T())},h=a([]),g=a(!1),b=a(!1),x=a(0),j=a(10),_=a(0),u=a([]),O=D(()=>{let e={sortType:3,orderBy:1};switch(y.value){case 1:break;case 2:e.sortType=1;break;case 3:e.sortType=4;break;case 4:e.sortType=2;break;case 5:e.sortType=2,e.orderBy=2;break}return e}),Q=async()=>{var i,$;let e={};if(t.value?e=await ve({page:x.value,size:j.value,status:1,merchant:(i=s.value)==null?void 0:i.merchant,type:s.value.type,...O.value,deleteFlag:!1}):e=await ce({page:x.value,size:j.value,status:1,sortType:y.value,merchantAddress:($=s.value)==null?void 0:$.merchant}),!e.success||!e.data||!+e.total){b.value=!0,g.value=!1;return}_.value=e.total,u.value=e.data,t.value&&(u.value=u.value.map(I=>{var w;return{...I.goods,storeName:(w=I.stores)==null?void 0:w.storeName}})),h.value=x.value===1?u.value.length>0?u.value:[]:h.value.concat(u.value),h.value.length>=_.value&&(b.value=!0)},z=async()=>{!s.value&&t.value||(g.value=!0,x.value+=1,await Q(),setTimeout(()=>{g.value=!1},1e3))},{loadingToggle:V}=ie(),Z=async e=>{if(e.stock===0&&e.goodsTypes!=2){P(r("order.Insufficient stock"));return}V(!0);const i=await de(e.id);V(!1),i.success&&(P(r("cart.addTips")),p.getCartCount())},T=()=>{u.value=[],h.value=[],x.value=0,_.value=0,b.value=!1,z()},F=e=>{m.push(e)};return te(async()=>{await N()}),(e,i)=>{var w,M,R;const $=E("van-sticky"),I=E("VanList");return l(),C("div",{class:d([{"safe-bottom-page":t.value},"overflow-y-auto bg-white"])},[o("section",we,[o("div",ke,[S(re,null,{default:L(()=>[o("span",null,f(e.$t("common.return")),1)]),_:1})]),(w=s.value)!=null&&w.type?(l(),C("div",Be,f(e.$t("mall.Fine goods",{type:e.$t(`common.shop_type_${(M=s.value)==null?void 0:M.type}`)})),1)):q("",!0),o("div",_e,[oe(J)?(l(),B(me,{key:0,shop:s.value,showInfo:"",onHandleTo:F},null,8,["shop"])):q("",!0)])]),o("div",$e,[S($,{"offset-top":44},{default:L(()=>[o("div",Ie,[S(xe,{orderBy:y.value,onChange:K},null,8,["orderBy"])])]),_:1}),o("div",Ce,[b.value&&_.value===0?(l(),B(fe,{key:0,title:e.$t("common.No products")},null,8,["title"])):(l(),B(I,{key:1,class:"pt-2 pb-5 px-2.5",loading:g.value,"onUpdate:loading":i[0]||(i[0]=k=>g.value=k),finished:b.value,"finished-text":e.$t("common.noMore"),"loading-text":e.$t("common.loading"),onLoad:z},{default:L(()=>[(l(!0),C(ae,null,se(h.value,k=>(l(),B(ne,{key:k.id,data:k,onClick:Se=>F(`/goodsDetail?id=${k.id}`),onHandleAddCart:Z,onHandleTo:F},null,8,["data","onClick"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"]))])]),t.value?(l(),B(pe,{key:0,shopId:t.value,shopType:(R=s.value)==null?void 0:R.type},null,8,["shopId","shopType"])):q("",!0)],2)}}const qe=G({...Te,setup:Fe}),Qe=U(qe,[["__scopeId","data-v-28766b7a"]]);export{Qe as default};
