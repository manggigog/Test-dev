import{_ as K,y as U,E as g,K as R,G as a,N as $,H as t,O as v,F as d,a2 as C,a3 as E,Q as u,a4 as V,a0 as S,X as Q,$ as W,r as w,bc as j,D as M,P as m,I as H,J as D,Y as F,Z as G,l as X,a1 as Y,bv as Z,bd as ee,z as se,ba as te,bb as oe}from"./vendor-D6JO6WHW.js";import{e as J,f as ae,s as le}from"./mall-DnMZRkyz.js";import{R as ne}from"./Recommends-qN18G-rV.js";import{B as re}from"./BackIcon-CPUEW9je.js";import"./index-CybuWkSo.js";import"./GoodsList-B7XSsxhX.js";import"./buy-cart-DX6aL7m1.js";import"./goods-BVwS8oFG.js";import"./ShopMaskTips-wgA1ZEjb.js";import"./shop-CeqcS6K2.js";import"./GoodsPrice-DAKFfGMp.js";import"./MCOIN-BOqZVkND.js";import"./cart-o5WHmNSV.js";import"./ImgBoutiqueLable-Dod52ZXF.js";import"./RatioBox-C9aLwz0w.js";import"./rangking-DQObfTIy.js";import"./useOrderStatus-DeHjEZ0k.js";const ce="/static/images/delete-EDwJAk4o.svg",ie={class:"box-shadow w-full pb-1.5 py-2 bg-white rounded-[10px] overflow-hidden"},de={class:"flex justify-between items-center pb-2.5 px-3.5"},ue={class:"flex items-center text-sm"},me={key:0},pe={class:"border-solid border-b px-2.5 border-black-100 mt-1.5 text-lg font-semibold text-black text-center pb-8"},he={class:"flex pt-5 pb-3.5 justify-around"},fe=U({props:{show:{type:Boolean},name:null,width:null,loading:{type:Boolean}},emits:["close","comfirm"],setup(l,{emit:f}){const p=()=>{f("comfirm")};return(n,r)=>{const _=g("van-icon"),e=g("van-button"),x=g("VanPopup");return a(),R(x,{show:l.show,"onUpdate:show":r[2]||(r[2]=b=>W(show)?show.value=b:null),style:Q([{width:l.width||"90%"},{background:"transparent","min-width":"280px","max-width":"335px"}]),"close-on-click-overlay":!0,onClickOverlay:r[3]||(r[3]=V(()=>f("close"),["stop"]))},{default:$(()=>[t("div",ie,[t("div",de,[t("div",ue,[l.name?(a(),d("span",me,u(l.name),1)):C("",!0),E(n.$slots,"header",{},void 0,!0)]),v(_,{class:"text-xl text-black",name:"cross",onClick:r[0]||(r[0]=V(()=>f("close"),["stop"]))})]),t("div",pe,[S(u(n.$t("mall.deletehistoryrecords"))+" ",1),E(n.$slots,"default",{},void 0,!0)]),t("div",he,[v(e,{round:"",type:"primary",class:"px-8 font-semibold border border-solid fd text-primary-001 border-primary-001",onClick:r[1]||(r[1]=()=>{f("close")})},{default:$(()=>[S(u(n.$t("common.cancel")),1)]),_:1}),v(e,{round:"",class:"px-8 font-semibold text-white bg-gradient",onClick:p,loading:l.loading},{default:$(()=>[S(u(n.$t("common.delete")),1)]),_:1},8,["loading"])])])]),_:3},8,["show","style"])}}}),ve=K(fe,[["__scopeId","data-v-1ed4ca51"]]),ye=l=>(F("data-v-318e4798"),l=l(),G(),l),we={class:"mt-4 bg-white rounded-t-xl py-3 px-3.5 pb-10 search-recods min-h-[60vh]"},ke={key:0,class:"mb-5"},_e={class:"flex items-center justify-between text-xs font-semibold mb-2.5 text-black-800"},xe=ye(()=>t("img",{class:"w-4 h-auto",src:ce},null,-1)),be=[xe],ge={class:"flex flex-wrap gap-2.5"},$e=["onClick"],Ce=["src"],Se={class:"flex items-center justify-between text-xs font-semibold mb-2.5 text-black-800"},Ie={class:"flex flex-wrap gap-2.5"},Pe=["onClick"],Le=["src"],Re=U({emits:["setKeyword"],setup(l,{emit:f}){const p=w([]),n=async()=>{const c=await J({page:1,size:50,type:1});c.success&&(p.value=c.data||[])},r=w([]),_=async()=>{const c=await ae({page:1,size:50});c.success&&(r.value=c.data||[])},[e,x]=j(!1),b=async()=>{x(!0),(await le()).success&&(x(!1),_(),I(!1))},[h,I]=j(!1),L=c=>{f("setKeyword",c)};return M(()=>{n(),_()}),(c,i)=>(a(),d("div",we,[r.value&&r.value.length>0?(a(),d("section",ke,[t("div",_e,[t("span",null,u(c.$t("mall.search history")),1),t("div",{onClick:i[0]||(i[0]=o=>m(I)(!0))},be)]),t("div",ge,[(a(!0),d(H,null,D(r.value,o=>(a(),d("div",{key:o.keyword,onClick:y=>L(o.keyword),class:"px-4 py-0.5 text-xs line-clamp-1 max-w-full leading-normal rounded-xl bg-black-100 text-black-400"},[o.iconUrl?(a(),d("img",{key:0,class:"inline-block w-auto h-4 align-middle",src:o.iconUrl},null,8,Ce)):C("",!0),S(" "+u(o.keyword),1)],8,$e))),128))])])):C("",!0),t("section",null,[t("div",Se,[t("span",null,u(c.$t("mall.popular searches")),1)]),t("div",Ie,[(a(!0),d(H,null,D(p.value,o=>(a(),d("div",{key:o.id,onClick:y=>L(o.keyword),class:"px-4 py-0.5 text-xs line-clamp-1 max-w-full leading-normal rounded-xl bg-black-100 text-black-400"},[o.iconUrl?(a(),d("img",{key:0,class:"inline-block w-auto h-4 align-middle",src:o.iconUrl},null,8,Le)):C("",!0),S(" "+u(o.keyword),1)],8,Pe))),128))])]),v(ve,{loading:m(e),show:m(h),onClose:i[1]||(i[1]=o=>m(I)(!1)),onComfirm:b},null,8,["loading","show"])]))}}),Ue=K(Re,[["__scopeId","data-v-318e4798"]]),qe=l=>(F("data-v-11d64116"),l=l(),G(),l),ze={style:{"background-color":"white"},class:"relative z-50 h-full min-h-screen overflow-y-hidden parent-view mall-header-bg"},Ne={class:"sticky top-0 z-50 text-sm font-normal mall-header-bg"},Be={class:"flex relative justify-center items-center h-[44px] px-2.5"},Ke={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},Ee={class:"font-semibold"},Ve={class:"px-2.5"},je={key:0,class:"bg-gradient-7 text-white px-2.5 py-0.5 text-xxs leading-normal rounded-xl"},He=qe(()=>t("div",{class:"h-[16px]"},null,-1)),De=U({name:"Search"});function Me(l){const f=X(),p=Y(),n=w(null),r=Z(ne),_=()=>{h.value=!1},e=ee({keyword:"",classId:null});se(()=>e.keyword,()=>{e.keyword.length<=0&&(h.value=!1)});const x=()=>{e.classId=null,i.value=null,f.replace({path:"/search",query:{classId:null,className:null}}),n.value.setParam(e)},b=w(null),h=w(!1),I=s=>{console.log(s.charCode,"value"),(s.code==="Enter"||+s.charCode==13)&&(e.keyword&&q(e.keyword)&&z(y.value[e.keyword]),h.value=!0,n.value.setParam(e),b.value.blur())},L=()=>{var s;((s=e.keyword)==null?void 0:s.length)<=0||(q(e.keyword)&&z(y.value[e.keyword]),h.value=!0,n.value.setParam(e))},c=s=>{if(q(s)){z(y.value[s]);return}e.keyword=s,h.value=!0,n.value.setParam(e)},i=w(),o=w([]),y=w({}),O=async()=>{const s=await J({page:1,size:99,type:100});if(s.success){o.value=s.data||[];for(const P of o.value)y.value[P.keyword]=P}},q=s=>y.value[s]&&y.value[s].targetUrl,z=s=>{s.targetUrl&&s.targetUrl.startsWith("http")?window.open(s.targetUrl,"_self"):s.targetUrl?f.push(s.linkUrl):n.value.setParam(e)};return M(()=>{e.classId=p.query.classId||null,e.keyword=p.query.keyword||"",p.query.className==="refresh"?(i.value=null,e.keyword=""):(i.value=p.query.className||null,e.keyword=p.query.keyword||""),(e.classId||e.keyword)&&(h.value=!0,n.value.setParam(e)),O()}),(s,P)=>{const N=g("van-icon"),T=g("van-field"),A=g("router-view");return a(),d("div",ze,[t("section",Ne,[t("section",Be,[t("div",Ke,[v(re,null,{default:$(()=>[t("span",null,u(s.$t("common.return")),1)]),_:1})]),t("div",Ee,u(s.$t("common.search")),1)]),t("section",Ve,[v(T,{ref:(k,B)=>{B.searchRef=k,b.value=k},"model-value":m(e).keyword,"onUpdate:model-value":P[0]||(P[0]=k=>m(e).keyword=k),clearable:"",class:"flex-1 rounded-3xl flex items-center h-[30px] text-black-300",onKeypress:I,placeholder:i.value?"":s.$t("mall.Enter search keywords"),onClear:_,enterkeyhint:"search"},{"left-icon":$(()=>[i.value?(a(),d("view",{key:0,onClick:x,class:"flex items-center border border-solid rounded-xl px-2 py-0.5 text-xs text-primary"},[S(u(i.value)+" ",1),v(N,{class:"ml-0.5",name:"cross",size:"10"})])):m(e).keyword?C("",!0):(a(),R(N,{key:1,name:"search",size:"18"}))]),"right-icon":$(()=>[t("div",{onClick:L},[m(e).keyword?(a(),R(N,{key:1,name:"search",size:"18"})):(a(),d("div",je,u(s.$t("common.search")),1))])]),_:1},8,["model-value","placeholder"])]),He]),t("section",null,[(!m(e).keyword||!h.value)&&!i.value?(a(),R(Ue,{key:0,onSetKeyword:c})):C("",!0),te(v(m(r),{isSearchPage:!0,class:"bg-[#f8f8f8]",ref:(k,B)=>{B.listRef=k,n.value=k},mode:"div"},null,512),[[oe,m(e).keyword&&h.value||i.value]])]),v(A,{class:"child-view"})])}}const Fe=U({...De,setup:Me}),rs=K(Fe,[["__scopeId","data-v-11d64116"]]);export{rs as default};
