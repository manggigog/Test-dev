import{_ as z}from"./member-BZWba7V1.js";import{_ as U,z as $,x as j,a2 as J,r as p,bl as O,E as P,F as c,G as g,H as m,I as s,U as Q,P as d,Q as i,O as e,Z as G,$ as H,a4 as X,N as Y,X as Z,Y as K,T as I}from"./vendor-Dr_RpJ_Y.js";import{B as W}from"./BackIcon-CDrGaEPo.js";import{a as tt,e as h,k as st,$ as ot,c as nt,bB as et}from"./index-BckdT6oc.js";import{u as at}from"./useCreditsNew-BPIiBA55.js";import{d as it,e as lt,q as rt}from"./beiRanking-CgdREoPr.js";import{b as ct}from"./beiConstContract-CxYXBNkI.js";const V=u=>(Z("data-v-507d91f5"),u=u(),K(),u),dt={class:"bg-[#F2F0EF] p-2.5"},ut={class:"flex-start mb-2.5"},pt={key:0,class:"mb-2.5 px-2.5 py-2 flex border border-solid border-[#ea3323] rounded-xl bg-white text-[#ea3323]"},mt=V(()=>s("div",{class:"ml-1.5 text-sm"},[s("span",{class:"mr-2"},"当前状态："),s("span",null,"退榜")],-1)),_t={class:"pt-6 bg-white rounded-lg"},ft={class:"px-3.5"},gt={class:"flex items-center"},ht={class:"mb-2.5 font-normal opacity-60 text-sm"},vt={class:"bg-[#F3F3F3] rounded-lg font-normal mb-3.5 px-[15px] py-[8px] min-h-8"},bt={class:"mb-2.5 font-normal opacity-60 text-sm"},yt={class:"text-sm font-normal border-t border-solid border-[#F3F3F3] px-3.5 pb-3.5"},kt={class:"flex-center-bw pt-3.5"},xt={class:"font-normal opacity-60"},wt={class:"w-[40px] border-[1px] border-solid border-white flex-center bg-[#FED73A] rounded-3xl"},Ft=V(()=>s("img",{src:z,class:"w-3 h-3"},null,-1)),It={class:"flex-center-bw pt-3.5"},$t={class:"font-normal opacity-60"},Vt={key:1},Bt={class:"flex-center-bw pt-3.5"},Ct={class:"font-normal opacity-60"},Dt={class:"flex-center-bw pt-3.5"},St={class:"font-normal opacity-60"},Lt=$({name:"JoinBeiRanking"});function Nt(u){const{t:v}=j(),{memberLevels:B}=nt(),{contributesStore:_}=tt(),[C,b]=J(!1),{allQuota:D}=at(),{userTotalLp:S}=ct(),y=p(null),L=async()=>{const{success:n,data:a}=await ot();n&&(a!=null&&a.id&&(y.value=a),o.nickname=a==null?void 0:a.storeName,q(a==null?void 0:a.id))},k=p(0),N=async()=>{k.value=await B()},x=p(0),R=async()=>{x.value=+await S()},o=O({nickname:"",introduction:"",status:null,denialReason:""}),l=p(null),q=async n=>{const{success:a,data:t}=await rt({shoId:n,month:et()});if(!(!a||!t)){if(t!=null&&t.status&&(t==null?void 0:t.status)===0){const r=document.getElementsByClassName("van-field__control");Object.values(r).forEach(f=>{f.setAttribute("class","myInput")})}l.value=t,t!=null&&t.introduction&&(o.introduction=t==null?void 0:t.introduction),t!=null&&t.status&&(o.status=t==null?void 0:t.status),t!=null&&t.denialReason&&(o.denialReason=t==null?void 0:t.denialReason)}},A=async()=>{var a,t,r;if(l.value&&((a=l.value)!=null&&a.id)&&l.value.status===0)return;if(o.introduction===((t=l.value)==null?void 0:t.introduction)&&o.status===1)return I(v("ranking.edit-tip"));b(!0);const{success:n}=((r=l.value)==null?void 0:r.status)===1?await it({introduction:o.introduction}):await lt({introduction:o.introduction});b(!1),n&&(w(),I({icon:st("images/sucess_icon.png"),duration:3e3,message:v("shop.shippingTemplate.submitSuccess")}))},w=async()=>{await L(),N(),R(),_.fetchContributes()};return P(()=>{w()}),(n,a)=>{var F;const t=c("van-icon"),r=c("VanImage"),f=c("VanField"),T=c("van-loading"),E=c("VanButton");return m(),g("div",dt,[s("div",ut,[d(W),s("div",null,i(n.$t("ranking.join shop ranking")),1)]),e(o).status==2?(m(),g("div",pt,[d(t,{name:"warning",color:"red",size:"1.125rem"}),mt])):Q("",!0),s("div",_t,[s("div",ft,[s("div",gt,[d(r,{src:(((F=y.value)==null?void 0:F.logo)||"").split(",")[0],class:"mb-5 w-[90px] h-[90px] mx-auto rounded-full border border-solid border-[#e5e7e] overflow-hidden",fit:"cover"},null,8,["src"])]),s("div",ht,i(n.$t("ranking.shop name")),1),s("div",vt,i(e(o).nickname),1),s("div",bt,i(n.$t("ranking.shop introduction")),1),d(f,{disabled:e(o).status&&e(o).status==0,modelValue:e(o).introduction,"onUpdate:modelValue":a[0]||(a[0]=M=>e(o).introduction=M),maxlength:"240",type:"textarea",row:3,class:"bg-[#F3F3F3] rounded-lg font-normal mb-3.5",placeholder:n.$t("shop.pleaseInput")+n.$t("ranking.shop introduction")},null,8,["disabled","modelValue","placeholder"])]),s("div",yt,[s("div",kt,[s("div",xt,i(n.$t("ranking.current level")),1),s("div",wt,[Ft,s("span",null,"V"+i(k.value),1)])]),s("div",It,[s("div",$t,i(n.$t("ranking.Number of points")),1),e(_).loading?(m(),G(T,{key:0,size:"14"})):(m(),g("div",Vt,i(e(h)(e(_).contributes,2)),1))]),s("div",Bt,[s("div",Ct,i(n.$t("ranking.Deposit MAI quantity")),1),s("div",null,i(e(h)(e(D))),1)]),s("div",Dt,[s("div",St,i(n.$t("ranking.Deposit LP quantity")),1),s("div",null,i(e(h)(x.value)),1)])])]),d(E,{loading:e(C),disabled:!e(o).nickname||!e(o).introduction,onClick:A,class:Y(["w-[150px] h-[40px] text-white rounded-3xl flex-center m-auto mt-[50px]",e(o).status==0?"bg-[#D9D9D9]":"btn-orange"])},{default:H(()=>[X(i(e(o).status==0?n.$t("ranking.apply await"):e(o).status==1?n.$t("common.edit"):e(o).status==2?n.$t("ranking.Re-apply"):n.$t("common.confirm")),1)]),_:1},8,["loading","disabled","class"])])}}const Rt=$({...Lt,setup:Nt}),jt=U(Rt,[["__scopeId","data-v-507d91f5"]]);export{jt as default};
