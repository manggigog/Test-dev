import{_ as z,y as L,w as N,l as P,a1 as V,r as o,a7 as E,bh as H,E as R,F as C,G as p,H as s,O as D,N as B,Q as $,K as y,I as F,J as j,P as b,T as A}from"./vendor-BUT0HZ5j.js";import{B as J}from"./BoutiqueGoodItemv2-ur8yUAX4.js";import{B as K}from"./BackIcon-biFt6cm7.js";import{r as M,a6 as O}from"./index-k1FFr-1T.js";import{q as Q}from"./cart-D1U0eSk3.js";import{_ as U}from"./DefaultPage-0Skrrm1V.js";import"./RatioBox-ys008e7W.js";import"./GoodsPrice-Ai76_1qQ.js";import"./MCOIN-BcbOHmhy.js";import"./ShopMaskTips-dKZ6_BUi.js";import"./goods-BVwS8oFG.js";const W={class:"overflow-y-auto"},X={class:"header-bar sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50"},Y={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},Z={class:"font-semibold"},tt={class:"bg-white h-full"},et=L({name:"ActivityGood"});function ot(st){var w;const{t:h}=N(),g=P(),n=V(),l=o(1);l.value=+((w=n.query)==null?void 0:w.type)||1;const i=o([]),u=o(!1),r=o(!1),c=o(0),_=o(10),v=o(0),d=o([]),f=o(0),q=E.throttle(()=>{const t=document.querySelector(".list-content");t&&(f.value=t.scrollTop)},200),I=()=>{const t=document.querySelector(".list-content");t&&(t.scrollTop=f.value)};H(()=>{var t,e;l.value!=+((t=n.query)==null?void 0:t.type)&&(l.value=+((e=n.query)==null?void 0:e.type)||1,c.value=0,i.value=[],r.value=!1,v.value=0,d.value=[],f.value=0),T(),I()});const S=async()=>{let t={};+l.value==1?t={page:c.value,size:_.value,status:1,sortType:3,boutiqueTop:!0,isActivity:99}:t={page:c.value,size:_.value,isActivity:1,boutiqueTop:!0};const e=await O(t);if(!e.success||!e.data||!+e.total){r.value=!0,u.value=!1;return}v.value=e.total,d.value=e.data,i.value=c.value===1?d.value.length>0?d.value:[]:i.value.concat(d.value),i.value.length>=v.value&&(r.value=!0)},T=async()=>{u.value=!0,c.value+=1,await S(),setTimeout(()=>{u.value=!1},1e3)},{loadingToggle:k}=M(),G=async t=>{if(t.stock===0&&t.goodsTypes!=2){A(h("order.Insufficient stock"));return}const e={needlogin:"true",...n.query};g.replace({path:n.path,query:e}),k(!0);const m=await Q(t.id);k(!1),m.success&&A(h("cart.addTips"))},x=t=>{g.push(t)};return(t,e)=>{const m=R("VanList");return p(),C("div",W,[s("section",X,[s("div",Y,[D(K,null,{default:B(()=>[s("span",null,$(t.$t("common.return")),1)]),_:1})]),s("div",Z,$(l.value===1?t.$t("activity.new"):t.$t("active.active")),1)]),s("div",{class:"list-content h-[calc(100vh-44px)] sticky top-[44px] overflow-auto rounded-t-[12px] bg-white",onScroll:e[1]||(e[1]=(...a)=>b(q)&&b(q)(...a))},[s("div",tt,[r.value&&v.value===0?(p(),y(U,{key:0,title:t.$t("common.No products")},null,8,["title"])):(p(),y(m,{key:1,class:"py-5 px-2.5 pt-2",loading:u.value,"onUpdate:loading":e[0]||(e[0]=a=>u.value=a),finished:r.value,"finished-text":t.$t("common.noMore"),"loading-text":t.$t("common.loading"),onLoad:T},{default:B(()=>[(p(!0),C(F,null,j(i.value,a=>(p(),y(J,{key:a.id,data:a,onClick:nt=>x(`/goodsDetail?id=${a.id}`),onHandleAddCart:G,onHandleTo:x},null,8,["data","onClick"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"]))])],32)])}}const at=L({...et,setup:ot}),ht=z(at,[["__scopeId","data-v-438f6566"]]);export{ht as default};
