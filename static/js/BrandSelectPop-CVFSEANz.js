import{_ as te,z as Q,x as X,a2 as Z,r as V,E as W,F as u,Z as P,H as h,$ as d,I as o,Q as i,P as m,U as I,a3 as T,bK as se,O as c,bJ as oe,a4 as O,T as D,by as ae,X as ne,Y as le,bl as q,D as re,G as N,bv as de,K as ie,N as ce,J as ue,n as pe}from"./vendor-Dr_RpJ_Y.js";import{_ as me}from"./search-B34EARrH.js";import{_ as ge}from"./checked-CkJ-Z4or.js";import{Y as J,ax as fe,ay as ve,a7 as xe,g as he,b1 as be,b2 as j}from"./index-CU2nzZe6.js";import{i as _e}from"./offlineGoods-DvT2Go6q.js";import{u as ye}from"./upload-GBdaxjFw.js";const we="/static/images/deleteImg-D8x_oyov.svg",Be=b=>(ne("data-v-18d94f07"),b=b(),le(),b),ke={class:"w-full p-4 bg-b6 rounded-[10px] overflow-hidden font-Puhui"},$e={class:"text-center felx-1 relative mx-1"},Ve={class:"text-base font-bold"},Ie={class:"title"},Ce={class:"border-b4 border-b border-solid"},Se={class:"text-sm text-[#2E2008] font-semibold"},Ne={class:"flex justify-between items-center py-4 border-b4 border-b border-solid"},Pe={class:"text-sm text-[#2E2008] font-semibold"},Le={class:"van-uploader__wrapper gap-3"},Ae=["onClick"],Fe={class:"van-image van-uploader__preview-image",style:{width:"60px",height:"60px","border-radius":"6px"}},ze=["onClick"],Oe=Be(()=>o("img",{class:"w-[15px] h-[15px]",src:we,alt:""},null,-1)),De=[Oe],Te={class:"w-[60px] h-[60px] bg-b5 rounded-xl text-center flex flex-col justify-center items-center text-[#d9d9d9]"},Ue=["src"],Ee={class:"text-xs font-light text-center text-b1 opacity-30"},Ke={class:"py-4"},Ge={class:"text-sm text-[#2E2008] font-semibold"},He={class:"flex items-center gap-x-3"},Re=Q({emits:["close","success"],setup(b,{emit:_}){const{t:g}=X(),[L,A]=Z(!1),C=V(!0),x=V({storeBrandName:null,storeBrandIcon:null,storeBrandDesc:null}),t=V([]),f=V(1),v=async a=>{if(t.value.length>=f.value)return;const n=fe(a.file);if(!n.valid)return B(n.tips);const p=ve(a.file);if(!p.valid)return B(p.tips);D.loading({message:g("common.uploading"),forbidClick:!0,duration:0});const k=await xe(a,"goodsDesc"),$=await ye(k);if(D.clear(),!$.success)return B(g("comomn.Image upload failed"));t.value.push({id:K(),url:he.imgUrl+$.data})},U=a=>{t.value.splice(a,1)},E=a=>{ae({images:t.value.map(n=>n.url),startPosition:a})},K=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var n=Math.random()*16|0,p=a==="x"?n:n&3|8;return p.toString(16)}),B=(a="",n="toast-warn.svg")=>{D({message:a,icon:J(n),duration:2e3,overlay:!0,overlayClass:"toastOverlay",className:"toastCard",type:"html"})},G=async()=>{if(!x.value.storeBrandName)return B(g("city.Please enter the brand name"));if(!t.value.length)return B(g("city.Please upload your brand main image"));A(!0);const a=t.value.map(k=>k.url);x.value.storeBrandIcon=a.join(",");const{success:n,data:p}=await be(x.value);A(!1),n&&(B(g("common.add success"),"toast-success.svg"),setTimeout(()=>{_("success",{...x.value,id:null})},2e3))};return W(()=>{}),(a,n)=>{const p=u("van-field"),k=u("VanImage"),$=u("van-uploader"),H=u("VanButton"),R=u("VanPopup");return h(),P(R,{teleport:"body",show:C.value,position:"bottom",round:"","close-on-click-overlay":!1,onClickOverlay:n[3]||(n[3]=e=>a.$emit("close")),"overlay-class":"categoryOverlay",class:"sm:w-[375px] sm:left-[50%] sm:translate-x-[-50%]",style:{"min-height":"30%","border-radius":"16px 16px 0 0"}},{default:d(()=>[o("div",ke,[o("header",$e,[o("div",Ve,i(a.$t("city.add brand")),1)]),o("div",Ie,[o("div",Ce,[m(p,{"input-align":"right",maxlength:12,modelValue:x.value.storeBrandName,"onUpdate:modelValue":n[0]||(n[0]=e=>x.value.storeBrandName=e),placeholder:a.$t("city.Please enter the brand name"),class:"no-bt"},{label:d(()=>[o("div",Se,i(a.$t("city.Brand Name")),1)]),_:1},8,["modelValue","placeholder"])]),o("div",Ne,[o("div",Pe,i(a.$t("city.Brand LOGO")),1),o("div",Le,[m(c(oe),se({class:"flex flex-wrap gap-3",modelValue:t.value,"onUpdate:modelValue":n[1]||(n[1]=e=>t.value=e),"item-key":"id"},{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}),{item:d(({element:e,index:s})=>[o("div",{class:"van-uploader__preview",onClick:T(l=>E(s),["stop"])},[o("div",Fe,[m(k,{src:e.url,class:"van-image__img",radius:"6px",fit:"cover"},null,8,["src"])]),o("div",{class:"absolute top-[4.25px] right-[4px] z-[9]",onClick:T(l=>U(s),["stop"]),tabindex:"0"},De,8,ze)],8,Ae)]),_:1},16,["modelValue"]),t.value.length<f.value?(h(),P($,{key:0,accept:c(_e),afterRead:v},{default:d(()=>[o("div",Te,[o("img",{src:c(J)("image-default.svg"),class:"w-6 mx-auto",alt:""},null,8,Ue),o("div",Ee,i(a.$t("common.add img")),1)])]),_:1},8,["accept"])):I("",!0)])]),o("div",Ke,[o("div",Ge,i(a.$t("city.Brand Description")),1),m(p,{modelValue:x.value.storeBrandDesc,"onUpdate:modelValue":n[2]||(n[2]=e=>x.value.storeBrandDesc=e),rows:"2",autosize:"",type:"textarea",placeholder:a.$t("city.Please enter a brand description"),class:"no-bt",style:{"padding-top":"8px !important","padding-bottom":"0 !important"},maxlength:"150","show-word-limit":""},null,8,["modelValue","placeholder"])])]),o("div",He,[m(H,{class:"submit-btn flex-1 bg-yellow text-b1 text-base font-semibold border-none h-[46px]",round:"",onClick:G,loading:c(L)},{default:d(()=>[O(i(a.$t("city.Confirm Add")),1)]),_:1},8,["loading"])])])]),_:1},8,["show"])}}}),Me=te(Re,[["__scopeId","data-v-18d94f07"]]),je={class:"w-full py-4 px-3 safe-bottom bg-b6 rounded-[10px] overflow-hidden font-Puhui"},Je={class:"text-center felx-1 relative mx-1"},Ye=["onClick"],qe={class:"text-base font-bold"},Qe={class:"absolute right-0 top-0 pl-2"},Xe={key:0,class:"flex-1 bg-b5 rounded-3xl mx-1 mt-4 mb-2"},Ze=o("div",null,[o("img",{src:me,class:"w-4 h-4"})],-1),We={class:"flex-1 flex items-center gap-1 text-sm"},et={class:"flex-1"},tt={key:0},st={class:"text-b3 line-clamp-1"},ot={key:0,class:"w-4 h-4",src:ge,alt:""},at={key:1,class:"flex items-center gap-x-3 pt-4"},ut=Q({props:{brand:null,includeAllStoreFlag:{type:Boolean},selectStore:{type:Boolean},level:null},emits:["close","selectBrand","selectStore","selectAllStore","add"],setup(b,{emit:_}){const g=b,{t:L}=X(),[A,C]=Z(!1),x=V(!0),t=q({total:0,loading:!1,finished:!1,list:[],currentBrand:[]}),f=q({page:0,size:100,storeBrandNameLike:void 0,showNotHaveStoresFlag:!0}),v=V([]),U=V(null),E=e=>{v.value=[e.storeBrandId],K()},K=()=>{var s;const e=(s=t.list||[])==null?void 0:s.find(l=>l.storeBrandId===v.value[0]);_("selectBrand",e),g.selectStore||_("close")},B=()=>{if(!v.value.length)return $(L("city.Please select a brand"));_("selectAllStore")},G=()=>{if(!v.value.length)return $(L("city.Please select a brand"));_("selectStore"),_("close")},a=e=>{const s=document.getElementById(e);s&&s.scrollIntoView({behavior:"smooth"})};re(()=>g.brand,async e=>{e!=null&&e.storeBrandId&&(await pe(),a(e==null?void 0:e.storeBrandId))},{immediate:!0,deep:!0});const n=()=>{t.finished=!1,t.list=[],f.page=0,p()},p=async()=>{t.loading=!0,f.page+=1,await k(),t.loading=!1},k=async()=>{const{success:e,data:s}=await j(f);if(!e){t.finished=!0;return}const{records:l,total:y,current:w,pages:S}=s;if(!y||!l||!(l!=null&&l.length)){t.finished=!0;return}if(t.total=y,t.currentBrand.length&&!f.storeBrandNameLike){let F=l.filter(M=>M.storeBrandId!=t.currentBrand[0].storeBrandId);t.list=f.page===1?t.currentBrand.concat(F):t.list.concat(F)}else t.list=f.page===1?l:t.list.concat(l);+w>=+S&&(t.finished=!0)},$=(e="",s="toast-warn.svg")=>{D({message:e,icon:J(s),duration:2e3,overlay:!0,overlayClass:"toastOverlay",className:"toastCard",type:"html"})},H=()=>{C(!0)},R=async e=>{t.loading=!0;const s=await j({page:1,size:1,storeBrandNameLike:e==null?void 0:e.storeBrandName,showNotHaveStoresFlag:!0});if(s.success){const{records:l,total:y}=s.data;y&&l&&(l!=null&&l.length)&&(t.currentBrand=l)}n(),C(!1),_("add",e)};return W(async()=>{var e,s,l;if((e=g.brand)!=null&&e.storeBrandId){v.value=[(s=g.brand)==null?void 0:s.storeBrandId],t.loading=!0;const y=await j({page:1,size:1,storeBrandNameLike:(l=g.brand)==null?void 0:l.storeBrandName,showNotHaveStoresFlag:!0});if(y.success){const{records:w,total:S}=y.data;S&&w&&(w!=null&&w.length)&&(t.currentBrand=w)}}p()}),(e,s)=>{const l=u("van-icon"),y=u("VanField"),w=u("VanImage"),S=u("van-checkbox"),F=u("van-checkbox-group"),M=u("VanList"),Y=u("VanButton"),ee=u("VanPopup");return h(),P(ee,{teleport:"body",show:x.value,position:"bottom",round:"","close-on-click-overlay":!1,onClickOverlay:s[5]||(s[5]=r=>e.$emit("close")),"overlay-class":"categoryOverlay",class:"sm:w-[375px] sm:left-[50%] sm:translate-x-[-50%]",style:{"min-height":"50%","border-radius":"16px 16px 0 0"}},{default:d(()=>[o("div",je,[o("header",Je,[o("div",{class:"absolute left-0 top-0 pr-2 text-sm text-newOrigin",onClick:T(H,["stop"])},i(e.$t("city.add brand")),9,Ye),o("div",qe,i(e.$t("offline.select_store_brand")),1),o("div",Qe,[m(l,{name:"cross",size:"20",onClick:s[0]||(s[0]=T(()=>{_("close")},["stop"]))})])]),b.level?I("",!0):(h(),N("div",Xe,[m(y,{modelValue:c(f).storeBrandNameLike,"onUpdate:modelValue":s[1]||(s[1]=r=>c(f).storeBrandNameLike=r),placeholder:e.$t("offline.input_store_name"),class:"w-[100%-20px] text-center bg-transparent items-center",clearable:"",onClear:n,onKeyup:de(n,["enter"])},{"left-icon":d(()=>[Ze]),"right-icon":d(()=>[o("div",{class:"text-newOrigin pl-1 ml-2",onClick:n},i(e.$t("common.search")),1)]),_:1},8,["modelValue","placeholder","onKeyup"])])),m(M,{loading:c(t).loading,"onUpdate:loading":s[3]||(s[3]=r=>c(t).loading=r),finished:c(t).finished,"immediate-check":!1,"loading-text":e.$t("common.loading"),onLoad:p,class:"shopList mx-1 overflow-y-auto h-[calc(100vh-200px)]"},{default:d(()=>[m(F,{modelValue:v.value,"onUpdate:modelValue":s[2]||(s[2]=r=>v.value=r),ref:(r,z)=>{z.checkboxGroup=r,U.value=r},max:1},{default:d(()=>[(h(!0),N(ue,null,ie(c(t).list,r=>(h(),P(S,{key:r.storeBrandId,name:r.storeBrandId,id:r.storeBrandId,"label-position":"left",class:"flex flex-1 justify-between py-4 border-b border-b-b4 last:border-none",onClick:z=>E(r)},{icon:d(z=>[z.checked?(h(),N("img",ot)):I("",!0)]),default:d(()=>[o("div",We,[m(w,{src:((r==null?void 0:r.storeBrandIcon)||"").split(",")[0],radius:"4px",width:"32px",height:"32px",fit:"cover"},null,8,["src"]),o("div",et,[o("div",{class:ce([{"text-newOrigin font-semibold":v.value.includes(r.storeBrandId)},"line-clamp-1"])},[O(i(r.storeBrandName)+" ",1),v.value.includes(r.storeBrandId)&&b.includeAllStoreFlag?(h(),N("span",tt,i(e.$t("city.current brand selected include all store")),1)):I("",!0)],2),o("div",st,i(r.storeBrandDesc),1)])])]),_:2},1032,["name","id","onClick"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["loading","finished","loading-text"]),!c(t).loading&&b.selectStore?(h(),N("div",at,[m(Y,{class:"submit-btn flex-1 bg-white text-b1 text-base font-normal border border-solid border-b4 h-[46px]",round:"",onClick:B},{default:d(()=>[O(i(e.$t("city.all store and supply")),1)]),_:1}),m(Y,{class:"submit-btn flex-1 bg-yellow text-b1 text-base font-semibold border-none h-[46px]",round:"",onClick:G},{default:d(()=>[O(i(e.$t("city.choose store")),1)]),_:1})])):I("",!0)]),c(A)?(h(),P(Me,{key:0,onSuccess:R,onClose:s[4]||(s[4]=r=>c(C)(!1))})):I("",!0)]),_:1},8,["show"])}}});export{ut as _,we as a};
