import{y as Pe,w as ze,x as Ce,F as S,a2 as N,P as i,G as v,I as te,J as xe,R as Z,X as Re,Q as d,a4 as ee,H as a,T as k,_ as Ge,be as Ve,o as Te,r as f,bf as Ue,D as Qe,E as _,O as m,a3 as ct,N as p,bz as ut,$ as Ye,K as X,Y as We,Z as Je,l as rt,a1 as dt,z as mt,a0 as he,bc as W,bd as J,bQ as pt,t as ft}from"./vendor-BUT0HZ5j.js";import{h as He,_ as vt,e as ht}from"./excel-DiIE5TbC.js";import{C as xt}from"./CommonVanProvider-BpsZUrD3.js";import{e as Oe,u as Xe,a8 as ke,R as gt,C as bt,V as yt,bH as Ke,l as Ae,bK as wt,bL as _t,b as kt,bI as Tt}from"./index-hbwLMIYO.js";import{_ as Ct}from"./OfflineGoods-BjltvH3M.js";import{_ as St}from"./OfflineConsumer-DYUtC3ei.js";import{_ as $t}from"./search-Dwmdj_3F.js";import{_ as Dt}from"./filter-B5MATEpa.js";import{D as It}from"./goods-BVwS8oFG.js";import{w as Ze,x as Lt,y as Et}from"./order-CKUhc8Y9.js";import{B as At}from"./BetweenTab-Bn5ZVRk8.js";import{a as ce,O as qe,d as Vt}from"./offlineGoods-DvT2Go6q.js";import"./BackIcon-biFt6cm7.js";import"./MCOIN-BcbOHmhy.js";import"./ImgBoutiqueLable-BF5Xoxsv.js";import"./shop-CeqcS6K2.js";import"./avatarRing-DpEnkbQ2.js";/* empty css                                                               */const Ot=a("span",null,"...",-1),Rt=[Ot],Ht=Pe({props:{order:null},emits:["open"],setup(L,{emit:oe}){const V=L,{t:j}=ze(),{accountStore:B}=Oe(),O=Ce(()=>{var F,E;return(F=V.order)!=null&&F.orderLabels?(E=V.order)==null?void 0:E.orderLabels.filter(o=>!!o).map((o,se)=>{var ae;return{...o,id:(ae=V.order)==null?void 0:ae.orderLabelIds[se]}}):[]}),ne=F=>{if(B.isOnlyView)return k(j("order.Requires merchant account operation"));oe("open",F)};return(F,E)=>i(O).length?(v(),S("ul",{key:0,class:"w-fit tag-style flex justify-start items-center mt-[16px] text-white overflow-x-hidden",onClick:E[1]||(E[1]=ee(o=>ne(L.order),["stop"]))},[i(O).length>0?(v(),S(te,{key:0},[(v(!0),S(te,null,xe(i(O).slice(0,5),o=>(v(),S("li",{style:Re({backgroundColor:i(He)(o==null?void 0:o.colorHex,.12),color:o==null?void 0:o.colorHex}),class:Z(["text-xxs h-[22px] rounded-[4px] px-[8px] py-1 mr-1 flex justify-center items-center font-normal whitespace-nowrap",{"w-[22px]":!(o!=null&&o.content)}]),key:o==null?void 0:o.id},d(o==null?void 0:o.content),7))),128)),i(O).length>4?(v(),S("li",{key:0,class:"bg-[#f5f5f5] text-default text-xxs w-[25px] h-[22px] rounded-[4px] py-1 mr-1 flex justify-center items-center",onClick:E[0]||(E[0]=ee(o=>ne(L.order),["stop"]))},Rt)):N("",!0)],64)):N("",!0)])):N("",!0)}}),et=L=>(We("data-v-510c91c8"),L=L(),Je(),L),Pt={class:"flex items-center p-3"},Mt={class:"flex-1 bg-white rounded-3xl search-input-box"},Nt=et(()=>a("div",null,[a("img",{src:$t,class:"w-4 h-4"})],-1)),Bt=et(()=>a("img",{src:Dt,class:"w-full h-full"},null,-1)),Ft=[Bt],Yt={class:"flex flex-col h-[75vh] justify-between px-5 pb-[80px]"},Ut={class:"pt-[18px] pb-4 font-semibold text-base text-center"},zt={class:"overflow-y-auto flex-1"},jt={class:"text-sm font-semibold"},Kt={class:"flex items-center gap-2 mt-3 overflow-x-auto"},qt=["onClick"],Gt={class:"mt-3 flex-start"},Qt={class:"mx-2"},Wt={key:0,class:"pt-4"},Jt={class:"text-sm font-semibold"},Xt={class:"pt-[10px] pr-[10px] mt-[10px] max-h-[300px]"},Zt={class:"pb-4 flex-center-bw p-4 flex justify-between gap-3 fixed bottom-0 left-0 right-0 bg-white"},eo={class:"text-base font-normal"},to={class:"text-base font-semibold"},oo=Pe({props:{modelValue:null,deliveryType:{default:It.online},shopType:null},emits:["update:modelValue","onSearch"],setup(L,{expose:oe,emit:V}){const{t:j}=ze(),[B,O]=Ve(!1),{getCurrentStoreId:ne}=Xe(),F=Te().format("YYYY-MM-DD"),E=Te().subtract("days",7).format("YYYY-MM-DD"),o=Te().subtract("month",1).format("YYYY-MM-DD"),se=Te().subtract("month",3).format("YYYY-MM-DD"),ae=Ce(()=>[{id:1,label:j("shop.Last 7 days")},{id:2,label:j("shop.last month")},{id:3,label:j("shop.last 3 months")}]),[ue,re]=Ve(!1),[de,me]=Ve(!1),A=f(new Date),l=f(new Date),b=f(new Date(new Date("2020/1/1").getTime())),le=f(new Date(new Date("2020/1/1").getTime())),h=Ue({startTime:null,endTime:null}),K=f(!1),H=f(!1),x=f([]),$=f([]),T=f(null),Y=()=>{V("onSearch"),T.value.blur()},ge=()=>{h.startTime=null,h.endTime=null,y.value=null,A.value=null,l.value=null,$.value=[],be()},R=()=>{re(!1),me(!1),(!h.startTime||!h.endTime)&&(h.endTime=null,h.startTime=null)},P=r=>{A.value=new Date(ke(r)),le.value=new Date(new Date(r).getTime()),h.startTime=ke(A.value.toString()),y.value=null,re(!1),me(!0)},Se=r=>{l.value=new Date(ke(r)),h.startTime=ke(A.value.toString()),h.endTime=ke(r),y.value=null,me(!1)},y=f(null),$e=r=>{if(y.value!==r){switch(l.value=new Date(F),h.endTime=F,r){case 1:h.startTime=E,A.value=new Date(E),le.value=new Date(new Date(E).getTime()+60*1e3);break;case 2:h.startTime=o,A.value=new Date(o),le.value=new Date(new Date(o).getTime()+60*1e3);break;case 3:h.startTime=se,A.value=new Date(se),le.value=new Date(new Date(se).getTime()+60*1e3);break}y.value=r}},be=()=>{const r={startTime:h.startTime?h.startTime+" 00:00:00":null,endTime:h.endTime?h.endTime+" 23:59:59":null,orderLabelIdList:$.value};V("onSearch",r),O(!1)},U=async()=>{var r;Ze({page:1,size:300,shopId:(r=await ne())==null?void 0:r.id}).then(u=>{x.value=u.data.map(q=>({id:q.id,content:q.content,colorHex:q.colorHex})),K.value=!1,x.value.length>=u.total&&(H.value=!0)})};return Qe(()=>{U()}),oe({onLoadTagList:U}),(r,u)=>{const q=_("VanField"),ye=_("van-datetime-picker"),pe=_("van-popup"),De=_("van-icon"),fe=_("van-checkbox"),Me=_("van-checkbox-group"),Ie=_("van-list"),Le=_("VanButton"),Ne=_("VanPopup");return v(),S(te,null,[a("div",Pt,[a("div",Mt,[m(q,{ref:(c,G)=>{G.searchRef=c,T.value=c},onKeyup:ut(Y,["enter"]),"model-value":L.modelValue,"onUpdate:modelValue":u[1]||(u[1]=c=>V("update:modelValue",c)),placeholder:r.$t("offline.searchTips"),class:"w-[100% - 20px] text-center bg-transparent items-center",clearable:"",enterkeyhint:"search"},{"left-icon":p(()=>[Nt]),"right-icon":p(()=>[a("div",{onClick:u[0]||(u[0]=c=>V("onSearch")),class:"text-newOrigin font-semibold leading-5"},d(r.$t("common.search")),1)]),_:1},8,["onKeyup","model-value","placeholder"])]),a("div",{class:"flex-shrink-0 w-5 h-5 ml-2",onClick:u[2]||(u[2]=c=>i(O)(!0))},Ft),ct(r.$slots,"default",{},void 0,!0)]),m(Ne,{teleport:"body",show:i(B),"onUpdate:show":u[11]||(u[11]=c=>Ye(B)?B.value=c:null),round:"",position:"bottom",closeable:"",class:"sm:w-[375px]",style:{height:"75vh","max-height":"75vh","min-width":"280px",left:"50%",transform:"translate3d(-50%, 0, 0)"},"close-on-click-overlay":"",onClickOverlay:u[12]||(u[12]=c=>i(O)(!1)),onClickCloseIcon:u[13]||(u[13]=c=>i(O)(!1))},{default:p(()=>[a("div",Yt,[a("div",Ut,d(r.$t("common.OrderScreening")),1),a("div",zt,[a("div",jt,d(r.$t("common.time")),1),a("div",Kt,[(v(!0),S(te,null,xe(i(ae),c=>(v(),S("div",{class:Z(["type-cell flex-1",{"cell-active":y.value==c.id}]),key:c.id,onClick:G=>$e(c.id)},d(c.label),11,qt))),128))]),a("div",Gt,[a("div",{class:"van-cell p-0 flex justify-center type-cell",onClick:u[3]||(u[3]=ee(c=>i(re)(!0),["stop"]))},[a("div",{class:Z({"opacity-30":!i(h).startTime})},d(i(h).startTime||r.$t("goods.selectStartTime")),3)]),m(pe,{show:i(ue),"onUpdate:show":u[5]||(u[5]=c=>Ye(ue)?ue.value=c:null),position:"bottom",round:"",style:{height:"50%"},"close-on-click-overlay":!1,teleport:"body"},{default:p(()=>[m(ye,{modelValue:A.value,"onUpdate:modelValue":u[4]||(u[4]=c=>A.value=c),"min-date":b.value,type:"date",title:r.$t("goods.selectStartTime"),onCancel:R,onConfirm:P},null,8,["modelValue","min-date","title"])]),_:1},8,["show"]),a("div",Qt,[m(De,{name:"minus"})]),a("div",{class:"van-cell p-0 flex justify-center type-cell",onClick:u[6]||(u[6]=ee(c=>i(me)(!0),["stop"]))},[a("div",{class:Z({"opacity-30":!i(h).endTime})},d(i(h).endTime||r.$t("goods.selectEndTime")),3)]),m(pe,{show:i(de),"onUpdate:show":u[8]||(u[8]=c=>Ye(de)?de.value=c:null),position:"bottom",round:"",style:{height:"50%"},"close-on-click-overlay":!1,teleport:"body"},{default:p(()=>[m(ye,{modelValue:l.value,"onUpdate:modelValue":u[7]||(u[7]=c=>l.value=c),onConfirm:Se,"min-date":le.value,onCancel:R,type:"date",title:r.$t("goods.selectEndTime")},null,8,["modelValue","min-date","title"])]),_:1},8,["show"])]),x.value&&x.value.length?(v(),S("div",Wt,[a("div",Jt,d(r.$t("common.tag")),1),a("div",Xt,[m(Ie,{loading:K.value,"onUpdate:loading":u[10]||(u[10]=c=>K.value=c),finished:H.value,onLoad:U},{default:p(()=>[m(Me,{modelValue:$.value,"onUpdate:modelValue":u[9]||(u[9]=c=>$.value=c),max:5},{default:p(()=>[(v(!0),S(te,null,xe(x.value,(c,G)=>(v(),X(fe,{name:c.id,key:G,class:"relative flex radioList"},{icon:p(Ee=>[Ee.checked?(v(),X(De,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[15px] border-0 top-[1px] bg-transparent",size:"30"})):N("",!0)]),default:p(()=>[a("div",{style:Re({backgroundColor:i(He)(c.colorHex,.12),color:c.colorHex}),class:Z(["rounded-[6px] min-h-[40px] p-[10px] text-white text-[0.875rem]",G===x.value.length-1?"":"mb-[16px]"])},d(c.content),7)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["loading","finished"])])])):N("",!0)]),a("div",Zt,[m(Le,{round:"",class:"!border-b4 text-b1 flex-1 h-[46px]",onClick:ge},{default:p(()=>[a("span",eo,d(r.$t("common.reset")),1)]),_:1}),m(Le,{round:"",class:"btn-yellow flex-1 h-[46px] border-0",onClick:be},{default:p(()=>[a("span",to,d(r.$t("common.confirm")),1)]),_:1})])])]),_:1},8,["show"])],64)}}}),no=Ge(oo,[["__scopeId","data-v-510c91c8"]]),so=L=>(We("data-v-6f16cab2"),L=L(),Je(),L),ao=["src"],lo={class:"text-b3"},io=so(()=>a("img",{src:vt,class:"w-5 h-5"},null,-1)),co=[io],uo={class:"mx-3 safe-body overflow-y-auto"},ro=["onClick"],mo={class:"text-b3"},po={key:0,class:"relative flex justify-end text-xs mt-3 gap-2"},fo={class:"px-[20px] pt-[18px] pb-[15px] flex justify-between bg-white z-40 text-[14px] items-center absolute top-0 left-0 right-0"},vo={class:"text-[#222221] text-[16px]"},ho={class:"tagForm"},xo={class:"text-[#222221] mb-[10px]"},go={class:"mt-[30px]"},bo={key:0,class:"text-center mt-[150px]"},yo={class:"h-[96px] p-[16px] flex flex-col justify-center items-center fixed bottom-0 left-0 right-0 bg-white"},wo={class:"mt-[8px] text-[#5D5A56] text-[12px] leading-none"},_o={class:"p-[16px] flex justify-center fixed bottom-0 left-0 right-0 bg-white"},ko=Pe({name:"MerchantOrders"});function To(L){const{regionStore:oe}=Oe(),{accountStore:V}=Oe(),{clerkStore:j}=Oe(),B=rt(),O=dt(),{getCurrentStoreId:ne}=Xe(),F=f(null),E=f(null),{t:o}=ze(),{generateKey:se,getMerchantDhKey:ae,decryptKey:ue,cryptoAESWithSearch:re}=gt(),de=Ce(()=>[{label:o("order.wait"),value:ce.PAYMENT_SUCCESS},{label:o("order.canceled"),value:ce.CANCELLED},{label:o("order.completed"),value:ce.COMPLETED},{label:o("common.all"),value:-1}]),[me,A]=Ve(!1),l=Ue({status:-1,shopInfo:null,list:[],total:0,loading:!1,finished:!1}),b=Ue({shopId:null,orderCustomerAddress:void 0,page:0,size:20,keywords:"",merchantEnsLike:void 0,orderStatus:-1,startTime:void 0,endTime:void 0,orderLabelIdList:void 0,sortBy:"desc|create_time"}),le=t=>{l.status=t,B.replace({path:"offlineMerchantOrders",query:{status:t}}),ye()},h=Ce(()=>!0),K=f(!1),H=f(!1),x=f(!1),$=f(null),T=f([]),Y=f(""),ge=f([]),R=f([]),P=f(null),Se=Ce(()=>{var t;return(t=l.shopInfo)==null?void 0:t.id}),y=f({content:"",colorHex:"",id:null,shopId:null}),$e=f(null),be=f([{id:null,content:"",colorHex:"#D4380D"},{id:null,content:"",colorHex:"#E58312"},{id:null,content:"",colorHex:"#DEAD0E"},{id:null,content:"",colorHex:"#389E0D"},{id:null,content:"",colorHex:"#0958D9"},{id:null,content:"",colorHex:"#531DAB"}]),U=f(!1),r=f(0),u=t=>{var n;return((n=de.value.find(w=>+w.value==+t))==null?void 0:n.label)||""},q=t=>{B.push(t)},ye=async t=>{t&&(b.startTime=(t==null?void 0:t.startTime)||void 0,b.endTime=(t==null?void 0:t.endTime)||void 0,b.orderLabelIdList=(t==null?void 0:t.orderLabelIdList)||void 0),l.finished=!1,l.total=0,l.list=[],b.page=0,pe()},pe=async()=>{var t,n;if(!((t=l.shopInfo)!=null&&t.id))return l.finished=!0;l.loading=!0,b.shopId=(n=l.shopInfo)==null?void 0:n.id,b.page+=1,await fe(),l.loading=!1},De=async t=>{const n=[];for(let w=0;w<t.length;w++){const g=t[w];if(g!=null&&g.orderRemark&&!g.merchantEns)try{let D=g.orderRemark;if(g!=null&&g.orderSubmitCustomerPubKey){const I=await ae(g.merchantAddress,g.orderSubmitCustomerPubKey);if(I){const{decrypt:ie}=ue(g.orderRemark,I);D=ie}}if(D){const I=await re(D);I&&n.push({orderId:g.orderId,merchantEns:I})}}catch(D){console.error("Decryption failed:",D)}}(n||[]).length&&_t(n)},fe=async()=>{const t=l.status;let n=null;U.value&&(n=Math.ceil((r.value+1)/b.size)),l.status<0?delete b.orderStatus:b.orderStatus=l.status,b.keywords?b.merchantEnsLike=await re(b.keywords):b.merchantEnsLike=void 0;const{success:w,data:g}=await Ke(b);if(l.loading=!1,!w){l.finished=!0;return}const{records:D,total:I,current:ie,pages:ve}=g;if(!I||!D||!(D!=null&&D.length)){l.finished=!0;return}l.total=I;const Q=f([]);Q.value=D.map(we=>({btnLoading:!1,...we})),De(Q.value),t===l.status&&(U.value?(l.list.splice((n-1)*b.size,b.size,...Q.value),U.value=!1):l.list=b.page===1?Q.value:l.list.concat(Q.value)),+ie>=+ve&&(l.finished=!0)},Me=t=>{if(V.isOnlyView)return k(o("order.Requires merchant account operation"));if(j.isClerk&&!j.clerkAuth)return k(o("order.Requires merchant account operation"));B.push({name:"offlineMerchantDetail",query:{id:t.orderId,quick:"deliver"}})},Ie=(t,n)=>{if(V.isOnlyView)return k(o("order.Requires merchant account operation"));r.value=n,K.value=!0,$e.value=t.orderId,t.orderLabelIds&&(T.value=[],t.orderLabelIds.forEach(w=>T.value.push(+w))),Be()},Le=t=>{x.value=!0,t.id&&(P.value=t.id,$.value=t.content,y.value.id=t.id,y.value.colorHex=t.colorHex,Y.value=t.colorHex,ge.value=T.value)},Ne=()=>{x.value=!0,P.value=null,$.value=null,y.value.id=null,y.value.colorHex=null,Y.value="",ge.value=T.value},c=t=>{T.value&&T.value.length>=5&&T.value.findIndex(n=>n===R.value[t].id)===-1&&k(o("common.tag select num valid",{num:5}))},G=()=>{x.value=!1,T.value=ge.value,P.value=null,R.value.length=0,$.value=null,Y.value="",Be()},Ee=()=>{K.value=!1,P.value=null,T.value=[],E.value.onLoadTagList()},Be=()=>{R.value=[],Ze({page:1,size:300,shopId:Se.value}).then(t=>{t==null||t.data.forEach(n=>{R.value.push({id:n.id,content:n.content,colorHex:n.colorHex})})})},tt=()=>{var t;if(!H.value){if(((t=Y.value)==null?void 0:t.length)===0){k.fail(o("order.Please select a color"));return}else y.value.colorHex=Y.value,y.value.id=P.value,y.value.content=$.value,y.value.shopId=Se.value;y.value.content&&(y.value.content=y.value.content.trim()),P.value||delete y.value.id,H.value=!0,Lt(y.value).then(n=>{n.msg==="SUCCESS"&&(x.value=!1,R.value=[],Y.value="",$.value=null,Be(),U.value=!0,fe(),k(o("order.Save success")))}).finally(()=>{H.value=!1})}},ot=()=>{H.value||(H.value=!0,Et({id:P.value}).then(t=>{t.msg==="SUCCESS"?(k(o("order.Delete success")),U.value=!0,fe(),G()):k(o("order.Delete failed"))}).finally(()=>{H.value=!1}))},nt=async()=>{H.value||(T.value=T.value.filter(t=>!!R.value.find(n=>t==n.id)),H.value=!0,await wt({orderId:$e.value,orderLabelIds:T.value}).then(t=>{if(t!=null&&t.success)K.value=!1,x.value=!1,$.value="",k(o("order.Save success")),U.value=!0,fe();else{k(o("order.Save failed"));return}}).finally(()=>{H.value=!1}))},st=t=>{if(V.isOnlyView)return k(o("order.Requires merchant account operation"));const n=t.orderCustomerAddress;kt(t.orderCustomerAddress,"...",5,5),B.push(`/merchantOrders-offlineOrderHistory?address=${n}&source=merchants`)},at=async()=>{var C;const t=navigator.userAgent.toLowerCase(),n=/mobile|android|iphone|ipad|phone/i.test(t),w=/tablet|ipad/i.test(t),g=/webview|wv/i.test(t),D=/fbav|instagram|line|twitter|whatsapp/i.test(t),I=/metamask/i.test(t),ie=/tokenpocket/i.test(t),ve=(window==null?void 0:window.$onekey)||!1;if(ft.isConnected()){A(!0);return}if(ve){A(!0);return}if((n||w)&&(g||D||I||ie||ve)&&!window.chrome&&!window.safari){A(!0);return}const Q={...b,page:1,size:99999};k.loading({duration:0,message:o("common.loading")});const{success:we,data:M}=await Ke(Q);if(!we||!(M!=null&&M.records)||(M==null?void 0:M.records.length)===0){k.clear(),k(o("common.No data download"));return}await se("merchant");const Fe=M==null?void 0:M.records.map(e=>new Promise(async lt=>{if(e!=null&&e.orderRemark&&(e!=null&&e.orderSubmitCustomerPubKey))try{const z=await ae(e.merchantAddress,e.orderSubmitCustomerPubKey);if(z){const it=ue(e.orderRemark,z);e.orderRemark=it.decrypt}}catch(z){console.error("解密失败:",z)}lt([{text:e==null?void 0:e.orderId},{text:(e==null?void 0:e.orderCustomerAddress)||""},{text:(e==null?void 0:e.orderPayAddress)||""},{text:(e==null?void 0:e.orderTransactionHash)||""},{text:(e==null?void 0:e.storeName)||(e==null?void 0:e.storeId)||""},{text:(e==null?void 0:e.shopName)||""},{text:typeof(e==null?void 0:e.orderType)=="number"?o(`offline.order_${qe[e==null?void 0:e.orderType]}`):""},{text:(e==null?void 0:e.relName)||""},{text:(e==null?void 0:e.relId)||""},{text:(e==null?void 0:e.relNumber)||0},{text:(e==null?void 0:e.relPrice)||0},{text:u(e==null?void 0:e.orderStatus)},{text:(e==null?void 0:e.orderTotalAmount)||0},{text:(e==null?void 0:e.orderRealAmount)||0},{text:e!=null&&e.orderDiscountRatio?(e==null?void 0:e.orderDiscountRatio)+"%":"0%"},{text:e!=null&&e.createTime?Ae(e==null?void 0:e.createTime):""},{text:e!=null&&e.payTime?Ae(e==null?void 0:e.payTime):""},{text:(e==null?void 0:e.orderStatus)!==ce.CANCELLED&&(e!=null&&e.finishTime)?Ae(e==null?void 0:e.finishTime):""},{text:(e==null?void 0:e.orderRemark)||""},{text:e!=null&&e.orderLabels&&(e!=null&&e.orderLabels.length)?e==null?void 0:e.orderLabels.map(z=>z==null?void 0:z.content).filter(z=>!!z).join(","):""},{text:typeof(e==null?void 0:e.cancelSource)=="number"?o(`offline.order_cancel_type_${Vt[e==null?void 0:e.cancelSource]}`):""},{text:(e==null?void 0:e.cancelReason)||""},{text:(e==null?void 0:e.orderStatus)===ce.CANCELLED&&(e!=null&&e.finishTime)?Ae(e==null?void 0:e.finishTime):""}])})),_e=await Promise.all(Fe);if(!_e||_e.length===0){k.clear(),k(o("common.No data download"));return}const s=[{text:o("order.export.orderId")},{text:o("order.export.buyerAddress")},{text:o("order.export.payAddress")},{text:o("order.export.transactionHash")},{text:o("order.export.belongShop")},{text:o("order.export.services")},{text:o("order.export.goodsType")},{text:o("order.export.goodsName")},{text:o("order.export.goodsId")},{text:o("order.export.goodsNumber")},{text:o("order.export.goodsPrice")},{text:o("order.orderStatus")},{text:o("order.export.goodsPriceTotal")},{text:o("order.export.actualAmount total")},{text:o("common.ratio")},{text:o("order.createTime")},{text:o("order.export.paymentTime")},{text:o("order.Complete time")},{text:o("order.remark")},{text:o("offline.export.order tag")},{text:o("offline.export.order cancel type")},{text:o("offline.export.order cancel reason")},{text:o("offline.cancel_time")}];try{const e=((C=await ne())==null?void 0:C.storeName)+o("offline.main title")+"_"+Te().format("YYYY-MM-DD HH:mm:ss");ht([s,..._e],{excelName:e,worksheet:"sheet"}),k.clear()}catch{k.clear()}},je=()=>{A(!1)};return mt(()=>O.path,async t=>{if(t==="/offlineMerchantOrders"){const n=sessionStorage.getItem("merchant_offline_refresh_chainOrderId");if(n){const w=l.list.findIndex(g=>g.orderId==n);if(w>-1&&l.status===ce.PAYMENT_SUCCESS)l.list.splice(w,1);else if(w>-1&&l.status===-1){const g=await Tt({id:n});g.success&&(l.list[w]=g.data||{})}sessionStorage.removeItem("merchant_offline_refresh_chainOrderId")}}},{deep:!0}),Qe(async()=>{var t,n;(t=O.query)!=null&&t.status&&(l.status=Number((n=O.query)==null?void 0:n.status)),l.shopInfo=await ne(),pe(),j.checkClerkAuth()}),(t,n)=>{const w=_("VanButton"),g=_("VanList"),D=_("van-field"),I=_("van-icon"),ie=_("van-radio"),ve=_("van-radio-group"),Q=_("van-checkbox"),we=_("van-checkbox-group"),M=_("van-button"),Fe=_("van-action-sheet"),_e=_("router-view");return v(),X(xt,{title:t.$t("offline.main title"),class:"bg-gray1 font-Puhui font-normal relative shopGoodsPage","theme-vars":{"field-placeholder-text-color":"#A6A6A6"},ref:(s,C)=>{C.shopGoodsRef=s,F.value=s}},{right:p(()=>[a("img",{src:i(yt)(`mall/${i(oe).country}-flag.svg`),class:"w-5 h-auto mr-1"},null,8,ao),a("span",lo,d(t.$t(`country.${i(oe).country}`))+d(i(oe).country),1)]),default:p(()=>[m(At,{options:i(de),"label-key":"label","value-key":"value",modelValue:i(l).status,"onUpdate:modelValue":n[0]||(n[0]=s=>i(l).status=s),onChange:le},null,8,["options","modelValue"]),m(no,{ref:(s,C)=>{C.searchBox=s,E.value=s},modelValue:i(b).keywords,"onUpdate:modelValue":n[1]||(n[1]=s=>i(b).keywords=s),onOnSearch:ye},{default:p(()=>[a("div",{class:"flex-shrink-0 w-5 ml-3",onClick:at},co)]),_:1},8,["modelValue"]),a("div",uo,[m(g,{loading:i(l).loading,"onUpdate:loading":n[2]||(n[2]=s=>i(l).loading=s),finished:i(l).finished,"immediate-check":!1,"finished-text":t.$t("common.noMore"),"loading-text":t.$t("common.loading"),onLoad:pe},{default:p(()=>[(v(!0),S(te,null,xe(i(l).list,(s,C)=>(v(),S("div",{class:"offline-crad-box mb-3",key:s.orderId,onClick:e=>q(`/offlineMerchantDetail?id=${s.orderId}`)},[m(St,{order:s,"show-status":"",status:u(s.orderStatus)},null,8,["order","status"]),m(Ht,{order:s,onOpen:e=>Ie(e,C)},null,8,["order","onOpen"]),m(Ct,{"show-order-type":"",class:"mt-3",goods:{goodsName:s.relName,goodsIcons:s.relIcons,orderType:s.orderType,goodsPrice:s.orderRealAmount},onImageClick:e=>s.orderType===i(qe).GOODS?q("/offlineMerchantOrders/offlineGoodsDetail?goodsId="+s.relId):q("/shop?shopId="+s.relId)},{"bottom-left":p(()=>[a("div",mo,d(t.$t("common.total"))+"：",1)]),_:2},1032,["goods","onImageClick"]),i(V).isOnlyView?N("",!0):(v(),S("section",po,[i(h)?(v(),X(w,{key:0,class:"bg-[#f5f5f5] rounded-md h-[32px] px-3 text-[#585654] text-sm font-normal",onClick:ee(e=>st(s),["stop"])},{default:p(()=>[he(d(t.$t("order.orderHistoryBuy")),1)]),_:2},1032,["onClick"])):N("",!0),m(w,{class:"bg-[#f5f5f5] rounded-md h-[32px] px-3 text-[#585654] text-sm font-normal",onClick:ee(e=>Ie(s,C),["stop"])},{default:p(()=>[he(d(t.$t("order.orderAddTag")),1)]),_:2},1032,["onClick"]),s.orderStatus===i(ce).PAYMENT_SUCCESS?(v(),X(w,{key:1,color:"#FED73A",round:"",class:"!text-b1 font-semibold h-[32px] rounded-md px-3",onClick:ee(e=>Me(s),["stop"])},{default:p(()=>[he(d(t.$t("order.Ship")),1)]),_:2},1032,["onClick"])):N("",!0)]))],8,ro))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])]),m(Fe,{show:K.value,"onUpdate:show":n[8]||(n[8]=s=>K.value=s),closeable:!1,class:"h-[70vh]",onCancel:G,onClose:Ee},{default:p(()=>[a("div",fo,[W(a("div",{class:"text-[#5D5A56] w-[60px]",onClick:G},d(t.$t("common.closed")),513),[[J,x.value]]),W(a("div",{class:"text-[#5D5A56] w-[30px]",onClick:Ee},d(t.$t("common.closed")),513),[[J,!x.value]]),a("div",vo,d(P.value?t.$t("common.editTag"):t.$t("common.addTag")),1),W(a("div",{class:"text-[#A45E00] w-[30px]",onClick:Ne},d(t.$t("piggy.add")),513),[[J,!x.value]]),W(a("div",{class:"text-[#A45E00] w-[30px]",onClick:tt},d(t.$t("common.save")),513),[[J,x.value]])]),a("div",{class:Z(["mt-[53px] px-[20px]",x.value&&P.value?"pb-[96px]":"pb-[72px]"])},[m(pt,{name:"van-slide-up"},{default:p(()=>[W(a("div",ho,[a("div",xo,d(t.$t("common.NameOptional")),1),m(D,{modelValue:$.value,"onUpdate:modelValue":n[3]||(n[3]=s=>$.value=s),maxlength:"5",placeholder:t.$t("common.pleaseEnter")},null,8,["modelValue","placeholder"]),a("div",go,d(t.$t("common.color")),1)],512),[[J,x.value]])]),_:1}),W(m(ve,{modelValue:Y.value,"onUpdate:modelValue":n[4]||(n[4]=s=>Y.value=s),max:1},{default:p(()=>[(v(!0),S(te,null,xe(be.value,(s,C)=>(v(),X(ie,{name:s.colorHex,key:C,class:"relative flex checkedList"},{icon:p(e=>[e.checked?(v(),X(I,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[23px] border-0 top-[1px] bg-transparent",size:"30"})):N("",!0)]),default:p(()=>[a("div",{style:Re({backgroundColor:i(He)(s.colorHex,.12),color:s.colorHex}),class:Z(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",C<be.value.length-1?"mb-[16px]":""])},d(s.content||$.value),7)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),[[J,x.value]]),!x.value&&R.value.length==0?(v(),S("div",bo,d(t.$t("common.NoLabels")),1)):N("",!0),W(m(we,{modelValue:T.value,"onUpdate:modelValue":n[5]||(n[5]=s=>T.value=s),max:5},{default:p(()=>[(v(!0),S(te,null,xe(R.value,(s,C)=>(v(),X(Q,{name:s.id,key:C,class:"relative flex radioList",onClick:e=>c(C)},{icon:p(e=>[e.checked?(v(),X(I,{key:0,name:"success",color:"white",class:"tag-icon absolute right-[40px] border-0 top-[1px] bg-transparent",size:"30"})):N("",!0)]),default:p(()=>[a("div",{style:Re({backgroundColor:i(He)(s.colorHex,.12),color:s.colorHex}),class:Z(["mr-[10px] rounded-[6px] min-h-[40px] p-[10px] text-white",C<R.value.length-1?"mb-[16px]":""])},d(s.content||$.value),7),a("div",null,[m(I,{name:"edit",class:"absolute right-[1px] top-[1px]",color:"#543E3E",size:"30",onClick:ee(e=>Le(s),["stop"])},null,8,["onClick"])])]),_:2},1032,["name","onClick"]))),128))]),_:1},8,["modelValue"]),[[J,!x.value]]),W(a("div",yo,[m(M,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"shrink-0 w-[180px] my-0 h-[40px] rounded-[20px]",onClick:n[6]||(n[6]=s=>ot()),block:""},{default:p(()=>[he(d(t.$t("common.RemoveTag")),1)]),_:1}),a("div",wo,[m(I,{name:"question-o",size:"12",class:"mr-[8px]"}),he(d(t.$t("common.AllOrderLabelsCannotBeViewedAfterRemoval")),1)])],512),[[J,x.value&&P.value]])],2),W(a("div",_o,[m(M,{color:"linear-gradient(to right, #FED53A, #FFA122)",class:"w-[180px] my-0 h-[40px] rounded-[20px]",onClick:n[7]||(n[7]=s=>nt()),block:""},{default:p(()=>[he(d(t.$t("common.ConfirmSelection")),1)]),_:1})],512),[[J,!x.value&&R.value.length>0]])]),_:1},8,["show"]),m(bt,{show:i(me),title:"导出账单",content:"请在PC端操作账单导出",showConfirm:!0,showReject:!1,confirmText:"我知道了",rejectText:"拒绝",onClose:je,onConfirm:je},null,8,["show"]),m(_e,{class:"child-view bg-gray1"})]),_:1},8,["title"])}}const Co=Pe({...ko,setup:To}),zo=Ge(Co,[["__scopeId","data-v-6f16cab2"]]);export{zo as default};
