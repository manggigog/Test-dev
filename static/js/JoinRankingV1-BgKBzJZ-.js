import{_ as G}from"./member-BMygrgIC.js";import{_ as H,y as J,w as K,bc as I,r as c,z as P,bd as X,D as Y,F as v,G as d,H as o,a2 as $,O as u,Q as a,P as n,E as p,N as F,K as Z,R as W,T as ee,Y as te,Z as oe,a1 as se,a0 as ne}from"./vendor-D6JO6WHW.js";import{B as ae}from"./BackIcon-CPUEW9je.js";import{f as ie,a2 as le,q as re,S as ce,d as V}from"./index-Ds2hFbCb.js";import{c as de,d as ue}from"./ranking-DPmlYDrw.js";import{u as pe}from"./upload-EllNmkoq.js";import{u as me}from"./useCreditsNew-BPu464d7.js";import"./beiConstContract--9OOQL--.js";const ve="/Test-dev/static/images/carema-jwSTtAX1.png",R=m=>(te("data-v-13d18ac6"),m=m(),oe(),m),fe={class:"bg-[#F2F0EF] p-2.5"},ge={class:"flex-start mb-2.5"},_e={key:0,class:"mb-2.5 px-2.5 py-2 flex border border-solid border-[#ea3323] rounded-xl bg-white text-[#ea3323]"},be={class:"ml-1.5 text-sm"},he={class:"mr-2"},ye={class:"pt-6 bg-white rounded-lg"},ke={class:"px-3.5"},we={class:"mb-5 flex-center"},xe=R(()=>o("div",{class:"w-[90px] h-[90px] rounded-full bg-[#D9D9D9] text-center text-lg text-[#d9d9d9] font-bold relative"},[o("div",{class:"w-[30px] h-[30px] border-[2px] border-solid border-white bg-oriange1 rounded-full flex-center absolute bottom-0 right-0"},[o("img",{src:ve,class:"w-[15px] h-auto m-auto"})])],-1)),Ie={class:"mb-2.5 font-normal opacity-60 text-sm"},$e={class:"bg-[#F3F3F3] rounded-lg font-normal mb-3.5 px-[15px] py-[8px]"},Fe={class:"mb-2.5 font-normal opacity-60 text-sm"},Ve={class:"text-sm font-normal border-t border-solid border-[#F3F3F3] px-3.5 pb-3.5"},Re={class:"flex-center-bw pt-3.5"},Ce={class:"font-normal opacity-60"},Be={class:"w-[40px] border-[1px] border-solid border-white flex-center bg-[#FED73A] rounded-3xl"},De=R(()=>o("img",{src:G,class:"w-3 h-3"},null,-1)),Se={class:"flex-center-bw pt-3.5"},Le={class:"font-normal opacity-60"},Ne={key:1},je={class:"flex-center-bw pt-3.5"},Ae={class:"font-normal opacity-60"},Ee={key:0,class:"flex-center-bw pt-3.5"},Te={class:"font-normal opacity-60"},ze=J({setup(m){const{t:C}=K(),{memberLevels:B,contributes:D}=ie(),[S,b]=I(!1),L=se(),l=c(0),{allQuota:N}=me();P(()=>L,t=>{t&&(l.value=+t.query.isShop||0)},{immediate:!0,deep:!0});const f=c(null),j=async()=>{const{success:t,data:e}=await ce();t&&e&&(f.value=e,l.value&&(i.value[0]={url:e!=null&&e.logo?e==null?void 0:e.logo.split()[0]:""},s.nickname=e==null?void 0:e.storeName))},h=c(0),A=async()=>{h.value=await B()},y=c(0),[E,k]=I(),T=async()=>{k(!0);const t=await D();t.success&&(y.value=t.result,k(!1))},s=X({nickname:"",introduction:"",status:0,denialReason:""}),w=c(null),z=async()=>{const{success:t,data:e}=await ue({type:l.value?2:1});if(t&&e){if(+(e==null?void 0:e.status)==3){const r=document.getElementsByClassName("van-field__control");Object.values(r).forEach(g=>{g.setAttribute("class","myInput")})}w.value=e,e!=null&&e.avatar&&(i.value[0]={url:e==null?void 0:e.avatar}),e!=null&&e.nickname&&(s.nickname=e==null?void 0:e.nickname),e!=null&&e.introduction&&(s.introduction=e==null?void 0:e.introduction),e!=null&&e.status&&(s.status=e==null?void 0:e.status),e!=null&&e.denialReason&&(s.denialReason=e==null?void 0:e.denialReason)}},i=c([]),q=async t=>{const e=await le(t,"shopLogo"),r=await pe(e);if(!r.success)return i.value.length-=1;i.value[i.value.length-1]={url:re.imgUrl+r.data}},M=async()=>{var e,r;if(+s.status==1)return;if(s.introduction===((e=w.value)==null?void 0:e.introduction)&&s.status===2)return ee(C("ranking.edit-tip"));b(!0);const{success:t}=await de({type:l.value?2:1,nickname:s.nickname,introduction:s.introduction,avatar:(r=i.value[i.value.length-1])==null?void 0:r.url});b(!1),t&&x()},x=async()=>{await j(),await z(),A(),T()};return Y(()=>{x()}),(t,e)=>{const r=p("van-icon"),g=p("van-uploader"),U=p("VanField"),O=p("van-loading"),Q=p("VanButton");return d(),v("div",fe,[o("div",ge,[u(ae),o("div",null,a(l.value?t.$t("ranking.join shop ranking"):t.$t("ranking.join talent ranking")),1)]),n(s).status==3?(d(),v("div",_e,[u(r,{name:"warning",color:"red",size:"1.125rem"}),o("div",be,[o("span",he,a(t.$t("ranking.Reason for review rejection")),1),o("span",null,a(n(s).denialReason),1)])])):$("",!0),o("div",ye,[o("div",ke,[o("div",we,[u(g,{disabled:"",deletable:!1,modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=_=>i.value=_),accept:"image/*","max-count":1,"preview-size":"90",afterRead:q},{default:F(()=>[xe]),_:1},8,["modelValue"])]),o("div",Ie,a(l.value?t.$t("ranking.shop name"):t.$t("ranking.my name")),1),o("div",$e,a(n(s).nickname),1),o("div",Fe,a(l.value?t.$t("ranking.shop introduction"):t.$t("ranking.my Introduction")),1),u(U,{disabled:n(s).status==1,modelValue:n(s).introduction,"onUpdate:modelValue":e[1]||(e[1]=_=>n(s).introduction=_),maxlength:"240",type:"textarea",row:3,class:"bg-[#F3F3F3] rounded-lg font-normal mb-3.5",placeholder:t.$t("shop.pleaseInput")+(l.value?t.$t("ranking.shop introduction"):t.$t("ranking.my Introduction"))},null,8,["disabled","modelValue","placeholder"])]),o("div",Ve,[o("div",Re,[o("div",Ce,a(t.$t("ranking.current level")),1),o("div",Be,[De,o("span",null,"V"+a(h.value),1)])]),o("div",Se,[o("div",Le,a(t.$t("ranking.Number of points")),1),n(E)?(d(),Z(O,{key:0,size:"14"})):(d(),v("div",Ne,a(n(V)(y.value,2)),1))]),o("div",je,[o("div",Ae,a(t.$t("ranking.Deposit MAI quantity")),1),o("div",null,a(n(V)(n(N))),1)]),l.value==0&&f.value?(d(),v("div",Ee,[o("div",Te,a(t.$t("ranking.Related stores")),1),o("div",null,a(f.value.storeName),1)])):$("",!0)])]),u(Q,{loading:n(S),disabled:!n(s).nickname||!n(s).introduction||!i.value.length,onClick:M,class:W(["w-[150px] h-[40px] text-white rounded-3xl flex-center m-auto mt-[50px]",n(s).status==1?"bg-[#D9D9D9]":"btn-orange"])},{default:F(()=>[ne(a(n(s).status==1?t.$t("ranking.apply await"):n(s).status==2?t.$t("common.edit"):n(s).status==3?t.$t("ranking.Re-apply"):t.$t("common.confirm")),1)]),_:1},8,["loading","disabled","class"])])}}}),Ke=H(ze,[["__scopeId","data-v-13d18ac6"]]);export{Ke as default};
