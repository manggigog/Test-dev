import{F as k,G as h,H as i,I as l,O as a,P as f,Q as g,Z as d,U as w,z as E,y as se,q as le,o as oe,x as ae,D as A,bl as ne,r as $,a2 as P,E as ie,bm as ce,$ as b,K as re,J as ue,a4 as de,T as fe}from"./vendor-Dr_RpJ_Y.js";import{k as O,a as pe,b as me,B as he,Y as ge,bD as ve,bU as xe,bV as ye,bW as _e}from"./index-7OiUoGXy.js";import{C as be}from"./CommonVanProvider-KZuKVOde.js";import{_ as ke}from"./EmptyTipsPop-DFfFg0cQ.js";import{_ as we,M as Ce}from"./MetaKeyTag-A7XrHmre.js";import{_ as $e}from"./ExpressMinutesTag-DqYOjPIv.js";import{R as Fe}from"./RatioBox-C8BvsGJW.js";import{B as U}from"./BoutiqueLabelInLogo-6zoXLJ5H.js";import{B as Se}from"./BetweenTab-nGcUWfRT.js";import"./BackIcon-CDrGaEPo.js";import"./useOrderStatus-CUBDjZMz.js";import"./shop-CeqcS6K2.js";/* empty css                                                               */const Ie={class:"pb-3"},Te={class:"w-full flex justify-start items-start px-3 bg-white p-3 rounded-xl"},Ve={class:"w-[60px] h-[60px] rounded-[4px] overflow-hidden flex-shrink-0 relative"},Ne=["src"],je={class:"absolute right-0 top-0"},Be={class:"ml-2 flex flex-col justify-between items-start w-full"},Ae={class:"flex items-center justify-start w-full"},Ee={class:"max-w-[calc(100%-66px)] text-base font-semibold text-black line-clamp-1 leading-[22px] flex-shrink-0"},qe={class:"flex items-center text-sm text-primary"},ze={class:"ml-1"},Le={class:"w-full flex justify-start items-center gap-1.5 overflow-x-auto h-[18px]"},Pe={props:{shop:{type:Object,required:!0}},setup(o){return(c,v)=>{const p=k("van-rate");return i(),h("div",Ie,[l("div",Te,[l("div",Ve,[l("img",{src:o.shop.logo||o.shop.scenery&&o.shop.scenery.split(",")[0]||a(O)("images/goods/defaultImg.png"),class:"w-[60px] h-[60px] object-cover"},null,8,Ne),l("div",je,[f(U,{type:o.shop.type},null,8,["type"])])]),l("div",Be,[l("div",Ae,[l("p",Ee,g(o.shop.storeName),1),f(Fe,{class:"ml-auto h-[22px]",tag:c.$t("common.rebate"),ratio:o.shop.discountRatio||0},null,8,["tag","ratio"])]),l("div",qe,[f(p,{class:"flex-shrink-0",readonly:"","allow-half":"",modelValue:o.shop.star,"onUpdate:modelValue":v[0]||(v[0]=F=>o.shop.star=F),size:16,gutter:"0",color:"#FEA021"},null,8,["modelValue"]),l("span",ze,g(o.shop.star),1)]),l("div",Le,[f(we,{type:o.shop.buyFlag?1:o.shop.watchFlag?2:o.shop.followFlag?3:0},null,8,["type"]),o.shop.recentExpressSeconds?(i(),d($e,{key:0,time:o.shop.recentExpressSeconds},null,8,["time"])):w("",!0),o.shop.metakeyFlag?(i(),d(Ce,{key:1})):w("",!0)])])])])}}},Re={class:"border-[0.5px] border-solid border-[#FF8812] rounded-sm px-1 py-0.5 text-[#FF8812] text-xxs font-normal min-w-fit"},R=E({props:{text:null},setup(o){return(c,v)=>(i(),h("div",Re,g(o.text),1))}}),Oe={class:"pb-3"},Ue={class:"w-full flex justify-start items-start px-3 bg-white p-3 rounded-xl"},De={class:"w-[60px] h-[60px] rounded-[4px] overflow-hidden flex-shrink-0 relative"},Me={class:"absolute right-0 top-0"},Ge={class:"ml-2 flex flex-col justify-between items-start w-full"},Ke={class:"flex items-center justify-start w-full"},He={class:"max-w-[calc(100%-66px)] text-base font-semibold text-black line-clamp-1 leading-[22px] flex-shrink-0"},Je=l("div",{class:"flex items-center text-sm text-primary"},null,-1),Qe={class:"w-full flex justify-start items-center gap-1.5 overflow-x-auto h-[18px] mt-1"},We={class:"mt-1 text-sm text-b3 font-normal line-clamp-1"},Ye={props:{shop:{type:Object,required:!0}},setup(o){const c=o,v=se(()=>{let p="";return c.shop.areaName1&&(p=c.shop.areaName1),c.shop.areaName2&&c.shop.areaName2!==c.shop.areaName1&&(p+=`-${c.shop.areaName2}`),p});return(p,F)=>{const S=k("van-image");return i(),h("div",Oe,[l("div",Ue,[l("div",De,[f(S,{width:"60",height:"60",src:o.shop.storeIcons&&o.shop.storeIcons.split(",")[0]||a(O)("images/goods/defaultImg.png"),class:"rounded-[4px] w-[60px] h-[60px]"},null,8,["src"]),l("div",Me,[f(U,{type:o.shop.type},null,8,["type"])])]),l("div",Ge,[l("div",Ke,[l("p",He,g(o.shop.storeName),1)]),Je,l("div",Qe,[f(R,{text:o.shop.goodsCategoryName1},null,8,["text"]),f(R,{text:a(v)},null,8,["text"])]),l("div",We,g(o.shop.storeAddress||""),1)])])])}}},Ze={class:"flex items-center justify-start gap-1"},Xe=["src"],et=l("span",{class:"text-b2 text-sm font-normal"},"取消",-1),tt=[et],st=l("span",{class:"text-b2 text-sm font-normal"},"编辑",-1),lt=[st],ot={class:"scrollPage p-3 h-[calc(100vh-83px)] overflow-y-auto"},at={class:"flex items-center justify-start"},nt={key:0,class:"flex-shrink-0 mr-3"},it={class:"w-full"},ct={key:0,class:"fixed bottom-0 left-0 right-0 bg-[#F5F5F5] p-3 pb-[calc(12px+env(safe-area-inset-bottom))] flex items-center justify-between"},rt={class:"flex-shrink-0 flex items-center justify-start gap-2 mr-3"},ut={key:0},dt=E({name:"shopsCollect"});function ft(o){const c=le(),v=oe(),{t:p}=ae(),{regionStore:F,accountStore:S}=pe(),{checkLoginAuth:D}=me(),M=[{label:p("shop.on-line"),value:1},{label:p("shop.off-line"),value:2}];A(()=>S.account,(e,s)=>{e&&e!==s&&(console.log("账号切换，清空列表"),setTimeout(()=>{location.reload()},50))}),A(()=>S.isLogin,(e,s)=>{e&&setTimeout(()=>{location.reload()},50)});const G=e=>{r.value=[],x.value=[],m.value=!1,I(!1),t.type=e||1,c.replace({query:{type:e}}),N()},t=ne({type:Number(v.query.type)||1,page:0,size:10,finished:!1,list:[],loading:!1,total:0}),r=$([]),x=$([]),q=$(null),m=$(!1),z=()=>{m.value?r.value=t.list.map(s=>t.type===2?s.collectId:s.shopId):r.value=[]},K=()=>{var e;(e=q.value)==null||e.toggle(),z()};A(r,e=>{console.log(e),e.length&&e.length>=t.list.length?m.value=!0:m.value=!1});const H=(e,s)=>{var u;C.value?(u=x.value[s])==null||u.toggle():c.push("/category?deliveryType=1&shopId="+e.shopId+"&activated=1")},J=(e,s)=>{var u;C.value?(u=x.value[s])==null||u.toggle():c.push("/storefront?storeId="+e.storeId+"&activated=1")},L=async()=>{t.loading=!0,t.page+=1,await Q(),t.loading=!1},Q=async()=>{let e=null;if(t.type===1&&(e=await ye({page:t.page,size:t.size})),t.type===2){const s=await _e({page:t.page,size:t.size,sortBy:"desc|create_time"});e={success:s.success,data:s.data.records||[],total:s.data.total||0}}if(!e.success){t.finished=!0;return}if(!e.data||!e.total){t.finished=!0;return}t.total=e.total,t.list=t.page===1?e.data:t.list.concat(e.data),m.value&&(r.value=t.list.map(s=>t.type===2?s.collectId:s.shopId)),t.list.length>=t.total&&(t.finished=!0)},N=()=>{t.page=0,t.total=0,t.finished=!1,t.list=[],L()},[C,I]=P(!1),[W,j]=P(!1),Y=async()=>{if(!r.value.length){fe("请选择要移除的店铺");return}let e=null;t.type===1?e=await ve({shopIds:r.value||[],type:2}):e=await xe({ids:r.value||[]}),e.success&&(N(),j(!0),r.value=[],x.value=[],m.value=!1),setTimeout(()=>{j(!1)},1e3)};let T=null;const Z=async()=>{const e=localStorage.getItem("shopsCollect_scrollTop");+e?(console.log("setCacheScrollTop",+e),T.scrollTo({top:+e,left:0,behavior:"instant"})):localStorage.removeItem("shopsCollect_scrollTop")},B=$(!1),X=()=>{B.value||(B.value=!0,setTimeout(()=>{localStorage.setItem("shopsCollect_scrollTop",T.scrollTop+""),B.value=!1},500))};return ie(()=>{T=document.querySelector(".scrollPage"),T.addEventListener("scroll",X)}),ce(async()=>{var e,s,u,V;D(!0)&&(Z(),!(((V=(u=(s=(e=c==null?void 0:c.options)==null?void 0:e.history)==null?void 0:s.state)==null?void 0:u.forward)==null?void 0:V.indexOf("activated=1"))>-1&&t.list.length)&&(r.value=[],x.value=[],m.value=!1,I(!1),N()))}),(e,s)=>{const u=k("van-checkbox"),V=k("van-checkbox-group"),ee=k("van-list"),te=k("VanButton");return i(),d(be,{class:"bg-[#F5F5F5] font-Puhui font-normal relative shopGoodsPage",title:"店铺收藏","theme-vars":{"field-placeholder-text-color":"#F5F5F5"},ref:(n,_)=>{_.shopsCollectRef=n}},{title:b(()=>[l("div",Ze,[l("div",null,[l("img",{src:a(ge)(`mall/${a(F).country}-flag.svg`),class:"w-4 h-auto"},null,8,Xe)]),l("span",null,g(e.$t("collect.shopsCollect")),1)])]),right:b(()=>[l("div",null,[a(C)===!0?(i(),h("div",{key:0,onClick:s[0]||(s[0]=n=>a(I)(!1))},tt)):(i(),h("div",{key:1,onClick:s[1]||(s[1]=n=>a(I)(!0))},lt))])]),default:b(()=>[l("div",null,[f(Se,{class:"between-tab__wrap",options:M,"label-key":"label","value-key":"value",modelValue:a(t).type,"onUpdate:modelValue":s[2]||(s[2]=n=>a(t).type=n),onChange:G},null,8,["modelValue"]),l("div",ot,[a(t).list.length===0&&!a(t).loading?(i(),d(he,{key:0,name:e.$t("common.No data yet")},null,8,["name"])):(i(),d(ee,{key:1,loading:a(t).loading,"onUpdate:loading":s[4]||(s[4]=n=>a(t).loading=n),"finished-text":e.$t("common.noMore"),"loading-text":e.$t("common.loading"),finished:a(t).finished,onLoad:L,"immediate-check":!0},{default:b(()=>[(i(!0),h(ue,null,re(a(t).list,(n,_)=>(i(),d(V,{key:n.shopId||n.collectId,modelValue:r.value,"onUpdate:modelValue":s[3]||(s[3]=y=>r.value=y),"checked-color":"#FEA021","icon-size":"16"},{default:b(()=>[l("div",at,[a(C)?(i(),h("div",nt,[a(t).type===2?(i(),d(u,{key:0,name:n.collectId,ref:y=>x.value[_]=y},null,8,["name"])):(i(),d(u,{key:1,name:n.shopId,ref:y=>x.value[_]=y},null,8,["name"]))])):w("",!0),l("div",it,[a(t).type===2?(i(),d(Ye,{key:0,shop:n,onClick:y=>J(n,_)},null,8,["shop","onClick"])):(i(),d(Pe,{key:1,shop:n,onClick:y=>H(n,_)},null,8,["shop","onClick"]))])])]),_:2},1032,["modelValue"]))),128))]),_:1},8,["loading","finished-text","loading-text","finished"]))])]),a(C)?(i(),h("div",ct,[l("div",rt,[f(u,{modelValue:m.value,"onUpdate:modelValue":s[5]||(s[5]=n=>m.value=n),"checked-color":"#FEA021","icon-size":"16",ref:n=>q.value=n,onClick:z},null,8,["modelValue"]),l("span",{class:"text-b3 text-sm font-normal",onClick:K},"全选")]),f(te,{class:"main-btn flex-center text-white font-semibold rounded-full !bg-[#f44] text-base w-full h-[46px]",onClick:Y},{default:b(()=>[de(g(e.$t("common.delete"))+" ",1),r.value.length>0?(i(),h("span",ut," ("+g(r.value.length)+") ",1)):w("",!0)]),_:1})])):w("",!0),a(W)?(i(),d(ke,{key:1,isError:!1,onClose:s[6]||(s[6]=n=>a(j)(!1)),text:"删除成功"})):w("",!0)]),_:1},512)}}const Ft=E({...dt,setup:ft});export{Ft as default};
