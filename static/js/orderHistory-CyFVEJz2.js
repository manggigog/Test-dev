import{B as z}from"./BackIcon-biFt6cm7.js";import{_ as G}from"./TimeFilter-CGMRTQ41.js";import{_ as D,y as E,r as u,x as q,l as Z,D as R,E as B,F as a,G as n,H as t,a3 as J,O as x,Q as s,P as i,I as F,J as L,a2 as I,B as C,a0 as j,w as Q,a1 as W,N as Y,Y as K,Z as X}from"./vendor-BUT0HZ5j.js";import{u as tt,p as et}from"./useOrderStatus-BSCfQVBG.js";import{P as st}from"./order-H59PKTFP.js";import{b as M,d as $,f as ot,u as at,c as nt}from"./index-hbwLMIYO.js";import{u as lt}from"./useRefundStatus-DsYoZX36.js";import{P}from"./flashSale-DDyqLyYN.js";import{A as rt,l as dt}from"./order-CKUhc8Y9.js";const it={class:"pb-0 bg-white rounded-xl"},ct={class:"flex justify-between"},ut={class:"flex-start"},mt={class:"ml-1 font-semibold text-base leading-[22px] text-[#2e2008]"},ft={class:"font-semibold text-sm leading-[20px] text-primary whitespace-nowrap"},_t={class:"flex w-full gap-2"},ht={class:"flex-1 flex flex-col min-h-[5rem] justify-between"},xt={class:"flex items-baseline justify-between w-full font-semibold"},vt={class:"w-full text-base line-clamp-2 leading-[22px] font-semibold flex flex-row justify-between items-center"},pt={class:"max-w-[140px] text-ellipsis overflow-hidden line-clamp-1"},yt={class:"flex justify-end text-sm font-normal text-[#a6a6a6]"},wt={key:0},bt={key:0},St={key:1},$t={key:1},gt={key:0},At={key:1},kt=j(" ) "),Tt={class:"mt-1 text-sm min-w-fit font-normal text-[#a6a6a6]"},Ct={key:0,class:"flex justify-end opacity-60 text-[#FD5520] text-sm"},It={key:1,class:"flex justify-end opacity-60 text-[#FD5520] text-sm"},jt={key:2,class:"flex justify-end opacity-60 text-[#FD5520] text-sm"},Nt=E({props:["order"],setup(e){const p=e,y=u(null);q(()=>1/y.value);const w=async()=>{const{mcoinRate:r}=ot();y.value=await r()};Z();const g=tt(p.order.refundStatus,p.order.payType),b=r=>{const v=new C(r.price).times(r.number).minus(r.goodsActivityReduceAmount||0).plus(r.goodsAdjustChangeAmount||0).toNumber();return $(v||0)};return R(async()=>{await w()}),(r,v)=>{const f=B("VanImage");return n(),a("div",it,[t("div",ct,[t("div",ut,[x(f,{src:e.order.stores&&e.order.stores.logo,class:"store-logo w-[30px] h-[30px] overflow-hidden rounded-[50%]",alt:"",round:"",fit:"cover"},null,8,["src"]),t("div",mt,s(i(M)(e.order.userAddress.address,"...",5,5)),1)]),t("div",ft,s(i(g)[e.order.status+""]),1)]),(n(!0),a(F,null,L(e.order.orderGoods,o=>{var m,_;return n(),a("div",{class:"mt-2",key:o.goodsName},[t("div",_t,[x(f,{src:(o.icons||"").split(",")[0],class:"min-w-20 w-20 h-20 overflow-hidden rounded-lg",alt:o.goodsName,title:o.goodsName,fit:"cover"},null,8,["src","alt","title"]),t("div",ht,[t("div",null,[t("div",xt,[t("div",vt,[t("div",pt,s(o.goodsName),1),t("div",null,[t("div",yt,[+e.order.paySource!==i(st).USDT_WALLET?(n(),a("div",wt,[e.order.payType===i(P).STORE_CARD?(n(),a("span",bt,s(i($)(+new i(C)(o.cardPrice).times(o.number??1)||0))+s((m=e.order.fmStoredCard)==null?void 0:m.symbol),1)):(n(),a("span",St,s(b(o))+" Mcoin",1))])):(n(),a("div",$t,[j(s(i($)(e.order.totalUsdt))+"USDT(",1),e.order.payType===i(P).STORE_CARD?(n(),a("span",gt,s(i($)(+new i(C)(o.cardPrice).times(o.number??1)||0))+s((_=e.order.fmStoredCard)==null?void 0:_.symbol),1)):(n(),a("span",At,"("+s(b(o))+" Mcoin)",1)),kt]))])])])]),t("div",Tt,s(r.$t("order.quantity",{number:o.number||0})),1)]),(e.order.status===5||e.order.refundStatus===3)&&e.order.refundStatus<10?(n(),a("div",Ct,s(r.$t("refund.refund success tips")),1)):e.order.refundStatus!=null&&e.order.status===1&&e.order.refundStatus===4?(n(),a("div",It,s(r.$t("refund.refund reject")),1)):I("",!0),e.order.refundStatus!=null?(n(),a("div",jt,s(i(lt)(e.order.refundStatus)),1)):I("",!0)])])])}),128)),J(r.$slots,"default",{},void 0,!0)])}}}),Pt=D(Nt,[["__scopeId","data-v-1cb2b6bf"]]),Dt=e=>(K("data-v-7931f4d3"),e=e(),X(),e),Et={class:"w-full bg-[#F2F0EF]",style:{"background-image":"none"}},Rt={class:"header-bar sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50"},Bt={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},Ft={class:"font-semibold"},Lt={class:"list-content pt-2 px-4"},Mt={class:"total__wrap w-full flex flex-row justify-between gap-2"},Ot={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},Ut={class:"text-xs font-normal text-default"},Vt={class:"text-left mt-1"},Ht={class:"num-value text-2xl font-semibold text-left"},zt={class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},Gt={class:"total__item w-[50%] h-[74px] bg-white rounded-xl"},qt={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},Zt={class:"text-xs font-normal text-default"},Jt={class:"text-left mt-1"},Qt={class:"num-value text-2xl font-semibold text-left"},Wt=Dt(()=>t("span",{class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},"Mcoin",-1)),Yt={class:"list__wrap mt-3 w-full h-[calc(100vh-174px)] z-50 overflow-y-auto scroll-smooth"},Kt={class:"bottom__wrap mt-2 w-full flex flex-row justify-between items-center"},Xt={class:"text-sm font-normal text-[#a6a6a6]"},te={class:"text-newOrigin text-sm font-normal"},ee={key:0},se={key:0},oe={key:1},ae=j(" Mcoin "),ne=E({setup(e){const{t:p}=Q(),y=W(),{getCurrentStoreId:w}=at(),g=20,b=p("order.history_order_title"),r=u(y.query.address),v=u(`${M(r.value,"...",5,5)||""}${b}`);document.title=v.value;const f=u({orderAmount:0,orderCount:0}),o=u([]),m=u(!1),_=u(!1),S=u(0),A=u(null),k=u(null),O=()=>{S.value=0,o.value=[],_.value=!1},U=async()=>{var h,d,T;const c={status:4,type:1,historyAddress:r.value,storeId:(h=await w())==null?void 0:h.id},l=await rt(c);l.success&&(f.value={orderAmount:((d=l==null?void 0:l.data)==null?void 0:d.orderAmount)||0,orderCount:((T=l==null?void 0:l.data)==null?void 0:T.orderCount)||0})},V=async()=>{var h;const c={page:S.value,size:g,type:1,status:4,historyAddress:r.value,storeId:(h=await w())==null?void 0:h.id,createStartTime:A.value,createEndTime:k.value},l=await dt(c);if(m.value=!1,!l.success||!l.data||!l.total){_.value=!0;return}o.value=S.value===1?l.data:[...o.value,...l.data],_.value=o.value.length>=l.total},N=async()=>{m.value=!0,S.value+=1,await V(),m.value=!1},H=c=>{c&&c[0]&&c[1]?[A.value,k.value]=c:(A.value=null,k.value=null),O(),N()};return R(()=>{U()}),(c,l)=>{const h=B("van-list");return n(),a("div",Et,[t("section",Rt,[t("div",Bt,[x(z)]),t("div",Ft,s(v.value),1)]),t("section",Lt,[t("div",Mt,[t("div",Ot,[t("p",Ut,s(c.$t("order.history_order_count")),1),t("p",Vt,[t("span",Ht,s(f.value.orderCount),1),t("span",zt,s(c.$t("common.order_count_suffix")),1)])]),t("div",Gt,[t("div",qt,[t("p",Zt,s(c.$t("order.history_transaction_count")),1),t("p",Jt,[t("span",Qt,s(i(nt)(f.value.orderAmount)),1),Wt])])])]),x(G,{"allow-reverse":"",onChange:H}),t("div",Yt,[x(h,{loading:m.value,"onUpdate:loading":l[0]||(l[0]=d=>m.value=d),finished:_.value,"finished-text":"没有更多了",onLoad:N},{default:Y(()=>[(n(!0),a(F,null,L(o.value,(d,T)=>(n(),a("div",{key:d.id,class:"list__item w-full min-h-[132px] rounded-xl bg-white p-3"},[x(Pt,{order:d},null,8,["order"]),t("div",Kt,[t("p",Xt,s(i(et)(+d.paySource)),1),t("p",te,[d.totalUsdt?(n(),a("span",ee,[t("span",null,s(d.totalUsdt)+"USDT",1),d.totalAmount?(n(),a("span",se,"("+s(d.totalAmount)+" Mcoin)",1)):I("",!0)])):(n(),a("span",oe,[t("span",null,s(d.totalAmount),1),ae]))])])]))),128))]),_:1},8,["loading","finished"])])])])}}}),he=D(ne,[["__scopeId","data-v-7931f4d3"]]);export{he as default};
