import{_ as ve,z as fe,x as he,a2 as j,y as X,j as Y,r as u,bl as ye,D as Te,F as w,G as v,H as f,I as s,P as c,$ as h,Q as i,bv as we,O as n,U as ge,J as D,K,N as k,a3 as W,a0 as O,X as be,Y as Ce}from"./vendor-Dr_RpJ_Y.js";import{_ as _e}from"./search-C4fLtTfY.js";import{_ as De}from"./filter-DRLh1k_O.js";import{a as ke}from"./category-D2HQzb2Y.js";import{u as Se,a as xe,aA as S}from"./index-BckdT6oc.js";import{D as I}from"./goods-BVwS8oFG.js";import{S as $e}from"./shop-CeqcS6K2.js";const Z=p=>(be("data-v-4f4218b8"),p=p(),Ce(),p),Ve={class:"flex items-center"},Ye={class:"flex-1 bg-white rounded-3xl search-input-box"},Ie=Z(()=>s("div",null,[s("img",{src:_e,class:"w-4 h-4"})],-1)),Me=Z(()=>s("img",{src:De,class:"w-full h-full"},null,-1)),Ee=[Me],Fe={class:"px-5"},Ue={class:"mt-[18px] font-semibold text-base text-center"},Be={class:"text-sm font-semibold mt-4"},Le={class:"flex items-center gap-2 mt-3"},Ne=["onClick"],Pe={class:"text-sm font-semibold mt-4"},je={class:"flex items-center gap-2 mt-3 overflow-x-auto"},Ke=["onClick"],Oe={class:"mt-3 flex-start"},Re={class:"mx-2"},Ae={class:"text-sm font-semibold mt-4"},ze={class:"flex flex-wrap items-center gap-3 mt-3"},Ge=["onClick"],qe={class:"pt-8 pb-4 flex-center-bw"},He={class:"text-base font-normal"},Je={class:"text-base font-semibold"},Qe=fe({props:{modelValue:null,deliveryType:{default:I.online},shopType:null,shopInfo:null},emits:["update:modelValue","onSubmit","onFilter"],setup(p,{emit:x}){const r=p,{getCurrentStoreId:ee}=Se(),{serviceCategoriesStore:te}=xe(),{t:y}=he(),[M,$]=j(!1),R=X(()=>r!=null&&r.shopType?[{id:-1,name:y("common.all")},{id:$e.SD,name:y("common.ordinary")},{id:r==null?void 0:r.shopType,name:y(`common.shop_type_${r==null?void 0:r.shopType}`)}]:[]),A=Y().format("YYYY-MM-DD"),E=Y().subtract("days",7).format("YYYY-MM-DD"),F=Y().subtract("month",1).format("YYYY-MM-DD"),U=Y().subtract("month",3).format("YYYY-MM-DD"),oe=X(()=>[{id:1,label:y("shop.Last 7 days")},{id:2,label:y("shop.last month")},{id:3,label:y("shop.last 3 months")}]),[B,L]=j(!1),[N,V]=j(!1),d=u(new Date),g=u(new Date),se=u(new Date(new Date("2020/1/1").getTime())),b=u(new Date(new Date("2020/1/1").getTime())),l=ye({startTime:null,endTime:null}),z=u(null),le=()=>{x("onSubmit"),z.value.blur()},ne=()=>{l.startTime=null,l.endTime=null,T.value=null,C.value=null,d.value=new Date,g.value=new Date,_.value=-1,q()},G=()=>{L(!1),V(!1),(!l.startTime||!l.endTime)&&(l.endTime=null,l.startTime=null)},ae=e=>{d.value=new Date(S(e)),b.value=new Date(new Date(e).getTime()),l.startTime=S(d.value.toString()),T.value=null,L(!1),V(!0)},ie=e=>{g.value=new Date(S(e)),l.startTime=S(d.value.toString()),l.endTime=S(e),T.value=null,V(!1)},T=u(null),re=e=>{if(T.value!==e){switch(g.value=new Date(A),l.endTime=A,e){case 1:l.startTime=E,d.value=new Date(E),b.value=new Date(new Date(E).getTime()+60*1e3);break;case 2:l.startTime=F,d.value=new Date(F),b.value=new Date(new Date(F).getTime()+60*1e3);break;case 3:l.startTime=U,d.value=new Date(U),b.value=new Date(new Date(U).getTime()+60*1e3);break}T.value=e}},P=u([]),C=u(null),_=u(-1),de=async()=>{var t;const e=await ke({address:(t=await ee())==null?void 0:t.merchant});P.value=(e.data||[]).map(m=>({...m,goodsCategoryName:m==null?void 0:m.name,goodsCategoryId:m==null?void 0:m.id}))},me=e=>{C.value!==e&&(C.value=e)},q=()=>{const e={upStartTime:l.startTime?l.startTime+" 00:00:00":null,upEndTime:l.endTime?l.endTime+" 23:59:59":null,subclassId:C.value,type:_.value};_.value<0&&delete e.type,x("onFilter",e),$(!1)};return Te(()=>r.deliveryType,e=>{e===I.online?de():P.value=te.categoriesTree},{immediate:!0}),(e,t)=>{const m=w("VanField"),H=w("van-datetime-picker"),J=w("van-popup"),ue=w("van-icon"),Q=w("VanButton"),ce=w("VanPopup");return f(),v(D,null,[s("div",Ve,[s("div",Ye,[c(m,{ref:(a,o)=>{o.searchRef=a,z.value=a},onKeyup:we(le,["enter"]),"model-value":p.modelValue,"onUpdate:modelValue":t[1]||(t[1]=a=>x("update:modelValue",a)),placeholder:e.$t("mall.Enter search keywords"),class:"w-[100% - 20px] text-center bg-transparent items-center",clearable:"",enterkeyhint:"search"},{"left-icon":h(()=>[Ie]),"right-icon":h(()=>[s("div",{onClick:t[0]||(t[0]=a=>x("onSubmit")),class:"text-newOrigin font-semibold leading-5"},i(e.$t("common.search")),1)]),_:1},8,["onKeyup","model-value","placeholder"])]),s("div",{class:"flex-shrink-0 w-5 h-5 ml-2",onClick:t[2]||(t[2]=a=>n($)(!0))},Ee)]),c(ce,{teleport:"body",show:n(M),"onUpdate:show":t[9]||(t[9]=a=>O(M)?M.value=a:null),round:"",position:"bottom",closeable:"",style:{"min-height":"40%","min-width":"280px",left:"50%",transform:"translate3d(-50%, 0, 0)"},class:"sm:w-[375px]","close-on-click-overlay":"",onClickOverlay:t[10]||(t[10]=a=>n($)(!1)),onClickCloseIcon:t[11]||(t[11]=a=>n($)(!1))},{default:h(()=>{var a;return[s("div",Fe,[s("div",Ue,i(p.deliveryType===n(I).online?e.$t("shop.Product filter"):e.$t("offline.goods_filter")),1),(a=n(R))!=null&&a.length?(f(),v(D,{key:0},[s("div",Be,i(p.deliveryType===n(I).online?e.$t("shop.Shop goods type"):e.$t("offline.goods_type")),1),s("div",Le,[(f(!0),v(D,null,K(n(R),o=>(f(),v("div",{key:o.id,class:k(["flex-1 type-cell",{"cell-active":o.id===_.value}]),onClick:()=>{_.value=o.id}},i(o.name),11,Ne))),128))])],64)):ge("",!0),s("div",Pe,i(e.$t("shop.Added time")),1),s("div",je,[(f(!0),v(D,null,K(n(oe),o=>(f(),v("div",{class:k(["type-cell flex-1",{"cell-active":T.value==o.id}]),key:o.id,onClick:pe=>re(o.id)},i(o.label),11,Ke))),128))]),s("div",Oe,[s("div",{class:"van-cell p-0 flex justify-center type-cell",onClick:t[3]||(t[3]=W(o=>n(L)(!0),["stop"]))},[s("div",{class:k({"opacity-30":!n(l).startTime})},i(n(l).startTime||e.$t("goods.selectStartTime")),3)]),c(J,{show:n(B),"onUpdate:show":t[5]||(t[5]=o=>O(B)?B.value=o:null),position:"bottom",round:"",style:{height:"50%"},"close-on-click-overlay":!1,teleport:"body"},{default:h(()=>[c(H,{modelValue:d.value,"onUpdate:modelValue":t[4]||(t[4]=o=>d.value=o),"min-date":se.value,type:"date",title:e.$t("goods.selectStartTime"),onCancel:G,onConfirm:ae},null,8,["modelValue","min-date","title"])]),_:1},8,["show"]),s("div",Re,[c(ue,{name:"minus"})]),s("div",{class:"van-cell p-0 flex justify-center type-cell",onClick:t[6]||(t[6]=W(o=>n(V)(!0),["stop"]))},[s("div",{class:k({"opacity-30":!n(l).endTime})},i(n(l).endTime||e.$t("goods.selectEndTime")),3)]),c(J,{show:n(N),"onUpdate:show":t[8]||(t[8]=o=>O(N)?N.value=o:null),position:"bottom",round:"",style:{height:"50%"},"close-on-click-overlay":!1,teleport:"body"},{default:h(()=>[c(H,{modelValue:g.value,"onUpdate:modelValue":t[7]||(t[7]=o=>g.value=o),onConfirm:ie,"min-date":b.value,onCancel:G,type:"date",title:e.$t("goods.selectEndTime")},null,8,["modelValue","min-date","title"])]),_:1},8,["show"])]),s("div",Ae,i(e.$t("shop.Shop Category")),1),s("div",ze,[(f(!0),v(D,null,K(P.value,o=>(f(),v("div",{class:k(["px-3 type-cell",{"cell-active":C.value==o.goodsCategoryId}]),key:o.goodsCategoryId,onClick:pe=>me(o.goodsCategoryId)},i(o.goodsCategoryName),11,Ge))),128))]),s("div",qe,[c(Q,{round:"",class:"!border-b4 text-b1 flex-1 h-[46px] mr-3",onClick:ne},{default:h(()=>[s("span",He,i(e.$t("common.reset")),1)]),_:1}),c(Q,{round:"",class:"btn-yellow flex-1 h-[46px] border-0",onClick:q},{default:h(()=>[s("span",Je,i(e.$t("common.confirm")),1)]),_:1})])])]}),_:1},8,["show"])],64)}}}),lt=ve(Qe,[["__scopeId","data-v-4f4218b8"]]);export{lt as S};
