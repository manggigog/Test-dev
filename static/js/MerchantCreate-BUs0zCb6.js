import{_ as $e,y as se,w as Ee,a1 as Fe,l as Ie,r as b,x as Se,be as L,D as Be,E as C,K as S,G as h,N as i,H as s,F as w,a2 as _,O as p,Q as u,R as y,P as r,a4 as k,bG as Z,bF as J,a0 as A,br as W,Y as Ve,Z as Ne,T as $}from"./vendor-BUT0HZ5j.js";import{_ as Le,C as Ae,a as ae}from"./CategoryPop-w2COQ4fO.js";import{_ as le}from"./right-arrow-D3mVT5UK.js";import{u as ee}from"./upload-GisNQoOq.js";import{e as Pe,u as Te,r as De,V as P,_ as Ue,S as ze,X as je,aL as Me,aQ as qe,a2 as te,q as oe}from"./index-hbwLMIYO.js";import{i as T}from"./offlineGoods-DvT2Go6q.js";import"./BackIcon-biFt6cm7.js";import"./search-Dwmdj_3F.js";import"./checked-C0ib8aDP.js";const B=E=>(Ve("data-v-0a30569c"),E=E(),Ne(),E),Re={class:"bg-white rounded-xl overflow-hidden mx-3 px-3 pb-4 title"},Ge={class:"border-b4 border-b border-solid"},Oe={class:"text-sm text-[#2E2008] font-semibold"},Ke={class:"border-b4 border-b border-solid"},Qe={class:"text-sm text-[#2E2008] font-semibold"},He={key:0,class:"border-b4 border-b border-solid"},Xe={class:"text-sm text-[#2E2008] font-semibold"},Ye={key:1,class:"border-b4 border-b border-solid"},Ze={class:"text-sm text-[#2E2008] font-semibold"},Je={class:"flex justify-between items-center pt-4"},We={class:"text-sm text-[#2E2008] font-semibold"},et={class:"van-uploader__wrapper gap-3"},tt=["onClick"],ot={class:"van-image van-uploader__preview-image",style:{width:"60px",height:"60px","border-radius":"6px"}},st=["src"],at=["onClick"],lt=B(()=>s("img",{class:"w-[15px] h-[15px]",src:ae,alt:""},null,-1)),nt=[lt],it={class:"w-[60px] h-[60px] bg-b5 rounded-xl text-center flex flex-col justify-center items-center text-[#d9d9d9]"},dt=["src"],ut={class:"text-xs font-light text-center text-b1 opacity-30"},rt={class:"bg-white rounded-xl overflow-hidden m-3 px-3 title"},ct={class:"border-b4 border-b border-solid"},pt={class:"text-sm text-[#2E2008] font-semibold"},gt={key:0},mt={class:"text-sm text-[#2E2008] font-semibold"},vt={key:1,class:"flex justify-between items-center py-4"},ft={class:"text-sm text-[#2E2008] font-semibold"},ht={class:"van-uploader__wrapper gap-3"},bt=["onClick"],_t={class:"van-image van-uploader__preview-image",style:{width:"60px",height:"60px","border-radius":"6px"}},xt=["src"],yt=["onClick"],Ct=B(()=>s("img",{class:"w-[15px] h-[15px]",src:ae,alt:""},null,-1)),wt=[Ct],kt={class:"w-[60px] h-[60px] bg-b5 rounded-xl text-center flex flex-col justify-center items-center text-[#d9d9d9]"},$t=["src"],Et={class:"text-xs font-light text-center text-b1 opacity-30"},Ft={class:"bg-white rounded-xl overflow-hidden m-3 px-3 pb-4 title"},It={class:"border-b4 border-b border-solid"},St={class:"text-sm text-[#2E2008] font-semibold"},Bt=B(()=>s("img",{class:"shrink-0 ml-[2px] w-4 h-4",src:le,alt:""},null,-1)),Vt={class:"border-b4 border-b border-solid"},Nt={class:"text-sm text-[#2E2008] font-semibold"},Lt=B(()=>s("img",{class:"shrink-0 ml-[2px] w-4 h-4",src:le,alt:""},null,-1)),At={class:"text-sm text-[#2E2008] font-semibold pt-4"},Pt={class:"bg-white rounded-xl overflow-hidden m-3 px-3 py-4 title"},Tt={class:"text-sm text-[#2E2008] font-semibold"},Dt={key:0,class:"fixed bottom-0 left-0 w-full flex items-center px-3 pt-4 safe-bottom justify-evenly gap-x-3 btn-wrapper"},Ut={class:"p-1"},zt={class:"text-sm text-center text-[#2E2008] font-semibold"},jt={class:"flex items-center justify-between mt-6"},Mt=se({name:"MerchantCreate"});function qt(E){const{t:g}=Ee(),{accountStore:ne,serviceCategoriesStore:D}=Pe(),{getCurrentStoreId:U}=Te(),{loadingToggle:z}=De(),ie=Fe(),de=Ie(),o=b({shopName:null,goodsCategoryId1:null,goodsCategoryName1:null,goodsCategoryId2:null,goodsCategoryName2:null,goodsCategoryId3:null,goodsCategoryName3:null,goodsCategoryId:null,shopPics:"",linkType:"1",customerServiceLink:null,linkPics:null,dituxuandian:null,suozaidiqu:null,address:null,remark:null}),j=Se(()=>!1),m=b([]),v=b([]),M=b([]),f=b(1),q=b(null),[ue,R]=L(!1),[F,G]=L(!1),[re,V]=L(!1),I=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,a=e==="x"?t:t&3|8;return a.toString(16)}),O=e=>{let t=!1;const a=T.split(",");for(let c=0;c<a.length;c++)if(console.log(e==null?void 0:e.type,a[c]),(e==null?void 0:e.type)===a[c]){t=!0;break}return t||x(g("common.uploadImgTypeTips",{format:a.map(c=>c.slice(6).toLocaleUpperCase()).join("/")})),t},K=b(3),ce=async e=>{if(m.value.length>=K.value||!O(e.file))return;$.loading({message:g("common.uploading"),forbidClick:!0,duration:0});const t=await te(e,"goodsDesc"),a=await ee(t);$.clear(),a.success&&m.value.push({id:I(),url:oe.imgUrl+a.data})},pe=e=>{m.value.splice(e,1)},ge=e=>{W({images:m.value.map(t=>t.url),startPosition:e})},Q=b(1),me=async e=>{if(v.value.length>=Q.value||!O(e.file))return;$.loading({message:g("common.uploading"),forbidClick:!0,duration:0});const t=await te(e,"goodsDesc"),a=await ee(t);$.clear(),a.success&&v.value.push({id:I(),url:oe.imgUrl+a.data})},ve=e=>{v.value.splice(e,1)},fe=e=>{W({images:v.value.map(t=>t.url),startPosition:e})},N=(e,t,a)=>{M.value=Me(D.fullCategories,{idKey:"goodsCategoryId",parentKey:"goodsCategoryParentId",rootId:t}),q.value=e,f.value=a,G(!0)},he=(e,t)=>{if(o.value[`goodsCategoryId${f.value}`]=e,o.value[`goodsCategoryName${f.value}`]=t,f.value<3)for(let a=f.value;a<3;a++)o.value[`goodsCategoryId${a+1}`]=null,o.value[`goodsCategoryName${a+1}`]=null},x=(e="",t="toast-warn.svg")=>{$({message:e,icon:P(t),duration:2e3,overlay:!0,overlayClass:"toastOverlay",className:"toastCard",type:"html"})},be=()=>o.value.shopName?!0:(x(g("offline.offline_name_placeholder")),!1),_e=async()=>{var a;const e=m.value.map(c=>c.url),t=v.value.map(c=>c.url);o.value.goodsPics=e.join(","),o.value.linkPics=t.join(","),o.value.shopId=(a=await U())==null?void 0:a.id},xe=async()=>{if(!be())return;if(!o.value.goodsCategoryId1)return x(g("shop.pleaseSelect")+g("offline.one_category"));if(!o.value.goodsCategoryId2)return x(g("shop.pleaseSelect")+g("offline.two_category"));if(!o.value.goodsCategoryId3)return x(g("shop.pleaseSelect")+g("offline.three_category"));R(!0),await _e();const{success:e,data:t}=await qe(o.value);R(!1),e&&(o.value.goodsId=t,x("添加成功","toast-success.svg"),setTimeout(()=>{var a;de.replace({path:"/offlineGoodsDetail",query:{goodsId:(a=o.value)==null?void 0:a.goodsId}})},2e3))},ye=async()=>{var a;const e=(a=ie.query)==null?void 0:a.goodsId;if(!e)return;const t=await je(e.toString(),!0);t.success&&(o.value=t.data,o.value.goodsId=e.toString(),o.value.shopPics&&(m.value=o.value.shopPics.split(",").map(c=>({id:I(),url:c}))),o.value.linkPics&&(v.value=o.value.linkPics.split(",").map(c=>({id:I(),url:c}))))},Ce=async()=>{var a;const{success:e,data:t}=await ze((a=await U())==null?void 0:a.merchant)};return Be(async()=>{z(!0),D.init(),await Ce(),ye(),z(!1)}),(e,t)=>{const a=C("van-field"),c=C("van-uploader"),H=C("van-radio"),we=C("van-radio-group"),ke=C("VanButton");return h(),S(Ae,{title:e.$t("添加新店"),class:"font-Puhui font-normal relative pb-20 bg-gray1",themeVars:{navBarBackgroundColor:"#F2F0EF"}},{default:i(()=>{var X,Y;return[s("div",Re,[s("div",Ge,[p(a,{"input-align":"right",maxlength:12,modelValue:o.value.shopName,"onUpdate:modelValue":t[0]||(t[0]=l=>o.value.shopName=l),placeholder:e.$t("shop.emptyName"),class:"no-bt"},{label:i(()=>[s("div",Oe,u(e.$t("shop.shopName")),1)]),_:1},8,["modelValue","placeholder"])]),s("div",Ke,[p(a,{"input-align":"right",autocomplete:"off",class:"no-bt",onClick:t[1]||(t[1]=l=>{var n;return N((n=o.value)==null?void 0:n.goodsCategoryId1,0,1)})},{label:i(()=>[s("div",Qe,u(e.$t("offline.one_category")),1)]),input:i(()=>{var l,n,d;return[s("div",{class:y(["dropdown text-b3",{"!text-b2":(l=o.value)==null?void 0:l.goodsCategoryId1,"down-active":f.value===1&&r(F)}])},u((n=o.value)!=null&&n.goodsCategoryId1?(d=o.value)==null?void 0:d.goodsCategoryName1:e.$t("shop.emptyClass")),3)]}),_:1})]),(X=o.value)!=null&&X.goodsCategoryId1?(h(),w("div",He,[p(a,{"input-align":"right",autocomplete:"off",class:"no-bt",onClick:t[2]||(t[2]=l=>{var n,d;return N((n=o.value)==null?void 0:n.goodsCategoryId2,(d=o.value)==null?void 0:d.goodsCategoryId1,2)})},{label:i(()=>[s("div",Xe,u(e.$t("offline.two_category")),1)]),input:i(()=>{var l,n,d;return[s("div",{class:y(["dropdown text-b3",{"!text-b2":(l=o.value)==null?void 0:l.goodsCategoryId2,"down-active":f.value===2&&r(F)}])},u((n=o.value)!=null&&n.goodsCategoryId2?(d=o.value)==null?void 0:d.goodsCategoryName2:e.$t("shop.emptyClass")),3)]}),_:1})])):_("",!0),(Y=o.value)!=null&&Y.goodsCategoryId2?(h(),w("div",Ye,[p(a,{"input-align":"right",autocomplete:"off",class:"no-bt",onClick:t[3]||(t[3]=l=>{var n,d;return N((n=o.value)==null?void 0:n.goodsCategoryId3,(d=o.value)==null?void 0:d.goodsCategoryId2,3)})},{label:i(()=>[s("div",Ze,u(e.$t("offline.three_category")),1)]),input:i(()=>{var l,n,d;return[s("div",{class:y(["dropdown text-b3",{"!text-b2":(l=o.value)==null?void 0:l.goodsCategoryId3,"down-active":f.value===3&&r(F)}])},u((n=o.value)!=null&&n.goodsCategoryId3?(d=o.value)==null?void 0:d.goodsCategoryName3:e.$t("shop.emptyClass")),3)]}),_:1})])):_("",!0),s("div",Je,[s("div",We,u(e.$t("营业执照")),1),s("div",et,[p(r(J),Z({class:"flex flex-wrap gap-3",modelValue:m.value,"onUpdate:modelValue":t[4]||(t[4]=l=>m.value=l),"item-key":"id"},{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}),{item:i(({element:l,index:n})=>[s("div",{class:"van-uploader__preview",onClick:k(d=>ge(n),["stop"])},[s("div",ot,[s("img",{src:l.url,class:"van-image__img rounded-md",style:{"object-fit":"cover"}},null,8,st)]),s("div",{class:"absolute top-[4.25px] right-[4px] z-[99]",onClick:k(d=>pe(n),["stop"]),tabindex:"0"},nt,8,at)],8,tt)]),_:1},16,["modelValue"]),m.value.length<K.value?(h(),S(c,{key:0,accept:r(T),afterRead:ce},{default:i(()=>[s("div",it,[s("img",{src:r(P)("image-default.svg"),class:"w-6 mx-auto",alt:""},null,8,dt),s("div",ut,u(e.$t("common.add img")),1)])]),_:1},8,["accept"])):_("",!0)])])]),s("div",rt,[s("div",ct,[p(a,{"input-align":"right",class:"no-bt"},{label:i(()=>[s("div",pt,u(e.$t("联系方式")),1)]),input:i(()=>[]),button:i(()=>[p(we,{modelValue:o.value.linkType,"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.linkType=l),"checked-color":"#FF8812",direction:"horizontal",onChange:e.handleLinkTypeChange},{default:i(()=>[p(H,{name:"1","icon-size":"16px"},{default:i(()=>[A(u(e.$t("Metakey")),1)]),_:1}),p(H,{name:"2","icon-size":"16px"},{default:i(()=>[A(u(e.$t("flashSale.service-link-outher")),1)]),_:1})]),_:1},8,["modelValue","onChange"])]),_:1})]),o.value.linkType==1?(h(),w("div",gt,[p(a,{"input-align":"right",maxlength:12,modelValue:o.value.customerServiceLink,"onUpdate:modelValue":t[6]||(t[6]=l=>o.value.customerServiceLink=l),placeholder:e.$t("Matekey聊天地址"),class:"no-bt"},{label:i(()=>[s("div",mt,u(e.$t("Matekey地址")),1)]),_:1},8,["modelValue","placeholder"])])):_("",!0),o.value.linkType==2?(h(),w("div",vt,[s("div",ft,u(e.$t("三方工具")),1),s("div",ht,[p(r(J),Z({class:"flex flex-wrap gap-3",modelValue:v.value,"onUpdate:modelValue":t[7]||(t[7]=l=>v.value=l),"item-key":"id"},{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}),{item:i(({element:l,index:n})=>[s("div",{class:"van-uploader__preview",onClick:k(d=>fe(n),["stop"])},[s("div",_t,[s("img",{src:l.url,class:"van-image__img rounded-md",style:{"object-fit":"cover"}},null,8,xt)]),s("div",{class:"absolute top-[4.25px] right-[4px] z-[99]",onClick:k(d=>ve(n),["stop"]),tabindex:"0"},wt,8,yt)],8,bt)]),_:1},16,["modelValue"]),v.value.length<Q.value?(h(),S(c,{key:0,accept:r(T),afterRead:me},{default:i(()=>[s("div",kt,[s("img",{src:r(P)("image-default.svg"),class:"w-6 mx-auto",alt:""},null,8,$t),s("div",Et,u(e.$t("common.add img")),1)])]),_:1},8,["accept"])):_("",!0)])])):_("",!0)]),s("div",Ft,[s("div",It,[p(a,{"input-align":"right",autocomplete:"off",class:"no-bt",onClick:t[8]||(t[8]=l=>r(V)(!0))},{label:i(()=>[s("div",St,u(e.$t("地图选点")),1)]),input:i(()=>{var l,n,d;return[s("div",{class:y(["text-b3",{"!text-b2":(l=o.value)==null?void 0:l.goodsCategoryId1}])},u((n=o.value)!=null&&n.goodsCategoryId1?(d=o.value)==null?void 0:d.goodsCategoryName1:e.$t("请选择店铺位置")),3),Bt]}),_:1})]),s("div",Vt,[p(a,{"input-align":"right",autocomplete:"off",class:"no-bt",onClick:t[9]||(t[9]=()=>{})},{label:i(()=>[s("div",Nt,u(e.$t("所在地区")),1)]),input:i(()=>{var l,n,d;return[s("div",{class:y(["text-b3",{"!text-b2":(l=o.value)==null?void 0:l.goodsCategoryId1}])},u((n=o.value)!=null&&n.goodsCategoryId1?(d=o.value)==null?void 0:d.goodsCategoryName1:e.$t("请选择店铺所在地区")),3),Lt]}),_:1})]),s("div",At,u(e.$t("详细地址")),1),p(a,{modelValue:o.value.address,"onUpdate:modelValue":t[10]||(t[10]=l=>o.value.address=l),rows:"1",autosize:"",type:"textarea",placeholder:e.$t("请输入店铺详细地址"),class:"no-bt",style:{"padding-top":"8px !important","padding-bottom":"0 !important"}},null,8,["modelValue","placeholder"])]),s("div",Pt,[s("div",Tt,u(e.$t("备注信息(仅审核人员可见)")),1),p(a,{modelValue:o.value.remark,"onUpdate:modelValue":t[11]||(t[11]=l=>o.value.remark=l),rows:"2",autosize:"",type:"textarea",placeholder:e.$t("请输入备注信息"),class:"no-bt",style:{"padding-top":"8px !important","padding-bottom":"0 !important"},maxlength:"200","show-word-limit":""},null,8,["modelValue","placeholder"])]),r(ne).isOnlyView?_("",!0):(h(),w("div",Dt,[p(ke,{round:"",class:y(["flex-1 min-w-[130px] h-[46px] text-base font-semibold",r(j)?"bg-b4 text-b2":"bg-btnOrBg text-b1"]),disabled:r(j),onClick:t[12]||(t[12]=l=>xe()),loading:r(ue)},{default:i(()=>[A(u(e.$t("确认添加")),1)]),_:1},8,["disabled","class","loading"])])),r(F)?(h(),S(Le,{key:1,list:M.value,level:f.value,id:q.value,onSelect:he,onClose:t[13]||(t[13]=l=>r(G)(!1))},null,8,["list","level","id"])):_("",!0),p(Ue,{noClose:"",show:r(re),onClose:t[15]||(t[15]=l=>r(V)(!1))},{default:i(()=>[s("div",Ut,[s("div",zt,u(e.$t("检测到您的地图选点位置信息与所输入店铺地址存在出入，请重新核对")),1),s("div",jt,[s("div",{class:"flex-1 h-[46px] leading-[46px] rounded-full text-base text-center text-[#2E2008] font-semibold bg-yellow",onClick:t[14]||(t[14]=k(l=>r(V)(!1),["stop"]))},u(e.$t("common.confirm")),1)])])]),_:1},8,["show"])]}),_:1},8,["title"])}}const Rt=se({...Mt,setup:qt}),Wt=$e(Rt,[["__scopeId","data-v-0a30569c"]]);export{Wt as default};
