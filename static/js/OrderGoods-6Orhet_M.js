import{_ as q,y as G,w as U,x as R,B as F,z as H,r as K,E as y,F as i,G as a,H as n,a2 as c,O as f,K as g,a4 as p,Q as l,P as r,N as z,a0 as A,bc as Q,R as Y,bo as Z,T as J,Y as L,Z as W}from"./vendor-BUT0HZ5j.js";import{_ as X}from"./MCOIN-BcbOHmhy.js";import{_ as ee}from"./BoutiqueLable-r45nG6V6.js";import{P as v}from"./flashSale-DDyqLyYN.js";import{_ as oe}from"./ShopMaskTips-dKZ6_BUi.js";import{S as h}from"./shop-CeqcS6K2.js";import{d as se}from"./index-DDhEkd_5.js";const te=o=>(L("data-v-46444764"),o=o(),W(),o),ae={class:"flex-center-bw"},ne={key:0},de={class:"flex-1 flex justify-between flex-col min-h-[80px] relative"},le={class:"text-left line-clamp-1"},re={class:"text-left opacity-60 line-clamp-2"},ie={class:"flex items-center mt-1 flex-warp goods-tag"},ce={key:0,class:"text-xs text-primary"},ue={class:"flex items-center"},me={key:0,class:"flex-center text-primary"},ge={key:1,class:"flex-center"},pe=te(()=>n("img",{src:X,class:"w-4 h-4 mr-1"},null,-1)),ye={key:3},fe=G({props:{goods:null,number:null,isDisabledEdit:{type:Boolean,default:!1},payType:null,card:null,needMask:{type:Boolean,default:!0},shopType:{default:h.SD}},emits:["changeNumber","handleTo"],setup(o,{emit:u}){const e=o,{t:O}=U(),P=R(()=>+e.goods.goodsTypes!=2&&(e.goods.warnType===2&&e.goods.stock<=e.goods.warnValue||e.goods.warnType===1&&e.goods.stock<=+new F(e.goods.totalStock).times(e.goods.warnValue).div(100)||!e.goods.warnType&&e.goods.stock<=50));H(()=>e.number,s=>{d.value=s});const d=K(e.number),_=s=>{try{return s.data.replace(/\d/g,"")}catch{return""}},M=()=>{var s,t;if(((s=e.card)==null?void 0:s.stock)<d.value&&+((t=e.card)==null?void 0:t.goodsTypes)!=2)return d.value=e.number,J(O("order.Insufficient stock"));if(d.value<=0){d.value=e.number;return}u("changeNumber",d.value)},x=R(()=>{var s;return e.shopType!==h.SD?new F(e.goods.price).times(d.value).times((s=e.goods)!=null&&s.goodsType?e.goods.balanceDiscountRatio:e.goods.discountRatio).div(100).times(.5).toNumber():0});return(s,t)=>{var T,w,S,D,C,N,I,V,B,$,E;const j=y("VanImage"),b=y("VanTag"),k=y("van-button");return a(),i("div",ae,[n("div",{class:"w-[80px] h-[80px] rounded-xl overflow-hidden mr-2 relative",onClick:t[0]||(t[0]=p(m=>u("handleTo",`/goodsDetail?id=${o.goods.id}`),["stop"]))},[o.needMask?(a(),i("div",ne,[!+o.goods.stock&&+o.goods.goodsTypes!=2||o.goods.shopStatus==3||o.goods.shopStatus==4||o.goods.shopStatus==0||o.goods.status!=1?(a(),g(oe,{key:0,status:o.goods.status,stock:o.goods.stock,shopStatus:o.goods.shopStatus},null,8,["status","stock","shopStatus"])):c("",!0)])):c("",!0),f(j,{src:(((T=o.goods)==null?void 0:T.icons)||((w=o.goods)==null?void 0:w.mainImageUrls)||"").split(",")[0],fit:"cover",class:"object-cover w-full h-full overflow-hidden"},null,8,["src"])]),n("div",de,[n("section",null,[n("div",le,l(((S=e.goods)==null?void 0:S.goodsName)||((D=e.goods)==null?void 0:D.title)),1),n("div",re,l(((C=e.goods)==null?void 0:C.goodsDesc)||((N=e.goods)==null?void 0:N.describe)),1),n("div",ie,[o.payType!==r(v).STORE_CARD?(a(),g(ee,{key:0,type:(I=e.goods)==null?void 0:I.goodsType},null,8,["type"])):c("",!0),o.payType!==r(v).STORE_CARD&&((V=e.goods)!=null&&V.goodsType)&&((B=e.goods)==null?void 0:B.goodsType)!==r(h).SD?(a(),g(b,{key:1,class:"flex-shrink-0 text-xs",size:"medium",color:"#FFF7D2","text-color":"#AD941A"},{default:z(()=>[A(l(s.$t("cart.Pay with points")),1)]),_:1})):c("",!0),o.goods.goodsType>0&&r(x)>0?(a(),g(b,{key:2,class:"flex-shrink-0 text-xs",size:"medium",color:"#FFF7EC","text-color":"#FEA021"},{default:z(()=>[n("span",null,l(s.$t("voucher.can_use",{amount:r(se)(r(x))})),1)]),_:1})):c("",!0)])]),n("section",null,[r(P)?(a(),i("div",ce,l(e.goods.stock<=0?s.$t("order.zero inventory"):s.$t("order.Tight inventory")),1)):c("",!0)]),n("section",ue,[o.payType===r(v).STORE_CARD?(a(),i("div",me,l(($=e.goods)==null?void 0:$.cardPrice)+l(o.card&&o.card.symbol),1)):(a(),i("div",ge,[pe,A(" "+l((E=e.goods)==null?void 0:E.price),1)])),e.isDisabledEdit?(a(),i("div",ye,"x"+l(e.number),1)):(a(),i("div",{key:2,class:"gap-1 ml-auto flex-center",onClick:t[4]||(t[4]=p(()=>{},["stop"]))},[f(k,{icon:"minus",size:"small",type:"primary",class:Y(["w-5 border-none aspect-square text-[#000]",{"text-[#D9D9D9] !opacity-100":e.number<=1}]),disabled:e.number===1,onClick:t[1]||(t[1]=p(m=>u("changeNumber",e.number-1),["stop"]))},null,8,["class","disabled"]),Q(n("input",{class:"w-9 h-[22px] bg-b5 text-center rounded-[4px] text-black",type:"number",nim:"1","onUpdate:modelValue":t[2]||(t[2]=m=>d.value=m),onInput:_,onBlur:M},null,544),[[Z,d.value]]),f(k,{icon:"plus",size:"small",type:"primary",class:"w-5 border-none aspect-square text-[#000]",onClick:t[3]||(t[3]=p(m=>u("changeNumber",e.number+1),["stop"]))})]))])])])}}}),Se=q(fe,[["__scopeId","data-v-46444764"]]);export{Se as O};
