import{B as z}from"./BackIcon-CDrGaEPo.js";import{_ as H}from"./TimeFilter-BFI-K4ma.js";import{_ as E,z as R,r as u,y as q,q as G,E as j,F as B,G as n,H as l,I as t,a1 as J,P as v,Q as e,O as c,J as L,K as U,B as C,a4 as I,x as K,o as Q,$ as W,X,Y,U as Z}from"./vendor-Dr_RpJ_Y.js";import{k as tt,p as et}from"./useOrderStatus-B4sCDXOr.js";import{P as st}from"./order-H59PKTFP.js";import{f as D,e as x,c as ot,u as at,d as nt}from"./index-BckdT6oc.js";import{P}from"./flashSale-DDyqLyYN.js";import{A as lt,m as rt}from"./order-BTAcEDew.js";const it={class:"pb-0 bg-white rounded-xl"},ct={class:"flex justify-between"},dt={class:"flex-start"},ut={class:"ml-1 font-semibold text-base leading-[22px] text-[#2e2008]"},mt={class:"font-semibold text-sm leading-[20px] text-primary whitespace-nowrap"},_t={class:"flex w-full gap-2"},ft={class:"flex-1 flex flex-col min-h-[5rem] justify-between"},pt={class:"flex items-baseline justify-between w-full font-semibold"},ht={class:"w-full text-base line-clamp-2 leading-[22px] font-semibold flex flex-row justify-between items-center"},vt={class:"max-w-[140px] text-ellipsis overflow-hidden line-clamp-1"},xt={class:"shrink-0"},yt={class:"flex justify-end text-sm font-normal text-[#a6a6a6]"},wt={key:0},bt={key:0},$t={key:1},gt={key:1},St={key:0},At={key:1},kt=I(" ) "),Tt={class:"mt-1 text-sm min-w-fit font-normal text-[#a6a6a6]"},Ct=R({props:["order"],setup(a){const y=u(null);q(()=>1/y.value);const S=async()=>{const{mcoinRate:d}=ot();y.value=await d()};G();const w=tt(),b=d=>{const p=new C(d.price).times(d.number).minus(d.goodsActivityReduceAmount||0).plus(d.goodsAdjustChangeAmount||0).toNumber();return x(p||0)};return j(async()=>{await S()}),(d,p)=>{const h=B("VanImage");return l(),n("div",it,[t("div",ct,[t("div",dt,[v(h,{src:a.order.stores&&a.order.stores.logo,class:"store-logo w-[30px] h-[30px] overflow-hidden rounded-[50%]",alt:"",round:"",fit:"cover"},null,8,["src"]),t("div",ut,e(c(D)(a.order.userAddress.address,"...",5,5)),1)]),t("div",mt,e(c(w)[a.order.status+""]),1)]),(l(!0),n(L,null,U(a.order.orderGoods,s=>{var m,_;return l(),n("div",{class:"mt-2",key:s.goodsName},[t("div",_t,[v(h,{src:(s.icons||"").split(",")[0],class:"min-w-20 w-20 h-20 overflow-hidden rounded-lg",alt:s.goodsName,title:s.goodsName,fit:"cover"},null,8,["src","alt","title"]),t("div",ft,[t("div",null,[t("div",pt,[t("div",ht,[t("div",vt,e(s.goodsName),1),t("div",xt,[t("div",yt,[+a.order.paySource!==c(st).USDT_WALLET?(l(),n("div",wt,[a.order.payType===c(P).STORE_CARD?(l(),n("span",bt,e(c(x)(+new c(C)(s.cardPrice).times(s.number??1)||0))+e((m=a.order.fmStoredCard)==null?void 0:m.symbol),1)):(l(),n("span",$t,e(b(s))+" Mcoin",1))])):(l(),n("div",gt,[I(e(c(x)(a.order.totalUsdt))+"USDT(",1),a.order.payType===c(P).STORE_CARD?(l(),n("span",St,e(c(x)(+new c(C)(s.cardPrice).times(s.number??1)||0))+e((_=a.order.fmStoredCard)==null?void 0:_.symbol),1)):(l(),n("span",At,"("+e(b(s))+" Mcoin)",1)),kt]))])])])]),t("div",Tt,e(d.$t("order.quantity",{number:s.number||0})),1)])])])])}),128)),J(d.$slots,"default",{},void 0,!0)])}}}),It=E(Ct,[["__scopeId","data-v-2370fe9c"]]),Nt=a=>(X("data-v-6a49eaf0"),a=a(),Y(),a),Pt={class:"w-full bg-[#F2F0EF]",style:{"background-image":"none"}},Et={class:"header-bar sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50"},Rt={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},jt={class:"font-semibold"},Bt={class:"list-content pt-2 px-4"},Lt={class:"total__wrap w-full flex flex-row justify-between gap-2"},Ut={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},Dt={class:"text-xs font-normal text-default"},Mt={class:"text-left mt-1"},Ot={class:"num-value text-2xl font-semibold text-left"},Vt={class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},Ft={class:"total__item w-[50%] h-[74px] bg-white rounded-xl p-3"},zt={class:"text-xs font-normal text-default"},Ht={class:"text-left mt-1"},qt={class:"num-value text-2xl font-semibold text-left"},Gt=Nt(()=>t("span",{class:"num-symbol text-xs font-normal text-[#a6a6a6] ml-1"},"Mcoin",-1)),Jt={class:"list__wrap mt-3 w-full h-[calc(100vh-174px)] z-50 overflow-y-auto scroll-smooth"},Kt={class:"bottom__wrap mt-2 w-full flex flex-row justify-between items-center"},Qt={class:"text-sm font-normal text-[#a6a6a6]"},Wt={class:"text-newOrigin text-sm font-normal"},Xt={key:0},Yt={key:0},Zt={key:1},te=I(" Mcoin "),ee=R({setup(a){const{t:y}=K(),S=Q(),{getCurrentStoreId:w}=at(),b=20,d=y("order.history_order_title"),p=u(S.query.address),h=u(`${D(p.value,"...",5,5)||""}${d}`);document.title=h.value;const s=u({orderAmount:0,orderCount:0}),m=u([]),_=u(!1),$=u(!1),g=u(0),A=u(null),k=u(null),M=()=>{g.value=0,m.value=[],$.value=!1},O=async()=>{var f,i,T;const r={status:4,type:1,historyAddress:p.value,storeId:(f=await w())==null?void 0:f.id},o=await lt(r);o.success&&(s.value={orderAmount:((i=o==null?void 0:o.data)==null?void 0:i.orderAmount)||0,orderCount:((T=o==null?void 0:o.data)==null?void 0:T.orderCount)||0})},V=async()=>{var f;const r={page:g.value,size:b,type:1,status:4,historyAddress:p.value,storeId:(f=await w())==null?void 0:f.id,createStartTime:A.value,createEndTime:k.value},o=await rt(r);if(_.value=!1,!o.success||!o.data||!o.total){$.value=!0;return}m.value=g.value===1?o.data:[...m.value,...o.data],$.value=m.value.length>=o.total},N=async()=>{_.value=!0,g.value+=1,await V(),_.value=!1},F=r=>{r&&r[0]&&r[1]?[A.value,k.value]=r:(A.value=null,k.value=null),M(),N()};return j(()=>{O()}),(r,o)=>{const f=B("van-list");return l(),n("div",Pt,[t("section",Et,[t("div",Rt,[v(z)]),t("div",jt,e(h.value),1)]),t("section",Bt,[t("div",Lt,[t("div",Ut,[t("p",Dt,e(r.$t("order.history_order_count")),1),t("p",Mt,[t("span",Ot,e(s.value.orderCount),1),t("span",Vt,e(r.$t("common.order_count_suffix")),1)])]),t("div",Ft,[t("p",zt,e(r.$t("order.history_transaction_count")),1),t("p",Ht,[t("span",qt,e(c(nt)(c(x)(s.value.orderAmount,Number(s.value.orderAmount)>=1e3?2:4))),1),Gt])])]),v(H,{"allow-reverse":"",onChange:F}),t("div",Jt,[v(f,{loading:_.value,"onUpdate:loading":o[0]||(o[0]=i=>_.value=i),finished:$.value,"finished-text":r.$t("common.no more"),onLoad:N},{default:W(()=>[(l(!0),n(L,null,U(m.value,(i,T)=>(l(),n("div",{key:i.id,class:"list__item w-full min-h-[132px] rounded-xl bg-white p-3"},[v(It,{order:i},null,8,["order"]),t("div",Kt,[t("p",Qt,e(c(et)(+i.paySource)),1),t("p",Wt,[i.totalUsdt?(l(),n("span",Xt,[t("span",null,e(i.totalUsdt)+"USDT",1),i.totalAmount?(l(),n("span",Yt,"("+e(i.totalAmount)+" Mcoin)",1)):Z("",!0)])):(l(),n("span",Zt,[t("span",null,e(i.totalAmount),1),te]))])])]))),128))]),_:1},8,["loading","finished","finished-text"])])])])}}}),de=E(ee,[["__scopeId","data-v-6a49eaf0"]]);export{de as default};
