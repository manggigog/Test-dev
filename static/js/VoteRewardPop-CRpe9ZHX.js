import{_ as T,y as b,U as A,bc as y,r as p,z as N,D as I,a9 as O,E as P,F as x,G as g,O as M,N as R,H as a,a2 as z,X as C,P as c,a4 as U,$,a0 as _,Y as j,Z as H,n as q,br as G}from"./vendor-CjApaIpB.js";import{bl as S}from"./index-DBW_ANsl.js";const W=o=>(j("data-v-18dc0ad8"),o=o(),H(),o),X={key:0,class:"center-card text-b1 font-semibold"},Y=W(()=>a("div",{class:"container relative"},[a("div",{class:"center-text",id:"original"},[a("div",null,"完成投票"),a("div",null,[_("获得 "),a("span",{class:"text-newOrigin"},"1"),_(" 张抵用券")])])],-1)),Z=[Y],J=b({props:{teleport:null},setup(o,{expose:D}){const{teleport:K}=o,{height:m}=A(),[s,h]=y(!1),l=p(null),e=p(null),u=p(null),[L,d]=y(!1),f=async()=>{d(!0),await S(500);const n=document.getElementById("original").cloneNode(!0);n.id="cloned-animation",n.classList.add("animated-div"),document.querySelector(".container").appendChild(n)},k=38;function v(t){Math.round(t.currentTime)>=k&&(f(),e.value.removeEventListener("enterFrame",v))}const w=async()=>{e.value.play();try{e.value.addEventListener("enterFrame",v)}catch{await S(1300),f()}},B=()=>{var t;d(!1),h(!0),(t=e.value)!=null&&t.isLoaded&&w()},E=()=>{e.value||(e.value=G.loadAnimation({container:l.value,renderer:"svg",loop:!1,autoplay:!1,animationData:u.value}),e.value.addEventListener("DOMLoaded",()=>{w()}))},i=()=>{h(!1),setTimeout(()=>{d(!1),e.value&&(e.value.stop(),e.value.goToAndStop(0,!0),e.value.removeEventListener("enterFrame",v))},500)};return N([s,l],()=>{s.value&&u.value&&l.value&&q(()=>{E()})}),I(async()=>{try{const t=await fetch("lottie/expand.json");u.value=await t.json()}catch(t){console.error("预加载Lottie动画数据失败:",t)}}),O(()=>{e.value&&e.value.destroy()}),D({handleShowReward:B}),(t,n)=>{const F=P("VanPopup");return g(),x("div",null,[M(F,{show:c(s),"onUpdate:show":n[0]||(n[0]=r=>$(s)?s.value=r:null),teleport:o.teleport,onClickOverlay:U(i,["stop"]),onClose:i,round:"",class:"bg-transparent position-center",sty:"",style:{width:"100%","max-width":"375px"}},{default:R(()=>[a("div",{class:"w-full overflow-hidden relative",style:C({height:`${c(m)}px`}),onClick:i},[a("div",{ref:(r,V)=>{V.lottieContainer=r,l.value=r},class:"pointer-events-none",style:C({height:`${c(m)}px`}),onClick:i},null,4),c(L)?(g(),x("div",X,Z)):z("",!0)],4)]),_:1},8,["show","teleport","onClickOverlay"])])}}}),te=T(J,[["__scopeId","data-v-18dc0ad8"]]);export{te as V};
