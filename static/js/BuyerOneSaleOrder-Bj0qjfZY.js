import{_ as E,y as J,w as M,r as o,a1 as U,bd as j,x as H,F as h,G as i,H as K,O as b,N as c,E as u,l as P,I as V,J as x,K as O,a2 as Q,a4 as W,a0 as X,Q as Y,P as Z}from"./vendor-D6JO6WHW.js";import{_ as ee}from"./BuyerDeliveredItem-TYz_3GvE.js";import{e as te,aF as ae}from"./index-CybuWkSo.js";import{l as T}from"./luckyShopContract-CxYnH-y_.js";import"./useOrderStatus-DeHjEZ0k.js";const oe={class:"relative"},se={class:"parent-view"},ne={key:0,class:"flex justify-end mt-5"},ie=J({setup(le){const{commodityBatch:B}=T(),{orderGoodsStore:N}=te(),{t:s}=M(),n=o(0),k=P(),C=U();C.query.active&&(n.value=Number(C.query.active));const G=j({tabList:[{id:1,name:s("order.wait")},{id:2,name:s("order.waitRceived")},{id:-1,name:s("order.all")}]}),R=H(()=>[{id:1,name:s("order.wait")},{id:2,name:s("order.waitRceived")},{id:-1,name:s("order.all")}]),l=o([]),d=o(!1),m=o(!1),v=o(0),$=o(10),L=o(0),S=async()=>{d.value=!0,v.value+=1,await F(),d.value=!1},w=o([]),F=async()=>{const e={page:v.value,size:$.value,status:G.tabList[n.value].id,type:1};n.value===2&&delete e.status;const t=await ae(e);if(!t.success||!t.data||!t.total){m.value=!0;return}L.value=t.total;const f=await B(t.data.map(r=>r.odGoodsId));w.value=(t.data||[]).map((r,p)=>{var _,g;return{nextActionTime:(_=f[p])==null?void 0:_.nextActionTime,commitStatus:(g=f[p])==null?void 0:g.status,...r,loading:!1}}),l.value=v.value===1?w.value:l.value.concat(w.value),l.value.length>=L.value&&(m.value=!0)},I=e=>{k.replace({path:"buyerFlashSaleOrder",query:{active:e,type:2}}),n.value=e,v.value=0,m.value=!1,l.value=[],S()},{luckyComfirmReceived:A}=T(),q=async e=>{e.loading=!0;const t=await A(e.odGoodsId);e.loading=!1,t.success&&(e.commitStatus=200)},D=e=>{k.push("/buyerFlashSaleOrder/buyOneSaleOrderDetail"),N.changeOrderGoodAction(JSON.stringify(e))};return(e,t)=>{const f=u("VanButton"),r=u("VanList"),p=u("VanTab"),_=u("VanTabs"),g=u("router-view");return i(),h("div",oe,[K("div",se,[b(_,{active:n.value,"onUpdate:active":t[1]||(t[1]=y=>n.value=y),onChange:I,background:"#f2f0ef",sticky:""},{default:c(()=>[(i(!0),h(V,null,x(Z(R),y=>(i(),O(p,{title:y.name,key:y.id},{default:c(()=>[b(r,{loading:d.value,"onUpdate:loading":t[0]||(t[0]=a=>d.value=a),finished:m.value,"finished-text":e.$t("common.noMore"),"loading-text":e.$t("common.loading"),onLoad:S},{default:c(()=>[(i(!0),h(V,null,x(l.value,a=>(i(),O(ee,{key:a.id,isList:!0,onClick:z=>D(a),order:a},{default:c(()=>[a.commitStatus===40?(i(),h("div",ne,[b(f,{round:"",class:"px-6 font-semibold btn text-primary h-9",loading:a.loading,onClick:W(z=>q(a),["stop"])},{default:c(()=>[X(Y(e.$t("order.confirmGeted")),1)]),_:2},1032,["loading","onClick"])])):Q("",!0)]),_:2},1032,["onClick","order"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])]),_:2},1032,["title"]))),128))]),_:1},8,["active"])]),b(g,{class:"child-view"})])}}}),ve=E(ie,[["__scopeId","data-v-5954caf6"]]);export{ve as default};
