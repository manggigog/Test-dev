import{_ as q,y as N,w as H,be as E,r as v,E as _,K as $,G as u,N as y,H as c,O as k,F as B,a2 as M,R as T,Q as g,P as p,a4 as V,D as J,I as K,J as Q,l as U,a0 as L}from"./vendor-BUT0HZ5j.js";import{e as R,o as W,b as Y,r as j,u as Z,_ as X,bt as ee,bY as te,bZ as ae}from"./index-k1FFr-1T.js";import{C as se,_ as ne}from"./ClerkHeader-BtwAbuZL.js";import{_ as oe}from"./DefaultPage-0Skrrm1V.js";import"./BackIcon-biFt6cm7.js";const le={class:"flex items-center gap-x-2"},re={key:0,class:"mr-auto text-xs text-newOrigin border border-solid border-newOrigin rounded-sm px-1"},ie={class:"text-b3 mt-2 pl-2"},de={class:"flex items-center gap-x-1"},ue=["onClick"],ce=N({props:{data:{default:()=>({})}},emits:["edit","delete","statusChange","confirmDelete"],setup(n,{emit:b}){const o=n,{t:S}=H(),{accountStore:l}=R(),{loadingToggle:C}=j(),{merchantAuths:I}=W(),[O,x]=E(!1),D=a=>{switch(a){case 0:return S("storeClerk.Waiting for notification confirmation");case 2:return S("storeClerk.Rejection Notice");case 1:return S("storeClerk.Confirmed notification");default:return""}},f=v(!1),m=v(!1),r=v(!1),P=()=>{var a,e;if(!r.value&&!(!l.account&&!((a=l.sign)!=null&&a.address)||!((e=o.data)!=null&&e.address)))return new Promise(async(t,i)=>{var d,h,A;r.value=!0;const s=await I(((d=l.store)==null?void 0:d.merchant)||l.account||((h=l.sign)==null?void 0:h.address),(A=o.data)==null?void 0:A.address);if(m.value=!0,r.value=!1,!s.success){i();return}f.value=s==null?void 0:s.result,t(f.value)})},w=v(!1),F=async()=>{r.value||(m.value||(C(!0),await P(),C(!1)),f.value?w.value=!0:b("delete",o.data))},z=async a=>{r.value||(a==2?(m.value||(C(!0),await P(),C(!1)),f.value?(w.value=!0,o.data.status=1):b("statusChange",a,o.data)):b("statusChange",a,o.data))};return(a,e)=>{const t=_("van-switch"),i=_("van-icon"),s=_("van-loading"),d=_("van-swipe-cell");return u(),$(d,{onOpen:e[4]||(e[4]=h=>p(x)(!0)),onClose:e[5]||(e[5]=h=>p(x)(!1))},{right:y(()=>[c("div",{class:T(["h-full rounded-e-xl flex-center pl-4 pr-3 -ml-2",{"bg-[#f44]":p(O)}]),onClick:V(F,["stop"])},[r.value?(u(),$(s,{key:0,color:"#fff",size:"20"})):(u(),$(i,{key:1,name:"delete-o",color:"#fff",size:"20"}))],10,ue)]),default:y(()=>{var h,A;return[c("div",{class:"bg-white rounded-xl p-3 text-b1 font-Puhui flex items-center justify-between relative z-10",onClick:e[1]||(e[1]=G=>b("edit",n.data))},[c("div",null,[c("div",le,[c("div",{class:T(["text-base font-semibold line-clamp-2 relative pl-2 name",{nameGray:((h=n.data)==null?void 0:h.status)===2}])},g(n.data.nickname),3),n.data.noticeFlag===1?(u(),B("div",re,g(D(n.data.agreeFlag)),1)):M("",!0)]),c("div",ie,g(a.$t("flashSale.wallet-address")+"ï¼š")+g(p(Y)(n.data.address,"...",4,4)),1)]),c("div",de,[k(t,{loading:n.data.loading||r.value,disabled:r.value,"model-value":n.data.status,onClick:e[0]||(e[0]=V(()=>{},["stop"])),"onUpdate:modelValue":z,"active-color":"#FF8812","inactive-color":"#D9D9D9","active-value":1,"inactive-value":2,size:"16"},null,8,["loading","disabled","model-value"]),k(i,{name:"arrow",color:"#999",size:"20"})])]),k(se,{show:w.value,address:(A=o.data)==null?void 0:A.address,onClose:e[2]||(e[2]=G=>w.value=!1),onSuccess:e[3]||(e[3]=()=>{f.value=!1,w.value=!1})},null,8,["show","address"])]}),_:1})}}}),fe=q(ce,[["__scopeId","data-v-9e8dac12"]]),me={class:"!bg-gray1 font-Puhui font-normal"},ve={key:1,class:"m-3 safe-body overflow-x-scroll"},ge={class:"py-8 text-base text-center text-black"},pe={class:"flex gap-x-3"},xe=N({setup(n){const{getCurrentStoreId:b}=Z(),{loadingToggle:o}=j(),[S,l]=E(!1),{accountStore:C}=R(),I=U(),O=e=>{I.push(e)},x=v(!1),D=v([]),f=async()=>{var t;o(!0),x.value=!0;const e=await ee({shopId:(t=await b())==null?void 0:t.id});o(!1),x.value=!1,e.success&&(D.value=e.data.map(i=>({...i,loading:!1})))},m=v({}),r=e=>{m.value=e,l(!0)},P=e=>{m.value=e,z()},w=e=>{O("/clerk/edit?id="+e.id)},F=v(!1),z=async()=>{F.value=!0;const e=await te({id:m.value.id});F.value=!1,e.success&&(l(!1),f())},a=async(e,t)=>{var s;t.loading=!0;const{success:i}=await ae({...t,status:e,shopId:(s=await b())==null?void 0:s.id});t.loading=!1,i&&(t.status=e)};return J(()=>{f()}),(e,t)=>{const i=_("VanButton"),s=_("van-button");return u(),B("div",me,[k(ne,{title:e.$t("storeClerk.Clerk Management")},null,8,["title"]),D.value.length===0&&!x.value?(u(),$(oe,{key:0,class:"pb-6",needTextTop:!0,titleColor:"#A45E00",title:e.$t("common.No data yet"),top:"4rem"},null,8,["title"])):(u(),B("div",ve,[(u(!0),B(K,null,Q(D.value,d=>(u(),$(fe,{key:d.id,data:d,onEdit:w,onDelete:r,onConfirmDelete:P,onStatusChange:a,class:"mb-3"},null,8,["data"]))),128))])),p(C).isOnlyView?M("",!0):(u(),$(i,{key:2,class:"bg-btnOrBg w-[calc(100%-32px)] max-w-[343px] mx-auto h-11 flex-center text-b1 text-base font-semibold z-50 rounded-3xl",onClick:t[0]||(t[0]=d=>O("/clerk/edit"))},{default:y(()=>[L(g(e.$t("storeClerk.Add new staff")),1)]),_:1})),k(X,{width:"90%",show:p(S),name:e.$t("common.tip"),onClose:t[2]||(t[2]=d=>p(l)(!1))},{default:y(()=>[c("div",ge,g(e.$t("storeClerk.delTips",{name:m.value.nickname})),1),c("div",pe,[k(s,{class:"plain-btn w-1/2 text-b1 rounded-full font-semibold border-solid border-b4",onClick:t[1]||(t[1]=d=>p(l)(!1))},{default:y(()=>[L(g(e.$t("common.cancel")),1)]),_:1}),k(s,{loading:F.value,class:"w-1/2 bg-btnOrBg text-b1 rounded-full font-semibold border-none",onClick:z},{default:y(()=>[L(g(e.$t("common.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["show","name"])])}}});export{xe as default};
