import{_ as L,z as I,x as A,r as v,y as Q,D,F as d,Z as E,H as f,$ as n,I as o,P as s,Q as r,G as x,K as Y,N as G,O as V,J as H,a4 as q,q as J,o as K,U as N,bj as Z,bt as ee,bW as te,X as le,Y as ae,T as w,aL as O}from"./vendor-Dr_RpJ_Y.js";import{B as oe}from"./BackIcon-CDrGaEPo.js";import{a as se,g as ne,F as P,E as j}from"./enums-DlE-aiss.js";import{S as pe}from"./Switch-DuYcYVSQ.js";import{a as ie,u as ue,bX as re,bY as de}from"./index-7OiUoGXy.js";const me=""+new URL("../images/arrow-down-s-fill-CVQBTz9N.svg",import.meta.url).href,ce={class:"fee-type-popup"},he={class:"fee-type-popup__header px-4 py-4 text-lg text-center font-normal"},fe={class:"fee-type-popup__footer px-4 py-4"},ve=I({props:{modelValue:{type:Boolean},type:null},emits:["update:modelValue","confirm"],setup(_,{emit:F}){const m=_,{t:u}=A(),l=v(m.modelValue),c=v(m.type),C=Q(()=>se(u));D(()=>m.modelValue,p=>{l.value=p,p&&m.type&&(c.value=m.type)}),D(()=>l.value,p=>{F("update:modelValue",p)}),D(()=>m.type,p=>{c.value=p});const y=()=>{F("confirm",c.value),l.value=!1};return(p,T)=>{const B=d("van-radio"),t=d("van-cell"),g=d("van-cell-group"),k=d("van-radio-group"),S=d("van-button"),R=d("van-popup");return f(),E(R,{show:l.value,"onUpdate:show":T[1]||(T[1]=i=>l.value=i),position:"bottom",round:"",closeable:"","close-icon-position":"top-right"},{default:n(()=>[o("div",ce,[o("div",he,r(p.$t("shop.shippingTemplate.billingRule")),1),s(k,{modelValue:c.value,"onUpdate:modelValue":T[0]||(T[0]=i=>c.value=i),class:"fee-type-popup__content px-4"},{default:n(()=>[s(g,null,{default:n(()=>[(f(!0),x(H,null,Y(V(C),i=>(f(),E(t,{key:i.value,clickable:"",onClick:U=>c.value=i.value},{title:n(()=>[o("span",{class:G(["label-option opacity-100",[c.value==i.value?"text-[#FF8812] font-semibold font-sm":"text-b1 text-xs font-normal"]])},r(i.label),3)]),"right-icon":n(()=>[s(B,{name:i.value,"checked-color":"#FF8812"},null,8,["name"])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},8,["modelValue"]),o("div",fe,[s(S,{block:"",round:"",type:"primary",onClick:y,class:"bg-yellow border-none text-base font-semibold text-b1"},{default:n(()=>[q(r(p.$t("common.confirm")),1)]),_:1})])])]),_:1},8,["show"])}}}),ge=L(ve,[["__scopeId","data-v-e2b1e536"]]),$=_=>(le("data-v-18e21a5b"),_=_(),ae(),_),be={class:"header-bar sticky top-0 flex font-normal justify-center text-sm items-center h-[44px] px-2.5 z-50"},_e={class:"absolute left-2.5 flex items-center gap-1 -translate-y-1/2 top-1/2"},ye={class:"text-lg font-bold"},Te=$(()=>o("div",{class:"font-semibold"},null,-1)),xe={class:"h-[calc(100vh-44px-78px)] sticky top-[44px] px-3 pt-3 overflow-y-auto"},we=$(()=>o("div",{class:"w-[93%] ml-auto mr-auto border-b border-b-[#D9D9D9]",role:"separator"},null,-1)),Fe=$(()=>o("div",{class:"w-[93%] ml-auto mr-auto border-b border-b-[#D9D9D9]",role:"separator"},null,-1)),ke={key:0,class:"text-sm font-normal whitespace-nowrap"},Ve={key:1,class:"text-sm text-b3 font-normal whitespace-nowrap"},$e=$(()=>o("img",{src:me,class:"w-4 h-4 ml-[2px]"},null,-1)),Ce={key:0,class:"w-full h-[78px] bg-white rounded-xl mt-3 py-4 px-3 flex flex-row justify-between items-center flex-nowrap"},Be={class:"text-sm font-normal text-b2 whitespace-nowrap"},Se=["placeholder","disabled"],De={class:"text-sm font-normal text-b2 whitespace-nowrap"},Ne={key:0,class:"btn-bg flex justify-end h-[78px] py-4 px-3 z-[1] gap-3"},Ee=I({name:"ShippingTemplate"});function qe(_){const F=v(!1),m=J(),u=K(),{t:l}=A(),{accountStore:c}=ie(),{getCurrentStoreId:C}=ue(),y=v(!1),p=v(null),T=()=>{g.value||(p.value=t.value.type,y.value=!0)},B=e=>{t.value.type=e||null,y.value=!1},t=v({id:null,address:null,name:null,type:null,defaultFlag:!1,threshold:0,cost:0}),g=v(!1),k=v({"Bound products cannot be deleted":l("shop.shippingTemplate.delete failed by bounded"),"There is currently a free shipping rule, which applies to all products in the store":l("shop.shippingTemplate.delete failed by repeated")}),S=Q(()=>ne(l));(()=>{const e=u.query.mode;(e===j.EDIT||e===j.VIEW)&&(t.value={id:Number(u.query.id)||null,address:u.query.address||null,name:u.query.name||null,type:Number(u.query.type)||null,defaultFlag:u.query.defaultFlag==="true",threshold:Number(u.query.threshold)||0,cost:Number(u.query.cost)||0})})();const i=async()=>{var a;if(!t.value.name){w.fail(l("shop.shippingTemplate.templateNameRequired"));return}if(!t.value.type){w.fail(l("shop.shippingTemplate.selectBillingRule"));return}t.value.type===P.FREE&&!t.value.threshold&&(t.value.threshold=0),F.value=!0,t.value.id||(t.value.id=null),t.value.address||(t.value.address=(a=await C())==null?void 0:a.merchant);const e=await de(t.value);if(!e.success){console.log(e);const b=k.value[e.failMsg]||e.failMsg||l("shop.shippingTemplate.submitFailed");O.alert({message:b,confirmButtonText:l("common.confirm-2"),confirmButtonColor:"#FEA021"});return}w.success(l("shop.shippingTemplate.submitSuccess")),m.back()},U=async()=>{const e={id:t.value.id};if(!e.id){w.fail(l("shop.shippingTemplate.selectTemplateToDelete"));return}const a=await re(e);if(!a.success){console.log(a);const b=k.value[a.failMsg]||a.failMsg||l("shop.shippingTemplate.deleteFailed");O.alert({message:b,confirmButtonText:l("common.confirm-2"),confirmButtonColor:"#FEA021"});return}w.success(l("shop.shippingTemplate.deleteSuccess")),setTimeout(()=>{m.back()},600)};return(e,a)=>{const b=d("van-field"),W=d("van-cell-group"),X=d("van-form"),M=d("VanButton");return f(),x("div",null,[o("section",be,[o("div",_e,[s(oe,null,{default:n(()=>[o("span",ye,r(e.$t("shop.shippingTemplate.title")),1)]),_:1})]),Te]),o("section",xe,[s(X,{class:"main-form"},{default:n(()=>[s(W,{inset:""},{default:n(()=>[s(b,{class:"text-right py-4 font-normal",modelValue:t.value.name,"onUpdate:modelValue":a[0]||(a[0]=h=>t.value.name=h),name:e.$t("shop.shippingTemplate.templateName"),label:e.$t("shop.shippingTemplate.templateName"),placeholder:e.$t("shop.shippingTemplate.templateNameLimit"),maxlength:"15",disabled:g.value,"input-align":"right","label-align":"left",rules:[{required:!0,message:e.$t("shop.shippingTemplate.templateNameRequired")}]},null,8,["modelValue","name","label","placeholder","disabled","rules"]),we,s(b,{name:"switch",label:e.$t("shop.shippingTemplate.setDefault"),"input-align":"right","label-align":"left",disabled:g.value},{input:n(()=>[s(pe,{modelValue:t.value.defaultFlag,"onUpdate:modelValue":a[1]||(a[1]=h=>t.value.defaultFlag=h),disabled:g.value},null,8,["modelValue","disabled"])]),_:1},8,["label","disabled"]),Fe,s(b,{clickable:"",name:e.$t("shop.shippingTemplate.billingRule"),label:e.$t("shop.shippingTemplate.billingRule"),"input-align":"right","label-align":"left",onClick:T,rules:[{required:!0,message:e.$t("shop.shippingTemplate.selectBillingRule")}]},{input:n(()=>[t.value.type?(f(),x("span",ke,r(V(S)[t.value.type]),1)):(f(),x("span",Ve,r(e.$t("shop.shippingTemplate.selectBillingRule")),1)),$e]),_:1},8,["name","label","rules"])]),_:1})]),_:1}),s(te,{name:"fade"},{default:n(()=>[t.value.type===V(P).FREE?(f(),x("div",Ce,[o("p",Be,r(e.$t("shop.shippingTemplate.actualPayment")),1),Z(o("input",{class:"mx-2 text-center h-[36px] w-[71%] bg-[#F5F5F5] rounded-md",type:"number",min:0,placeholder:e.$t("common.pleaseInput"),"onUpdate:modelValue":a[2]||(a[2]=h=>t.value.threshold=h),disabled:g.value,onInput:a[3]||(a[3]=h=>{var z;return t.value.threshold=(z=h.target.value)==null?void 0:z.replace(/[^0-9.]/g,"")})},null,40,Se),[[ee,t.value.threshold]]),o("p",De,r(e.$t("shop.shippingTemplate.freeShipping")),1)])):N("",!0)]),_:1})]),V(c).isOnlyView?N("",!0):(f(),x("div",Ne,[t.value.id?(f(),E(M,{key:0,class:"del-btn font-semibold h-[46px] w-full px-4 rounded-md text-base bg-white text-b2",onClick:U},{default:n(()=>[q(r(e.$t("common.delete")),1)]),_:1})):N("",!0),s(M,{class:"font-semibold h-[46px] w-full px-4 rounded-md text-base bg-yellow",onClick:i},{default:n(()=>[q(r(e.$t("common.save")),1)]),_:1})])),s(ge,{modelValue:y.value,"onUpdate:modelValue":a[4]||(a[4]=h=>y.value=h),type:p.value,onConfirm:B},null,8,["modelValue","type"])])}}const Ie=I({...Ee,setup:qe}),Pe=L(Ie,[["__scopeId","data-v-18e21a5b"]]);export{Pe as default};
