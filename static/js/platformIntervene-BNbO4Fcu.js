import{_ as M,z as Q,q as re,x as K,y as le,bQ as de,G as c,H as r,I as o,a1 as ce,U as B,Q as f,O as u,J as y,K as b,Z as C,X,Y,a2 as ue,bl as fe,o as me,$ as m,F as v,P as p,N as U,a4 as T,a3 as R,T as H,a9 as pe,by as he}from"./vendor-Dr_RpJ_Y.js";import{_ as ve}from"./tips-gray-CQI5auMx.js";import{C as _e}from"./CommonVanProvider-KZuKVOde.js";import{_ as ge}from"./avatarRing-CLGxkH-F.js";import{G as xe}from"./GoodsItem-DZxsKjaZ.js";import{a as Z,i as we,f as W}from"./index-7OiUoGXy.js";import{u as ye,o as be}from"./useOrderStatus-CUBDjZMz.js";import{b as Ce,u as Ie}from"./useRefund-CEIg7RXJ.js";import{a as Fe,m as Be}from"./order-D0_No2Ew.js";import{p as Ee}from"./refund-Bg6bFzAK.js";import{v as ke}from"./useOrderActionButtons-B97DXcfO.js";import{_ as Se}from"./RegionBox-Q1yXQihF.js";import"./BackIcon-CDrGaEPo.js";import"./credit-EZuPIBEN.js";import"./mcoin-logo-1-Deho8IWN.js";import"./flashSale-DDyqLyYN.js";import"./useShipTemplate-VxaDU85Q.js";import"./enums-DlE-aiss.js";const $e=i=>(X("data-v-8f1a6948"),i=i(),Y(),i),Ae={class:"gap-2 flex-center-bw"},De=$e(()=>o("div",{class:"w-8 h-8"},[o("img",{src:ge,class:"w-full h-full rounded-md object-cover",alt:"",fit:"cover"})],-1)),Pe={class:"flex flex-col justify-center flex-1 h-8 text-default"},Re={class:"text-sm font-semibold flex-center-bw"},Te={key:0},Le={class:"text-primary line-clamp-1 ml-2"},Ve={class:"text-xs opacity-60"},Ne=Q({props:{order:null,isService:{type:Boolean},nowTime:null},emits:["open"],setup(i,{emit:L}){const g=i;Z();const h=re(),{t:E}=K();le(()=>Ce(g.order));const a=x=>{g.isService||h.push(x)},k=()=>{g.isService||h.push(`/sellerOrderDetail?id=${g.order.id}`)};return de("openBatchReceiptPop",null),we(),(x,S)=>(r(),c("div",{class:"px-3 mt-3 bg-white rounded-xl py-4",onClick:k},[o("div",Ae,[De,o("div",Pe,[o("div",Re,[i.order.userAddress&&i.order.userAddress.address?(r(),c("div",Te,f(u(W)(i.order.userAddress.address,"...",5,5)),1)):B("",!0),o("div",Le,f(u(ye)(i.order)),1)]),o("div",Ve,f(u(be)(i.order,"intervene")),1)])]),(r(!0),c(y,null,b(i.order.orderGoods,I=>(r(),C(xe,{creditFlag:i.order.creditFlag,payType:i.order.payType,key:I.goodsName,goods:I,storeCard:i.order.fmStoredCard,showBuyFlag:!1,onHandleTo:a,class:"!py-0 mt-[20px]"},null,8,["creditFlag","payType","goods","storeCard"]))),128)),ce(x.$slots,"default",{},void 0,!0)]))}}),je=M(Ne,[["__scopeId","data-v-8f1a6948"]]),_=i=>(X("data-v-9ebc5a5a"),i=i(),Y(),i),Ge={class:"flex justify-between mt-3 text-sm text-[#2E2008]"},ze=_(()=>o("div",{class:"text-b3 font-normal"},f("平台介入原因"),-1)),Oe={class:"test-sm font-semibold"},qe=["onClick"],Je=_(()=>o("p",null,"补充凭证",-1)),Ue={key:0},He={key:0,class:"mt-2"},Me=_(()=>o("div",{class:"w-full h-[1px] bg-[#D9D9D9]"},null,-1)),Qe={class:"mt-2"},Ke={class:"text-b2 font-normal whitespace-pre-wrap"},Xe={class:"flex flex-wrap gap-2 mt-2"},Ye={key:1,class:"mt-2"},Ze=_(()=>o("div",{class:"w-full h-[1px] bg-[#D9D9D9]"},null,-1)),We={class:"mt-2"},et={class:"text-b2 font-normal whitespace-pre-wrap"},tt={class:"flex flex-wrap gap-2 mt-2"},st={class:"w-full bg-[#F5F5F5] rounded-lg mt-3 p-2"},nt={class:"flex items-center justify-start"},ot=_(()=>o("p",null,"审核进度",-1)),at={class:"p-2"},it={class:"flex items-center text-xxs gap-1.5 text-primary"},rt=["onClick"],lt=_(()=>o("img",{class:"w-[16px] h-[16px] ml-[2px]",src:ve},null,-1)),dt=[lt],ct={key:0,class:"mt-2 flex flex-col gap-2.5"},ut={class:"font-semibold text-[#FF8812] mx-1"},ft={class:"text-sm text-[#FF8812] font-semibold"},mt={key:0,class:"flex justify-end gap-2 mt-3"},pt=T("支持买家"),ht=T("支持商家"),vt=Q({setup(i){const{accountStore:L}=Z(),{t:g}=K(),[h,E]=ue(!1),a=fe({active:1,page:0,size:10,finished:!1,list:[],loading:!1,total:0}),k=t=>Ie(t,!0),x=t=>ke(t),S=t=>{const e=L.account.toLowerCase(),n=t.refundInfo.interventions||[];if(!n.length||!e)return!1;let d=!1;return d=n.some(D=>D.address.toLowerCase()===e),d},I=(t,e)=>{t.showExtContent=e||!1},ee=(t,e)=>{var n,d;if(e===1)return(n=t.refundInfo)!=null&&n.merchantInterveneStatus?"支持商家":"支持买家";if(e===2)return(d=t.refundInfo)!=null&&d.merchantInterveneStatus?"支持买家":"支持商家"},V=(t,e)=>{var n,d;if(e==="buyer")return(n=t.refundInfo)!=null&&n.merchantInterveneStatus?2:1;if(e==="seller")return(d=t.refundInfo)!=null&&d.merchantInterveneStatus?1:2},$=t=>{const e=t.refundInfo||{};let n={};return n=e.buyerEvidence?JSON.parse(e.buyerEvidence):{},n.imgs&&typeof n.imgs=="string"&&(n.imgs=n.imgs.split(",")||[]),n},A=t=>{const e=t.refundInfo||{};let n={};return n=e.merchantEvidence?JSON.parse(e.merchantEvidence):{},n.imgs&&typeof n.imgs=="string"&&(n.imgs=n.imgs.split(",")||[]),n},N=me();N.query.active&&(a.active=Number(N.query.active));const j=async(t,e)=>{if(!e){H.fail("缺少支持对象，请重试");return}try{E(!0);const{success:n}=await Ee({orderId:t.id,status:e});n&&te(t.id)}finally{E(!1)}},te=async t=>{const e=await Fe({id:t});if(!e.success)return;const n=a.list.findIndex(d=>d.id==t);n>-1&&!pe.isEmpty(e.data)&&(e.data.showExtContent=!0,a.list[n]=e.data)},se=async()=>{a.loading=!0,a.page+=1,await ne(),a.loading=!1},ne=async()=>{const t={page:a.page,size:a.size,type:4},e=await Be(t);if(a.loading=!1,!e.success){a.finished=!0;return}if(!e.data||!e.total){a.finished=!0;return}e.data.forEach(n=>{n.showExtContent=!0}),a.total=e.total,a.list=a.page===1?e.data:a.list.concat(e.data),a.list.length>=a.total&&(a.finished=!0)},G=(t,e)=>{if(!Array.isArray(t)){H.fail("不支持预览的图片来源");return}he({images:t,startPosition:e})};return(t,e)=>{const n=v("van-icon"),d=v("van-image"),D=v("van-popover"),oe=v("i18n-t"),z=v("VanButton"),ae=v("VanList");return r(),C(_e,{title:t.$t("order.Platform intervention"),class:"bg-gray1 font-Puhui font-normal relative shopGoodsPage h-full px-3","theme-vars":{"field-placeholder-text-color":"#A6A6A6"},ref:(s,F)=>{F.shopGoodsRef=s}},{right:m(()=>[p(Se)]),default:m(()=>[p(ae,{class:"mt-2.5",loading:u(a).loading,"onUpdate:loading":e[0]||(e[0]=s=>u(a).loading=s),finished:u(a).finished,"finished-text":t.$t("common.noMore"),"loading-text":t.$t("common.loading"),onLoad:se},{default:m(()=>[(r(!0),c(y,null,b(u(a).list,s=>(r(),C(je,{key:s.id,order:s,isService:!0},{default:m(()=>{var F,O,q,J;return[o("div",Ge,[ze,o("div",Oe,f(k(s)),1)]),o("div",{class:U(["min-h-[36px] w-full bg-[#F5F5F5] rounded-lg mt-3 p-2",{"h-auto":s.showExtContent}])},[o("div",{class:"flex items-center justify-between",onClick:l=>I(s,!s.showExtContent)},[Je,o("div",null,[p(n,{name:"arrow-down",color:"#585654",class:U({"rotate-180":s.showExtContent})},null,8,["class"])])],8,qe),s.showExtContent?(r(),c("div",Ue,[s.refundInfo.merchantInterveneStatus?(r(),c("div",He,[Me,o("div",Qe,[o("p",Ke,f(((F=A(s))==null?void 0:F.content)||"-"),1)]),o("div",Xe,[(r(!0),c(y,null,b((O=A(s))==null?void 0:O.imgs,(l,P)=>(r(),C(d,{key:l,src:l,width:"72",height:"72",class:"w-[72px] h-[72px] rounded-md overflow-hidden bg-[#d9d9d9]",onClick:ie=>{var w;return G((w=A(s))==null?void 0:w.imgs,P)}},null,8,["src","onClick"]))),128))])])):(r(),c("div",Ye,[Ze,o("div",We,[o("p",et,f(((q=$(s))==null?void 0:q.content)||"-"),1)]),o("div",tt,[(r(!0),c(y,null,b((J=$(s))==null?void 0:J.imgs,(l,P)=>(r(),C(d,{key:l,src:l,width:"72",height:"72",class:"w-[72px] h-[72px] rounded-md overflow-hidden bg-[#d9d9d9]",onClick:ie=>{var w;return G((w=$(s))==null?void 0:w.imgs,P)}},null,8,["src","onClick"]))),128))])]))])):B("",!0)],2),o("div",st,[o("div",nt,[ot,p(D,{show:s.showPopover,"onUpdate:show":l=>s.showPopover=l,placement:"top-start"},{reference:m(()=>[o("div",{onClick:R(l=>s.showPopover=!s.showPopover,["stop"])},dt,8,rt)]),default:m(()=>[o("div",at,[o("div",it,[p(n,{name:"warning",color:"#FEA021",size:"14"}),T(" "+f(t.$t("order.saleAuth")),1)])])]),_:2},1032,["show","onUpdate:show"])]),s.refundInfo.interventions&&s.refundInfo.interventions.length>0?(r(),c("div",ct,[(r(!0),c(y,null,b(s.refundInfo.interventions,l=>(r(),c("div",{class:"flex items-center justify-between text-sm font-normal font-Puhui text-b2",key:l.id},[p(oe,{keypath:"order.saleAuthRes",tag:"span"},{address:m(()=>[o("span",ut,f(u(W)(l.address,"....",5,4)),1)]),_:2},1024),o("div",ft,f(ee(s,l.status)),1)]))),128))])):B("",!0)]),x?(r(),c("div",mt,[p(z,{class:"handle-btn whitespace-nowrap text-sm font-normal text-b2 min-w-[80px]",onClick:R(l=>j(s,V(s,"buyer")),["stop"]),loading:u(h),disabled:S(s)||u(h)},{default:m(()=>[pt]),_:2},1032,["onClick","loading","disabled"]),p(z,{class:"handle-btn whitespace-nowrap text-sm font-normal text-b2 min-w-[80px]",onClick:R(l=>j(s,V(s,"seller")),["stop"]),loading:u(h),disabled:S(s)||u(h)},{default:m(()=>[ht]),_:2},1032,["onClick","loading","disabled"])])):B("",!0)]}),_:2},1032,["order"]))),128))]),_:1},8,["loading","finished","finished-text","loading-text"])]),_:1},8,["title"])}}}),Tt=M(vt,[["__scopeId","data-v-9ebc5a5a"]]);export{Tt as default};
