import{_ as B}from"./upload-B7OBZe8E.js";import{_ as I,y as U,w as $,r as u,bc as E,E as c,K as F,G as R,N as _,H as a,O as r,Q as i,a0 as T,T as g,Y as D,Z as N}from"./vendor-CjApaIpB.js";import{e as P,b as z}from"./concat-DuyRaIc0.js";import{r as O,a2 as j,q as L}from"./index-CduCwCyL.js";import{u as q}from"./upload-oEQH2FHy.js";const A=s=>(D("data-v-87db80a2"),s=s(),N(),s),G={class:"px-4 py-4 mb-4"},H={class:"mb-4 text-base font-medium text-center"},K={class:"mt-4 mb-6"},Q={class:"bg-[#F2F0EF] p-2.5 pt-[5px] rounded-xl w-[60px] h-[60px]"},Y=A(()=>a("img",{class:"w-[24px] h-[24px] m-auto object-cover",src:B},null,-1)),Z={class:"text-[#2E2008] opacity-30 text-xxs mt-[2px]"},J={class:"text-xxs text-[#2E2008] opacity-30 leading-none text-center w-full"},M={class:"text-center"},W=U({props:{show:{type:Boolean},id:{default:null}},emits:["close"],setup(s,{emit:p}){const m=s,{t:f}=$(),n=u(""),t=u([]),v=u(!1),{loadingToggle:d}=O(),[X,ee]=E(!1),b=u(3),h=async o=>{try{v.value=!0,d(!0,1);const e=await j(o,"feedback"),l=await q(e);if(!l.success)return t.value.length-=1;t.value[t.value.length-1]={url:L.imgUrl+l.data}}finally{d(!1),v.value=!1}},w=async()=>{if(v.value){g(f("common.uploading"));return}if(d(!0),!n.value){g(f("common.please input content"));return}const o=t.value.map(l=>l.url).join(",");let e={};m.id?e=await P({content:n.value,imageUrls:o,id:m.id}):e=await z({content:n.value,imageUrls:o}),d(!1),e.success&&(n.value="",t.value=[],p("close",1),g(f("common.success")))},k=()=>{n.value="",t.value=[]};return(o,e)=>{const l=c("van-icon"),y=c("van-field"),V=c("van-uploader"),C=c("VanButton"),S=c("VanPopup");return R(),F(S,{show:m.show,round:"",onOpen:k,position:"bottom",onClickOverlay:e[3]||(e[3]=()=>{p("close")})},{default:_(()=>[a("div",G,[a("div",H,i(s.id?o.$t("user.Respond to feedback"):o.$t("common.comminicate")),1),r(l,{name:"cross",size:"22",class:"absolute top-4 right-2.5",onClick:e[0]||(e[0]=()=>{p("close")})}),r(y,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=x=>n.value=x),rows:"5",autosize:"",label:"",type:"textarea",maxlength:"200",placeholder:s.id?o.$t("user.Enter your response to this feedback"):o.$t("profile.feedbackDes"),"show-word-limit":""},null,8,["modelValue","placeholder"]),a("div",K,[r(V,{modelValue:t.value,"onUpdate:modelValue":e[2]||(e[2]=x=>t.value=x),accept:"image/*","preview-size":"60","max-count":b.value,afterRead:h},{default:_(()=>[a("div",Q,[Y,a("div",Z,i(o.$t("common.add img")),1),a("div",J,i(t.value.length)+" / "+i(b.value),1)])]),_:1},8,["modelValue","max-count"])]),a("div",M,[r(C,{class:"font-semibold btn h-[38px] min-w-[160px] px-4 rounded-3xl text-base",onClick:w},{default:_(()=>[T(i(o.$t("common.submit")),1)]),_:1})])])]),_:1},8,["show"])}}}),le=I(W,[["__scopeId","data-v-87db80a2"]]);export{le as C};
