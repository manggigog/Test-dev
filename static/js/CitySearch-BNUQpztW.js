import{y as B,F as d,G as l,I as O,J as D,a4 as ee,R as se,Q as r,_ as q,x as V,E as R,H as e,O as y,P as w,a2 as S,K as C,Y as z,Z as P,X as te,l as oe,a1 as ae,w as le,r as f,D as ne,bc as ce,bo as ie,bz as re,N as de}from"./vendor-BUT0HZ5j.js";import{_ as ue}from"./search-Dwmdj_3F.js";import{_ as me}from"./delete-C3qvlPYO.js";import{B as fe}from"./BackIcon-biFt6cm7.js";import{B as ve}from"./BetweenTab-Bn5ZVRk8.js";import{_ as he}from"./MCOIN-BcbOHmhy.js";import{_ as _e}from"./store-CPx32ymB.js";import{u as G}from"./useCityMap-fPla5ZMg.js";import{R as pe}from"./RatioBox-1s0IUNNW.js";import{_ as ge}from"./ImgBoutiqueLable-BF5Xoxsv.js";import{d as be,e as xe,as as ye,az as we,aA as $e}from"./index-hbwLMIYO.js";import{O as ke}from"./OfflineMerchantLabel-DTcnjuGQ.js";/* empty css                                                               */import"./shop-CeqcS6K2.js";const Ce={class:"flex flex-wrap items-center gap-3"},Se=["onClick"],Ie=B({props:{modelValue:null,options:null},emits:["update:modelValue","change"],setup(s,{emit:u}){function v(i){u("update:modelValue",i.value),u("change",i.value)}return(i,p)=>(l(),d("div",Ce,[(l(!0),d(O,null,D(s.options,(a,n)=>(l(),d("div",{class:se(["w-fit h-[32px] px-3 py-1.5 rounded-md text-sm flex justify-center items-center",s.modelValue===a.value?"bg-[#FFF8EC] text-[#FF8812] border-solid border border-[#FF8812]":"bg-[#F5F5F5]  text-[#585654]"]),key:a.value??n,onClick:ee(m=>v(a),["stop"])},r(a.label),11,Se))),128))]))}}),M=s=>(z("data-v-7b615ccc"),s=s(),P(),s),Ne=["data-store-name"],Re={class:"shrink-0 offline-goods-img__wrap w-[80px] h-[80px] overflow-hidden relative"},Fe={class:"offline-goods-info__wrap ml-2 flex-1 flex flex-col justify-between min-h-[80px]",style:{width:"calc(100% - 80px - 8px)"}},Ee={class:"w-full flex flex-col items-start"},Oe={class:"w-full"},Ve={class:"font-semibold text-sm line-clamp-1"},Be={class:"w-full"},Te={class:"font-normal text-b3 text-sm line-clamp-1"},Le={class:"flex items-center justify-start font-Puhui"},je={class:"flex items-center"},De=M(()=>e("img",{src:he,class:"w-4 h-4 mr-1"},null,-1)),qe={class:"text-b1 font-semibold text-sm"},ze={key:0,class:"w-full"},Pe={class:"font-normal text-b3 text-sm flex items-center justify-start"},Ge=M(()=>e("img",{src:_e,class:"w-4 h-4 line-clamp-1"},null,-1)),Me={class:"line-clamp-1"},Ae={key:0,class:"distance ml-auto whitespace-nowrap pl-1"},Ke=B({props:{goods:{type:Object,default:()=>({})},showStoreName:{type:Boolean,default:!1}},setup(s){const u=s,{distanceFormat:v}=G(),i=V(()=>{var a;return(((a=u.goods.goodsIcons)==null?void 0:a.split(","))||[""])[0]});return(p,a)=>{const n=R("VanImage");return l(),d("section",{class:"flex items-start","data-store-name":s.goods.shopName},[e("div",Re,[y(n,{src:w(i),class:"offline-goods-img w-[80px] h-[80px] rounded-lg overflow-hidden",alt:"商品主图",fit:"cover"},null,8,["src"]),y(ge,{type:s.goods.goodsType||null},null,8,["type"])]),e("div",Fe,[e("div",Ee,[e("div",Oe,[e("div",Ve,r(s.goods.goodsName||""),1)]),e("div",Be,[e("div",Te,r(s.goods.goodsDesc||""),1)])]),e("div",Le,[e("div",je,[De,e("div",qe,r(w(be)(s.goods.goodsPrice)),1)]),s.goods.goodsDiscountRatio?(l(),C(pe,{key:0,class:"ratio-box ml-1 !px-1",tag:p.$t("common.rebate"),ratio:s.goods.goodsDiscountRatio},null,8,["tag","ratio"])):S("",!0)]),s.showStoreName&&s.goods.shopName?(l(),d("div",ze,[e("div",Pe,[Ge,e("span",Me,r(s.goods.shopName||"")+"·"+r(s.goods.storeName),1),s.goods.distance?(l(),d("span",Ae,r(w(v)(s.goods.distance)),1)):S("",!0)])])):S("",!0)])],8,Ne)}}}),Ue=q(Ke,[["__scopeId","data-v-7b615ccc"]]),He={class:"shop-img w-[80px] h-[80px] rounded-lg overflow-hidden flex-shrink-0 relative"},Je={class:"shop-content h-full ml-2 w-full"},Qe={class:"w-full text-base text-b1 font-semibold flex items-center justify-between"},Xe={class:"line-clamp-1"},Ye={class:"text-sm text-b3 font-normal"},Ze={class:"text-sm text-b3 font-normal mt-[18px] flex items-center justify-between"},We={class:"engagement"},es={class:"distance"},ss={props:{backgroundColor:{type:String,default:""},store:{type:Object,default:()=>({})}},setup(s){const{distanceFormat:u}=G();return(v,i)=>{var a,n,m,h;const p=R("van-image");return l(),d("div",{class:"w-full rounded-xl flex items-center justify-start",style:te({backgroundColor:s.backgroundColor})},[e("div",He,[y(p,{width:"80",height:"80",fit:"cover",src:(((a=s.store)==null?void 0:a.storeIcons)||"").split(",")[0]},null,8,["src"]),+((n=s.store)==null?void 0:n.storeGoodsCount)>0?(l(),C(ke,{key:0})):S("",!0)]),e("div",Je,[e("div",Qe,[e("span",Xe,r((m=s.store)==null?void 0:m.storeName),1)]),e("div",Ye,r((h=s.store)==null?void 0:h.goodsCategoryName1)+" "+r(s.store.areaName3),1),e("div",Ze,[e("span",We,r(s.store.wantCount)+"人想要",1),e("span",es,r(w(u)(s.store.distance)),1)])])],4)}}},A=s=>(z("data-v-e4166748"),s=s(),P(),s),ts={class:"font-Puhui font-normal relative pb-20 app-container"},os={class:"header__wrap w-full h-[50px]"},as={class:"header__title h-full van-nav-bar__content"},ls={class:"van-nav-bar__left van-haptics-feedback"},ns={class:"van-nav-bar__title van-ellipsis text-b1 text-lg font-bold"},cs={class:"van-nav-bar__right van-haptics-feedback text-b3"},is={class:"search__wrap w-full h-[48px] px-3 pb-3"},rs={class:"search__input w-full h-full bg-white rounded-3xl flex items-center justify-center px-3 py-2.5"},ds=A(()=>e("div",{class:"search__icon flex-shrink-0"},[e("img",{src:ue,class:"w-4 h-4"})],-1)),us=["placeholder","onKeyup"],ms=A(()=>e("img",{src:me,class:"w-4 h-4",alt:""},null,-1)),fs=[ms],vs={class:"text-[#FF8812] text-sm font-semibold whitespace-nowrap"},hs={class:"list__wrap"},_s={class:"p-3"},ps={class:"goods__wrap overflow-y-scroll"},gs=B({name:"OfflineHome"});function bs(s){var j;const u=oe(),v=ae(),{cityMapStore:i}=xe(),{t:p}=le(),a=f(""),n=f(+((j=v.query)==null?void 0:j.tab)||"STORE"),m=f(!1),h=f(0),K=f(20),$=f(!1),g=f([]),U=V(()=>[{label:"线下门店",value:"STORE"},{label:p("shop.offline server"),value:"SERVE"}]),_=f("asc|distance"),H=V(()=>n.value==="STORE"?[{label:"距离优先",value:"asc|distance"},{label:"销量优先",value:"asc|store_sales_volume_order"}]:[{label:"距离优先",value:"asc|distance"},{label:"销量优先",value:"asc|store_sales_volume_order"},{label:"星级优先",value:"asc|goods_sort"}]),J=()=>{a.value="",F()},Q=t=>{n.value=t,t==="STORE"&&_.value==="asc|goods_sort"&&(_.value="asc|distance"),u.replace({path:"/city/search",query:{tab:t}}),L()},X=t=>{_.value=t,L()},T=f(null),F=()=>{m.value||(h.value=0,$.value=!1,g.value=[],I(),T.value.blur())},L=()=>{h.value=0,$.value=!1,g.value=[],I()},I=async()=>{m.value=!0,h.value+=1,$.value=!1,await Y(),m.value=!1},Y=async()=>{var o;let t={};n.value==="STORE"?t={storeNameLike:a.value,overseasFlag:!1,areaIdPreviousLastLeaf:(o=i==null?void 0:i.currentActiveCity)==null?void 0:o.areaId}:t={goodsStatus:1,goodsNameLike:a.value};let c="";n.value==="STORE"?c=_.value+",asc|store_id":c=_.value+",asc|goods_id",_.value==="asc|distance"&&(!i.locationCoords.lat||!i.locationCoords.lng)&&(c=null);const N={page:h.value,size:K.value,...t,longitude:i.locationCoords.lng||null,latitude:i.locationCoords.lat||null,sortBy:c},{success:E,data:b}=n.value==="STORE"?await we(N):await $e(N);if(!E||!b||!b.total){$.value=!0;return}const k=b.records||[];k.forEach(x=>{x.shopName=x.storeName||x.shopName}),g.value=h.value===1?k:[...g.value,...k],g.value.length>=b.total&&($.value=!0)},Z=t=>{u.push({path:"/city/search/offlineGoodsDetail",query:{goodsId:t.goodsId}})},W=t=>{console.log(t),u.push({path:"/city/search/storefront",query:{storeId:t.storeId,child:1}})};return ne(()=>{var t,c;(t=v.query)!=null&&t.tab&&(n.value=(c=v.query)==null?void 0:c.tab),I()}),(t,c)=>{var b,k;const N=R("van-list"),E=R("router-view");return l(),d("div",ts,[e("div",os,[e("div",as,[e("div",ls,[y(fe)]),e("div",ns,r(t.$t("common.search")),1),e("div",cs,r((k=(b=w(i))==null?void 0:b.currentActiveCity)==null?void 0:k.areaName),1)])]),e("div",is,[e("div",rs,[ds,ce(e("input",{ref:(o,x)=>{x.searchRef=o,T.value=o},type:"text","onUpdate:modelValue":c[0]||(c[0]=o=>a.value=o),class:"w-full h-full bg-transparent ml-1 font-normal",placeholder:t.$t("mall.Enter search keywords"),onKeyup:re(F,["enter"]),enterkeyhint:"search"},null,40,us),[[ie,a.value]]),a.value?(l(),d("div",{key:0,class:"flex-shrink-0 flex items-center justify-center",onClick:J},fs)):S("",!0),e("div",{class:"search__btn ml-2 flex-shrink-0",onClick:F},[e("span",vs,r(t.$t("common.search")),1)])])]),e("div",hs,[y(ve,{options:w(U),"label-key":"label","value-key":"value",class:"!pt-3",modelValue:n.value,"onUpdate:modelValue":c[1]||(c[1]=o=>n.value=o),onChange:Q},null,8,["options","modelValue"]),e("div",_s,[y(Ie,{options:w(H),modelValue:_.value,"onUpdate:modelValue":c[2]||(c[2]=o=>_.value=o),onChange:X},null,8,["options","modelValue"])]),e("div",ps,[g.value.length===0&&!m.value?(l(),C(ye,{key:0,name:t.$t("common.No data yet")},null,8,["name"])):(l(),C(N,{key:1,loading:m.value,"onUpdate:loading":c[3]||(c[3]=o=>m.value=o),finished:$.value,"finished-text":t.$t("common.noMore"),onLoad:I},{default:de(()=>[(l(!0),d(O,null,D(g.value,o=>(l(),d(O,{key:o.goodsId},[n.value==="STORE"?(l(),C(ss,{key:0,store:o,class:"mb-4 :last:mb-0",onClick:x=>W(o)},null,8,["store","onClick"])):(l(),C(Ue,{key:1,goods:o,class:"mb-4 :last:mb-0",onClick:x=>Z(o),"show-store-name":""},null,8,["goods","onClick"]))],64))),128))]),_:1},8,["loading","finished","finished-text"]))])]),y(E,{class:"child-view bg-gray1"})])}}const xs=Object.assign(gs,{setup:bs}),Ts=q(xs,[["__scopeId","data-v-e4166748"]]);export{Ts as default};
