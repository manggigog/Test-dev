import{y as Q,F as d,G as a,H as t,Q as y,l as le,r as _,D as ie,O as k,P as e,_ as E,w as te,N as it,Y as j,Z as H,T as _e,x as R,z as ct,R as K,I as J,J as ve,a9 as De,E as ae,K as M,a0 as nt,bc as we,bd as xe,a3 as Bt,X as U,a2 as ee,n as he,a4 as Lt,be as D,bf as Pt,bg as at,bh as Ut,bi as At,t as lt}from"./vendor-BUT0HZ5j.js";import{L as zt,I as Nt}from"./LevelPop-CI2l8sgM.js";import{_ as Dt,a as Et,E as Ft,H as Ot}from"./EditUserNamePop-DqezgEHN.js";import{_ as Mt}from"./avatarRing-DpEnkbQ2.js";import{U as Wt}from"./UserAsset-mpHxScRn.js";import{u as Ee,f as be,a as rt,b as ut,p as ge,c as jt,d as W,e as ce,h as Ht,g as Gt,m as qt,i as Vt,j as Qt,o as Zt,k as Yt,l as Xt,n as V,q as Jt}from"./index-k1FFr-1T.js";import{_ as Kt}from"./mcoin-logo-1-BPG653EL.js";import{u as dt}from"./usePointRelase-C-Fgyriy.js";import{L as Ne}from"./Lottie_v2-BaRBl8U7.js";import{I as es,W as ts}from"./WithdrawPop-D92I1eYc.js";import{a as ss}from"./activityContract-ByRlGdW4.js";import{q as os,u as ns}from"./user-B-N_oWpO.js";import{b as as}from"./browser-DFlSdkZC.js";import"./close-DLkDHnDK.js";import"./PopHeader-CfzTkyoF.js";import"./TokenBalance-CFr2KqO2.js";import"./level-L7avmjJN.js";import"./ChangeRegionPop-C7x8iMg_.js";import"./arrow-CRN8rk-J.js";import"./arrow-bottom-DXMIX572.js";import"./ApproveButton-DKuNv3sH.js";import"./MCOIN-BcbOHmhy.js";const ls="/Test-dev/static/images/edit-D2b4Y7Fs.svg",is={class:"flex items-center justify-start text-lg mt-1"},cs={class:"truncate text-sm text-b1 font-semibold line-clamp-1"},rs=t("img",{src:ls,class:"w-4 h-4"},null,-1),us=[rs],ds=Q({props:{userName:null},emits:["handleToEditName"],setup(o,{emit:h}){return(r,u)=>(a(),d("div",is,[t("div",cs,y(o.userName),1),t("div",{class:"ml-1 text-primary",onClick:u[0]||(u[0]=l=>h("handleToEditName"))},us)]))}}),ms={class:"relative pt-3 px-3 pb-1"},ps={class:"avatar-wrap flex flex-row justify-start items-center"},fs={class:"relative flex-shrink-0"},vs=t("img",{class:"w-[32px] h-[32px] relative m-auto",src:Mt},null,-1),hs={class:"text-xs font-Puhui text-center px-1"},gs={class:"nickname-wrap h-[36px]"},_s=Q({props:{info:null,vsageUserInfo:null,isTag:{type:Boolean},tokens:null},emits:["setEditNameShow","setLevelShow"],setup(o,{emit:h}){const{getCurrentAccount:r}=Ee(),u=le(),{memberLevels:l}=be(),{changeUserInfo:i,userInfo:$}=rt(),m=_(($==null?void 0:$.storeMemberLevel)||0),x=async()=>{m.value=await l(),i({...$,storeMemberLevel:m.value})},S=f=>{u.push(f)},p=()=>{h("setEditNameShow")};return ie(()=>{x()}),(f,c)=>{var T;return a(),d("div",ms,[t("div",ps,[t("div",fs,[vs,t("div",{class:"bg-white rounded-xl flex text-center absolute right-[-14px] bottom-[-4px] min-w-max",onClick:c[0]||(c[0]=g=>h("setLevelShow"))},[t("p",hs," V"+y(m.value||0),1)])]),k(Wt,{tokens:o.tokens,onHandleTo:S,class:"w-full ml-6"},null,8,["tokens"])]),t("div",gs,[k(ds,{class:"min-w-max","user-name":((T=o.vsageUserInfo)==null?void 0:T.nickName)||e(ut)(e(r)()||"-","...",5,4),onHandleToEditName:p},null,8,["user-name"])])])}}}),ws="/Test-dev/static/images/tools-scan-C28Ke7ai.png",xs="/Test-dev/static/images/tools-trans-Ck2uxaL4.png",bs="/Test-dev/static/images/tools-share-Dmjj9UlR.png",ys="/Test-dev/static/images/tools-i18n-cOjffy46.png",ye=o=>(j("data-v-74f1ba01"),o=o(),H(),o),$s={class:"flex flex-col justify-start items-center absolute right-3 top-[54px]"},Ss=ye(()=>t("img",{src:ws,alt:"扫码"},null,-1)),Ts=[Ss],Is=ye(()=>t("img",{src:xs,alt:"转账"},null,-1)),ks=[Is],Cs=ye(()=>t("img",{src:bs,alt:"分享"},null,-1)),Rs=[Cs],Bs={class:"tool-item"},Ls=ye(()=>t("img",{src:ys,alt:"语言"},null,-1)),Ps={emits:["handleTo","scan","invite"],setup(o,{emit:h}){const{t:r}=te(),{members:u}=be(),l=()=>{h("scan")},i=()=>{h("handleTo","/collect")},$=async()=>{if(!await u())return _e(r("home.inviteTip"));h("invite")};return(m,x)=>(a(),d("div",$s,[t("div",{class:"tool-item",onClick:l},Ts),t("div",{class:"tool-item",onClick:i},ks),t("div",{class:"tool-item",onClick:$},Rs),t("div",Bs,[k(Dt,{position:"right"},{icon:it(()=>[Ls]),_:1})])]))}},Us=E(Ps,[["__scopeId","data-v-74f1ba01"]]),As="/Test-dev/static/images/information-BqDj4dbA.svg",Fe=o=>(j("data-v-a99e19b8"),o=o(),H(),o),zs={class:"point-days rounded-lg"},Ns={class:"relative w-full"},Ds=Fe(()=>t("img",{src:Et,class:"absolute top-0 right-0 -z-1"},null,-1)),Es={key:0,class:"z-10"},Fs={key:0,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},Os={class:"time-text-shadow"},Ms={class:"text-xs"},Ws={key:1,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},js={class:"time-text-shadow"},Hs={class:"text-xs text-[#000] font-semibold"},Gs={key:2,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},qs={class:"time-text-shadow"},Vs={class:"text-xs text-[#000] font-semibold"},Qs={key:3,class:"text-[#000] font-semibold text-2xl flex items-end z-10"},Zs={class:"time-text-shadow"},Ys={class:"text-xs text-[#000] font-semibold"},Xs={key:1,class:"text-[#000] font-semibold text-3xl flex items-center z-10"},Js=Fe(()=>t("span",{class:"time-text-shadow text-3xl font-WorkSans"}," ∞ ",-1)),Ks={class:"ml-1 text-xs pt-3 pl-1"},eo={class:"text-b2 font-normal text-xxs"},to={class:"text-xxs font-bold text-b2"},so=Fe(()=>t("img",{class:"w-3 h-3 ml-[2px]",src:As},null,-1)),oo=Q({props:{contributes:{default:0},coinPoint:{default:0},userActiveStatus:{default:0},userActiveTime:{default:null}},emits:["handleOpen"],setup(o,{emit:h}){const r=o,{t:u}=te(),l=R(()=>r.userActiveStatus===1?r.userActiveStatus:r.contributes<=1e4?1:0),i=_(0),$=_(0),m=_(0),x=_(0),S=_(0),p=R(()=>($.value=Math.floor(i.value/3600/24)<=0?0:Math.floor(i.value/3600/24),x.value=Math.floor(i.value/3600)<=0?0:Math.floor(i.value/3600),m.value=Math.floor(i.value/60)<=0?0:Math.floor(i.value/60),S.value=Math.floor(i.value)<=0?0:Math.floor(i.value),[$.value,x.value,m.value,S.value]));let f=null;return ct(()=>{var c;return(c=r.userActiveTime)==null?void 0:c.cutdownTimestamp},c=>{c&&(i.value=(c-new Date().getTime())/1e3,f&&clearInterval(f),f=setInterval(()=>{i.value>0?i.value--:clearInterval(f)},1e3))},{immediate:!0,deep:!0}),(c,T)=>(a(),d("div",zs,[t("div",Ns,[t("div",{class:K(["flex items-end justify-center relative rounded-t-lg p-2 min-w-[80px] overflow-hidden h-[46px]",e(l)?" bg-[#FED73A]":"bg-[#E9E4DE]"])},[Ds,o.contributes>=1e4?(a(),d("div",Es,[e(p)[0]>0?(a(),d("div",Fs,[(a(!0),d(J,null,ve(e(ge)(e(p)[0],2),(g,I)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1",key:I},[t("span",Os,y(g),1)]))),128)),t("div",Ms,y(c.$t("common.days")),1)])):e(p)[1]>0?(a(),d("div",Ws,[(a(!0),d(J,null,ve(e(ge)(e(p)[1],2),(g,I)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:I},[t("span",js,y(g),1)]))),128)),t("div",Hs,y(c.$t("common.hours")),1)])):e(p)[2]>0?(a(),d("div",Gs,[(a(!0),d(J,null,ve(e(ge)(e(p)[2],2),(g,I)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:I},[t("span",qs,y(g),1)]))),128)),t("div",Vs,y(c.$t("common.minutes")),1)])):(a(),d("div",Qs,[(a(!0),d(J,null,ve(e(ge)(e(p)[3],2),(g,I)=>(a(),d("div",{class:"bg-white w-[23px] h-[30px] rounded-lg mr-1 px-1 overflow-hidden text-center",key:I},[t("span",Zs,y(g),1)]))),128)),t("div",Ys,y(c.$t("common.seconds")),1)]))])):(a(),d("div",Xs,[Js,t("div",Ks,y(c.$t("common.days")),1)]))],2),t("div",{onClick:T[0]||(T[0]=g=>h("handleOpen")),class:K(["font-normal pl-4 text-center rounded-b-[4px] pr-2 flex items-center justify-center w-full py-[1px] h-[15px]",e(l)?"bg-[#FFE0B6]":"bg-[#FFF0D9]"])},[t("span",eo,y(e(jt)(e(W)(o.coinPoint,0))),1),t("span",to,y(c.$t("common.credit")),1),so],2)])]))}}),no=E(oo,[["__scopeId","data-v-a99e19b8"]]),ao="/Test-dev/static/images/go-tr-C6OxuTpH.png",lo="/Test-dev/static/images/go-tr-icon-D6nG65Ok.png",io="/Test-dev/static/images/go-tr-arrow-BxXIWQWF.png",Oe=o=>(j("data-v-41206486"),o=o(),H(),o),co=Oe(()=>t("div",{class:"tr-img"},[t("img",{src:ao})],-1)),ro=Oe(()=>t("img",{src:lo,alt:"token right icon",class:"absolute top-[-6px] left-[6px] w-[40px] h-[40px]"},null,-1)),uo={class:"absolute right-[4px] top-0 h-full flex justify-end items-center -translate-y-[2px]"},mo={class:"text-sm font-semibold font-Puhui text-b6"},po=Oe(()=>t("img",{src:io,class:"w-[16px] h-[16px] ml-[2px]"},null,-1)),fo={setup(o){const h=()=>{var u;const r=`${(u=window.location)==null?void 0:u.origin}/ecology/#/maiPledge?refresh=1&origin=main`;window.location.assign(r)};return(r,u)=>(a(),d("div",{class:"go-token-right relative w-[128px]",onClick:h},[co,ro,t("p",uo,[t("span",mo,y(r.$t("ecology.Token Rights road")),1),po])]))}},vo=E(fo,[["__scopeId","data-v-41206486"]]),ho="/Test-dev/static/images/balance-big-BlAQSRAv.png",go="/Test-dev/static/images/balance-small-DTMS8DT7.png",_o="/Test-dev/static/images/visibility-D5JMp6Ho.svg",wo="/Test-dev/static/images/copy-gray-CDg8kt-2.svg",xo="/Test-dev/static/images/bank-card-fill-6SZF_gMZ.svg",Z=o=>(j("data-v-0d1f03ca"),o=o(),H(),o),bo={class:"balance-container relative w-full"},yo=Z(()=>t("img",{src:ho,class:"absolute top-0 left-0 w-full h-[107px] z-[1]"},null,-1)),$o=Z(()=>t("img",{src:go,class:"absolute top-2 right-2 w-[40%] h-[39px]"},null,-1)),So={class:"absolute top-0 left-0 w-full h-full p-3 z-[2]"},To={class:"point-box"},Io={class:"flex items-center font-sm text-b2 font-normal"},ko=Z(()=>t("img",{class:"w-4 h-4",src:_o},null,-1)),Co=[ko],Ro={class:"text-xl text-b1 font-Audiowide mt-1 leading-[25px] min-w-max"},Bo=Z(()=>t("img",{src:wo,class:"w-3 h-3 ml-2",alt:"copy"},null,-1)),Lo={class:"balance-box"},Po={class:"balance-item"},Uo={class:"balance-icon"},Ao=Z(()=>t("img",{src:Kt,alt:""},null,-1)),zo={class:"balance-label text-b3 text-sm"},No={class:"balance-value"},Do=Z(()=>t("div",{class:"divider"},null,-1)),Eo={class:"balance-icon"},Fo=Z(()=>t("img",{src:xo},null,-1)),Oo={class:"balance-label text-b3"},Mo={class:"balance-value"},Wo=Q({props:{contributes:{default:0},contributesLoading:{type:Boolean,default:!1},pointBalance:{default:0},mcoinBalance:{default:0},pointLoading:{type:Boolean,default:!1},mcoinLoading:{type:Boolean,default:!1}},setup(o){const h=le(),{getCurrentAccount:r}=Ee(),{contributesStore:u}=ce(),{t:l}=te(),i=_(1),$=()=>{const c=Math.min(window.innerWidth,375);i.value=c/375},m=()=>{u.changeHideIntegral(!u.hideIntegral)},x=()=>{const f=r();f&&Ht(f)},S=R(()=>ut(r()||"-","...",5,4)),p=f=>{h.push(f)};return ie(()=>{window.addEventListener("resize",$)}),De(()=>{window.removeEventListener("resize",$)}),(f,c)=>{const T=ae("VanLoading"),g=ae("van-loading");return a(),d("div",bo,[yo,$o,t("div",So,[t("div",To,[t("div",Io,[t("span",null,y(f.$t("common.credit")),1),t("div",{class:"pl-1",onClick:m},Co)]),t("div",Ro,[o.contributesLoading?(a(),M(T,{key:0,color:"#000",size:"20"})):(a(),d("span",{key:1,class:"relative",onClick:c[0]||(c[0]=I=>p("/integralDetail"))},y(e(u).hideIntegral?e(W)(o.contributes,2):"***"),1))])]),t("div",{class:"address-box text-b1 font-normal text-xs absolute flex items-center justify-end h-[18px] leading-[18px] top-[16px] right-[20px]",onClick:x},[t("span",null,y(e(S)),1),Bo]),t("div",Lo,[t("div",Po,[t("div",Uo,[Ao,t("div",zo,y(f.$t("common.wallet")),1)]),t("div",No,[o.mcoinLoading?(a(),M(g,{key:0,size:"14"})):(a(),d(J,{key:1},[nt(y(e(W)(o.mcoinBalance||0,3)),1)],64))])]),Do,t("div",{class:"balance-item",onClick:c[1]||(c[1]=I=>p("/balanceDetail"))},[t("div",Eo,[Fo,t("div",Oo,y(f.$t("assets.canWithdrawv2")),1)]),t("div",Mo,[o.pointLoading?(a(),M(g,{key:0,size:"14"})):(a(),d(J,{key:1},[nt(y(e(W)(o.pointBalance,3)),1)],64))])])])])])}}}),jo=E(Wo,[["__scopeId","data-v-0d1f03ca"]]),Ho={class:"flex justify-between gap-3"},Go={emits:["invest","withdraw"],setup(o){return(h,r)=>(a(),d("div",Ho,[t("div",{class:"send-btn w-full h-[50px] text-[#FF8812] text-lg text-center flex items-center justify-center",onClick:r[0]||(r[0]=u=>h.$emit("invest"))},y(h.$t("home.invest")),1),t("div",{class:"get-btn w-full h-[50px] text-b1 text-lg text-center flex items-center justify-center",onClick:r[1]||(r[1]=u=>h.$emit("withdraw"))},y(h.$t("home.withdraw")),1)]))}},qo=E(Go,[["__scopeId","data-v-8029a830"]]),Vo="/Test-dev/static/images/cat-house-BaIWGYDK.png",Qo="/Test-dev/static/images/cat-shadow-naI2hTWi.svg",Zo="/Test-dev/static/images/bowl-BUuEu_lz.png",Yo="/Test-dev/static/images/arrow-right-s-line-DoZN1Qa9.png",Xo="/Test-dev/static/images/cat-food-CqiIXtTs.png",Jo=o=>(j("data-v-7ab7cf68"),o=o(),H(),o),Ko={class:"text-xs text-white font-semibold text-shadow text-center whitespace-nowrap"},en=Jo(()=>t("img",{src:Xo,alt:"",class:"h-[28px]"},null,-1)),tn={class:"font-semibold text-sm text-[#B67829] display-text-shadow"},sn={key:1},on=Q({props:{scale:{default:1},bubbleLoading:{type:Boolean,default:!1},text:{default:""}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:h,emit:r}){const u=o,{t:l}=te(),{contributesStore:i}=ce(),{handleNaturePoints:$}=dt(),m=R(()=>u.bubbleLoading),x=R(()=>i.freeRelease||0);R(()=>i.releaseLoading),R(()=>i.releaseSecond);const S=_(!1),p=_(!1),f=()=>{if(u.bubbleLoading||S.value||W(x.value)<=0)return;S.value=!0,setTimeout(()=>{p.value=!0,S.value=!1;try{r("releaseStart"),$(c)}catch(T){console.error("release fail:",T),setTimeout(()=>{r("releaseFail"),p.value=!1},1e3)}},500);const c=(T=!0)=>{T?r("releaseSuccess"):(console.error("release fail"),setTimeout(()=>{r("releaseFail"),p.value=!1,console.log("animationFinished",p.value)},1e3))}};return h({handleRelease:f}),(c,T)=>{const g=ae("van-loading");return we((a(),d("div",{class:K(["release-bubble w-[140px] max-w-[140px] h-[140px] max-h-[140px] flex flex-col items-center justify-center",S.value?"release-loading":""]),style:U({width:`${90*o.scale}px`,height:`${90*o.scale}px`}),onClick:f},[t("div",Ko,y(o.text),1),en,t("div",tn,[e(m)?(a(),M(g,{key:0,size:"14",color:"#B67829"})):(a(),d("span",sn," +"+y(e(x)<1?e(W)(e(x),4):e(W)(e(x),2)),1))]),Bt(c.$slots,"default",{},void 0,!0)],6)),[[xe,!p.value]])}}}),nn=E(on,[["__scopeId","data-v-7ab7cf68"]]),mt=o=>(j("data-v-436b4b17"),o=o(),H(),o),an={class:"release-component"},ln={class:"progress-bar__wrap absolute z-10 left-[-16px] top-[50px]"},cn=mt(()=>t("div",{class:"progress_pattern"},null,-1)),rn=[cn],un={class:"progress_word absolute z-10 left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2"},dn=mt(()=>t("img",{class:"absolute z-10 right-[2px] top-1/2 transform -translate-y-1/2 w-[12px] h-[12px]",src:Yo,alt:""},null,-1)),mn={props:{bowlStyle:{type:Object,default:()=>({})},text:{type:String,required:!0},releaseSecond:{type:Number,default:0},bubbleLoading:{type:Boolean,default:!1}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:h,emit:r}){const u=le(),{contributesStore:l}=ce(),i=_(!1),$=R(()=>l.releaseData||{}),m=_(!1),x=R(()=>{const g=+$.value.monthTotal||0,I=+$.value.remainTotal||0;return g>0?I/g:0}),S=()=>{m.value=!0,r("releaseStart")},p=()=>{T(),r("releaseSuccess"),setTimeout(async()=>{await l.fetchUserRelase(),setTimeout(()=>{m.value=!1},1e3)},12e3)},f=()=>{m.value=!1,r("releaseFail")},c=_(null),T=async()=>{i.value=!0,await l.getNaturalReleaseTimes(),i.value=!1};return h({releaseBubbleRef:c}),ie(()=>{T()}),(g,I)=>(a(),d("div",an,[t("img",{src:Zo,class:"cat-food w-[60px] h-[44px] absolute z-[1]",style:U(o.bowlStyle),role:"img",alt:"猫粮盆"},null,4),e(W)(+e(l).freeRelease)>0?(a(),M(nn,{key:0,ref:(v,B)=>{B.releaseBubbleRef=v,c.value=v},class:"absolute left-[-16px] top-[-96px] z-50",style:U([{transition:"opacity 0.2s ease-in"},{opacity:m.value?0:1}]),text:o.text,bubbleLoading:m.value,onReleaseSuccess:p,onReleaseStart:S,onReleaseFail:f},null,8,["style","text","bubbleLoading"])):ee("",!0),t("div",ln,[t("div",{class:"progress_bar relative flex items-center",onClick:I[0]||(I[0]=v=>e(u).push("/releaseTimeDetail"))},[t("div",{class:"progress_act",style:U(`width: calc(${e(x)} * 177px / 2)`)},rn,4),t("div",un,y(e($).remainTotal||0)+"/"+y(e($).monthTotal||0),1),dn])])]))}},pn=E(mn,[["__scopeId","data-v-436b4b17"]]),fn={class:"multi-lottie-container relative"},vn={props:{animation:{type:String,default:"wink",validator:o=>["eat2","eat1","wink"].includes(o)},lottieClass:{type:String,default:""},lottieStyle:{type:Object,default:()=>({})}},emits:["complete"],setup(o,{expose:h,emit:r}){const u=o,l={eat2:{path:"lottie/eat_v2.json",loop:!0},eat1:{path:"lottie/eat.json",loop:!1},wink:{path:"lottie/wink.json",loop:!0}},i=_(u.animation),$=_(null),m=_(null),x=_(null),S=R(()=>{switch(i.value){case"eat2":return $.value;case"eat1":return m.value;case"wink":return x.value;default:return x.value}});ct(()=>u.animation,v=>{v!==i.value&&["eat2","eat1","wink"].includes(v)&&(i.value=v,he(()=>{p()}))});const p=()=>{const v=S.value;if(v)try{i.value==="wink"?v.handlePlay():v.handleGoToAndPlay(0)}catch(B){console.warn("Failed to play animation:",B)}},f=()=>{i.value!=="wink"&&(i.value="wink",he(()=>{p()})),r("complete",i.value)};return h({setAnimation:v=>{["eat2","eat1","wink"].includes(v)?(i.value=v,he(()=>{p()})):console.warn(`Invalid animation key: ${v}`)},play:()=>{p()},pause:()=>{const v=S.value;if(v&&typeof v.pause=="function")try{v.handlePause()}catch(B){console.warn("Failed to pause animation:",B)}},stop:()=>{const v=S.value;if(v&&typeof v.stop=="function")try{v.handleStop()}catch(B){console.warn("Failed to stop animation:",B)}},getCurrentLottieRef:S}),he(()=>{p()}),(v,B)=>(a(),d("div",fn,[we(k(Ne,{class:K(["lottie-item eat-2",o.lottieClass]),style:U(o.lottieStyle),path:l.eat2.path,loop:l.eat2.loop,ref:(z,F)=>{F.eat2Ref=z,$.value=z},autoplay:!1,onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="eat2"]]),we(k(Ne,{class:K(["lottie-item",o.lottieClass]),style:U(o.lottieStyle),path:l.eat1.path,loop:l.eat1.loop,ref:(z,F)=>{F.eat1Ref=z,m.value=z},autoplay:!1,onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="eat1"]]),we(k(Ne,{class:K(["lottie-item",o.lottieClass]),style:U(o.lottieStyle),path:l.wink.path,loop:l.wink.loop,autoplay:!0,ref:(z,F)=>{F.winkRef=z,x.value=z},onComplete:f},null,8,["class","style","path","loop"]),[[xe,i.value==="wink"]])]))}},hn=E(vn,[["__scopeId","data-v-7a50b9a2"]]),gn="/Test-dev/static/images/roadSigns-DPiZ1yw1.png",_n={},wn={class:"p-3 flex justify-center items-center"},xn=t("img",{src:gn,alt:"road-sign",class:"w-[78px]"},null,-1),bn=[xn];function yn(o,h){return a(),d("div",wn,bn)}const $n=E(_n,[["render",yn]]),Sn="/Test-dev/static/webp/cat-house-min-D9fPn9IA.webp",pt=o=>(j("data-v-1322bf64"),o=o(),H(),o),Tn={class:"mascot-cat__container relative"},In=pt(()=>t("div",{class:"pre-bg"},null,-1)),kn=["lowsrc"],Cn=["src"],Rn=pt(()=>t("img",{src:Qo,class:"w-[100px]",alt:"猫影子"},null,-1)),Bn=[Rn],Ln={props:{vsageUserInfo:{type:Object,default:()=>({})}},emits:["releaseStart","releaseSuccess","releaseFail"],setup(o,{expose:h,emit:r}){const u=o,l=le(),{t:i}=te(),{contributesStore:$}=ce();dt();const m=R(()=>{var L,A;return console.log("nftId",(L=u.vsageUserInfo)==null?void 0:L.nftTokenId),(A=u.vsageUserInfo)==null?void 0:A.nftTokenId}),x=_(1),S=_(0),p=()=>{let A=0;window.innerWidth>=640?A=375:A=window.innerWidth,S.value=Number(A),x.value=A/375},f=R(()=>({transform:` scale(${x.value})`,transformOrigin:"top left",top:`${.6784*S.value+5}px`,left:`${50*x.value}px`,zIndex:10})),c=R(()=>({transform:`scale(${x.value})`,transformOrigin:"top right",top:`${.6784*S.value+6}px`,right:`${12*x.value-10}px`})),T=R(()=>({width:"140px",top:`${.6784*S.value+-60}px`,zIndex:2})),g=R(()=>({width:"100px",top:`${.6784*S.value+79}px`,zIndex:1})),I=_(null),v=_("wink"),B=L=>{v.value=L,I.value&&I.value.setAnimation(L)},z=()=>{r("releaseStart"),B("eat2")},F=()=>{B("eat2"),setTimeout(()=>{r("releaseSuccess")},3e3),setTimeout(()=>{B("wink")},4e3)},re=()=>{r("releaseFail"),B("wink")},$e=()=>{console.log("handleToPlaza"),l.push({path:"/plaza",query:{from:"home"}})};return ie(()=>{window.addEventListener("resize",p),p()}),De(()=>{window.removeEventListener("resize",p)}),h({setLottie:B}),(L,A)=>(ae("van-button"),a(),d("div",Tn,[In,t("img",{lowsrc:e(Sn),src:Vo,class:"cat-house w-[257px] h-[252px] absolute top-[31px] left-0 z-0",style:U({transform:` scale(${x.value})`,transformOrigin:"top left"}),role:"img",decoding:"async",alt:"猫爬架"},null,12,kn),k(pn,{ref:(Y,se)=>{se.releaseComponentRef=Y},text:L.$t("integral.nature"),"release-second":e($).releaseSecond,onReleaseStart:z,onReleaseSuccess:F,onReleaseFail:re,style:U(e(f))},null,8,["text","release-second","style"]),e(m)===-1||e(m)===null||e(m)===void 0?(a(),M(hn,{key:0,class:"pointer-events-none mx-auto absolute w-[140px] left-0 right-0",style:U(e(T)),animation:v.value,ref:(Y,se)=>{se.multiLottieRef=Y,I.value=Y}},null,8,["style","animation"])):(a(),d("div",{key:1,class:"absolute ip-box-img left-0 right-0 mx-auto flex justify-center items-center",style:U(e(T))},[t("img",{src:e(Gt)(`nft/nft-${e(m)}.png`)},null,8,Cn)],4)),e(m)===-1||e(m)===null||e(m)===void 0?(a(),d("div",{key:2,class:"cat-shadow pointer-events-none mx-auto absolute w-[100px] left-0 right-0 bottom-0",style:U(e(g))},Bn,4)):ee("",!0),k($n,{class:"absolute",style:U(e(c)),onClick:Lt($e,["self"])},null,8,["style","onClick"]),ee("",!0)]))}},Pn=E(Ln,[["__scopeId","data-v-1322bf64"]]),Un=o=>(j("data-v-979ecdba"),o=o(),H(),o),An={class:"relative home-app w-full overflow-hidden font-Puhui"},zn={class:"home__container h-auto pb-20 w-full"},Nn={class:"top-ui__wrap relative z-20"},Dn={class:"bottom-ui__wrap flex flex-col justify-end px-3 pb-[90px] w-full z-10 pointer-events-none"},En={class:"flex items-end justify-between pointer-events-none"},Fn={class:"mt-3 pointer-events-auto"},On={class:"mt-3 pointer-events-auto"},Mn={key:0,class:"fixed top-0 bottom-0 left-0 right-0 z-50 min-h-screen min-w-screen"},Wn=Un(()=>t("div",{style:{color:"red"},class:"frame"},null,-1)),jn=Q({name:"Home"});function Hn(o){var tt,st;qt();const{activeStatus:h,activeAmounts:r}=ss(),{getCurrentAccount:u}=Ee(),{contributesStore:l}=ce(),{pointBalances:i,pointWithdraw:$}=be(),m=Vt(),x=Qt(),{trade:S}=be(),{tradeWithUsdt:p}=Zt(),{t:f}=te(),c=le(),[T,g]=D(!1),[I,v]=D(!1),[B,z]=D(!1),[F,re]=D(!1),[$e,L]=D(!1),[A,Y]=D(!0),[se,ft]=D(!0),[Me,ue]=D(!1),[vt,G]=D(!1),[We,Se]=D(!1),[ht,Te]=D(!1),je=_(null),{userInfo:q,changeUserInfo:gt}=rt(),{getOneBalance:de}=Yt(),oe=_(["MCOIN","MUSD","MAI"]),w=Pt({nftActive:!1,userInfo:{address:"",userName:""},contributesOld:0,userContributes:{contributes:0,consumes:0,payments:0,releaseSecond:0},vsageUserInfo:{nickName:((tt=q==null?void 0:q.vsageUserInfo)==null?void 0:tt.nickName)||"",nftTokenId:((st=q==null?void 0:q.vsageUserInfo)==null?void 0:st.nftTokenId)||-1},nftId:-1,coinPoint:0,userActiveStatus:0,userActiveTime:null,pointBalance:null,mcoinBalance:null,usdtBalance:null,allowance:0}),Ie=async()=>{w.pointBalance=await i(),Y(!1)},me=async()=>{w.mcoinBalance=await(await m).balanceOf(),ft(!1)},ke=async()=>{try{w.usdtBalance=await(await x).balanceOf(u())}catch{w.usdtBalance=0}},He=async()=>{const s=await(await m).allowance(Jt.flashMall);w.allowance=s.result},Ge=s=>{if(typeof s=="string"&&s.indexOf("address")!==-1&&(s.indexOf("offlineSubmit")!==-1||s.indexOf("pay")!==-1)){g(!1);const n=V(s,"address"),C=V(s,"ratio"),P=V(s,"caddr"),b=V(s,"cname"),N=V(s,"amount"),X=V(s,"orderType"),ne=V(s,"key");c.push({path:"/offlineSubmit",query:{address:n,ratio:C,caddr:P,cname:b,amount:N,orderType:X,key:ne}})}if(typeof s=="string"&&s.indexOf("goodsDetail")!==-1&&s.indexOf("id")!==-1&&(g(!1),c.push({path:"/goodsDetail",query:{id:s.split("=")[1]}})),typeof s=="string"&&s.indexOf("offlineGoodsDetail")!==-1&&s.indexOf("goodsId")!==-1&&(g(!1),c.push({path:"/offlineGoodsDetail",query:{goodsId:s.split("=")[1]}})),typeof s=="string"&&s.indexOf("shop")!==-1&&s.indexOf("shopId")!==-1&&(g(!1),c.push({path:"/shop",query:{shopId:s.split("=")[1]}})),typeof s=="string"&&s.indexOf("category")!==-1&&s.indexOf("shopId")!==-1){const n=_t(s,"shopId");g(!1),c.push({path:"/category",query:{deliveryType:1,init:1,shopId:n}})}};function _t(s,n){const C=s.substring(s.indexOf("#")+1),P=C.indexOf("?"),b=P!==-1?C.substring(P+1):"";return new URLSearchParams(b).get(n)}const wt=s=>{s.catch(()=>{_e(f("common.scanError")),g(!1)})},qe=()=>{v(!1),z(!0)},Ce=s=>{c.push(s)},Ve=async()=>{const s=await ns(u());!s.success||!s.data||(w.contributesOld=w.userContributes.contributes||0,w.userInfo=s.data)},Qe=_(),xt=R(()=>Qe.value&&Qe.value.memberLevel||0),bt=async()=>{if(!lt.isConnected()||!as.versions.android)return g(!0);lt.invokeQRScanner().then(s=>{Ge(s)}).catch(s=>{_e(s)})},Re=async()=>{const s=await os();!s.success||!s.data||(w.vsageUserInfo=s.data,gt({...q,vsageUserInfo:w.vsageUserInfo}))},yt=async(s,n,C)=>{if(C==="USDT")$t(s,n);else{G(!0);try{const P=await S(u(),s,n);if(!P.success)return G(!1);await P.result.wait(),G(!1),ue(!1),Be("eat1"),Le(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3)}finally{G(!1)}}},$t=async(s,n)=>{G(!0);try{const C=await p(u(),s,n);if(!C.success)return;await C.result.wait(),G(!1),ue(!1),Be("eat1"),Le(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3)}finally{G(!1)}},St=s=>{s==="USDT"?ke():me()},Tt=async(s,n)=>{Te(!0);try{const C=await $(s,n);if(Te(!1),!C.success)return;_e(f("maiPledge.Extraction successful")),Se(!1),Be("eat1"),Le(),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),je.value.amount=null}finally{Te(!1)}},Ze=async()=>{var P,b,N;const s=await r();w.coinPoint=+s||0;const n=await h();if(!n.success)return;w.userActiveStatus=Number(((P=n.result)==null?void 0:P.status)||0);const C=Xt(((b=n.result)==null?void 0:b.time)*1e3);w.userActiveTime={dateTime:C,cutdownTimestamp:+((N=n.result)==null?void 0:N.time)*1e3,m:C.split("-")[1].padStart(2,"0"),d:C.split("-")[2].split(" ")[0].padStart(2,"0"),h:C.split("-")[2].split(" ")[1].split(":")[0].padStart(2,"0")}},Ye=_(null),Be=s=>{Ye.value.setLottie(s)},Le=async()=>{Ve(),l.fetchContributes(),Re(),Ze(),Ie(),me(),ke(),He(),oe.value.forEach(s=>de(s)),setTimeout(()=>{document.title="首页"},500)},Pe=_(!1),Ue=()=>{Ve(),Re(),He(),setTimeout(()=>{document.title="首页"},500)},O=at(()=>{Pe.value&&(localStorage.getItem("isRegister")?(localStorage.removeItem("isRegister"),setTimeout(()=>{l.fetchContributes(),l.fetchRelaseByScan()},3e3)):(l.fetchContributes(),l.fetchRelaseByScan()),Ze(),Ie(),me(),ke())},3e4,{immediateCallback:!0});let pe,Ae;const It=()=>{O.pause()},kt=()=>{O.resume(),Ae=0,pe=at(()=>{Ae<3?(console.log("getPointBalance/getMcoinBalance"),Ie(),me(),oe.value.forEach(s=>de(s))):pe.pause(),Ae++},3e3)},Ct=()=>{O.resume()},Xe=_(375),Je=_(0),ze=()=>{Xe.value=window.innerWidth,Je.value=window.innerHeight,setTimeout(()=>{fe()},100)};R(()=>Math.min(640,Xe.value)/Je.value);const Ke=_(0),et=_(0),fe=()=>{const s=document.querySelector(".top-ui__wrap"),n=document.querySelector(".bottom-ui__wrap"),C=document.querySelector(".main-ui__wrap");if(s&&n){const P=s.getBoundingClientRect(),b=n.getBoundingClientRect(),N=C.getBoundingClientRect(),X=P.bottom,ne=b.top,Rt=N.top,ot=X+(ne-X)/2;return Ke.value=ot-235||0,et.value=Math.max(Rt+40,88),{topUiBottom:X,bottomUiTop:ne,centerPoint:ot,distance:ne-X}}else return null};return ie(()=>{Ue(),ze(),window.addEventListener("resize",ze),l.releaseSecond=0,l.releaseSecondFlag=!1,l.freeRelease=0,setTimeout(()=>{fe()},100),document.addEventListener("visibilitychange",function(){document.hidden||(Ue(),oe.value.forEach(s=>de(s)),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),setTimeout(()=>{fe()},100),O.pause(),setTimeout(()=>{Pe.value=!0,O.resume()},500),console.log("fm-home show"))})}),Ut(()=>{Ue(),oe.value.forEach(s=>de(s)),setTimeout(()=>{l.getNaturalReleaseTimes()},3e3),setTimeout(()=>{fe()},100),O.pause(),setTimeout(()=>{Pe.value=!0,O.resume()},500)}),De(()=>{window.removeEventListener("resize",ze),O&&O.pause(),pe&&pe.pause()}),(s,n)=>{var P;const C=ae("van-icon");return a(),d("div",An,[t("div",zn,[t("div",Nn,[t("div",{class:"bg-test absolute left-0 top-0 w-full",style:U({height:et.value+"px"})},null,4),k(_s,{tokens:oe.value,info:e(w).userInfo,vsageUserInfo:e(w).vsageUserInfo,onSetLevelShow:n[0]||(n[0]=b=>e(v)(!0)),onSetEditNameShow:n[1]||(n[1]=b=>e(re)(!0))},null,8,["tokens","info","vsageUserInfo"]),k(Us,{onHandleTo:Ce,onScan:bt,onInvite:qe})]),t("div",{class:"main-ui__wrap w-full absolute top-0",style:U({transform:`translateY(${Ke.value}px)`})},[k(Pn,{ref:(b,N)=>{N.gameGrassRef=b,Ye.value=b},vsageUserInfo:e(w).vsageUserInfo,onReleaseStart:It,onReleaseSuccess:kt,onReleaseFail:Ct},null,8,["vsageUserInfo"])],4),t("div",Dn,[t("div",En,[k(no,{class:"point-times__wrap pointer-events-auto",contributes:e(l).contributes,coinPoint:e(w).coinPoint,userActiveStatus:e(w).userActiveStatus,userActiveTime:e(w).userActiveTime,onHandleOpen:n[2]||(n[2]=b=>e(L)(!0))},null,8,["contributes","coinPoint","userActiveStatus","userActiveTime"]),k(vo,{onHandleTo:Ce,class:"pointer-events-auto"})]),t("div",Fn,[k(jo,{contributes:e(l).contributes,contributesLoading:e(l).loading,pointBalance:e(w).pointBalance,mcoinBalance:e(w).mcoinBalance,pointLoading:e(A),mcoinLoading:e(se)},null,8,["contributes","contributesLoading","pointBalance","mcoinBalance","pointLoading","mcoinLoading"])]),t("div",On,[k(qo,{onInvest:n[3]||(n[3]=b=>e(ue)(!0)),onWithdraw:n[4]||(n[4]=b=>e(Se)(!0))})])])]),k(zt,{show:e(I),userInfo:e(w).userInfo,memberLevel:e(xt),onClose:n[5]||(n[5]=b=>e(v)(!1)),onInvite:qe,onHandleTo:Ce},null,8,["show","userInfo","memberLevel"]),k(Nt,{show:e(B),onClose:n[6]||(n[6]=b=>e(z)(!1))},null,8,["show"]),e(T)?(a(),d("div",Mn,[t("div",{class:"absolute z-50 text-white top-2 left-2",onClick:n[7]||(n[7]=b=>e(g)(!1))},[k(C,{name:"arrow-left"})]),k(e(At.QrStream),{onDecode:Ge,onInit:wt},{default:it(()=>[Wn]),_:1})])):ee("",!0),k(Ft,{show:e(F),userName:(P=e(w).vsageUserInfo)==null?void 0:P.nickName,onClose:n[8]||(n[8]=b=>e(re)(!1)),onSuccess:n[9]||(n[9]=b=>Re())},null,8,["show","userName"]),k(Ot,{show:e($e),onClose:n[10]||(n[10]=b=>e(L)(!1))},null,8,["show"]),e(Me)?(a(),M(es,{key:1,show:e(Me),MCOINBalance:+e(w).mcoinBalance+ +e(w).pointBalance,pointBalance:+e(w).pointBalance,USDTBalance:+e(w).usdtBalance,loading:e(vt),owner:e(u)(),onClose:n[11]||(n[11]=b=>e(ue)(!1)),onHanldeInvest:yt,onChangeBalance:St},null,8,["show","MCOINBalance","pointBalance","USDTBalance","loading","owner"])):ee("",!0),e(We)?(a(),M(ts,{key:2,ref:(b,N)=>{N.withdrawRef=b,je.value=b},show:e(We),balance:e(w).pointBalance,loading:e(ht),onClose:n[12]||(n[12]=b=>e(Se)(!1)),onHandleWithdraw:Tt},null,8,["show","balance","loading"])):ee("",!0)])}}const Gn=Q({...jn,setup:Hn}),va=E(Gn,[["__scopeId","data-v-979ecdba"]]);export{va as default};
