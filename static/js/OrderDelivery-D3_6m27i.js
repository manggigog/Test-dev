import{z as w,F as N,G as i,H as o,I as s,P as _,Q as t,O as n,U as C,J as $,_ as we,q as Ce,a2 as ke,bl as Ie,Z as A,$ as Ve,a4 as Ee,o as Te,r as Ke,E as Be,K as De}from"./vendor-Dr_RpJ_Y.js";import{_ as Me}from"./mcoin-logo-1-Deho8IWN.js";import{k as Se}from"./useOrderStatus-CUBDjZMz.js";import{P as Le}from"./flashSale-DDyqLyYN.js";import{r as Pe,V as Ae}from"./index-7OiUoGXy.js";import{u as Fe}from"./useShipTemplate-VxaDU85Q.js";import{B as He,a as Ue,v as Re}from"./order-D0_No2Ew.js";import{B as Oe}from"./BackIcon-CDrGaEPo.js";import"./enums-DlE-aiss.js";const je={class:"gap-2 mt-3 flex-center-bw"},qe={class:"flex flex-col justify-between flex-1 h-20"},Ge={class:"font-semibold flex-center-bw"},ze={class:"mr-2 line-clamp-2"},Je={key:0,class:"flex items-baseline flex-shrink-0 gap-1 text-primary"},Qe=["src"],We={class:"text-xs"},Ze={key:1,class:"flex items-baseline flex-shrink-0 gap-1 text-primary"},Xe=s("img",{src:Me,class:"w-3 h-3",alt:""},null,-1),Ye=s("span",{class:"text-xs"},"Mcoin",-1),es={class:"font-semibold text-primary flex-center-bw"},ss={class:"opacity-60 text-default"},ts={class:"flex justify-end opacity-60"},as={class:"mt-1 flex-center-bw"},rs={class:"text-b3 text-sm font-normal"},ds={class:"flex items-center text-b3 text-sm font-normal"},os=w({props:{order:null,goods:null},setup(a){const{order:h,goods:g}=a,{getExpressTypeText:u}=Fe(),f=Se();return(x,v)=>{var y,e,d;const r=N("VanImage");return o(),i($,null,[s("div",je,[_(r,{src:a.goods.icons.split(",")[0],class:"w-20 h-20 overflow-hidden rounded-xl",fit:"cover",alt:""},null,8,["src"]),s("div",qe,[s("div",null,[s("div",Ge,[s("div",ze,t(a.goods.goodsName),1),a.order.payType===n(Le).STORE_CARD?(o(),i("div",Je,[(y=a.order.fmStoredCard)!=null&&y.symbolLogo?(o(),i("img",{key:0,src:(e=a.order.fmStoredCard)==null?void 0:e.symbolLogo,class:"w-3 h-3",alt:""},null,8,Qe)):C("",!0),s("span",null,t(a.goods.cardPrice),1),s("span",We,t((d=a.order.fmStoredCard)==null?void 0:d.symbol),1)])):(o(),i("div",Ze,[Xe,s("span",null,t(a.goods.price),1),Ye]))]),s("div",es,[s("div",null,t(n(f)[a.order.status+""]),1),s("div",ss,"x"+t(a.goods.number),1)])]),s("div",ts,t(x.$t("order.deliveryTime"))+" "+t(a.order.expressTime&&n(Pe)(a.order.expressTime)||"-"),1)])]),s("div",null,[s("div",as,[s("div",rs,t(x.$t("order.expressPrice")),1),s("div",ds,t(n(u)(a.goods)),1)])])],64)}}}),ns={class:"px-3 py-4 mt-3 bg-white rounded-xl"},is={class:"flex-center-bw"},ls={class:"opacity-60"},cs={class:"mt-3 flex-center-bw"},us={class:"mr-2 opacity-60 whitespace-nowrap"},ms={key:1,class:"text-right break-all"},ps={class:"mt-3 flex-center-bw"},hs={class:"mr-2 opacity-60 whitespace-nowrap"},ys={key:1,class:"text-right break-all"},fs={class:"mt-3"},xs={class:"opacity-60"},vs={class:"bg-[#f2f0ef] rounded-md py-2 px-2 mt-2"},gs={key:0,class:"mt-5 flex-center"},bs=w({props:{order:null},setup(a){const h=a,{getMerchantDhKey:g,encryptKey:u}=Ae(),f=Ce(),[x,v]=ke(!1),r=Ie({expressCompany:"",expressNo:"",orderId:h.order.id}),y=async()=>{var p;const e=await g((p=h.order)==null?void 0:p.address);let d={expressCompany:r.expressCompany,expressNo:r.expressNo,orderId:r.orderId,shippingHash:null};if(e){const l=u(r.expressNo,e);d.expressNo=l.encrypt,d.shippingHash=l.hash;const b=u(r.expressCompany,e);d.expressCompany=b.encrypt}v(!0),(await He(d)).success&&f.back(),v(!1)};return(e,d)=>{const m=N("VanField"),p=N("VanButton");return o(),i("div",null,[s("div",ns,[s("div",is,[s("div",ls,t(e.$t("order.deliveryType")),1),s("div",null,t(e.$t("order.deliveryMyself")),1)]),s("div",cs,[s("div",us,t(e.$t("order.deliveryId")),1),a.order.status===1?(o(),A(m,{key:0,class:"flex-1","input-align":"right",modelValue:n(r).expressNo,"onUpdate:modelValue":d[0]||(d[0]=l=>n(r).expressNo=l),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])):(o(),i("div",ms,t(a.order.expressNo),1))]),s("div",ps,[s("div",hs,t(e.$t("order.deliveryCompany")),1),a.order.status===1?(o(),A(m,{key:0,class:"flex-1","input-align":"right",modelValue:n(r).expressCompany,"onUpdate:modelValue":d[1]||(d[1]=l=>n(r).expressCompany=l),placeholder:e.$t("shop.pleaseInput")},null,8,["modelValue","placeholder"])):(o(),i("div",ys,t(a.order.expressCompany),1))]),s("div",fs,[s("div",xs,t(e.$t("order.refundAddress")),1),s("div",vs,[s("div",null,t(a.order.stores.storeName),1),s("div",null,t(a.order.stores.contact)+" "+t(a.order.stores.location)+" "+t(a.order.stores.contactAddress),1)])])]),a.order.status===1?(o(),i("div",gs,[_(p,{class:"mb-[50px] inline-block btn-orange btn-shadow w-[150px] h-[40px] text-white",loading:n(x),disabled:!n(r).expressNo||!n(r).expressCompany,onClick:y},{default:Ve(()=>[Ee(t(e.$t("order.Ship")),1)]),_:1},8,["loading","disabled"])])):C("",!0)])}}}),_s=we(bs,[["__scopeId","data-v-6da57c35"]]),Ns={class:"h-full px-3 bg-[#f2f0ef]"},$s={class:"gap-2 mt-2 flex-start"},As={class:"px-3 py-4 mt-3 bg-white rounded-xl"},ws={class:"flex-center-bw"},Cs={class:"opacity-60"},ks={class:"font-semibold"},Is={class:"break-all"},Vs={class:"mt-4 text-base font-semibold text-black"},Es={class:"mt-1 opacity-60"},Hs=w({setup(a){const{getMerchantDhKey:h,decryptAddressKey:g,decryptKey:u,cryptoAESWithSearch:f}=Ae(),v=Te().query.id,r=Ke(null),y=async()=>{var l,b,k,I,V,E,T,K,B,D,M,S,L,P,F,H,U,R,O,j,q,G,z,J,Q,W,Z,X,Y,ee,se,te,ae,re,de,oe,ne,ie,le,ce,ue,me,pe,he,ye,fe,xe,ve,ge,be,_e,Ne;const e=await Ue({id:v});let d="";if((l=e.data)!=null&&l.userAddress&&(e.data.userAddress.postscript=e.data.postscript),(b=e.data)!=null&&b.userAddress&&((I=(k=e.data)==null?void 0:k.userAddress)!=null&&I.encryptFlag)){const c=await h(e.data.address,(V=e.data)==null?void 0:V.submitUserPubKey);c&&(e.data.userAddress=g(e.data.userAddress,c),(T=(E=e.data)==null?void 0:E.userAddress)!=null&&T.success&&!((K=e.data)!=null&&K.merchantEns)&&(d+=((D=(B=e.data)==null?void 0:B.userAddress)==null?void 0:D.userName)+((S=(M=e.data)==null?void 0:M.userAddress)==null?void 0:S.telNumber)+(((P=(L=e.data)==null?void 0:L.userAddress)==null?void 0:P.postalCode)??"")+((H=(F=e.data)==null?void 0:F.userAddress)==null?void 0:H.provinceName)+((R=(U=e.data)==null?void 0:U.userAddress)==null?void 0:R.cityName)+((j=(O=e.data)==null?void 0:O.userAddress)==null?void 0:j.countyName)+((G=(q=e.data)==null?void 0:q.userAddress)==null?void 0:G.detailInfo)+((J=(z=e.data)==null?void 0:z.userAddress)==null?void 0:J.postscript)))}else(Q=e.data)!=null&&Q.merchantEns||(d+=((Z=(W=e.data)==null?void 0:W.userAddress)==null?void 0:Z.userName)+((Y=(X=e.data)==null?void 0:X.userAddress)==null?void 0:Y.telNumber)+(((se=(ee=e.data)==null?void 0:ee.userAddress)==null?void 0:se.postalCode)??"")+((ae=(te=e.data)==null?void 0:te.userAddress)==null?void 0:ae.provinceName)+((de=(re=e.data)==null?void 0:re.userAddress)==null?void 0:de.cityName)+((ne=(oe=e.data)==null?void 0:oe.userAddress)==null?void 0:ne.countyName)+((le=(ie=e.data)==null?void 0:ie.userAddress)==null?void 0:le.detailInfo)+((ue=(ce=e.data)==null?void 0:ce.userAddress)==null?void 0:ue.postscript));if(e.data.shippingHash){const c=await h(e.data.address,(me=e.data)==null?void 0:me.shippingUserPubKey);if(c){const $e=u(e.data.expressNo,c);$e.hash===e.data.shippingHash&&(e.data.expressNo=$e.decrypt,e.data.expressCompany=u(e.data.expressCompany,c).decrypt,(pe=e.data)!=null&&pe.merchantEns||(d+=((he=e.data)==null?void 0:he.expressNo)+((ye=e.data)==null?void 0:ye.expressCompany)))}else(fe=e.data)!=null&&fe.merchantEns||(d+=((xe=e.data)==null?void 0:xe.expressNo)+((ve=e.data)==null?void 0:ve.expressCompany));(ge=e.data)!=null&&ge.merchantEns||(d+=((be=e.data)==null?void 0:be.hash)+((_e=e.data)==null?void 0:_e.address))}const p=[{id:(Ne=e.data)==null?void 0:Ne.id,merchantEns:await f(d)}].filter(c=>c.merchantEns);p.length>0&&Re({enInfoList:p}),r.value=e.data};return Be(async()=>{await y()}),(e,d)=>(o(),i("div",Ns,[s("div",$s,[_(Oe),s("div",null,t(e.$t("order.deliver")),1)]),r.value?(o(),i($,{key:0},[s("div",As,[s("div",ws,[s("div",Cs,t(e.$t("order.orderNumber")),1),s("div",ks,t(r.value.id),1)]),(o(!0),i($,null,De(r.value.orderGoods,m=>(o(),A(os,{key:m.goodsName,goods:m,order:r.value},null,8,["goods","order"]))),128)),s("div",Is,[s("div",Vs,t(r.value.userAddress.provinceName??"")+t(r.value.userAddress.cityName)+" "+t(r.value.userAddress.countyName)+t(r.value.userAddress.detailInfo),1),s("div",Es,t(r.value.userAddress.userName)+t(r.value.userAddress.telNumber),1)])]),_(_s,{order:r.value},null,8,["order"])],64)):C("",!0)]))}});export{Hs as default};
